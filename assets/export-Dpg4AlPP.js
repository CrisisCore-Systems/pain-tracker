import{_ as e}from"./pdf-vendor-zZbfvrDE.js";import{z as t,A as o,D as n,l as i}from"./index-CMuG_LiM.js";const a={debug:0,info:1,warn:2,error:3},s={enabled:"undefined"!=typeof process&&!0,minLevel:"debug",maxBufferSize:500,includeCategories:[],excludeCategories:[],consoleOutput:!0};const r=new class{config;buffer=[];listeners=[];constructor(e={}){this.config={...s,...e}}configure(e){this.config={...this.config,...e}}shouldLogCategory(e){return!this.config.excludeCategories.includes(e)&&(0===this.config.includeCategories.length||this.config.includeCategories.includes(e))}shouldLogLevel(e){return a[e]>=a[this.config.minLevel]}log(e,t,o,n,i){if(!this.config.enabled)return;if(!this.shouldLogLevel(e))return;if(!this.shouldLogCategory(t))return;const a={timestamp:(new Date).toISOString(),level:e,category:t,message:o,metadata:n,error:i};if(this.buffer.push(a),this.buffer.length>this.config.maxBufferSize&&this.buffer.shift(),this.config.consoleOutput){e.toUpperCase()}this.listeners.forEach(e=>e(a))}debug(e,t,o){this.log("debug",e,t,o)}info(e,t,o){this.log("info",e,t,o)}warn(e,t,o){this.log("warn",e,t,o)}error(e,t,o,n){this.log("error",e,t,n,o)}swallowed(e,t,o,n){const i=o instanceof Error?o:new Error(String(o));this.log("warn",e,`Swallowed error in ${t}`,{...n,operation:t},i)}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}getBuffer(){return[...this.buffer]}getByCategory(e){return this.buffer.filter(t=>t.category===e)}getByLevel(e){return this.buffer.filter(t=>t.level===e)}clearBuffer(){this.buffer=[]}exportBuffer(){return JSON.stringify(this.buffer,null,2)}},l={debug:(e,t)=>r.debug("analytics",e,t),info:(e,t)=>r.info("analytics",e,t),warn:(e,t)=>r.warn("analytics",e,t),error:(e,t,o)=>r.error("analytics",e,t,o),swallowed:(e,t,o)=>r.swallowed("analytics",e,t,o)},c=e=>{t.trackDataExport("csv").catch(e=>{l.swallowed(e,{context:"exportToCSV",exportType:"csv"})}),o("csv",e.length),n("csv",e.length);return[["Date","Time","Pain Level","Locations","Symptoms","Limited Activities","Sleep Quality","Mood Impact","Missed Work Days","Notes"].join(","),...e.map(e=>{const[t,o]=e.timestamp.split("T");return[t,(o||"").slice(0,5),e.baselineData.pain,`"${e.baselineData.locations?.join("; ")||""}"`,`"${e.baselineData.symptoms?.join("; ")||""}"`,`"${e.functionalImpact?.limitedActivities?.join("; ")||""}"`,e.qualityOfLife?.sleepQuality||"",e.qualityOfLife?.moodImpact||"",e.workImpact?.missedWork||"",`"${e.notes?.replace(/"/g,'""')||""}"`].join(",")})].join("\\n")},f=e=>(t.trackDataExport("json").catch(e=>{l.swallowed(e,{context:"exportToJSON",exportType:"json"})}),o("json",e.length),n("json",e.length),JSON.stringify(e,null,2)),g=(e,t,o="text/plain;charset=utf-8")=>{if("undefined"==typeof window)return;let n;if(e.startsWith("data:")){const[t,o]=e.split(",");n=new Blob([atob(o)],{type:t.split(":")[1].split(";")[0]})}else n=new Blob([e],{type:o});const i=window.URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(i)},u=async a=>{t.trackDataExport("pdf").catch(e=>{l.swallowed(e,{context:"exportToPDF",exportType:"pdf"})}),o("pdf",a.length),n("pdf",a.length);const{default:s}=await e(async()=>{const{default:e}=await import("./pdf-vendor-zZbfvrDE.js").then(e=>e.j);return{default:e}},[]),r=new s;r.setFontSize(20),r.text("Pain Tracking Report",20,30),r.setFontSize(12);const c=a.length>0?new Date(a[0].timestamp).toLocaleDateString():"N/A",f=a.length>0?new Date(a[a.length-1].timestamp).toLocaleDateString():"N/A";if(r.text(`Report Period: ${c} to ${f}`,20,45),r.text(`Total Entries: ${a.length}`,20,55),a.length>0){const e=a.reduce((e,t)=>e+t.baselineData.pain,0)/a.length;r.text(`Average Pain Level: ${i(e,1)}/10`,20,65);const t=p(a.flatMap(e=>e.baselineData.symptoms||[])),o=p(a.flatMap(e=>e.baselineData.locations||[]));r.text(`Most Common Symptoms: ${t.slice(0,3).join(", ")}`,20,75),r.text(`Most Common Locations: ${o.slice(0,3).join(", ")}`,20,85)}let g=105;r.setFontSize(14),r.text("Detailed Entries",20,g),g+=15,r.setFontSize(10),a.slice(0,20).forEach((e,t)=>{g>270&&(r.addPage(),g=30);const o=new Date(e.timestamp).toLocaleDateString(),n=new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(r.text(`${t+1}. ${o} ${n} - Pain: ${e.baselineData.pain}/10`,20,g),g+=8,e.baselineData.symptoms&&e.baselineData.symptoms.length>0&&(r.text(`   Symptoms: ${e.baselineData.symptoms.join(", ")}`,25,g),g+=8),e.baselineData.locations&&e.baselineData.locations.length>0&&(r.text(`   Locations: ${e.baselineData.locations.join(", ")}`,25,g),g+=8),e.notes){const t=r.splitTextToSize(`   Notes: ${e.notes}`,150);r.text(t,25,g),g+=5*t.length+5}g+=5}),a.length>20&&r.text(`... and ${a.length-20} more entries`,20,g);const u=r.getNumberOfPages();for(let e=1;e<=u;e++)r.setPage(e),r.setFontSize(8),r.text(`Generated on ${(new Date).toLocaleDateString()} - Page ${e} of ${u}`,20,285);return r.output("datauristring")},p=e=>{const t={};return e.forEach(e=>{t[e]=(t[e]||0)+1}),Object.entries(t).sort(([,e],[,t])=>t-e).map(([e])=>e)},d=Object.freeze(Object.defineProperty({__proto__:null,downloadData:g,exportToCSV:c,exportToJSON:f,exportToPDF:u},Symbol.toStringTag,{value:"Module"}));export{d as _,c as a,u as b,l as c,g as d,f as e};
