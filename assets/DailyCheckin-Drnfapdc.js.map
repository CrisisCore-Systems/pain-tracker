{"version":3,"file":"DailyCheckin-Drnfapdc.js","sources":["../../src/design-system/fused-v2/QuickLogStepper.tsx","../../src/utils/pain-tracker/checkinInsights.ts","../../src/components/checkin/DailyCheckin.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { ChevronLeft, Check, Mic, MicOff } from 'lucide-react';\r\nimport { cn } from '../utils';\r\nimport { useAdaptiveCopy } from '../../contexts/useTone';\r\nimport { quickLogCopy } from '../../content/microcopy';\r\nimport type {\r\n  SpeechRecognition,\r\n  SpeechRecognitionConstructor,\r\n  SpeechRecognitionErrorEvent,\r\n  SpeechRecognitionEvent,\r\n} from '../../types/speech';\r\nimport '../tokens/fused-v2.css';\r\n\r\ninterface QuickLogStepperProps {\r\n  onComplete: (data: {\r\n    pain: number;\r\n    locations: string[];\r\n    symptoms: string[];\r\n    notes: string;\r\n  }) => void;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst PAIN_LABELS = [\r\n  'No pain',\r\n  'Very mild',\r\n  'Mild',\r\n  'Uncomfortable',\r\n  'Moderate',\r\n  'Distracting',\r\n  'Distressing',\r\n  'Intense',\r\n  'Very intense',\r\n  'Severe',\r\n  'Unbearable',\r\n];\r\n\r\nconst LOCATION_TAGS = [\r\n  'Lower back',\r\n  'Upper back',\r\n  'Neck',\r\n  'Wrist (L)',\r\n  'Wrist (R)',\r\n  'Shoulder (L)',\r\n  'Shoulder (R)',\r\n  'Hip (L)',\r\n  'Hip (R)',\r\n  'Knee (L)',\r\n  'Knee (R)',\r\n  'Ankle (L)',\r\n  'Ankle (R)',\r\n  'Foot (L)',\r\n  'Foot (R)',\r\n  'Hand (L)',\r\n  'Hand (R)',\r\n  'Head',\r\n  'Abdomen',\r\n  'Cervical spine',\r\n  'Thoracic spine',\r\n  'Lumbar spine',\r\n];\r\n\r\nconst SYMPTOM_TAGS = [\r\n  'Aching',\r\n  'Sharp',\r\n  'Dull ache',\r\n  'Burning',\r\n  'Throbbing',\r\n  'Stabbing',\r\n  'Tingling',\r\n  'Numbness',\r\n  'Stiffness',\r\n  'Weakness',\r\n  'Cramping',\r\n  'Electric shock',\r\n];\r\n\r\ntype SpeechRecognitionWindow = Window & {\r\n  webkitSpeechRecognition?: SpeechRecognitionConstructor;\r\n  SpeechRecognition?: SpeechRecognitionConstructor;\r\n};\r\n\r\nfunction useQuickVoiceNotes() {\r\n  const [isSupported, setIsSupported] = useState(false);\r\n  const [isListening, setIsListening] = useState(false);\r\n  const [transcript, setTranscript] = useState('');\r\n  const [voiceError, setVoiceError] = useState<string | null>(null);\r\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\r\n  const lastTranscriptRef = useRef('');\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    const speechWindow = window as unknown as SpeechRecognitionWindow;\r\n    const SpeechRecognitionCtor =\r\n      speechWindow.webkitSpeechRecognition || speechWindow.SpeechRecognition;\r\n\r\n    if (SpeechRecognitionCtor) {\r\n      setIsSupported(true);\r\n      const recognition = new SpeechRecognitionCtor();\r\n      recognition.continuous = true;\r\n      recognition.interimResults = true;\r\n      recognition.onresult = (event: SpeechRecognitionEvent) => {\r\n        const resultsArray = Array.from(event.results);\r\n        const finalResults = resultsArray.filter(result => result.isFinal);\r\n        const relevantResults = finalResults.length > 0 ? finalResults : resultsArray;\r\n\r\n        const combinedTranscript = relevantResults\r\n          .map(result => result[0])\r\n          .map(r => r?.transcript ?? '')\r\n          .join('')\r\n          .trim();\r\n\r\n        if (combinedTranscript === lastTranscriptRef.current) return;\r\n        lastTranscriptRef.current = combinedTranscript;\r\n        setTranscript(combinedTranscript);\r\n      };\r\n      recognition.onerror = (event: SpeechRecognitionErrorEvent) => {\r\n        setIsListening(false);\r\n        const errorMap: Record<string, string> = {\r\n          'not-allowed': 'Microphone permissions were denied.',\r\n          network: 'Speech service not reachable right now.',\r\n          'no-speech': 'No speech detected. Try again when ready.',\r\n        };\r\n        const friendlyMessage =\r\n          (event?.error && errorMap[event.error]) ||\r\n          'Voice input stopped. Please verify microphone permissions.';\r\n        console.warn('Voice recognition error', event);\r\n        setVoiceError(friendlyMessage);\r\n      };\r\n      recognition.onend = () => setIsListening(false);\r\n      recognitionRef.current = recognition;\r\n    }\r\n\r\n    return () => {\r\n      recognitionRef.current?.stop();\r\n      recognitionRef.current = null;\r\n    };\r\n  }, []);\r\n\r\n  const startListening = useCallback(() => {\r\n    if (recognitionRef.current && !isListening) {\r\n      setTranscript('');\r\n      setVoiceError(null);\r\n      lastTranscriptRef.current = '';\r\n      try {\r\n        recognitionRef.current.start();\r\n        setIsListening(true);\r\n      } catch (error) {\r\n        console.warn('Voice recognition failed to start', error);\r\n        setVoiceError('Unable to start voice input. Please check microphone permissions.');\r\n        setIsListening(false);\r\n      }\r\n    }\r\n  }, [isListening]);\r\n\r\n  const stopListening = useCallback(() => {\r\n    if (recognitionRef.current && isListening) {\r\n      recognitionRef.current.stop();\r\n      setIsListening(false);\r\n    }\r\n  }, [isListening]);\r\n\r\n  const resetTranscript = useCallback(() => setTranscript(''), []);\r\n  const clearVoiceError = useCallback(() => setVoiceError(null), []);\r\n\r\n  return {\r\n    isSupported,\r\n    isListening,\r\n    transcript,\r\n    startListening,\r\n    stopListening,\r\n    resetTranscript,\r\n    voiceError,\r\n    clearVoiceError,\r\n  };\r\n}\r\n\r\nexport function QuickLogStepper({ onComplete, onCancel }: QuickLogStepperProps) {\r\n  const [step, setStep] = useState(1);\r\n  const [pain, setPain] = useState(5);\r\n  const [locations, setLocations] = useState<string[]>([]);\r\n  const [symptoms, setSymptoms] = useState<string[]>([]);\r\n  const [notes, setNotes] = useState('');\r\n  const [voiceMode, setVoiceMode] = useState(false);\r\n\r\n  // Adaptive copy based on patient state\r\n  const painLabel = useAdaptiveCopy(quickLogCopy.painSliderLabel);\r\n  const painHint = useAdaptiveCopy(quickLogCopy.painSliderHint);\r\n  const locationsLabel = useAdaptiveCopy(quickLogCopy.locationsLabel);\r\n  const locationsHint = useAdaptiveCopy(quickLogCopy.locationsHint);\r\n  const _bodyMapToggle = useAdaptiveCopy(quickLogCopy.bodyMapToggle);\r\n  const notesLabel = useAdaptiveCopy(quickLogCopy.notesLabel);\r\n  const notesPlaceholder = useAdaptiveCopy(quickLogCopy.notesPlaceholder);\r\n  const continueBtn = useAdaptiveCopy(quickLogCopy.continueButton);\r\n  const saveBtn = useAdaptiveCopy(quickLogCopy.saveButton);\r\n  const keyboardHintText = useAdaptiveCopy(quickLogCopy.keyboardHint);\r\n\r\n  const {\r\n    isSupported: voiceSupported,\r\n    isListening,\r\n    transcript,\r\n    startListening,\r\n    stopListening,\r\n    resetTranscript,\r\n    voiceError,\r\n    clearVoiceError,\r\n  } = useQuickVoiceNotes();\r\n\r\n  const handlePainChange = (value: number) => {\r\n    setPain(value);\r\n  };\r\n\r\n  const toggleTag = (tag: string, list: string[], setter: (val: string[]) => void) => {\r\n    if (list.includes(tag)) {\r\n      setter(list.filter(t => t !== tag));\r\n    } else {\r\n      setter([...list, tag]);\r\n    }\r\n  };\r\n\r\n  const handleNext = useCallback(() => {\r\n    if (step < 3) {\r\n      setStep(step + 1);\r\n    } else {\r\n      if (locations.length === 0) return;\r\n      onComplete({ pain, locations, symptoms, notes });\r\n    }\r\n  }, [step, pain, locations, symptoms, notes, onComplete]);\r\n\r\n  const handleBack = () => {\r\n    if (step > 1) {\r\n      setStep(step - 1);\r\n    } else {\r\n      onCancel();\r\n    }\r\n  };\r\n\r\n  const getSeverityColor = (level: number) => {\r\n    return `hsl(220, ${20 + level * 5}%, ${95 - level * 6}%)`;\r\n  };\r\n\r\n  const hasNavigator = typeof navigator !== 'undefined';\r\n  const isOffline = hasNavigator && navigator.onLine === false;\r\n  const connectionStatus = isOffline\r\n    ? 'Offline: only works if your browser/OS provides local speech.'\r\n    : 'Uses your device speech service. Offline support varies by browser/OS.';\r\n\r\n  const voiceStatusTooltip = voiceSupported\r\n    ? 'Voice Mode requires a browser with Web Speech API support (SpeechRecognition). Offline capability varies by browser/OS.'\r\n    : 'Voice Mode requires a browser with Web Speech API support (SpeechRecognition).';\r\n\r\n  const isSaveStep = step === 3;\r\n  const saveDisabledReason = isSaveStep && locations.length === 0 ? 'Select at least one location to save.' : null;\r\n  const selectionSummary = `${locations.length} location${locations.length === 1 ? '' : 's'} selected · ${symptoms.length} symptom${symptoms.length === 1 ? '' : 's'} selected`;\r\n\r\n  useEffect(() => {\r\n    if (!voiceMode && isListening) {\r\n      stopListening();\r\n    }\r\n    if (!voiceMode) {\r\n      clearVoiceError();\r\n    }\r\n  }, [isListening, voiceMode, stopListening, clearVoiceError]);\r\n\r\n  const handleInsertTranscript = () => {\r\n    if (!transcript) return;\r\n    setNotes(prev => (prev ? `${prev}\\n${transcript}` : transcript));\r\n    resetTranscript();\r\n  };\r\n\r\n  // Keyboard shortcuts for navigation\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      // Enter to continue\r\n      if (e.key === 'Enter' && !e.shiftKey) {\r\n        // Don't trigger if user is typing in textarea\r\n        if (document.activeElement?.tagName === 'TEXTAREA') return;\r\n        e.preventDefault();\r\n        handleNext();\r\n      }\r\n      // Escape to go back\r\n      if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        if (step > 1) {\r\n          setStep(step - 1);\r\n        } else {\r\n          onCancel();\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [step, handleNext, onCancel]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-surface-900 flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between p-4 border-b border-surface-700\">\r\n        <button\r\n          onClick={handleBack}\r\n          className={cn(\r\n            'flex items-center gap-2 px-3 py-2 rounded-[var(--radius-md)]',\r\n            'text-small text-ink-300 hover:text-ink-100 hover:bg-surface-800',\r\n            'transition-colors duration-[var(--duration-fast)]'\r\n          )}\r\n        >\r\n          <ChevronLeft className=\"w-4 h-4\" />\r\n          {step === 1 ? 'Cancel' : 'Back'}\r\n        </button>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          {[1, 2, 3].map(s => (\r\n            <div\r\n              key={s}\r\n              className={cn(\r\n                'w-2 h-2 rounded-full transition-all duration-[var(--duration-normal)]',\r\n                s === step && 'w-6 bg-primary-500',\r\n                s < step && 'bg-good-500',\r\n                s > step && 'bg-surface-600'\r\n              )}\r\n            />\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"text-small text-ink-400 text-mono w-16 text-right\">{step}/3</div>\r\n      </div>\r\n\r\n      <div className=\"p-4 pb-0\">\r\n        <div className=\"max-w-2xl mx-auto bg-surface-800 border border-surface-700 rounded-[var(--radius-lg)] p-4 flex flex-col gap-3 md:flex-row md:items-start md:justify-between\">\r\n          <div className=\"flex gap-3 items-start\">\r\n            {voiceSupported ? (\r\n              <Mic className=\"w-5 h-5 text-primary-400 mt-0.5\" aria-hidden=\"true\" />\r\n            ) : (\r\n              <MicOff className=\"w-5 h-5 text-ink-500 mt-0.5\" aria-hidden=\"true\" />\r\n            )}\r\n            <div>\r\n              <div className=\"text-body-medium text-ink-100\" title={voiceStatusTooltip}>\r\n                Voice Mode\r\n              </div>\r\n              <p className=\"text-small text-ink-400\">\r\n                {voiceSupported\r\n                  ? connectionStatus\r\n                  : \"Voice mode isn't available in this browser. You can still use your operating system's built-in dictation features.\"}\r\n              </p>\r\n              {voiceError && (\r\n                <p className=\"text-small text-danger-400\" role=\"alert\">\r\n                  {voiceError}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-tiny text-ink-500\" title={voiceStatusTooltip}>\r\n              {voiceMode ? 'On' : 'Off'} ·{' '}\r\n              {voiceSupported ? 'Speech (browser-dependent)' : 'Unavailable in this browser'}\r\n            </span>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setVoiceMode(prev => !prev)}\r\n              disabled={!voiceSupported}\r\n              aria-pressed={voiceMode}\r\n              className={cn(\r\n                'px-4 py-2 rounded-[var(--radius-md)] text-small font-medium',\r\n                'border border-surface-600 transition-colors duration-[var(--duration-fast)]',\r\n                voiceMode\r\n                  ? 'bg-primary-500 text-ink-900 border-primary-500'\r\n                  : 'bg-surface-900 text-ink-200 hover:border-primary-500/60',\r\n                !voiceSupported && 'opacity-60 cursor-not-allowed'\r\n              )}\r\n            >\r\n              {voiceMode ? 'Disable voice mode' : 'Enable voice mode'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto p-6\">\r\n        {step === 1 && (\r\n          <div className=\"max-w-2xl mx-auto space-y-6\">\r\n            <div className=\"surface-card\">\r\n              <div className=\"text-small text-ink-300\">Quick log</div>\r\n              <p className=\"text-small text-ink-400\">\r\n                Captures pain level and at least one location. Symptoms and notes are optional.\r\n                This is the fastest way to log.\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <h2 className=\"text-h2 text-ink-50 mb-2\">{painLabel}</h2>\r\n              <p className=\"text-small text-ink-400\">{painHint}</p>\r\n            </div>\r\n\r\n            {/* Direct Numeric Entry with Steppers (Accessibility Enhancement) */}\r\n            <div className=\"flex items-center justify-center gap-4 mb-6\">\r\n              <button\r\n                onClick={() => handlePainChange(Math.max(0, pain - 1))}\r\n                aria-label=\"Decrease pain level\"\r\n                className={cn(\r\n                  'flex items-center justify-center',\r\n                  'w-12 h-12 min-w-[48px] min-h-[48px]',\r\n                  'rounded-[var(--radius-md)]',\r\n                  'bg-surface-700 hover:bg-surface-600 border border-surface-600',\r\n                  'text-ink-200 hover:text-ink-100',\r\n                  'transition-colors duration-[var(--duration-fast)]',\r\n                  'text-h2 font-medium',\r\n                  'disabled:opacity-50 disabled:cursor-not-allowed'\r\n                )}\r\n                disabled={pain === 0}\r\n              >\r\n                −\r\n              </button>\r\n\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                max=\"10\"\r\n                value={pain}\r\n                onChange={e => {\r\n                  const val = Math.max(0, Math.min(10, Number(e.target.value)));\r\n                  handlePainChange(val);\r\n                }}\r\n                aria-label=\"Pain level numeric entry\"\r\n                className={cn(\r\n                  'w-24 h-16 text-center',\r\n                  'text-4xl font-bold text-mono',\r\n                  'bg-surface-800 border-2 border-surface-600',\r\n                  'text-ink-50 rounded-[var(--radius-md)]',\r\n                  'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent',\r\n                  '[appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none'\r\n                )}\r\n              />\r\n\r\n              <button\r\n                onClick={() => handlePainChange(Math.min(10, pain + 1))}\r\n                aria-label=\"Increase pain level\"\r\n                className={cn(\r\n                  'flex items-center justify-center',\r\n                  'w-12 h-12 min-w-[48px] min-h-[48px]',\r\n                  'rounded-[var(--radius-md)]',\r\n                  'bg-surface-700 hover:bg-surface-600 border border-surface-600',\r\n                  'text-ink-200 hover:text-ink-100',\r\n                  'transition-colors duration-[var(--duration-fast)]',\r\n                  'text-h2 font-medium',\r\n                  'disabled:opacity-50 disabled:cursor-not-allowed'\r\n                )}\r\n                disabled={pain === 10}\r\n              >\r\n                +\r\n              </button>\r\n            </div>\r\n\r\n            {/* Large Pain Display */}\r\n            <div\r\n              className={cn(\r\n                'p-8 rounded-[var(--radius-xl)] text-center',\r\n                'transition-all duration-[var(--duration-normal)]'\r\n              )}\r\n              style={{\r\n                backgroundColor: getSeverityColor(pain),\r\n                color: pain > 5 ? 'var(--ink-50)' : 'var(--ink-900)',\r\n              }}\r\n              role=\"status\"\r\n              aria-live=\"polite\"\r\n            >\r\n              <div className=\"text-display text-mono mb-2 text-6xl font-bold\">{pain}</div>\r\n              <div className=\"text-body-medium\">{PAIN_LABELS[pain]}</div>\r\n            </div>\r\n\r\n            {/* Slider with Ladder */}\r\n            <div className=\"space-y-2\">\r\n              <label htmlFor=\"pain-slider\" className=\"sr-only\">\r\n                Pain intensity slider. Use arrow keys or swipe to adjust.\r\n              </label>\r\n              <input\r\n                id=\"pain-slider\"\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"10\"\r\n                value={pain}\r\n                onChange={e => handlePainChange(Number(e.target.value))}\r\n                onKeyDown={e => {\r\n                  if (e.key === 'ArrowUp' || e.key === 'ArrowRight') {\r\n                    e.preventDefault();\r\n                    handlePainChange(Math.min(10, pain + 1));\r\n                  } else if (e.key === 'ArrowDown' || e.key === 'ArrowLeft') {\r\n                    e.preventDefault();\r\n                    handlePainChange(Math.max(0, pain - 1));\r\n                  }\r\n                }}\r\n                aria-label=\"Pain intensity\"\r\n                aria-valuemin={0}\r\n                aria-valuemax={10}\r\n                aria-valuenow={pain}\r\n                aria-valuetext={`${pain} of 10, ${PAIN_LABELS[pain]}`}\r\n                aria-describedby=\"pain-slider-help\"\r\n                className=\"w-full h-12 cursor-pointer appearance-none bg-transparent\r\n                  [&::-webkit-slider-track]:h-2 [&::-webkit-slider-track]:bg-gray-300 \r\n                  [&::-webkit-slider-track]:rounded-full\r\n                  [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-6 \r\n                  [&::-webkit-slider-thumb]:h-6 [&::-webkit-slider-thumb]:rounded-full \r\n                  [&::-webkit-slider-thumb]:bg-blue-600 [&::-webkit-slider-thumb]:shadow-lg\r\n                  [&::-moz-range-track]:h-2 [&::-moz-range-track]:bg-gray-300 \r\n                  [&::-moz-range-track]:rounded-full\r\n                  [&::-moz-range-thumb]:w-6 [&::-moz-range-thumb]:h-6 \r\n                  [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-blue-600 \r\n                  [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-lg\r\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\r\n              />\r\n              <div id=\"pain-slider-help\" className=\"sr-only\">\r\n                Use arrow keys to adjust pain level, or click the plus and minus buttons above for\r\n                precise control.\r\n              </div>\r\n\r\n              {/* Number Ladder */}\r\n              <div className=\"flex justify-between text-tiny text-ink-400 text-mono px-1\">\r\n                {Array.from({ length: 11 }, (_, i) => (\r\n                  <button\r\n                    key={i}\r\n                    onClick={() => handlePainChange(i)}\r\n                    aria-label={`Set pain level to ${i}, ${PAIN_LABELS[i]}`}\r\n                    className={cn(\r\n                      'w-8 h-8 min-w-[32px] min-h-[32px] rounded flex items-center justify-center',\r\n                      'hover:bg-surface-700 transition-colors',\r\n                      'focus:outline-none focus:ring-2 focus:ring-primary-500',\r\n                      i === pain && 'bg-primary-500 text-ink-900 font-bold'\r\n                    )}\r\n                  >\r\n                    {i}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {step === 2 && (\r\n          <div className=\"max-w-2xl mx-auto space-y-6\">\r\n            <div>\r\n              <h2 className=\"text-h2 text-ink-50 mb-2\">{locationsLabel}</h2>\r\n              <p className=\"text-small text-ink-400\">{locationsHint}</p>\r\n              {locations.length === 0 && (\r\n                <p className=\"text-small text-warn-400 mt-2\" role=\"note\">\r\n                  At least one location is required to save.\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Screen Reader Summary */}\r\n            <div aria-live=\"polite\" aria-atomic=\"true\" className=\"sr-only\">\r\n              {locations.length > 0\r\n                ? `${locations.length} location${locations.length > 1 ? 's' : ''} selected: ${locations.join(', ')}`\r\n                : 'No locations selected'}\r\n            </div>\r\n\r\n            {/* Location Tags */}\r\n            <fieldset>\r\n              <legend className=\"sr-only\">Pain locations</legend>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {LOCATION_TAGS.map(tag => (\r\n                  <button\r\n                    key={tag}\r\n                    onClick={() => toggleTag(tag, locations, setLocations)}\r\n                    role=\"checkbox\"\r\n                    aria-checked={locations.includes(tag)}\r\n                    aria-label={`${tag} location`}\r\n                    className={cn(\r\n                      'px-4 py-2 min-w-[48px] min-h-[48px] rounded-[var(--radius-full)] text-small',\r\n                      'border-2 transition-all duration-[var(--duration-fast)]',\r\n                      'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-surface-900',\r\n                      locations.includes(tag)\r\n                        ? 'bg-primary-500 border-primary-500 text-ink-900 font-medium'\r\n                        : 'bg-surface-800 border-surface-600 text-ink-200 hover:border-primary-500/50'\r\n                    )}\r\n                  >\r\n                    {locations.includes(tag) && (\r\n                      <Check className=\"w-3 h-3 inline mr-1\" aria-hidden=\"true\" />\r\n                    )}\r\n                    {tag}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </fieldset>\r\n\r\n            {/* Symptoms */}\r\n            <div className=\"mt-8\">\r\n              <h3 className=\"text-body-medium text-ink-200 mb-3\">What does it feel like?</h3>\r\n\r\n              {/* Screen Reader Summary */}\r\n              <div aria-live=\"polite\" aria-atomic=\"true\" className=\"sr-only\">\r\n                {symptoms.length > 0\r\n                  ? `${symptoms.length} symptom${symptoms.length > 1 ? 's' : ''} selected: ${symptoms.join(', ')}`\r\n                  : 'No symptoms selected'}\r\n              </div>\r\n\r\n              <fieldset>\r\n                <legend className=\"sr-only\">Pain symptoms</legend>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {SYMPTOM_TAGS.map(tag => (\r\n                    <button\r\n                      key={tag}\r\n                      onClick={() => toggleTag(tag, symptoms, setSymptoms)}\r\n                      role=\"checkbox\"\r\n                      aria-checked={symptoms.includes(tag)}\r\n                      aria-label={`${tag} symptom`}\r\n                      className={cn(\r\n                        'px-4 py-2 min-w-[48px] min-h-[48px] rounded-[var(--radius-full)] text-small',\r\n                        'border-2 transition-all duration-[var(--duration-fast)]',\r\n                        'focus:outline-none focus:ring-2 focus:ring-warn-500 focus:ring-offset-2 focus:ring-offset-surface-900',\r\n                        symptoms.includes(tag)\r\n                          ? 'bg-warn-500 border-warn-500 text-ink-900 font-medium'\r\n                          : 'bg-surface-800 border-surface-600 text-ink-200 hover:border-warn-500/50'\r\n                      )}\r\n                    >\r\n                      {symptoms.includes(tag) && (\r\n                        <Check className=\"w-3 h-3 inline mr-1\" aria-hidden=\"true\" />\r\n                      )}\r\n                      {tag}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </fieldset>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {step === 3 && (\r\n          <div className=\"max-w-2xl mx-auto space-y-6\">\r\n            <div>\r\n              <h2 className=\"text-h2 text-ink-50 mb-2\">{notesLabel}</h2>\r\n              <p className=\"text-small text-ink-400\">Context helps identify patterns</p>\r\n            </div>\r\n\r\n            <div>\r\n              <label htmlFor=\"pain-notes\" className=\"block text-body-medium text-ink-200 mb-2\">\r\n                Additional Notes\r\n              </label>\r\n              <textarea\r\n                id=\"pain-notes\"\r\n                value={notes}\r\n                onChange={e => setNotes(e.target.value)}\r\n                placeholder={notesPlaceholder}\r\n                inputMode=\"text\"\r\n                autoComplete=\"on\"\r\n                autoCorrect=\"on\"\r\n                autoCapitalize=\"sentences\"\r\n                enterKeyHint=\"done\"\r\n                aria-label=\"Additional notes about pain\"\r\n                aria-describedby=\"notes-hint notes-remaining\"\r\n                maxLength={500}\r\n                className={cn(\r\n                  'w-full h-32 p-4 rounded-[var(--radius-xl)]',\r\n                  'bg-surface-800 border border-surface-600',\r\n                  'text-body text-ink-100 placeholder:text-ink-500',\r\n                  'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-surface-900 focus:border-transparent',\r\n                  'transition-all duration-[var(--duration-fast)]',\r\n                  'resize-none'\r\n                )}\r\n              />\r\n              <div className=\"flex justify-between items-center mt-2\">\r\n                <span id=\"notes-hint\" className=\"text-small text-ink-400\">\r\n                  {notes.length === 0\r\n                    ? 'No notes yet'\r\n                    : `${notes.length} character${notes.length === 1 ? '' : 's'}`}\r\n                </span>\r\n                <span\r\n                  id=\"notes-remaining\"\r\n                  className=\"text-small text-ink-500\"\r\n                  aria-live=\"polite\"\r\n                  aria-atomic=\"true\"\r\n                >\r\n                  {500 - notes.length} remaining\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            {voiceMode && voiceSupported && (\r\n              <div className=\"surface-card border border-surface-700 bg-surface-800/70\">\r\n                <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\r\n                  <div>\r\n                    <div className=\"text-body-medium text-ink-100\">Voice dictation</div>\r\n                    <p className=\"text-small text-ink-400\">\r\n                      Dictates using your device speech service. {connectionStatus}\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={isListening ? stopListening : startListening}\r\n                    className={cn(\r\n                      'px-4 py-2 rounded-[var(--radius-md)] text-small font-medium',\r\n                      'border border-surface-600 transition-colors duration-[var(--duration-fast)] flex items-center gap-2',\r\n                      isListening\r\n                        ? 'bg-danger-500 text-ink-900 border-danger-500'\r\n                        : 'bg-primary-500 text-ink-900 border-primary-500'\r\n                    )}\r\n                    aria-pressed={isListening}\r\n                    aria-label={isListening ? 'Stop voice dictation' : 'Start voice dictation'}\r\n                  >\r\n                    {isListening ? <MicOff className=\"w-4 h-4\" /> : <Mic className=\"w-4 h-4\" />}\r\n                    {isListening ? 'Stop dictation' : 'Start dictation'}\r\n                  </button>\r\n                </div>\r\n\r\n                {transcript && (\r\n                  <div className=\"mt-3 p-3 rounded-[var(--radius-md)] bg-surface-900 border border-surface-700\">\r\n                    <div className=\"text-small text-ink-300 mb-1\">Heard</div>\r\n                    <p className=\"text-body text-ink-100 mb-3\" aria-live=\"polite\">\r\n                      {transcript}\r\n                    </p>\r\n                    <div className=\"flex gap-2 flex-wrap\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={handleInsertTranscript}\r\n                        className={cn(\r\n                          'px-3 py-2 rounded-[var(--radius-md)] text-small font-medium',\r\n                          'bg-primary-500 text-ink-900 hover:bg-primary-400 transition-colors'\r\n                        )}\r\n                      >\r\n                        Insert into notes\r\n                      </button>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={resetTranscript}\r\n                        className={cn(\r\n                          'px-3 py-2 rounded-[var(--radius-md)] text-small font-medium',\r\n                          'bg-surface-900 text-ink-200 border border-surface-600 hover:border-primary-500/60 transition-colors'\r\n                        )}\r\n                      >\r\n                        Clear\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Summary */}\r\n            <div className=\"surface-card\">\r\n              <div className=\"text-small text-ink-400 mb-3\">Summary</div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-ink-300\">Pain level:</span>\r\n                  <span className=\"text-mono text-ink-50 font-medium\">{pain}/10</span>\r\n                  <span className=\"text-ink-400\">({PAIN_LABELS[pain]})</span>\r\n                </div>\r\n                {locations.length > 0 && (\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <span className=\"text-ink-300\">Locations:</span>\r\n                    <span className=\"text-ink-50\">{locations.join(', ')}</span>\r\n                  </div>\r\n                )}\r\n                {symptoms.length > 0 && (\r\n                  <div className=\"flex items-start gap-2\">\r\n                    <span className=\"text-ink-300\">Symptoms:</span>\r\n                    <span className=\"text-ink-50\">{symptoms.join(', ')}</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer - Sticky for One-Handed Operation */}\r\n      <div className=\"sticky bottom-0 left-0 right-0 p-4 border-t border-surface-700 bg-surface-900/95 backdrop-blur-sm z-10\">\r\n        <div className=\"max-w-2xl mx-auto\">\r\n          {isSaveStep && (\r\n            <>\r\n              <div\r\n                className={cn('mb-2 text-small', locations.length > 0 ? 'text-ink-400' : 'text-warn-400')}\r\n                aria-live=\"polite\"\r\n              >\r\n                {selectionSummary}\r\n              </div>\r\n              {saveDisabledReason && (\r\n                <p className=\"text-small text-warn-400 mb-3\" role=\"alert\">\r\n                  {saveDisabledReason}\r\n                </p>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          <div className=\"flex gap-3\">\r\n            {step > 1 && (\r\n              <button\r\n                onClick={() => setStep(step - 1)}\r\n                className={cn(\r\n                  'px-6 py-4 rounded-[var(--radius-xl)]',\r\n                  'min-h-[56px] min-w-[56px]',\r\n                  'bg-surface-800 hover:bg-surface-700',\r\n                  'text-body-medium text-ink-200 font-medium',\r\n                  'transition-colors duration-[var(--duration-fast)]',\r\n                  'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-surface-900',\r\n                  'flex-shrink-0'\r\n                )}\r\n                aria-label=\"Go back to previous step\"\r\n              >\r\n                Back\r\n              </button>\r\n            )}\r\n            <button\r\n              onClick={handleNext}\r\n              disabled={isSaveStep && !!saveDisabledReason}\r\n              className={cn(\r\n                'flex-1 py-4 rounded-[var(--radius-xl)]',\r\n                'min-h-[56px]',\r\n                'bg-primary-500 hover:bg-primary-400',\r\n                'text-body-medium text-ink-900 font-medium',\r\n                'transition-colors duration-[var(--duration-fast)]',\r\n                'shadow-[var(--elevation-2)]',\r\n                'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 focus:ring-offset-surface-900',\r\n                isSaveStep && !!saveDisabledReason && 'opacity-60 cursor-not-allowed'\r\n              )}\r\n              aria-label={step === 3 ? 'Save pain entry' : `Continue to step ${step + 1}`}\r\n            >\r\n              {step === 3 ? saveBtn : continueBtn}\r\n            </button>\r\n          </div>\r\n        </div>\r\n        {/* Keyboard Hint */}\r\n        <div className=\"max-w-2xl mx-auto mt-2 text-center\">\r\n          <p className=\"text-xs text-ink-500\">\r\n            {keyboardHintText}\r\n            {step > 1 && (\r\n              <>\r\n                {' '}\r\n                or <kbd className=\"px-2 py-1 bg-surface-800 rounded text-ink-400\">Esc</kbd> to go\r\n                back\r\n              </>\r\n            )}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import type { PainEntry } from '../../types';\r\n\r\nexport interface CheckinInsight {\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  confidence: number; // 0-100\r\n}\r\n\r\nfunction clamp(n: number, min: number, max: number): number {\r\n  return Math.max(min, Math.min(max, n));\r\n}\r\n\r\nfunction titleCase(s: string): string {\r\n  const trimmed = s.trim();\r\n  if (!trimmed) return trimmed;\r\n  return trimmed.charAt(0).toUpperCase() + trimmed.slice(1);\r\n}\r\n\r\nfunction summarizeTopLocation(entries: PainEntry[]): { location: string; count: number } | null {\r\n  const counts = new Map<string, number>();\r\n  for (const entry of entries) {\r\n    for (const loc of entry.baselineData.locations ?? []) {\r\n      if (!loc) continue;\r\n      counts.set(loc, (counts.get(loc) ?? 0) + 1);\r\n    }\r\n  }\r\n  const sorted = [...counts.entries()].sort((a, b) => b[1] - a[1]);\r\n  if (!sorted.length) return null;\r\n  const [location, count] = sorted[0];\r\n  return { location, count };\r\n}\r\n\r\nfunction noteMentionsDeskWork(note: string): boolean {\r\n  const n = note.toLowerCase();\r\n  return (\r\n    n.includes('desk') ||\r\n    n.includes('computer') ||\r\n    n.includes('laptop') ||\r\n    n.includes('typing') ||\r\n    n.includes('sitting') ||\r\n    n.includes('chair') ||\r\n    n.includes('ergonomic')\r\n  );\r\n}\r\n\r\nfunction lastNDays(entries: PainEntry[], days: number): PainEntry[] {\r\n  const now = Date.now();\r\n  const minTs = now - days * 24 * 60 * 60 * 1000;\r\n  return entries.filter(e => {\r\n    const ts = new Date(e.timestamp).getTime();\r\n    return Number.isFinite(ts) && ts >= minTs;\r\n  });\r\n}\r\n\r\nfunction averagePain(entries: PainEntry[]): number | null {\r\n  if (!entries.length) return null;\r\n  const sum = entries.reduce((acc, e) => acc + (e.baselineData?.pain ?? 0), 0);\r\n  return sum / entries.length;\r\n}\r\n\r\n/**\r\n * Generates pain-focused, post-check-in insights.\r\n * Intentionally avoids logging or embedding raw note content.\r\n */\r\nexport function generateCheckinInsights(params: {\r\n  newEntry: PainEntry;\r\n  allEntries: PainEntry[];\r\n}): CheckinInsight[] {\r\n  const { newEntry, allEntries } = params;\r\n\r\n  const insights: CheckinInsight[] = [];\r\n\r\n  const recent = lastNDays(allEntries, 30);\r\n  const recentExcludingNew = recent.filter(e => e.id !== newEntry.id);\r\n\r\n  const newPain = newEntry.baselineData.pain;\r\n  const newLocations = (newEntry.baselineData.locations ?? []).filter(Boolean);\r\n\r\n  // 1) Pattern consistency by location\r\n  if (newLocations.length) {\r\n    const top = summarizeTopLocation(recentExcludingNew);\r\n    const match = top && newLocations.includes(top.location);\r\n\r\n    if (match && top) {\r\n      insights.push({\r\n        id: 'location-consistency',\r\n        title: 'This matches a recent pattern',\r\n        description: `${titleCase(top.location)} shows up often in your recent entries. Noting what was happening around flare-ups can help spot workable adjustments over time.`,\r\n        confidence: clamp(Math.round((top.count / Math.max(1, recentExcludingNew.length)) * 100), 40, 90),\r\n      });\r\n    } else if (top) {\r\n      insights.push({\r\n        id: 'location-context',\r\n        title: 'Location trend to watch',\r\n        description: `${titleCase(top.location)} is one of your more common recent locations. If today's pain feels different, consider adding a quick note about activity, posture, sleep, or medication timing.`,\r\n        confidence: clamp(Math.round((top.count / Math.max(1, recentExcludingNew.length)) * 100), 35, 85),\r\n      });\r\n    }\r\n  }\r\n\r\n  // 2) Pain level compared to recent baseline\r\n  const last7 = lastNDays(allEntries, 7);\r\n  const last7Avg = averagePain(last7);\r\n  if (last7Avg !== null && Number.isFinite(newPain)) {\r\n    const delta = newPain - last7Avg;\r\n    if (Math.abs(delta) >= 1) {\r\n      insights.push({\r\n        id: 'pain-vs-recent',\r\n        title: delta > 0 ? 'A higher-pain moment today' : 'A gentler moment today',\r\n        description:\r\n          delta > 0\r\n            ? `Today is about ${delta.toFixed(1)} points higher than your recent 7-day average. If you can, jot a short context note (activity, stress, sleep, meds) so patterns are easier to trust later.`\r\n            : `Today is about ${Math.abs(delta).toFixed(1)} points lower than your recent 7-day average. If anything helped (rest, pacing, stretching, heat/ice), it can be worth noting for future flares.`,\r\n        confidence: clamp(Math.round((last7.length / 10) * 100), 35, 80),\r\n      });\r\n    }\r\n  }\r\n\r\n  // 3) Gentle, pain-relevant prompt based on note keywords\r\n  const note = newEntry.notes ?? '';\r\n  if (note && noteMentionsDeskWork(note)) {\r\n    insights.push({\r\n      id: 'desk-work',\r\n      title: 'Desk-work signal',\r\n      description:\r\n        'You mentioned desk or sitting work. If it fits your day, small ergonomic tweaks (chair height, monitor position, micro-breaks) can be useful to test and track over time.',\r\n      confidence: 55,\r\n    });\r\n  }\r\n\r\n  // 4) Data-quality nudge (because analytics depend on it)\r\n  insights.push({\r\n    id: 'data-quality',\r\n    title: 'Make patterns easier to trust',\r\n    description:\r\n      'If you want stronger trigger detection, consider tracking a few context factors consistently (activity level, meds taken and timing, sleep quality, stress). Even quick yes/no notes help.',\r\n    confidence: 60,\r\n  });\r\n\r\n  // Keep this short and non-overwhelming\r\n  return insights.slice(0, 4);\r\n}\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { QuickLogStepper } from '../../design-system/fused-v2/QuickLogStepper';\r\nimport type { PainEntry } from '../../types';\r\nimport { useToast } from '../../components/feedback';\r\nimport { FocusManager, announceToScreenReader } from '../../utils/accessibility';\r\nimport type { CheckinInsight } from '../../utils/pain-tracker/checkinInsights';\r\nimport { generateCheckinInsights } from '../../utils/pain-tracker/checkinInsights';\r\n\r\ninterface DailyCheckinProps {\r\n  onComplete: (data: Omit<PainEntry, 'id' | 'timestamp'>) => void;\r\n  onCancel: () => void;\r\n  // pass existing entries so the empathy engine can use historical data\r\n  entries: PainEntry[];\r\n  userId?: string;\r\n  onDone?: () => void;\r\n}\r\n\r\nexport default function DailyCheckin({ onComplete, onCancel, entries, onDone }: DailyCheckinProps) {\r\n  const [mood, setMood] = useState<number>(5);\r\n  const [sleepQuality, setSleepQuality] = useState<number>(6);\r\n  const [insights, setInsights] = useState<CheckinInsight[] | null>(null);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const mountedRef = useRef(true);\r\n  const modalRef = useRef<HTMLDivElement | null>(null);\r\n  const toast = useToast();\r\n\r\n  // Manage focus trap and keyboard behavior for the modal\r\n  useEffect(() => {\r\n    if (!isModalOpen || !modalRef.current) return;\r\n\r\n    // Save previous focus and move to the modal container\r\n    FocusManager.saveFocusAndMoveTo(modalRef.current);\r\n\r\n    // Create focus trap\r\n    const releaseTrap = FocusManager.createFocusTrap(modalRef.current);\r\n\r\n    // Announce modal open to screen readers\r\n    announceToScreenReader('Insights are available. Dialog opened.', 'polite');\r\n\r\n    const handleKey = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        e.preventDefault();\r\n        setIsModalOpen(false);\r\n        setInsights(null);\r\n        FocusManager.restoreFocus();\r\n        announceToScreenReader('Insights dismissed', 'polite');\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKey);\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKey);\r\n      releaseTrap();\r\n    };\r\n  }, [isModalOpen]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      mountedRef.current = false;\r\n    };\r\n  }, []);\r\n\r\n  // Test-only: allow showing canned insights immediately when the test flag is present\r\n  useEffect(() => {\r\n    try {\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      if (urlParams.get('test_show_insights') === '1') {\r\n        const canned: CheckinInsight[] = [\r\n          {\r\n            id: 'test-immediate-1',\r\n            title: 'Immediate test insight',\r\n            description: 'Canned insight shown for E2E tests.',\r\n            confidence: 80,\r\n          },\r\n        ];\r\n        setInsights(canned.slice(0, 5));\r\n        setIsModalOpen(true);\r\n        announceToScreenReader('Insights are available. Dialog opened.', 'polite');\r\n      }\r\n    } catch {\r\n      // ignore\r\n    }\r\n  }, []);\r\n\r\n  const handleComplete = async (data: { pain: number; locations: string[]; symptoms: string[]; notes: string }) => {\r\n    const entry: Omit<PainEntry, 'id' | 'timestamp'> = {\r\n      baselineData: {\r\n        pain: data.pain,\r\n        locations: data.locations,\r\n        symptoms: data.symptoms,\r\n      },\r\n      functionalImpact: {\r\n        limitedActivities: [],\r\n        assistanceNeeded: [],\r\n        mobilityAids: [],\r\n      },\r\n      medications: {\r\n        current: [],\r\n        changes: '',\r\n        effectiveness: '',\r\n      },\r\n      treatments: { recent: [], effectiveness: '', planned: [] },\r\n      qualityOfLife: {\r\n        sleepQuality: sleepQuality, // 0-10 scale\r\n        moodImpact: mood, // 0-10 scale\r\n        socialImpact: [],\r\n      },\r\n      workImpact: { missedWork: 0, modifiedDuties: [], workLimitations: [] },\r\n      comparison: { worseningSince: '', newLimitations: [] },\r\n      notes: data.notes,\r\n    };\r\n\r\n    // Save immediately\r\n    try {\r\n      onComplete(entry);\r\n    } catch (err) {\r\n      // If parent throws, still attempt empathy work but surface a toast\r\n      console.error('onComplete threw', err);\r\n      toast.error('Save failed', 'Your check-in could not be saved.');\r\n      return;\r\n    }\r\n\r\n    // Generate pain-focused insights (no empathy framing) and show the top insight via toast\r\n    (async () => {\r\n      // Test hook: if test_insights query param is present, short-circuit with canned insights\r\n      try {\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n        if (urlParams.get('test_insights') === '1') {\r\n          const canned: CheckinInsight[] = [\r\n            {\r\n              id: 'test-1',\r\n              title: 'Test insight',\r\n              description: 'This is a test insight.',\r\n              confidence: 90,\r\n            },\r\n          ];\r\n          if (!mountedRef.current) {\r\n            if (canned.length > 0) {\r\n              const top = canned[0];\r\n              toast.info(top.title, top.description ?? 'A new insight is ready in your app.');\r\n            }\r\n            return;\r\n          }\r\n\r\n          setInsights(canned.slice(0, 5));\r\n          setIsModalOpen(true);\r\n          if (canned.length > 0) {\r\n            const top = canned[0];\r\n            toast.success(top.title, top.description ?? 'We found something you might find helpful.');\r\n          }\r\n          return;\r\n        }\r\n      } catch {\r\n        // ignore test hook failures\r\n      }\r\n      try {\r\n        // Ensure we pass full PainEntry objects (with id + timestamp) for consistent analysis\r\n        const savedEntryForInsights = {\r\n          ...entry,\r\n          id: Date.now(),\r\n          timestamp: new Date().toISOString(),\r\n        } as PainEntry;\r\n        const combinedPainEntries = [...(entries || []), savedEntryForInsights];\r\n\r\n        const insightsResult = generateCheckinInsights({\r\n          newEntry: savedEntryForInsights,\r\n          allEntries: combinedPainEntries,\r\n        });\r\n\r\n        if (!mountedRef.current) {\r\n          // Component unmounted — surface quick summary via toast\r\n          if (insightsResult && insightsResult.length > 0) {\r\n            const top = insightsResult[0];\r\n            toast.info(top.title, top.description ?? 'A new insight is ready in your app.');\r\n          }\r\n          return;\r\n        }\r\n\r\n        const slice = insightsResult.slice(0, 5);\r\n        setInsights(slice);\r\n        setIsModalOpen(true);\r\n        if (insightsResult && insightsResult.length > 0) {\r\n          const top = insightsResult[0];\r\n          toast.success(top.title, top.description ?? 'We found something you might find helpful.');\r\n        }\r\n      } catch (err) {\r\n        console.warn('Check-in insights failed', err);\r\n      }\r\n    })();\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background p-4\">\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <div className=\"mb-4\">\r\n          <h1 className=\"text-2xl font-semibold\">Daily Check-in</h1>\r\n          <p className=\"text-sm text-muted-foreground mt-2\">\r\n            How are you holding up today? This quick check-in helps the app give kinder,\r\n            more useful insights.\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 gap-4 mb-4\">\r\n          <label className=\"text-sm text-foreground\">Mood (0-10)</label>\r\n          <input\r\n            type=\"range\"\r\n            min={0}\r\n            max={10}\r\n            value={mood}\r\n            onChange={e => setMood(Number(e.target.value))}\r\n            aria-label=\"Mood\"\r\n          />\r\n          <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\r\n            <span>Mood: {mood}</span>\r\n            <div className=\"flex items-center gap-2\">\r\n              <label className=\"text-sm\">Sleep quality (0-10)</label>\r\n              <input\r\n                type=\"range\"\r\n                min={0}\r\n                max={10}\r\n                value={sleepQuality}\r\n                onChange={e => setSleepQuality(Number(e.target.value))}\r\n                className=\"w-40\"\r\n                aria-label=\"Sleep quality\"\r\n              />\r\n              <span className=\"ml-2\">{sleepQuality}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Reuse QuickLogStepper for the quick pain intensity + body map flow */}\r\n        <QuickLogStepper onComplete={handleComplete} onCancel={onCancel} />\r\n\r\n        {/* Accessible insights modal */}\r\n        {insights && isModalOpen && (\r\n          <div\r\n            className=\"fixed inset-0 z-50 flex items-center justify-center\"\r\n            role=\"presentation\"\r\n            aria-hidden={!isModalOpen}\r\n          >\r\n            {/* Overlay */}\r\n            <div\r\n              className=\"fixed inset-0 bg-black/50\"\r\n              aria-hidden=\"true\"\r\n              onClick={() => {\r\n                // Clicking overlay dismisses the insights (but keeps user on check-in)\r\n                setIsModalOpen(false);\r\n                setInsights(null);\r\n                FocusManager.restoreFocus();\r\n                announceToScreenReader('Insights dismissed', 'polite');\r\n              }}\r\n            />\r\n\r\n            <div\r\n              ref={modalRef}\r\n              role=\"dialog\"\r\n              aria-modal=\"true\"\r\n              aria-labelledby=\"insights-title\"\r\n              aria-describedby=\"insights-desc\"\r\n              className=\"relative z-10 w-full max-w-2xl mx-4 bg-panel rounded-lg shadow-lg p-6 focus:outline-none\"\r\n            >\r\n              <h3 id=\"insights-title\" className=\"text-lg font-semibold\">\r\n                Thoughtful follow-up\r\n              </h3>\r\n              <p id=\"insights-desc\" className=\"text-sm text-muted-foreground mt-1\">\r\n                Here are a few insights based on your recent check-in.\r\n              </p>\r\n\r\n              <ul className=\"mt-3 space-y-2\">\r\n                {insights.map(i => (\r\n                  <li key={i.id} className=\"p-2 bg-background rounded\">\r\n                    <strong>{i.title}</strong>\r\n                    <div className=\"text-sm text-muted-foreground\">{i.description}</div>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n\r\n              <div className=\"mt-4 flex justify-end gap-2\">\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-secondary\"\r\n                  onClick={() => {\r\n                    setIsModalOpen(false);\r\n                    setInsights(null);\r\n                    FocusManager.restoreFocus();\r\n                    announceToScreenReader('Insights dismissed', 'polite');\r\n                  }}\r\n                >\r\n                  Dismiss\r\n                </button>\r\n\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"btn btn-primary\"\r\n                  onClick={() => {\r\n                    setIsModalOpen(false);\r\n                    setInsights(null);\r\n                    FocusManager.restoreFocus();\r\n                    announceToScreenReader('Insights accepted. Returning to dashboard.', 'polite');\r\n                    if (typeof onDone === 'function') {\r\n                      onDone();\r\n                    }\r\n                  }}\r\n                >\r\n                  Done\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["PAIN_LABELS","LOCATION_TAGS","SYMPTOM_TAGS","QuickLogStepper","onComplete","onCancel","step","setStep","useState","pain","setPain","locations","setLocations","symptoms","setSymptoms","notes","setNotes","voiceMode","setVoiceMode","painLabel","useAdaptiveCopy","quickLogCopy","painSliderLabel","painHint","painSliderHint","locationsLabel","locationsHint","bodyMapToggle","notesLabel","notesPlaceholder","continueBtn","continueButton","saveBtn","saveButton","keyboardHintText","keyboardHint","isSupported","voiceSupported","isListening","transcript","startListening","stopListening","resetTranscript","voiceError","clearVoiceError","setIsSupported","setIsListening","setTranscript","setVoiceError","recognitionRef","useRef","lastTranscriptRef","useEffect","window","speechWindow","SpeechRecognitionCtor","webkitSpeechRecognition","SpeechRecognition","recognition","continuous","interimResults","onresult","event","resultsArray","Array","from","results","finalResults","filter","result","isFinal","combinedTranscript","length","map","r","join","trim","current","onerror","friendlyMessage","error","network","onend","stop","useCallback","start","useQuickVoiceNotes","handlePainChange","value","toggleTag","tag","list","setter","includes","t","handleNext","connectionStatus","navigator","onLine","voiceStatusTooltip","isSaveStep","saveDisabledReason","selectionSummary","handleKeyDown","e","key","shiftKey","document","activeElement","tagName","preventDefault","addEventListener","removeEventListener","jsxDEV","className","children","onClick","cn","ChevronLeft","fileName","lineNumber","columnNumber","this","s","Mic","MicOff","title","role","type","prev","disabled","Math","max","min","onChange","val","Number","target","style","backgroundColor","level","color","htmlFor","id","onKeyDown","_","i","Check","placeholder","inputMode","autoComplete","autoCorrect","autoCapitalize","enterKeyHint","maxLength","Fragment","clamp","n","titleCase","trimmed","charAt","toUpperCase","slice","lastNDays","entries","days","minTs","Date","now","ts","timestamp","getTime","isFinite","generateCheckinInsights","params","newEntry","allEntries","insights","recentExcludingNew","newPain","baselineData","newLocations","Boolean","top","counts","Map","entry","loc","set","get","sorted","sort","a","b","location","count","summarizeTopLocation","push","description","confidence","round","last7","last7Avg","reduce","acc","delta","abs","toFixed","note","toLowerCase","noteMentionsDeskWork","DailyCheckin","onDone","mood","setMood","sleepQuality","setSleepQuality","setInsights","isModalOpen","setIsModalOpen","mountedRef","modalRef","toast","useToast","FocusManager","saveFocusAndMoveTo","releaseTrap","createFocusTrap","announceToScreenReader","handleKey","restoreFocus","URLSearchParams","search","async","data","functionalImpact","limitedActivities","assistanceNeeded","mobilityAids","medications","changes","effectiveness","treatments","recent","planned","qualityOfLife","moodImpact","socialImpact","workImpact","missedWork","modifiedDuties","workLimitations","comparison","worseningSince","newLimitations","err","canned","info","success","savedEntryForInsights","toISOString","insightsResult","ref"],"mappings":"+cAuBA,MAAMA,EAAc,CAClB,UACA,YACA,OACA,gBACA,WACA,cACA,cACA,UACA,eACA,SACA,cAGIC,EAAgB,CACpB,aACA,aACA,OACA,YACA,YACA,eACA,eACA,UACA,UACA,WACA,WACA,YACA,YACA,WACA,WACA,WACA,WACA,OACA,UACA,iBACA,iBACA,gBAGIC,EAAe,CACnB,SACA,QACA,YACA,UACA,YACA,WACA,WACA,WACA,YACA,WACA,WACA,kBAwGK,SAASC,GAAgBC,WAAEA,EAAAC,SAAYA,IAC5C,MAAOC,EAAMC,GAAWC,EAAAA,SAAS,IAC1BC,EAAMC,GAAWF,EAAAA,SAAS,IAC1BG,EAAWC,GAAgBJ,EAAAA,SAAmB,KAC9CK,EAAUC,GAAeN,EAAAA,SAAmB,KAC5CO,EAAOC,GAAYR,EAAAA,SAAS,KAC5BS,EAAWC,GAAgBV,EAAAA,UAAS,GAGrCW,EAAYC,EAAgBC,EAAaC,iBACzCC,EAAWH,EAAgBC,EAAaG,gBACxCC,EAAiBL,EAAgBC,EAAaI,gBAC9CC,EAAgBN,EAAgBC,EAAaK,eAC5BN,EAAgBC,EAAaM,eACpD,MAAMC,EAAaR,EAAgBC,EAAaO,YAC1CC,EAAmBT,EAAgBC,EAAaQ,kBAChDC,EAAcV,EAAgBC,EAAaU,gBAC3CC,EAAUZ,EAAgBC,EAAaY,YACvCC,EAAmBd,EAAgBC,EAAac,eAGpDC,YAAaC,EAAAC,YACbA,EAAAC,WACAA,EAAAC,eACAA,EAAAC,cACAA,EAAAC,gBACAA,EAAAC,WACAA,EAAAC,gBACAA,GA5HJ,WACE,MAAOR,EAAaS,GAAkBrC,EAAAA,UAAS,IACxC8B,EAAaQ,GAAkBtC,EAAAA,UAAS,IACxC+B,EAAYQ,GAAiBvC,EAAAA,SAAS,KACtCmC,EAAYK,GAAiBxC,EAAAA,SAAwB,MACtDyC,EAAiBC,EAAAA,OAAiC,MAClDC,EAAoBD,EAAAA,OAAO,IAEjCE,EAAAA,UAAU,KACR,GAAsB,oBAAXC,OAAwB,OAEnC,MAAMC,EAAeD,OACfE,EACJD,EAAaE,yBAA2BF,EAAaG,kBAEvD,GAAIF,EAAuB,CACzBV,GAAe,GACf,MAAMa,EAAc,IAAIH,EACxBG,EAAYC,YAAa,EACzBD,EAAYE,gBAAiB,EAC7BF,EAAYG,SAAYC,IACtB,MAAMC,EAAeC,MAAMC,KAAKH,EAAMI,SAChCC,EAAeJ,EAAaK,OAAOC,GAAUA,EAAOC,SAGpDC,GAFkBJ,EAAaK,OAAS,EAAIL,EAAeJ,GAG9DU,IAAIJ,GAAUA,EAAO,IACrBI,IAAIC,GAAKA,GAAGnC,YAAc,IAC1BoC,KAAK,IACLC,OAECL,IAAuBpB,EAAkB0B,UAC7C1B,EAAkB0B,QAAUN,EAC5BxB,EAAcwB,KAEhBb,EAAYoB,QAAWhB,IACrBhB,GAAe,GACf,MAKMiC,EACHjB,GAAOkB,OAN+B,CACvC,cAAe,sCACfC,QAAS,0CACT,YAAa,6CAGanB,EAAMkB,QAChC,6DAEFhC,EAAc+B,IAEhBrB,EAAYwB,MAAQ,IAAMpC,GAAe,GACzCG,EAAe4B,QAAUnB,CAC3B,CAEA,MAAO,KACLT,EAAe4B,SAASM,OACxBlC,EAAe4B,QAAU,OAE1B,IAEH,MAAMrC,EAAiB4C,EAAAA,YAAY,KACjC,GAAInC,EAAe4B,UAAYvC,EAAa,CAC1CS,EAAc,IACdC,EAAc,MACdG,EAAkB0B,QAAU,GAC5B,IACE5B,EAAe4B,QAAQQ,QACvBvC,GAAe,EACjB,OAASkC,GAEPhC,EAAc,qEACdF,GAAe,EACjB,CACF,GACC,CAACR,IAEEG,EAAgB2C,EAAAA,YAAY,KAC5BnC,EAAe4B,SAAWvC,IAC5BW,EAAe4B,QAAQM,OACvBrC,GAAe,KAEhB,CAACR,IAEEI,EAAkB0C,EAAAA,YAAY,IAAMrC,EAAc,IAAK,IACvDH,EAAkBwC,EAAAA,YAAY,IAAMpC,EAAc,MAAO,IAE/D,MAAO,CACLZ,cACAE,cACAC,aACAC,iBACAC,gBACAC,kBACAC,aACAC,kBAEJ,CA+BM0C,GAEEC,EAAoBC,IACxB9E,EAAQ8E,IAGJC,EAAY,CAACC,EAAaC,EAAgBC,KAC1CD,EAAKE,SAASH,GAChBE,EAAOD,EAAKvB,OAAO0B,GAAKA,IAAMJ,IAE9BE,EAAO,IAAID,EAAMD,KAIfK,EAAaX,EAAAA,YAAY,KAC7B,GAAI9E,EAAO,EACTC,EAAQD,EAAO,OACV,CACL,GAAyB,IAArBK,EAAU6D,OAAc,OAC5BpE,EAAW,CAAEK,OAAME,YAAWE,WAAUE,SAC1C,GACC,CAACT,EAAMG,EAAME,EAAWE,EAAUE,EAAOX,IAgBtC4F,EAFoC,oBAAdC,YAC2B,IAArBA,UAAUC,OAExC,gEACA,yEAEEC,EAAqB9D,EACvB,0HACA,iFAEE+D,EAAsB,IAAT9F,EACb+F,EAAqBD,GAAmC,IAArBzF,EAAU6D,OAAe,wCAA0C,KACtG8B,EAAmB,GAAG3F,EAAU6D,kBAAuC,IAArB7D,EAAU6D,OAAe,GAAK,kBAAkB3D,EAAS2D,iBAAqC,IAApB3D,EAAS2D,OAAe,GAAK,eAE/JpB,EAAAA,UAAU,MACHnC,GAAaqB,GAChBG,IAEGxB,GACH2B,KAED,CAACN,EAAarB,EAAWwB,EAAeG,IAiC3C,OAxBAQ,EAAAA,UAAU,KACR,MAAMmD,EAAiBC,IAErB,GAAc,UAAVA,EAAEC,MAAoBD,EAAEE,SAAU,CAEpC,GAAwC,aAApCC,SAASC,eAAeC,QAAwB,OACpDL,EAAEM,iBACFf,GACF,CAEc,WAAVS,EAAEC,MACJD,EAAEM,iBACExG,EAAO,EACTC,EAAQD,EAAO,GAEfD,MAMN,OADAsG,SAASI,iBAAiB,UAAWR,GAC9B,IAAMI,SAASK,oBAAoB,UAAWT,IACpD,CAACjG,EAAMyF,EAAY1F,MAGpB4G,OAAC,MAAA,CAAIC,UAAU,4CAEbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,oEACbC,SAAA,CAAAF,EAAAA,OAAC,SAAA,CACCG,QAvEW,KACb9G,EAAO,EACTC,EAAQD,EAAO,GAEfD,KAoEI6G,UAAWG,EACT,+DACA,kEACA,qDAGFF,SAAA,CAAAF,EAAAA,OAACK,EAAA,CAAYJ,UAAU,gBAAvB,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACU,IAATpH,EAAa,SAAW,cAT3B,GAAA,EAAA,CAAAiH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,MAYAT,EAAAA,OAAC,MAAA,CAAIC,UAAU,0BACZC,SAAA,CAAC,EAAG,EAAG,GAAG1C,IAAIkD,GACbV,EAAAA,OAAC,MAAA,CAECC,UAAWG,EACT,wEACAM,IAAMrH,GAAQ,qBACdqH,EAAIrH,GAAQ,cACZqH,EAAIrH,GAAQ,mBALTqH,GADP,EAAA,CAAAJ,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,QAcAT,OAAC,MAAA,CAAIC,UAAU,oDAAqDC,SAAA,CAAA7G,EAAK,YAAzE,GAAA,EAAA,CAAAiH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,aA3BF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,eA8BC,MAAA,CAAIR,UAAU,WACbC,SAAAF,EAAAA,OAAC,MAAA,CAAIC,UAAU,8JACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,yBACZC,SAAA,CAAA9E,EACC4E,EAAAA,OAACW,EAAA,CAAIV,UAAU,kCAAkC,cAAY,aAA7D,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAEAT,SAACY,EAAA,CAAOX,UAAU,8BAA8B,cAAY,aAA5D,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAED,MAAA,CACCP,SAAA,CAAAF,EAAAA,OAAC,MAAA,CAAIC,UAAU,gCAAgCY,MAAO3B,EAAoBgB,SAAA,mBAA1E,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAGC,IAAA,CAAER,UAAU,0BACVC,SAAA9E,EACG2D,EACA,2HAHN,GAAA,EAAA,CAAAuB,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAKC/E,GACCsE,EAAAA,OAAC,IAAA,CAAEC,UAAU,6BAA6Ba,KAAK,QAC5CZ,SAAAxE,QADH,GAAA,EAAA,CAAA4E,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAVJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aANF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAsBAT,OAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAF,EAAAA,OAAC,OAAA,CAAKC,UAAU,yBAAyBY,MAAO3B,EAC7CgB,SAAA,CAAAlG,EAAY,KAAO,MAAM,KAAG,IAC5BoB,EAAiB,6BAA+B,qCAFnD,GAAA,EAAA,CAAAkF,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAIAT,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLZ,QAAS,IAAMlG,EAAa+G,IAASA,GACrCC,UAAW7F,EACX,eAAcpB,EACdiG,UAAWG,EACT,8DACA,8EACApG,EACI,iDACA,2DACHoB,GAAkB,iCAGpB8E,WAAY,qBAAuB,0BAdtC,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aALF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAvBF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,YADF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,QAkDAT,OAAC,MAAA,CAAIC,UAAU,6BACZC,SAAA,CAAS,IAAT7G,GACC2G,SAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,eACbC,SAAA,CAAAF,SAAC,MAAA,CAAIC,UAAU,0BAA0BC,SAAA,kBAAzC,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,IAAA,CAAEC,UAAU,0BAA0BC,SAAA,wHAAvC,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAQC,MAAA,CACCP,SAAA,CAAAF,SAAC,KAAA,CAAGC,UAAU,2BAA4BC,SAAAhG,QAA1C,GAAA,EAAA,CAAAoG,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,IAAA,CAAEC,UAAU,0BAA2BC,SAAA5F,QAAxC,GAAA,EAAA,CAAAgG,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAMAT,OAAC,MAAA,CAAIC,UAAU,8CACbC,SAAA,CAAAF,EAAAA,OAAC,SAAA,CACCG,QAAS,IAAM7B,EAAiB4C,KAAKC,IAAI,EAAG3H,EAAO,IACnD,aAAW,sBACXyG,UAAWG,EACT,mCACA,sCACA,6BACA,gEACA,kCACA,oDACA,sBACA,mDAEFa,SAAmB,IAATzH,EACX0G,SAAA,UAdD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAkBAT,EAAAA,OAAC,QAAA,CACCe,KAAK,SACLK,IAAI,IACJD,IAAI,KACJ5C,MAAO/E,EACP6H,SAAU9B,IACR,MAAM+B,EAAMJ,KAAKC,IAAI,EAAGD,KAAKE,IAAI,GAAIG,OAAOhC,EAAEiC,OAAOjD,SACrDD,EAAiBgD,IAEnB,aAAW,2BACXrB,UAAWG,EACT,wBACA,+BACA,6CACA,yCACA,kFACA,8HAhBJ,GAAA,EAAA,CAAAE,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAoBAT,EAAAA,OAAC,SAAA,CACCG,QAAS,IAAM7B,EAAiB4C,KAAKE,IAAI,GAAI5H,EAAO,IACpD,aAAW,sBACXyG,UAAWG,EACT,mCACA,sCACA,6BACA,gEACA,kCACA,oDACA,sBACA,mDAEFa,SAAmB,KAATzH,EACX0G,SAAA,UAdD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAvCF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MA2DAT,EAAAA,OAAC,MAAA,CACCC,UAAWG,EACT,6CACA,oDAEFqB,MAAO,CACLC,iBA/NYC,EA+NsBnI,EA9NvC,YAAY,GAAa,EAARmI,OAAe,GAAa,EAARA,OA+NhCC,MAAOpI,EAAO,EAAI,gBAAkB,kBAEtCsH,KAAK,SACL,YAAU,SAEVZ,SAAA,CAAAF,SAAC,MAAA,CAAIC,UAAU,iDAAkDC,SAAA1G,QAAjE,GAAA,EAAA,CAAA8G,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,MAAA,CAAIR,UAAU,mBAAoBC,SAAAnH,EAAYS,SAA/C,GAAA,EAAA,CAAA8G,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAbF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAiBAT,OAAC,MAAA,CAAIC,UAAU,YACbC,SAAA,CAAAF,EAAAA,OAAC,QAAA,CAAM6B,QAAQ,cAAc5B,UAAU,UAAUC,SAAA,kEAAjD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAGAT,EAAAA,OAAC,QAAA,CACC8B,GAAG,cACHf,KAAK,QACLK,IAAI,IACJD,IAAI,KACJ5C,MAAO/E,EACP6H,SAAU9B,GAAKjB,EAAiBiD,OAAOhC,EAAEiC,OAAOjD,QAChDwD,UAAWxC,IACK,YAAVA,EAAEC,KAA+B,eAAVD,EAAEC,KAC3BD,EAAEM,iBACFvB,EAAiB4C,KAAKE,IAAI,GAAI5H,EAAO,KAClB,cAAV+F,EAAEC,KAAiC,cAAVD,EAAEC,MACpCD,EAAEM,iBACFvB,EAAiB4C,KAAKC,IAAI,EAAG3H,EAAO,MAGxC,aAAW,iBACX,gBAAe,EACf,gBAAe,GACf,gBAAeA,EACf,iBAAgB,GAAGA,YAAeT,EAAYS,KAC9C,mBAAiB,mBACjByG,UAAU,g9BAtBZ,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAmCC,MAAA,CAAIqB,GAAG,mBAAmB7B,UAAU,UAAUC,SAAA,4GAA/C,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAMAT,OAAC,MAAA,CAAIC,UAAU,6DACZC,SAAAnD,MAAMC,KAAK,CAAEO,OAAQ,IAAM,CAACyE,EAAGC,IAC9BjC,EAAAA,OAAC,SAAA,CAECG,QAAS,IAAM7B,EAAiB2D,GAChC,aAAY,qBAAqBA,MAAMlJ,EAAYkJ,KACnDhC,UAAWG,EACT,6EACA,yCACA,yDACA6B,IAAMzI,GAAQ,yCAGf0G,SAAA+B,GAVIA,GADP,EAAA,CAAA3B,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA7CF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA3FF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MA6JQ,IAATpH,GACC2G,SAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,CAAAF,SAAC,MAAA,CACCE,SAAA,CAAAF,SAAC,KAAA,CAAGC,UAAU,2BAA4BC,SAAA1F,QAA1C,GAAA,EAAA,CAAA8F,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,IAAA,CAAEC,UAAU,0BAA2BC,SAAAzF,QAAxC,GAAA,EAAA,CAAA6F,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACsB,IAArB/G,EAAU6D,QACTyC,EAAAA,OAAC,KAAEC,UAAU,gCAAgCa,KAAK,OAAOZ,SAAA,mDAAzD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAJJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAWAT,EAAAA,OAAC,MAAA,CAAI,YAAU,SAAS,cAAY,OAAOC,UAAU,UAClDC,SAAAxG,EAAU6D,OAAS,EAChB,GAAG7D,EAAU6D,kBAAkB7D,EAAU6D,OAAS,EAAI,IAAM,gBAAgB7D,EAAUgE,KAAK,QAC3F,8BAHN,GAAA,EAAA,CAAA4C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAOC,WAAA,CACCP,SAAA,CAAAF,SAAC,SAAA,CAAOC,UAAU,UAAUC,SAAA,uBAA5B,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,MAAA,CAAIR,UAAU,uBACZC,SAAAlH,EAAcwE,IAAIiB,GACjBuB,EAAAA,OAAC,SAAA,CAECG,QAAS,IAAM3B,EAAUC,EAAK/E,EAAWC,GACzCmH,KAAK,WACL,eAAcpH,EAAUkF,SAASH,GACjC,aAAY,GAAGA,aACfwB,UAAWG,EACT,8EACA,0DACA,2GACA1G,EAAUkF,SAASH,GACf,6DACA,8EAGLyB,SAAA,CAAAxG,EAAUkF,SAASH,MAClBuB,OAACkC,GAAMjC,UAAU,sBAAsB,cAAY,aAAnD,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAEDhC,IAjBIA,GADP,EAAA,CAAA6B,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QA6BAT,OAAC,MAAA,CAAIC,UAAU,OACbC,SAAA,CAAAF,SAAC,KAAA,CAAGC,UAAU,qCAAqCC,SAAA,gCAAnD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAGAT,EAAAA,OAAC,MAAA,CAAI,YAAU,SAAS,cAAY,OAAOC,UAAU,UAClDC,SAAAtG,EAAS2D,OAAS,EACf,GAAG3D,EAAS2D,iBAAiB3D,EAAS2D,OAAS,EAAI,IAAM,gBAAgB3D,EAAS8D,KAAK,QACvF,6BAHN,GAAA,EAAA,CAAA4C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAMC,WAAA,CACCP,SAAA,CAAAF,SAAC,SAAA,CAAOC,UAAU,UAAUC,SAAA,sBAA5B,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,MAAA,CAAIR,UAAU,uBACZC,SAAAjH,EAAauE,IAAIiB,GAChBuB,EAAAA,OAAC,SAAA,CAECG,QAAS,IAAM3B,EAAUC,EAAK7E,EAAUC,GACxCiH,KAAK,WACL,eAAclH,EAASgF,SAASH,GAChC,aAAY,GAAGA,YACfwB,UAAWG,EACT,8EACA,0DACA,wGACAxG,EAASgF,SAASH,GACd,uDACA,2EAGLyB,SAAA,CAAAtG,EAASgF,SAASH,MACjBuB,OAACkC,GAAMjC,UAAU,sBAAsB,cAAY,aAAnD,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAEDhC,IAjBIA,GADP,EAAA,CAAA6B,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAVF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAhDF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAyFQ,IAATpH,GACC2G,SAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,CAAAF,SAAC,MAAA,CACCE,SAAA,CAAAF,SAAC,KAAA,CAAGC,UAAU,2BAA4BC,SAAAvF,QAA1C,GAAA,EAAA,CAAA2F,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,IAAA,CAAEC,UAAU,0BAA0BC,SAAA,wCAAvC,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eAKC,MAAA,CACCP,SAAA,CAAAF,EAAAA,OAAC,QAAA,CAAM6B,QAAQ,aAAa5B,UAAU,2CAA2CC,SAAA,yBAAjF,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAGAT,EAAAA,OAAC,WAAA,CACC8B,GAAG,aACHvD,MAAOzE,EACPuH,SAAU9B,GAAKxF,EAASwF,EAAEiC,OAAOjD,OACjC4D,YAAavH,EACbwH,UAAU,OACVC,aAAa,KACbC,YAAY,KACZC,eAAe,YACfC,aAAa,OACb,aAAW,8BACX,mBAAiB,6BACjBC,UAAW,IACXxC,UAAWG,EACT,6CACA,2CACA,kDACA,oIACA,iDACA,qBAnBJ,GAAA,EAAA,CAAAE,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAsBAT,OAAC,MAAA,CAAIC,UAAU,yCACbC,SAAA,CAAAF,EAAAA,OAAC,QAAK8B,GAAG,aAAa7B,UAAU,0BAC7BC,SAAiB,IAAjBpG,EAAMyD,OACH,eACA,GAAGzD,EAAMyD,mBAAoC,IAAjBzD,EAAMyD,OAAe,GAAK,YAH5D,GAAA,EAAA,CAAA+C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAKAT,EAAAA,OAAC,OAAA,CACC8B,GAAG,kBACH7B,UAAU,0BACV,YAAU,SACV,cAAY,OAEXC,SAAA,CAAA,IAAMpG,EAAMyD,OAAO,oBANtB,GAAA,EAAA,CAAA+C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aANF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA1BF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MA2CCzG,GAAaoB,GACZ4E,SAAC,MAAA,CAAIC,UAAU,2DACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,qEACbC,SAAA,CAAAF,SAAC,MAAA,CACCE,SAAA,CAAAF,SAAC,MAAA,CAAIC,UAAU,gCAAgCC,SAAA,wBAA/C,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QACAT,OAAC,IAAA,CAAEC,UAAU,0BAA0BC,SAAA,CAAA,8CACOnB,SAD9C,GAAA,EAAA,CAAAuB,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAMAT,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLZ,QAAS9E,EAAcG,EAAgBD,EACvC0E,UAAWG,EACT,8DACA,sGACA/E,EACI,+CACA,kDAEN,eAAcA,EACd,aAAYA,EAAc,uBAAyB,wBAElD6E,SAAA,CAAA7E,IAAc2E,OAACY,EAAA,CAAOX,UAAU,gBAAlB,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAAiCT,EAAAA,OAACW,EAAA,CAAIV,UAAU,gBAAf,GAAA,EAAA,CAAAK,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAC/CpF,EAAc,iBAAmB,yBAdpC,GAAA,EAAA,CAAAiF,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAPF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAyBCnF,GACC0E,EAAAA,OAAC,MAAA,CAAIC,UAAU,+EACbC,SAAA,CAAAF,SAAC,MAAA,CAAIC,UAAU,+BAA+BC,SAAA,cAA9C,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,IAAA,CAAER,UAAU,8BAA8B,YAAU,SAClDC,SAAA5E,QADH,GAAA,EAAA,CAAAgF,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAGAT,OAAC,MAAA,CAAIC,UAAU,uBACbC,SAAA,CAAAF,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLZ,QAjcS,KACxB7E,IACLvB,EAASiH,GAASA,EAAO,GAAGA,MAAS1F,IAAeA,GACpDG,MA+boBwE,UAAWG,EACT,8DACA,sEAEHF,SAAA,0BAPD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAUAT,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLZ,QAAS1E,EACTwE,UAAWG,EACT,8DACA,uGAEHF,SAAA,cAPD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAXF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aALF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA3BJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QA4DFT,OAAC,MAAA,CAAIC,UAAU,eACbC,SAAA,CAAAF,SAAC,MAAA,CAAIC,UAAU,+BAA+BC,SAAA,gBAA9C,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QACAT,OAAC,MAAA,CAAIC,UAAU,YACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,eAAeC,SAAA,oBAA/B,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QACAT,OAAC,OAAA,CAAKC,UAAU,oCAAqCC,SAAA,CAAA1G,EAAK,aAA1D,GAAA,EAAA,CAAA8G,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QACAT,OAAC,OAAA,CAAKC,UAAU,eAAeC,SAAA,CAAA,IAAEnH,EAAYS,GAAM,WAAnD,GAAA,EAAA,CAAA8G,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAHF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAKC/G,EAAU6D,OAAS,GAClByC,EAAAA,OAAC,MAAA,CAAIC,UAAU,yBACbC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,eAAeC,SAAA,mBAA/B,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,OAAA,CAAKR,UAAU,cAAeC,SAAAxG,EAAUgE,KAAK,YAA9C,GAAA,EAAA,CAAA4C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAKD7G,EAAS2D,OAAS,GACjByC,EAAAA,OAAC,MAAA,CAAIC,UAAU,yBACbC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,eAAeC,SAAA,kBAA/B,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,eACC,OAAA,CAAKR,UAAU,cAAeC,SAAAtG,EAAS8D,KAAK,YAA7C,GAAA,EAAA,CAAA4C,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAbJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA9GF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aA1PJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,QAmYAT,OAAC,MAAA,CAAIC,UAAU,yGACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,oBACZC,SAAA,CAAAf,GACCa,EAAAA,OAAA0C,WAAA,CACExC,SAAA,CAAAF,EAAAA,OAAC,MAAA,CACCC,UAAWG,EAAG,kBAAmB1G,EAAU6D,OAAS,EAAI,eAAiB,iBACzE,YAAU,SAET2C,SAAAb,QAJH,GAAA,EAAA,CAAAiB,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAMCrB,GACCY,EAAAA,OAAC,IAAA,CAAEC,UAAU,gCAAgCa,KAAK,QAC/CZ,SAAAd,QADH,GAAA,EAAA,CAAAkB,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aARJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,QAeFT,OAAC,MAAA,CAAIC,UAAU,aACZC,SAAA,CAAA7G,EAAO,GACN2G,EAAAA,OAAC,SAAA,CACCG,QAAS,IAAM7G,EAAQD,EAAO,GAC9B4G,UAAWG,EACT,uCACA,4BACA,sCACA,4CACA,oDACA,2GACA,iBAEF,aAAW,2BACZF,SAAA,aAZD,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAgBFT,EAAAA,OAAC,SAAA,CACCG,QAASrB,EACTmC,SAAU9B,KAAgBC,EAC1Ba,UAAWG,EACT,yCACA,eACA,sCACA,4CACA,oDACA,8BACA,2GACAjB,KAAgBC,GAAsB,iCAExC,aAAqB,IAAT/F,EAAa,kBAAoB,oBAAoBA,EAAO,IAEvE6G,SAAS,IAAT7G,EAAa0B,EAAUF,QAf1B,GAAA,EAAA,CAAAyF,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAlBF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAjBF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,eAuDC,MAAA,CAAIR,UAAU,qCACbC,SAAAF,EAAAA,OAAC,IAAA,CAAEC,UAAU,uBACVC,SAAA,CAAAjF,EACA5B,EAAO,GACN2G,EAAAA,OAAA0C,EAAAA,SAAA,CACGxC,SAAA,CAAA,IAAI,MACFF,SAAC,MAAA,CAAIC,UAAU,gDAAgDC,SAAA,YAA/D,GAAA,EAAA,CAAAI,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,MAAwE,qBAF7E,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,aAHJ,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,IAAAC,YADF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,aAxDF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,aArdF,GAAA,EAAA,CAAAH,SAAA,8FAAAC,WAAA,IAAAC,aAAA,GAAAC,MA3DuB,IAACkB,CAulB5B,CC5zBA,SAASgB,EAAMC,EAAWxB,EAAaD,GACrC,OAAOD,KAAKC,IAAIC,EAAKF,KAAKE,IAAID,EAAKyB,GACrC,CAEA,SAASC,EAAUnC,GACjB,MAAMoC,EAAUpC,EAAE/C,OAClB,OAAKmF,EACEA,EAAQC,OAAO,GAAGC,cAAgBF,EAAQG,MAAM,GADlCH,CAEvB,CA6BA,SAASI,EAAUC,EAAsBC,GACvC,MACMC,EADMC,KAAKC,MACU,GAAPH,EAAY,GAAK,GAAK,IAC1C,OAAOD,EAAQhG,OAAOoC,IACpB,MAAMiE,EAAK,IAAIF,KAAK/D,EAAEkE,WAAWC,UACjC,OAAOnC,OAAOoC,SAASH,IAAOA,GAAMH,GAExC,CAYO,SAASO,EAAwBC,GAItC,MAAMC,SAAEA,EAAAC,WAAUA,GAAeF,EAE3BG,EAA6B,GAG7BC,EADSf,EAAUa,EAAY,IACH5G,UAAYoC,EAAEuC,KAAOgC,EAAShC,IAE1DoC,EAAUJ,EAASK,aAAa3K,KAChC4K,GAAgBN,EAASK,aAAazK,WAAa,IAAIyD,OAAOkH,SAGpE,GAAID,EAAa7G,OAAQ,CACvB,MAAM+G,EA9DV,SAA8BnB,GAC5B,MAAMoB,MAAaC,IACnB,IAAA,MAAWC,KAAStB,EAClB,IAAA,MAAWuB,KAAOD,EAAMN,aAAazK,WAAa,GAC3CgL,GACLH,EAAOI,IAAID,GAAMH,EAAOK,IAAIF,IAAQ,GAAK,GAG7C,MAAMG,EAAS,IAAIN,EAAOpB,WAAW2B,KAAK,CAACC,EAAGC,IAAMA,EAAE,GAAKD,EAAE,IAC7D,IAAKF,EAAOtH,OAAQ,OAAO,KAC3B,MAAO0H,EAAUC,GAASL,EAAO,GACjC,MAAO,CAAEI,WAAUC,QACrB,CAkDgBC,CAAqBlB,GACnBK,GAAOF,EAAaxF,SAAS0F,EAAIW,WAElCX,EACXN,EAASoB,KAAK,CACZtD,GAAI,uBACJjB,MAAO,gCACPwE,YAAa,GAAGxC,EAAUyB,EAAIW,4IAC9BK,WAAY3C,EAAMzB,KAAKqE,MAAOjB,EAAIY,MAAQhE,KAAKC,IAAI,EAAG8C,EAAmB1G,QAAW,KAAM,GAAI,MAEvF+G,GACTN,EAASoB,KAAK,CACZtD,GAAI,mBACJjB,MAAO,0BACPwE,YAAa,GAAGxC,EAAUyB,EAAIW,6KAC9BK,WAAY3C,EAAMzB,KAAKqE,MAAOjB,EAAIY,MAAQhE,KAAKC,IAAI,EAAG8C,EAAmB1G,QAAW,KAAM,GAAI,KAGpG,CAGA,MAAMiI,EAAQtC,EAAUa,EAAY,GAC9B0B,GAhDatC,EAgDUqC,GA/ChBjI,OACD4F,EAAQuC,OAAO,CAACC,EAAKpG,IAAMoG,GAAOpG,EAAE4E,cAAc3K,MAAQ,GAAI,GAC7D2J,EAAQ5F,OAFO,KAD9B,IAAqB4F,EAiDnB,GAAiB,OAAbsC,GAAqBlE,OAAOoC,SAASO,GAAU,CACjD,MAAM0B,EAAQ1B,EAAUuB,EACpBvE,KAAK2E,IAAID,IAAU,GACrB5B,EAASoB,KAAK,CACZtD,GAAI,iBACJjB,MAAO+E,EAAQ,EAAI,6BAA+B,yBAClDP,YACEO,EAAQ,EACJ,kBAAkBA,EAAME,QAAQ,+JAChC,kBAAkB5E,KAAK2E,IAAID,GAAOE,QAAQ,qJAChDR,WAAY3C,EAAMzB,KAAKqE,MAAOC,EAAMjI,OAAS,GAAM,KAAM,GAAI,KAGnE,CAGA,MAAMwI,EAAOjC,EAAShK,OAAS,GAqB/B,OApBIiM,GAxFN,SAA8BA,GAC5B,MAAMnD,EAAImD,EAAKC,cACf,OACEpD,EAAEhE,SAAS,SACXgE,EAAEhE,SAAS,aACXgE,EAAEhE,SAAS,WACXgE,EAAEhE,SAAS,WACXgE,EAAEhE,SAAS,YACXgE,EAAEhE,SAAS,UACXgE,EAAEhE,SAAS,YAEf,CA6EcqH,CAAqBF,IAC/B/B,EAASoB,KAAK,CACZtD,GAAI,YACJjB,MAAO,mBACPwE,YACE,4KACFC,WAAY,KAKhBtB,EAASoB,KAAK,CACZtD,GAAI,eACJjB,MAAO,gCACPwE,YACE,6LACFC,WAAY,KAIPtB,EAASf,MAAM,EAAG,EAC3B,CC7HA,SAAwBiD,GAAa/M,WAAEA,EAAAC,SAAYA,EAAA+J,QAAUA,EAAAgD,OAASA,IACpE,MAAOC,EAAMC,GAAW9M,EAAAA,SAAiB,IAClC+M,EAAcC,GAAmBhN,EAAAA,SAAiB,IAClDyK,EAAUwC,GAAejN,EAAAA,SAAkC,OAC3DkN,EAAaC,GAAkBnN,EAAAA,UAAS,GACzCoN,EAAa1K,EAAAA,QAAO,GACpB2K,EAAW3K,EAAAA,OAA8B,MACzC4K,EAAQC,IAGd3K,EAAAA,UAAU,KACR,IAAKsK,IAAgBG,EAAShJ,QAAS,OAGvCmJ,EAAaC,mBAAmBJ,EAAShJ,SAGzC,MAAMqJ,EAAcF,EAAaG,gBAAgBN,EAAShJ,SAG1DuJ,EAAuB,yCAA0C,UAEjE,MAAMC,EAAa7H,IACH,WAAVA,EAAEC,MACJD,EAAEM,iBACF6G,GAAe,GACfF,EAAY,MACZO,EAAaM,eACbF,EAAuB,qBAAsB,YAMjD,OAFAzH,SAASI,iBAAiB,UAAWsH,GAE9B,KACL1H,SAASK,oBAAoB,UAAWqH,GACxCH,MAED,CAACR,IAEJtK,EAAAA,UAAU,IACD,KACLwK,EAAW/I,SAAU,GAEtB,IAGHzB,EAAAA,UAAU,KACR,IAEE,GAA4C,MAD1B,IAAImL,gBAAgBlL,OAAO6I,SAASsC,QACxC3C,IAAI,sBAA+B,CAS/C4B,EARiC,CAC/B,CACE1E,GAAI,mBACJjB,MAAO,yBACPwE,YAAa,sCACbC,WAAY,KAGGrC,MAAM,EAAG,IAC5ByD,GAAe,GACfS,EAAuB,yCAA0C,SACnE,CACF,CAAA,MAEA,GACC,IA6GH,gBACG,MAAA,CAAIlH,UAAU,iCACbC,SAAAF,EAAAA,OAAC,MAAA,CAAIC,UAAU,oBACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,OACbC,SAAA,CAAAF,SAAC,KAAA,CAAGC,UAAU,yBAAyBC,SAAA,uBAAvC,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,IAAA,CAAEC,UAAU,qCAAqCC,SAAA,2GAAlD,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,GAAAC,QAQAT,OAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,CAAAF,SAAC,QAAA,CAAMC,UAAU,0BAA0BC,SAAA,oBAA3C,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,EAAAA,OAAC,QAAA,CACCe,KAAK,QACLK,IAAK,EACLD,IAAK,GACL5C,MAAO6H,EACP/E,SAAU9B,GAAK8G,EAAQ9E,OAAOhC,EAAEiC,OAAOjD,QACvC,aAAW,aANb,GAAA,EAAA,CAAA+B,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,QAQAT,OAAC,MAAA,CAAIC,UAAU,kEACbC,SAAA,CAAAF,SAAC,OAAA,CAAKE,SAAA,CAAA,SAAOkG,SAAb,GAAA,EAAA,CAAA9F,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,QACAT,OAAC,MAAA,CAAIC,UAAU,0BACbC,SAAA,CAAAF,SAAC,QAAA,CAAMC,UAAU,UAAUC,SAAA,6BAA3B,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,EAAAA,OAAC,QAAA,CACCe,KAAK,QACLK,IAAK,EACLD,IAAK,GACL5C,MAAO+H,EACPjF,SAAU9B,GAAKgH,EAAgBhF,OAAOhC,EAAEiC,OAAOjD,QAC/C0B,UAAU,OACV,aAAW,sBAPb,GAAA,EAAA,CAAAK,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MASAT,SAAC,OAAA,CAAKC,UAAU,OAAQC,SAAAoG,QAAxB,GAAA,EAAA,CAAAhG,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAXF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAVF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,GAAAC,MA6BAT,EAAAA,OAAC9G,EAAA,CAAgBC,WAnJAqO,MAAOC,IAC5B,MAAMhD,EAA6C,CACjDN,aAAc,CACZ3K,KAAMiO,EAAKjO,KACXE,UAAW+N,EAAK/N,UAChBE,SAAU6N,EAAK7N,UAEjB8N,iBAAkB,CAChBC,kBAAmB,GACnBC,iBAAkB,GAClBC,aAAc,IAEhBC,YAAa,CACXlK,QAAS,GACTmK,QAAS,GACTC,cAAe,IAEjBC,WAAY,CAAEC,OAAQ,GAAIF,cAAe,GAAIG,QAAS,IACtDC,cAAe,CACb9B,eACA+B,WAAYjC,EACZkC,aAAc,IAEhBC,WAAY,CAAEC,WAAY,EAAGC,eAAgB,GAAIC,gBAAiB,IAClEC,WAAY,CAAEC,eAAgB,GAAIC,eAAgB,IAClD/O,MAAO2N,EAAK3N,OAId,IACEX,EAAWsL,EACb,OAASqE,GAIP,YADAjC,EAAM9I,MAAM,cAAe,oCAE7B,CAGA,WAEE,IAEE,GAAuC,MADrB,IAAIuJ,gBAAgBlL,OAAO6I,SAASsC,QACxC3C,IAAI,iBAA0B,CAC1C,MAAMmE,EAA2B,CAC/B,CACEjH,GAAI,SACJjB,MAAO,eACPwE,YAAa,0BACbC,WAAY,KAGhB,IAAKqB,EAAW/I,QAAS,CACvB,GAAImL,EAAOxL,OAAS,EAAG,CACrB,MAAM+G,EAAMyE,EAAO,GACnBlC,EAAMmC,KAAK1E,EAAIzD,MAAOyD,EAAIe,aAAe,sCAC3C,CACA,MACF,CAIA,GAFAmB,EAAYuC,EAAO9F,MAAM,EAAG,IAC5ByD,GAAe,GACXqC,EAAOxL,OAAS,EAAG,CACrB,MAAM+G,EAAMyE,EAAO,GACnBlC,EAAMoC,QAAQ3E,EAAIzD,MAAOyD,EAAIe,aAAe,6CAC9C,CACA,MACF,CACF,CAAA,MAEA,CACA,IAEE,MAAM6D,EAAwB,IACzBzE,EACH3C,GAAIwB,KAAKC,MACTE,WAAA,IAAeH,MAAO6F,eAIlBC,EAAiBxF,EAAwB,CAC7CE,SAAUoF,EACVnF,WAJ0B,IAAKZ,GAAW,GAAK+F,KAOjD,IAAKvC,EAAW/I,QAAS,CAEvB,GAAIwL,GAAkBA,EAAe7L,OAAS,EAAG,CAC/C,MAAM+G,EAAM8E,EAAe,GAC3BvC,EAAMmC,KAAK1E,EAAIzD,MAAOyD,EAAIe,aAAe,sCAC3C,CACA,MACF,CAEA,MAAMpC,EAAQmG,EAAenG,MAAM,EAAG,GAGtC,GAFAuD,EAAYvD,GACZyD,GAAe,GACX0C,GAAkBA,EAAe7L,OAAS,EAAG,CAC/C,MAAM+G,EAAM8E,EAAe,GAC3BvC,EAAMoC,QAAQ3E,EAAIzD,MAAOyD,EAAIe,aAAe,6CAC9C,CACF,OAASyD,GAET,CACF,EAjEA,IA4GiD1P,iBAA7C,GAAA,EAAA,CAAAkH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,GAAAC,MAGCuD,GAAYyC,GACXzG,EAAAA,OAAC,MAAA,CACCC,UAAU,sDACVa,KAAK,eACL,eAAc2F,EAGdvG,SAAA,CAAAF,EAAAA,OAAC,MAAA,CACCC,UAAU,4BACV,cAAY,OACZE,QAAS,KAEPuG,GAAe,GACfF,EAAY,MACZO,EAAaM,eACbF,EAAuB,qBAAsB,iBARjD,GAAA,EAAA,CAAA7G,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAYAT,EAAAA,OAAC,MAAA,CACCqJ,IAAKzC,EACL9F,KAAK,SACL,aAAW,OACX,kBAAgB,iBAChB,mBAAiB,gBACjBb,UAAU,2FAEVC,SAAA,CAAAF,EAAAA,OAAC,KAAA,CAAG8B,GAAG,iBAAiB7B,UAAU,wBAAwBC,SAAA,6BAA1D,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,eAGC,IAAA,CAAEqB,GAAG,gBAAgB7B,UAAU,qCAAqCC,SAAA,+DAArE,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,QAIAT,OAAC,KAAA,CAAGC,UAAU,iBACXC,SAAA8D,EAASxG,IAAIyE,GACZjC,EAAAA,OAAC,KAAA,CAAcC,UAAU,4BACvBC,SAAA,CAAAF,EAAAA,OAAC,SAAA,CAAQE,WAAEW,YAAX,GAAA,EAAA,CAAAP,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MACAT,SAAC,MAAA,CAAIC,UAAU,gCAAiCC,WAAEmF,kBAAlD,GAAA,EAAA,CAAA/E,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,QAFOwB,EAAEH,IAAX,EAAA,CAAAxB,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAFJ,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,QASAT,OAAC,MAAA,CAAIC,UAAU,8BACbC,SAAA,CAAAF,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLd,UAAU,oBACVE,QAAS,KACPuG,GAAe,GACfF,EAAY,MACZO,EAAaM,eACbF,EAAuB,qBAAsB,WAEhDjH,SAAA,gBATD,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAaAT,EAAAA,OAAC,SAAA,CACCe,KAAK,SACLd,UAAU,kBACVE,QAAS,KACPuG,GAAe,GACfF,EAAY,MACZO,EAAaM,eACbF,EAAuB,6CAA8C,UAC/C,mBAAXhB,GACTA,KAGLjG,SAAA,aAZD,GAAA,EAAA,CAAAI,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAdF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAxBF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aAlBF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,IAAAC,aA1CJ,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,GAAAC,YADF,GAAA,EAAA,CAAAH,SAAA,uFAAAC,WAAA,IAAAC,aAAA,GAAAC,KAyHJ"}