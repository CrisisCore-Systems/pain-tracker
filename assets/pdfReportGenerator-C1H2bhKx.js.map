{"version":3,"file":"pdfReportGenerator-C1H2bhKx.js","sources":["../../src/utils/pdfReportGenerator.ts"],"sourcesContent":["import jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\nimport type { PainEntry, ReportTemplate } from '../types';\r\nimport { formatNumber } from './formatting';\r\n\r\ninterface JSDocWithAutoTable extends jsPDF {\r\n  // jspdf-autotable typings vary between versions; allow flexible access\r\n  autoTable: (options: unknown) => jsPDF;\r\n  lastAutoTable?: { finalY: number };\r\n}\r\n\r\ninterface DateRange {\r\n  start: string;\r\n  end: string;\r\n}\r\n\r\ninterface PDFSection {\r\n  id: string;\r\n  title: string;\r\n  type: string;\r\n  dataSource: string;\r\n  config: Record<string, unknown>;\r\n}\r\n\r\nexport interface PDFReportOptions {\r\n  template: ReportTemplate;\r\n  entries: PainEntry[];\r\n  dateRange: { start: string; end: string };\r\n  includeCharts?: boolean;\r\n  includeRawData?: boolean;\r\n}\r\n\r\nexport class PDFReportGenerator {\r\n  private doc: jsPDF;\r\n  private options: PDFReportOptions;\r\n\r\n  constructor(options: PDFReportOptions) {\r\n    this.doc = new jsPDF();\r\n    this.options = options;\r\n  }\r\n\r\n  async generate(): Promise<Blob> {\r\n    this.addHeader();\r\n    this.addSummary();\r\n    this.addDetailedSections();\r\n    if (this.options.includeRawData) {\r\n      this.addRawData();\r\n    }\r\n    this.addFooter();\r\n\r\n    return this.doc.output('blob');\r\n  }\r\n\r\n  private addHeader(): void {\r\n    const { template, dateRange } = this.options;\r\n\r\n    // Title\r\n    this.doc.setFontSize(20);\r\n    this.doc.setFont('helvetica', 'bold');\r\n    this.doc.text('Pain Tracker Report', 20, 30);\r\n\r\n    // Template info\r\n    this.doc.setFontSize(14);\r\n    this.doc.setFont('helvetica', 'normal');\r\n    this.doc.text(template.name, 20, 45);\r\n\r\n    // Date range\r\n    this.doc.setFontSize(10);\r\n    this.doc.text(\r\n      `Period: ${new Date(dateRange.start).toLocaleDateString()} - ${new Date(dateRange.end).toLocaleDateString()}`,\r\n      20,\r\n      55\r\n    );\r\n\r\n    // Generated date\r\n    this.doc.text(\r\n      `Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`,\r\n      20,\r\n      62\r\n    );\r\n\r\n    // Add a line separator\r\n    this.doc.line(20, 70, 190, 70);\r\n  }\r\n\r\n  private addSummary(): void {\r\n    const { entries, dateRange } = this.options;\r\n\r\n    const filteredEntries = entries.filter(entry => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const startDate = new Date(dateRange.start);\r\n      const endDate = new Date(dateRange.end);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n\r\n    this.doc.setFontSize(16);\r\n    this.doc.setFont('helvetica', 'bold');\r\n    this.doc.text('Summary', 20, 85);\r\n\r\n    this.doc.setFontSize(12);\r\n    this.doc.setFont('helvetica', 'normal');\r\n\r\n    let yPos = 95;\r\n\r\n    // Basic statistics\r\n    const avgPain =\r\n      filteredEntries.length > 0\r\n        ? filteredEntries.reduce((sum, entry) => sum + entry.baselineData.pain, 0) /\r\n          filteredEntries.length\r\n        : 0;\r\n\r\n    const mostCommonLocation = this.getMostCommon(\r\n      filteredEntries.flatMap(e => e.baselineData.locations || [])\r\n    );\r\n    const mostCommonSymptom = this.getMostCommon(\r\n      filteredEntries.flatMap(e => e.baselineData.symptoms || [])\r\n    );\r\n\r\n    this.doc.text(`Total Entries: ${filteredEntries.length}`, 20, yPos);\r\n    yPos += 8;\r\n    this.doc.text(`Average Pain Level: ${formatNumber(avgPain, 1)}/10`, 20, yPos);\r\n    yPos += 8;\r\n    this.doc.text(`Most Common Location: ${mostCommonLocation}`, 20, yPos);\r\n    yPos += 8;\r\n    this.doc.text(`Most Common Symptom: ${mostCommonSymptom}`, 20, yPos);\r\n    yPos += 8;\r\n\r\n    // Pain level distribution\r\n    const painDistribution = this.getPainDistribution(filteredEntries);\r\n    this.doc.text('Pain Level Distribution:', 20, yPos + 5);\r\n\r\n    yPos += 15;\r\n    Object.entries(painDistribution).forEach(([level, count]) => {\r\n      this.doc.text(`Level ${level}: ${count} entries`, 30, yPos);\r\n      yPos += 6;\r\n    });\r\n  }\r\n\r\n  private addDetailedSections(): void {\r\n    const { template, entries, dateRange } = this.options;\r\n\r\n    let yPos = 160;\r\n\r\n    template.sections.forEach((section: unknown) => {\r\n      const pdfSection = section as PDFSection;\r\n\r\n      if (yPos > 250) {\r\n        this.doc.addPage();\r\n        yPos = 30;\r\n      }\r\n\r\n      this.doc.setFontSize(14);\r\n      this.doc.setFont('helvetica', 'bold');\r\n      this.doc.text(pdfSection.title, 20, yPos);\r\n      yPos += 10;\r\n\r\n      this.doc.setFontSize(10);\r\n      this.doc.setFont('helvetica', 'normal');\r\n\r\n      switch (pdfSection.type) {\r\n        case 'metrics':\r\n          yPos = this.addMetricsSection(pdfSection, entries, dateRange, yPos);\r\n          break;\r\n        case 'table':\r\n          yPos = this.addTableSection(pdfSection, entries, dateRange, yPos);\r\n          break;\r\n        case 'text':\r\n          yPos = this.addTextSection(pdfSection, entries, dateRange, yPos);\r\n          break;\r\n        default:\r\n          this.doc.text(`[Chart: ${pdfSection.dataSource}]`, 20, yPos);\r\n          yPos += 10;\r\n      }\r\n\r\n      yPos += 15;\r\n    });\r\n  }\r\n\r\n  private addMetricsSection(\r\n    section: PDFSection,\r\n    entries: PainEntry[],\r\n    dateRange: DateRange,\r\n    yPos: number\r\n  ): number {\r\n    const filteredEntries = entries.filter(entry => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const startDate = new Date(dateRange.start);\r\n      const endDate = new Date(dateRange.end);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n\r\n    switch (section.dataSource) {\r\n      case 'medications': {\r\n        const medications = new Set(\r\n          filteredEntries.flatMap(e => e.medications?.current?.map(m => m.name) || [])\r\n        );\r\n        this.doc.text(`Total Unique Medications: ${medications.size}`, 20, yPos);\r\n        yPos += 8;\r\n        Array.from(medications)\r\n          .slice(0, 5)\r\n          .forEach(med => {\r\n            this.doc.text(`â€¢ ${med}`, 30, yPos);\r\n            yPos += 6;\r\n          });\r\n        break;\r\n      }\r\n      case 'progress': {\r\n        const avgPain =\r\n          filteredEntries.length > 0\r\n            ? filteredEntries.reduce((sum, entry) => sum + entry.baselineData.pain, 0) /\r\n              filteredEntries.length\r\n            : 0;\r\n        this.doc.text(`Average Pain Level: ${formatNumber(avgPain, 1)}/10`, 20, yPos);\r\n        yPos += 8;\r\n        this.doc.text(`Total Entries: ${filteredEntries.length}`, 20, yPos);\r\n        yPos += 8;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return yPos;\r\n  }\r\n\r\n  private addTableSection(\r\n    section: PDFSection,\r\n    entries: PainEntry[],\r\n    dateRange: DateRange,\r\n    yPos: number\r\n  ): number {\r\n    const filteredEntries = entries.filter(entry => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const startDate = new Date(dateRange.start);\r\n      const endDate = new Date(dateRange.end);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n\r\n    switch (section.dataSource) {\r\n      case 'symptoms': {\r\n        const symptomCounts = this.getSymptomCounts(filteredEntries);\r\n        const topSymptoms = Object.entries(symptomCounts)\r\n          .sort(([, a], [, b]) => b - a)\r\n          .slice(0, 10);\r\n\r\n        if (topSymptoms.length > 0) {\r\n          const tableData = topSymptoms.map(([symptom, count]) => [symptom, count.toString()]);\r\n\r\n          (this.doc as unknown as JSDocWithAutoTable).autoTable({\r\n            startY: yPos,\r\n            head: [['Symptom', 'Frequency']],\r\n            body: tableData,\r\n            margin: { left: 20 },\r\n            styles: { fontSize: 8 },\r\n            headStyles: { fillColor: [66, 139, 202] },\r\n          });\r\n\r\n          yPos = ((this.doc as unknown as JSDocWithAutoTable).lastAutoTable?.finalY ?? yPos) + 10;\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    return yPos;\r\n  }\r\n\r\n  private addTextSection(\r\n    section: PDFSection,\r\n    entries: PainEntry[],\r\n    dateRange: DateRange,\r\n    yPos: number\r\n  ): number {\r\n    const filteredEntries = entries.filter(entry => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const startDate = new Date(dateRange.start);\r\n      const endDate = new Date(dateRange.end);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n\r\n    switch (section.dataSource) {\r\n      case 'overview': {\r\n        this.doc.text(\r\n          `Report covers ${filteredEntries.length} pain entries from ${new Date(dateRange.start).toLocaleDateString()} to ${new Date(dateRange.end).toLocaleDateString()}.`,\r\n          20,\r\n          yPos\r\n        );\r\n        yPos += 8;\r\n        break;\r\n      }\r\n      case 'treatments': {\r\n        const treatments = new Set(\r\n          filteredEntries.flatMap(e => e.treatments?.recent?.map(t => t.type) || [])\r\n        );\r\n        this.doc.text(`Treatments received: ${Array.from(treatments).join(', ')}`, 20, yPos);\r\n        yPos += 8;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return yPos;\r\n  }\r\n\r\n  private addRawData(): void {\r\n    const { entries, dateRange } = this.options;\r\n\r\n    this.doc.addPage();\r\n    this.doc.setFontSize(16);\r\n    this.doc.setFont('helvetica', 'bold');\r\n    this.doc.text('Raw Data', 20, 30);\r\n\r\n    const filteredEntries = entries.filter(entry => {\r\n      const entryDate = new Date(entry.timestamp);\r\n      const startDate = new Date(dateRange.start);\r\n      const endDate = new Date(dateRange.end);\r\n      return entryDate >= startDate && entryDate <= endDate;\r\n    });\r\n\r\n    const tableData = filteredEntries.map(entry => [\r\n      new Date(entry.timestamp).toLocaleDateString(),\r\n      entry.baselineData.pain.toString(),\r\n      (entry.baselineData.locations || []).join(', '),\r\n      (entry.baselineData.symptoms || []).join(', '),\r\n      (entry.notes || '').substring(0, 50) + ((entry.notes || '').length > 50 ? '...' : ''),\r\n    ]);\r\n\r\n    (this.doc as unknown as JSDocWithAutoTable).autoTable({\r\n      startY: 40,\r\n      head: [['Date', 'Pain Level', 'Locations', 'Symptoms', 'Notes']],\r\n      body: tableData,\r\n      margin: { left: 20, right: 20 },\r\n      styles: { fontSize: 7 },\r\n      headStyles: { fillColor: [66, 139, 202] },\r\n      columnStyles: {\r\n        0: { cellWidth: 25 },\r\n        1: { cellWidth: 20 },\r\n        2: { cellWidth: 35 },\r\n        3: { cellWidth: 35 },\r\n        4: { cellWidth: 55 },\r\n      },\r\n    });\r\n  }\r\n\r\n  private addFooter(): void {\r\n    const pageCount = this.doc.getNumberOfPages();\r\n\r\n    for (let i = 1; i <= pageCount; i++) {\r\n      this.doc.setPage(i);\r\n      this.doc.setFontSize(8);\r\n      this.doc.setFont('helvetica', 'normal');\r\n      this.doc.text(\r\n        `Page ${i} of ${pageCount} - Generated by Pain Tracker Pro`,\r\n        20,\r\n        this.doc.internal.pageSize.height - 10\r\n      );\r\n    }\r\n  }\r\n\r\n  private getMostCommon(items: string[]): string {\r\n    if (items.length === 0) return 'None';\r\n\r\n    const counts = items.reduce(\r\n      (acc, item) => {\r\n        acc[item] = (acc[item] || 0) + 1;\r\n        return acc;\r\n      },\r\n      {} as Record<string, number>\r\n    );\r\n\r\n    return Object.entries(counts).sort(([, a], [, b]) => b - a)[0][0];\r\n  }\r\n\r\n  private getPainDistribution(entries: PainEntry[]): Record<string, number> {\r\n    const distribution: Record<string, number> = {};\r\n\r\n    entries.forEach(entry => {\r\n      const level = entry.baselineData.pain.toString();\r\n      distribution[level] = (distribution[level] || 0) + 1;\r\n    });\r\n\r\n    return distribution;\r\n  }\r\n\r\n  private getSymptomCounts(entries: PainEntry[]): Record<string, number> {\r\n    const counts: Record<string, number> = {};\r\n\r\n    entries.forEach(entry => {\r\n      (entry.baselineData.symptoms || []).forEach(symptom => {\r\n        counts[symptom] = (counts[symptom] || 0) + 1;\r\n      });\r\n    });\r\n\r\n    return counts;\r\n  }\r\n}\r\n\r\nexport async function generatePDFReport(options: PDFReportOptions): Promise<Blob> {\r\n  const generator = new PDFReportGenerator(options);\r\n  return generator.generate();\r\n}\r\n\r\nexport function downloadPDF(blob: Blob, filename: string): void {\r\n  const url = URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  URL.revokeObjectURL(url);\r\n}\r\n"],"names":["PDFReportGenerator","doc","options","constructor","this","jsPDF","generate","addHeader","addSummary","addDetailedSections","includeRawData","addRawData","addFooter","output","template","dateRange","setFontSize","setFont","text","name","Date","start","toLocaleDateString","end","toLocaleTimeString","line","entries","filteredEntries","filter","entry","entryDate","timestamp","startDate","endDate","yPos","avgPain","length","reduce","sum","baselineData","pain","mostCommonLocation","getMostCommon","flatMap","e","locations","mostCommonSymptom","symptoms","formatNumber","painDistribution","getPainDistribution","Object","forEach","level","count","sections","section","pdfSection","addPage","title","type","addMetricsSection","addTableSection","addTextSection","dataSource","medications","Set","current","map","m","size","Array","from","slice","med","symptomCounts","getSymptomCounts","topSymptoms","sort","a","b","tableData","symptom","toString","autoTable","startY","head","body","margin","left","styles","fontSize","headStyles","fillColor","lastAutoTable","finalY","treatments","recent","t","join","notes","substring","right","columnStyles","cellWidth","pageCount","getNumberOfPages","i","setPage","internal","pageSize","height","items","counts","acc","item","distribution","async","generatePDFReport"],"mappings":"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"}