{"version":3,"mappings":"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","names":["getPainSeverity","pain","async","exportWorkSafeBCPDF","entries","options","privacyAnalytics","trackDataExport","catch","error","analyticsLogger","swallowed","context","exportType","trackDataExported","length","trackExport","startDate","endDate","patientName","claimNumber","healthcareProvider","includeDetailedEntries","includeTrendSummary","filteredEntries","filter","entry","timestamp","Date","sort","a","b","getTime","metrics","totalEntries","averagePain","maxPain","minPain","painVariability","missedWorkDays","mostAffectedLocations","mostCommonSymptoms","treatmentEffectiveness","painLevels","map","e","baselineData","avgPain","reduce","Math","max","min","variance","acc","val","pow","sqrt","total","workImpact","missedWork","locationCounts","forEach","locations","loc","Object","slice","symptomCounts","symptoms","sym","effectivenessReports","treatments","effectiveness","Boolean","calculateMetrics","painTrend","recentEntries","olderEntries","diff","abs","getPainTrend","default","jsPDF","__vitePreload","import","then","n","j","__VITE_PRELOAD__","doc","yPosition","pageWidth","internal","pageSize","getWidth","leftMargin","rightMargin","contentWidth","checkPageBreak","requiredSpace","addPage","setFillColor","rect","setTextColor","setFontSize","setFont","text","toLocaleDateString","reportId","now","toString","toUpperCase","roundedRect","col2","setDrawColor","setLineWidth","line","boxWidth","formatNumber","align","String","boxHeight","summaryText","ceil","toLowerCase","summaryLines","splitTextToSize","points","byDay","Map","dt","key","getFullYear","getMonth","padStart","getDate","existing","get","sum","count","day","setHours","set","Array","from","values","label","month","value","toDailyAveragePain","hasEnough","start","delta","direction","deltaText","chartH","chartW","x","y","width","height","p","span","barWidth","floor","i","normalized","barH","round","bx","by","drawMiniTrendBars","endLabel","variabilityDesc","allLimitations","Set","allMobilityAids","functionalImpact","limitedActivities","add","mobilityAids","size","lim","aid","allWorkLimitations","allModifiedDuties","workLimitations","l","modifiedDuties","d","duty","maxEntries","date","join","notes","substring","disclaimerLines","pageCount","getNumberOfPages","setPage","output","ReportsPage","toast","useToast","isExporting","setIsExporting","useState","dateRange","setDateRange","showExportPreview","setShowExportPreview","useMemo","cutoff","csvHeaderPreview","exportToCSV","split","jsonPreview","raw","exportToJSON","parsed","JSON","parse","stringify","quickStats","icon","FileText","TrendingUp","Calendar","sortedEntries","toFixed","handleExport","type","exportFn","filename","mimeType","Promise","resolve","setTimeout","data","downloadData","success","handleWorkSafeBCExport","sorted","pdfData","toISOString","link","document","createElement","href","download","body","appendChild","click","removeChild","downloadWorkSafeBCPDF","reportTypes","id","name","description","FileSpreadsheet","format","color","action","FileJson","FileType","exportToPDF","specializedReports","Shield","badge","available","jsxDEV","className","children","fileName","lineNumber","columnNumber","this","onChange","target","option","Card","CardHeader","CardTitle","Button","variant","onClick","v","CardContent","stat","index","AlertCircle","Download","report","disabled","Badge","info","ChevronRight","Clock","CheckCircle2"],"ignoreList":[],"sources":["../../src/utils/pain-tracker/wcb-export.ts","../../src/components/reports/ReportsPage.tsx"],"sourcesContent":["import type { PainEntry } from '../../types';\r\n// import jsPDF from 'jspdf'; // Moved to dynamic import\r\nimport { formatNumber } from '../formatting';\r\nimport { privacyAnalytics } from '../../services/PrivacyAnalyticsService';\r\nimport { trackDataExported } from '../../analytics/ga4-events';\r\nimport { trackExport } from '../usage-tracking';\r\nimport { analyticsLogger } from '../../lib/debug-logger';\r\n\r\n/**\r\n * Enhanced WorkSafe BC PDF Export\r\n * \r\n * Generates professional, comprehensive PDF reports aligned with\r\n * WorkSafe BC Form 8 requirements for claims documentation.\r\n * \r\n * Features:\r\n * - Professional header with patient information (optional)\r\n * - Executive summary with key metrics\r\n * - Pain trend analysis with visual indicators\r\n * - Functional impact assessment\r\n * - Work impact documentation\r\n * - Treatment history and effectiveness\r\n * - Clinical recommendations\r\n * - Legal disclaimer\r\n */\r\n\r\ninterface WCBExportOptions {\r\n  /** Date range for the report */\r\n  startDate: Date;\r\n  endDate: Date;\r\n  /** Optional patient name (de-identified if omitted) */\r\n  patientName?: string;\r\n  /** Optional claim number */\r\n  claimNumber?: string;\r\n  /** Optional healthcare provider */\r\n  healthcareProvider?: string;\r\n  /** Include detailed entries (may increase file size) */\r\n  includeDetailedEntries?: boolean;\r\n  /** Include a brief pain trend summary section */\r\n  includeTrendSummary?: boolean;\r\n}\r\n\r\ntype TrendPoint = { label: string; value: number };\r\n\r\nfunction toDailyAveragePain(entries: PainEntry[], maxDays: number): TrendPoint[] {\r\n  if (entries.length === 0) return [];\r\n\r\n  const byDay = new Map<string, { sum: number; count: number; day: Date }>();\r\n  for (const entry of entries) {\r\n    const dt = new Date(entry.timestamp);\r\n    // Normalize to local day key (YYYY-MM-DD)\r\n    const key = `${dt.getFullYear()}-${String(dt.getMonth() + 1).padStart(2, '0')}-${String(dt.getDate()).padStart(2, '0')}`;\r\n    const existing = byDay.get(key);\r\n    if (existing) {\r\n      existing.sum += entry.baselineData.pain;\r\n      existing.count += 1;\r\n    } else {\r\n      const day = new Date(dt);\r\n      day.setHours(0, 0, 0, 0);\r\n      byDay.set(key, { sum: entry.baselineData.pain, count: 1, day });\r\n    }\r\n  }\r\n\r\n  const points = Array.from(byDay.values())\r\n    .sort((a, b) => a.day.getTime() - b.day.getTime())\r\n    .slice(-maxDays)\r\n    .map(({ day, sum, count }) => ({\r\n      label: day.toLocaleDateString('en-CA', { month: 'short', day: 'numeric' }),\r\n      value: count > 0 ? sum / count : 0,\r\n    }));\r\n\r\n  return points;\r\n}\r\n\r\nfunction drawMiniTrendBars(\r\n  doc: jsPDF,\r\n  points: TrendPoint[],\r\n  x: number,\r\n  y: number,\r\n  width: number,\r\n  height: number\r\n) {\r\n  if (points.length === 0) return;\r\n\r\n  const values = points.map(p => p.value);\r\n  const min = Math.min(...values);\r\n  const max = Math.max(...values);\r\n  const span = Math.max(0.1, max - min);\r\n\r\n  const barGap = 1;\r\n  const barWidth = Math.max(1, Math.floor((width - barGap * (points.length - 1)) / points.length));\r\n\r\n  // Light frame\r\n  doc.setDrawColor(226, 232, 240); // slate-200\r\n  doc.setLineWidth(0.2);\r\n  doc.rect(x, y, width, height);\r\n\r\n  // Bars\r\n  doc.setFillColor(14, 165, 233); // sky-500\r\n  for (let i = 0; i < points.length; i++) {\r\n    const v = points[i].value;\r\n    const normalized = (v - min) / span;\r\n    const barH = Math.max(1, Math.round(normalized * (height - 2)));\r\n    const bx = x + i * (barWidth + barGap);\r\n    const by = y + height - 1 - barH;\r\n    doc.rect(bx, by, barWidth, barH, 'F');\r\n  }\r\n}\r\n\r\ninterface ReportMetrics {\r\n  totalEntries: number;\r\n  averagePain: number;\r\n  maxPain: number;\r\n  minPain: number;\r\n  painVariability: number;\r\n  missedWorkDays: number;\r\n  mostAffectedLocations: string[];\r\n  mostCommonSymptoms: string[];\r\n  treatmentEffectiveness: string;\r\n}\r\n\r\n/**\r\n * Calculate report metrics from pain entries\r\n */\r\nfunction calculateMetrics(entries: PainEntry[]): ReportMetrics {\r\n  if (entries.length === 0) {\r\n    return {\r\n      totalEntries: 0,\r\n      averagePain: 0,\r\n      maxPain: 0,\r\n      minPain: 0,\r\n      painVariability: 0,\r\n      missedWorkDays: 0,\r\n      mostAffectedLocations: [],\r\n      mostCommonSymptoms: [],\r\n      treatmentEffectiveness: 'No data available',\r\n    };\r\n  }\r\n\r\n  const painLevels = entries.map(e => e.baselineData.pain);\r\n  const avgPain = painLevels.reduce((a, b) => a + b, 0) / painLevels.length;\r\n  const maxPain = Math.max(...painLevels);\r\n  const minPain = Math.min(...painLevels);\r\n  \r\n  // Calculate standard deviation for variability\r\n  const variance = painLevels.reduce((acc, val) => acc + Math.pow(val - avgPain, 2), 0) / painLevels.length;\r\n  const painVariability = Math.sqrt(variance);\r\n\r\n  // Count missed work days\r\n  const missedWorkDays = entries.reduce((total, e) => total + (e.workImpact?.missedWork || 0), 0);\r\n\r\n  // Get most common locations\r\n  const locationCounts: Record<string, number> = {};\r\n  entries.forEach(e => {\r\n    e.baselineData.locations?.forEach(loc => {\r\n      locationCounts[loc] = (locationCounts[loc] || 0) + 1;\r\n    });\r\n  });\r\n  const mostAffectedLocations = Object.entries(locationCounts)\r\n    .sort(([, a], [, b]) => b - a)\r\n    .slice(0, 5)\r\n    .map(([loc]) => loc);\r\n\r\n  // Get most common symptoms\r\n  const symptomCounts: Record<string, number> = {};\r\n  entries.forEach(e => {\r\n    e.baselineData.symptoms?.forEach(sym => {\r\n      symptomCounts[sym] = (symptomCounts[sym] || 0) + 1;\r\n    });\r\n  });\r\n  const mostCommonSymptoms = Object.entries(symptomCounts)\r\n    .sort(([, a], [, b]) => b - a)\r\n    .slice(0, 5)\r\n    .map(([sym]) => sym);\r\n\r\n  // Summarize treatment effectiveness\r\n  const effectivenessReports = entries\r\n    .map(e => e.treatments?.effectiveness)\r\n    .filter(Boolean);\r\n  const treatmentEffectiveness = effectivenessReports.length > 0\r\n    ? `Based on ${effectivenessReports.length} reports`\r\n    : 'No treatment effectiveness data recorded';\r\n\r\n  return {\r\n    totalEntries: entries.length,\r\n    averagePain: avgPain,\r\n    maxPain,\r\n    minPain,\r\n    painVariability,\r\n    missedWorkDays,\r\n    mostAffectedLocations,\r\n    mostCommonSymptoms,\r\n    treatmentEffectiveness,\r\n  };\r\n}\r\n\r\n/**\r\n * Get pain severity description\r\n */\r\nfunction getPainSeverity(pain: number): string {\r\n  if (pain <= 2) return 'Mild';\r\n  if (pain <= 4) return 'Moderate';\r\n  if (pain <= 6) return 'Moderately Severe';\r\n  if (pain <= 8) return 'Severe';\r\n  return 'Extreme';\r\n}\r\n\r\n/**\r\n * Get pain trend description\r\n */\r\nfunction getPainTrend(entries: PainEntry[]): string {\r\n  if (entries.length < 2) return 'Insufficient data for trend analysis';\r\n  \r\n  const recentEntries = entries.slice(-7);\r\n  const olderEntries = entries.slice(-14, -7);\r\n  \r\n  if (olderEntries.length === 0) return 'Trend analysis requires at least 2 weeks of data';\r\n  \r\n  const recentAvg = recentEntries.reduce((a, e) => a + e.baselineData.pain, 0) / recentEntries.length;\r\n  const olderAvg = olderEntries.reduce((a, e) => a + e.baselineData.pain, 0) / olderEntries.length;\r\n  \r\n  const diff = recentAvg - olderAvg;\r\n  \r\n  if (Math.abs(diff) < 0.5) return 'Stable';\r\n  if (diff > 1.5) return 'Significantly Worsening';\r\n  if (diff > 0.5) return 'Slightly Worsening';\r\n  if (diff < -1.5) return 'Significantly Improving';\r\n  return 'Slightly Improving';\r\n}\r\n\r\n/**\r\n * Export enhanced WorkSafe BC PDF report\r\n */\r\nexport async function exportWorkSafeBCPDF(\r\n  entries: PainEntry[],\r\n  options: WCBExportOptions\r\n): Promise<string> {\r\n  // Track analytics\r\n  privacyAnalytics.trackDataExport('pdf').catch((error) => {\r\n    analyticsLogger.swallowed(error, { context: 'exportWorkSafeBCPDF', exportType: 'wcb-pdf' });\r\n  });\r\n  trackDataExported('pdf', entries.length);\r\n  trackExport('pdf', entries.length);\r\n\r\n  const { \r\n    startDate, \r\n    endDate, \r\n    patientName, \r\n    claimNumber,\r\n    healthcareProvider,\r\n    includeDetailedEntries = true,\r\n    includeTrendSummary = true,\r\n  } = options;\r\n\r\n  // Filter entries by date range\r\n  const filteredEntries = entries.filter(entry => {\r\n    const timestamp = new Date(entry.timestamp);\r\n    return timestamp >= startDate && timestamp <= endDate;\r\n  }).sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\r\n\r\n  const metrics = calculateMetrics(filteredEntries);\r\n  const painTrend = getPainTrend(filteredEntries);\r\n\r\n  const { default: jsPDF } = await import('jspdf');\r\n  const doc = new jsPDF();\r\n  let yPosition = 20;\r\n  const pageWidth = doc.internal.pageSize.getWidth();\r\n  const leftMargin = 20;\r\n  const rightMargin = pageWidth - 20;\r\n  const contentWidth = rightMargin - leftMargin;\r\n\r\n  // Helper function to add a new page if needed\r\n  const checkPageBreak = (requiredSpace: number) => {\r\n    if (yPosition + requiredSpace > 270) {\r\n      doc.addPage();\r\n      yPosition = 20;\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // ===== HEADER =====\r\n  doc.setFillColor(15, 23, 42); // slate-900\r\n  doc.rect(0, 0, pageWidth, 45, 'F');\r\n  \r\n  doc.setTextColor(255, 255, 255);\r\n  doc.setFontSize(20);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.text('Pain Tracker Pro', leftMargin, 18);\r\n  \r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text('WorkSafe BC Clinical Documentation Report', leftMargin, 28);\r\n  \r\n  doc.setFontSize(10);\r\n  doc.text(`Generated: ${new Date().toLocaleDateString('en-CA')}`, leftMargin, 38);\r\n  \r\n  // Report ID\r\n  const reportId = `WCB-${Date.now().toString(36).toUpperCase()}`;\r\n  doc.text(`Report ID: ${reportId}`, rightMargin - 50, 38);\r\n\r\n  yPosition = 55;\r\n\r\n  // ===== PATIENT INFORMATION BOX =====\r\n  doc.setTextColor(0, 0, 0);\r\n  doc.setFillColor(248, 250, 252); // slate-50\r\n  doc.roundedRect(leftMargin, yPosition, contentWidth, 35, 3, 3, 'F');\r\n  \r\n  doc.setFontSize(11);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.text('Patient Information', leftMargin + 5, yPosition + 10);\r\n  \r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setFontSize(10);\r\n  \r\n  const col1 = leftMargin + 5;\r\n  const col2 = leftMargin + contentWidth / 2;\r\n  \r\n  doc.text(`Patient: ${patientName || '[De-identified]'}`, col1, yPosition + 20);\r\n  doc.text(`Claim #: ${claimNumber || 'N/A'}`, col2, yPosition + 20);\r\n  doc.text(`Report Period: ${startDate.toLocaleDateString('en-CA')} to ${endDate.toLocaleDateString('en-CA')}`, col1, yPosition + 28);\r\n  doc.text(`Provider: ${healthcareProvider || 'N/A'}`, col2, yPosition + 28);\r\n\r\n  yPosition += 45;\r\n\r\n  // ===== EXECUTIVE SUMMARY =====\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(15, 23, 42);\r\n  doc.text('Executive Summary', leftMargin, yPosition);\r\n  yPosition += 8;\r\n  \r\n  doc.setDrawColor(14, 165, 233); // sky-500\r\n  doc.setLineWidth(2);\r\n  doc.line(leftMargin, yPosition, leftMargin + 40, yPosition);\r\n  yPosition += 10;\r\n\r\n  // Key metrics grid\r\n  const boxWidth = (contentWidth - 10) / 3;\r\n  const boxHeight = 30;\r\n  \r\n  // Average Pain Box\r\n  doc.setFillColor(254, 243, 199); // amber-100\r\n  doc.roundedRect(leftMargin, yPosition, boxWidth, boxHeight, 2, 2, 'F');\r\n  doc.setFontSize(20);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(180, 83, 9); // amber-700\r\n  doc.text(formatNumber(metrics.averagePain, 1), leftMargin + boxWidth / 2, yPosition + 15, { align: 'center' });\r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text('Average Pain', leftMargin + boxWidth / 2, yPosition + 24, { align: 'center' });\r\n  \r\n  // Peak Pain Box\r\n  doc.setFillColor(254, 226, 226); // red-100\r\n  doc.roundedRect(leftMargin + boxWidth + 5, yPosition, boxWidth, boxHeight, 2, 2, 'F');\r\n  doc.setFontSize(20);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(185, 28, 28); // red-700\r\n  doc.text(String(metrics.maxPain), leftMargin + boxWidth + 5 + boxWidth / 2, yPosition + 15, { align: 'center' });\r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text('Peak Pain', leftMargin + boxWidth + 5 + boxWidth / 2, yPosition + 24, { align: 'center' });\r\n  \r\n  // Total Entries Box\r\n  doc.setFillColor(219, 234, 254); // blue-100\r\n  doc.roundedRect(leftMargin + (boxWidth + 5) * 2, yPosition, boxWidth, boxHeight, 2, 2, 'F');\r\n  doc.setFontSize(20);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(29, 78, 216); // blue-700\r\n  doc.text(String(metrics.totalEntries), leftMargin + (boxWidth + 5) * 2 + boxWidth / 2, yPosition + 15, { align: 'center' });\r\n  doc.setFontSize(8);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.text('Total Entries', leftMargin + (boxWidth + 5) * 2 + boxWidth / 2, yPosition + 24, { align: 'center' });\r\n\r\n  yPosition += boxHeight + 15;\r\n\r\n  // Summary text\r\n  doc.setTextColor(71, 85, 105); // slate-600\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  \r\n  const summaryText = `During this ${Math.ceil((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24))}-day reporting period, the patient recorded ${metrics.totalEntries} pain entries. Pain levels ranged from ${metrics.minPain} to ${metrics.maxPain} (${getPainSeverity(metrics.maxPain)}), with an average intensity of ${formatNumber(metrics.averagePain, 1)}/10 (${getPainSeverity(metrics.averagePain)}). The overall pain trend is assessed as ${painTrend.toLowerCase()}.`;\r\n  \r\n  const summaryLines = doc.splitTextToSize(summaryText, contentWidth);\r\n  doc.text(summaryLines, leftMargin, yPosition);\r\n  yPosition += summaryLines.length * 5 + 10;\r\n\r\n  // Optional pain trend summary (text + mini visualization)\r\n  if (includeTrendSummary) {\r\n    checkPageBreak(45);\r\n\r\n    doc.setTextColor(15, 23, 42);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setFontSize(11);\r\n    doc.text('Pain Trend Summary', leftMargin, yPosition);\r\n    yPosition += 8;\r\n\r\n    const points = toDailyAveragePain(filteredEntries, 14);\r\n    const hasEnough = points.length >= 3;\r\n\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setFontSize(10);\r\n    doc.setTextColor(71, 85, 105);\r\n\r\n    if (!hasEnough) {\r\n      doc.text('Not enough data in this period to render a trend summary.', leftMargin, yPosition);\r\n      yPosition += 10;\r\n    } else {\r\n      const start = points[0].value;\r\n      const end = points[points.length - 1].value;\r\n      const delta = end - start;\r\n\r\n      const direction = Math.abs(delta) < 0.3 ? 'stable' : delta > 0 ? 'worsening' : 'improving';\r\n      const deltaText = `${delta > 0 ? '+' : ''}${formatNumber(delta, 1)}`;\r\n\r\n      doc.text(\r\n        `Daily average pain over the last ${points.length} days is ${direction} (${deltaText} change from start to end of period segment).`,\r\n        leftMargin,\r\n        yPosition\r\n      );\r\n      yPosition += 8;\r\n\r\n      // Mini bars\r\n      const chartH = 18;\r\n      const chartW = Math.min(90, contentWidth);\r\n      drawMiniTrendBars(doc, points, leftMargin, yPosition, chartW, chartH);\r\n\r\n      // Label endpoints\r\n      doc.setFontSize(8);\r\n      doc.setTextColor(100, 116, 139); // slate-500\r\n      doc.text(points[0].label, leftMargin, yPosition + chartH + 6);\r\n      const endLabel = points[points.length - 1].label;\r\n      doc.text(endLabel, leftMargin + chartW, yPosition + chartH + 6, { align: 'right' });\r\n\r\n      yPosition += chartH + 14;\r\n    }\r\n  }\r\n\r\n  if (metrics.missedWorkDays > 0) {\r\n    doc.setTextColor(185, 28, 28); // red-700\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text(`⚠ ${metrics.missedWorkDays} work day(s) missed during this period due to pain.`, leftMargin, yPosition);\r\n    yPosition += 12;\r\n  }\r\n\r\n  // ===== PAIN ANALYSIS =====\r\n  checkPageBreak(60);\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(15, 23, 42);\r\n  doc.text('Pain Analysis', leftMargin, yPosition);\r\n  yPosition += 8;\r\n  \r\n  doc.setDrawColor(14, 165, 233);\r\n  doc.setLineWidth(2);\r\n  doc.line(leftMargin, yPosition, leftMargin + 40, yPosition);\r\n  yPosition += 10;\r\n\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(71, 85, 105);\r\n\r\n  // Most affected locations\r\n  if (metrics.mostAffectedLocations.length > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Primary Pain Locations:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    metrics.mostAffectedLocations.forEach((loc, i) => {\r\n      doc.text(`  ${i + 1}. ${loc}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  // Most common symptoms\r\n  if (metrics.mostCommonSymptoms.length > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Associated Symptoms:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    metrics.mostCommonSymptoms.forEach((sym, i) => {\r\n      doc.text(`  ${i + 1}. ${sym}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  // Pain variability\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.text('Pain Variability:', leftMargin, yPosition);\r\n  doc.setFont('helvetica', 'normal');\r\n  const variabilityDesc = metrics.painVariability < 1 ? 'Low (consistent)' : \r\n                          metrics.painVariability < 2 ? 'Moderate' : 'High (fluctuating)';\r\n  doc.text(`  Standard deviation: ${formatNumber(metrics.painVariability, 2)} - ${variabilityDesc}`, leftMargin + 5, yPosition + 6);\r\n  yPosition += 15;\r\n\r\n  // ===== FUNCTIONAL IMPACT =====\r\n  checkPageBreak(60);\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(15, 23, 42);\r\n  doc.text('Functional Impact Assessment', leftMargin, yPosition);\r\n  yPosition += 8;\r\n  \r\n  doc.setDrawColor(14, 165, 233);\r\n  doc.setLineWidth(2);\r\n  doc.line(leftMargin, yPosition, leftMargin + 40, yPosition);\r\n  yPosition += 10;\r\n\r\n  // Gather functional limitations\r\n  const allLimitations = new Set<string>();\r\n  const allMobilityAids = new Set<string>();\r\n  filteredEntries.forEach(entry => {\r\n    entry.functionalImpact?.limitedActivities?.forEach(a => allLimitations.add(a));\r\n    entry.functionalImpact?.mobilityAids?.forEach(a => allMobilityAids.add(a));\r\n  });\r\n\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(71, 85, 105);\r\n\r\n  if (allLimitations.size > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Activities Limited by Pain:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    Array.from(allLimitations).slice(0, 8).forEach(lim => {\r\n      doc.text(`  • ${lim}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  if (allMobilityAids.size > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Mobility Aids Used:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    Array.from(allMobilityAids).forEach(aid => {\r\n      doc.text(`  • ${aid}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  // ===== WORK IMPACT =====\r\n  checkPageBreak(50);\r\n  doc.setFontSize(14);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(15, 23, 42);\r\n  doc.text('Work Impact', leftMargin, yPosition);\r\n  yPosition += 8;\r\n  \r\n  doc.setDrawColor(14, 165, 233);\r\n  doc.setLineWidth(2);\r\n  doc.line(leftMargin, yPosition, leftMargin + 40, yPosition);\r\n  yPosition += 10;\r\n\r\n  // Gather work impact data\r\n  const allWorkLimitations = new Set<string>();\r\n  const allModifiedDuties = new Set<string>();\r\n  filteredEntries.forEach(entry => {\r\n    entry.workImpact?.workLimitations?.forEach(l => allWorkLimitations.add(l));\r\n    entry.workImpact?.modifiedDuties?.forEach(d => allModifiedDuties.add(d));\r\n  });\r\n\r\n  doc.setFontSize(10);\r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setTextColor(71, 85, 105);\r\n\r\n  doc.text(`Total Work Days Missed: ${metrics.missedWorkDays}`, leftMargin, yPosition);\r\n  yPosition += 8;\r\n\r\n  if (allWorkLimitations.size > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Work-Related Limitations:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    Array.from(allWorkLimitations).slice(0, 6).forEach(lim => {\r\n      doc.text(`  • ${lim}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  if (allModifiedDuties.size > 0) {\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Required Accommodations:', leftMargin, yPosition);\r\n    doc.setFont('helvetica', 'normal');\r\n    yPosition += 6;\r\n    Array.from(allModifiedDuties).slice(0, 6).forEach(duty => {\r\n      doc.text(`  • ${duty}`, leftMargin + 5, yPosition);\r\n      yPosition += 5;\r\n    });\r\n    yPosition += 5;\r\n  }\r\n\r\n  // ===== DETAILED ENTRIES (if requested) =====\r\n  if (includeDetailedEntries && filteredEntries.length > 0) {\r\n    checkPageBreak(40);\r\n    doc.setFontSize(14);\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.setTextColor(15, 23, 42);\r\n    doc.text('Daily Pain Log Summary', leftMargin, yPosition);\r\n    yPosition += 8;\r\n    \r\n    doc.setDrawColor(14, 165, 233);\r\n    doc.setLineWidth(2);\r\n    doc.line(leftMargin, yPosition, leftMargin + 40, yPosition);\r\n    yPosition += 10;\r\n\r\n    doc.setFontSize(9);\r\n    doc.setFont('helvetica', 'normal');\r\n    doc.setTextColor(71, 85, 105);\r\n\r\n    // Table header\r\n    doc.setFillColor(241, 245, 249); // slate-100\r\n    doc.rect(leftMargin, yPosition, contentWidth, 8, 'F');\r\n    doc.setFont('helvetica', 'bold');\r\n    doc.text('Date', leftMargin + 3, yPosition + 5.5);\r\n    doc.text('Pain', leftMargin + 35, yPosition + 5.5);\r\n    doc.text('Locations', leftMargin + 55, yPosition + 5.5);\r\n    doc.text('Notes', leftMargin + 120, yPosition + 5.5);\r\n    yPosition += 10;\r\n\r\n    doc.setFont('helvetica', 'normal');\r\n    const maxEntries = Math.min(filteredEntries.length, 25);\r\n    \r\n    for (let i = 0; i < maxEntries; i++) {\r\n      checkPageBreak(8);\r\n      const entry = filteredEntries[i];\r\n      const date = new Date(entry.timestamp).toLocaleDateString('en-CA');\r\n      const pain = entry.baselineData.pain;\r\n      const locations = (entry.baselineData.locations || []).slice(0, 2).join(', ');\r\n      const notes = (entry.notes || '').substring(0, 30);\r\n      \r\n      // Alternate row colors\r\n      if (i % 2 === 0) {\r\n        doc.setFillColor(248, 250, 252);\r\n        doc.rect(leftMargin, yPosition - 3, contentWidth, 7, 'F');\r\n      }\r\n      \r\n      doc.text(date, leftMargin + 3, yPosition);\r\n      doc.text(`${pain}/10`, leftMargin + 35, yPosition);\r\n      doc.text(locations || '-', leftMargin + 55, yPosition);\r\n      doc.text(notes || '-', leftMargin + 120, yPosition);\r\n      yPosition += 7;\r\n    }\r\n\r\n    if (filteredEntries.length > maxEntries) {\r\n      doc.setTextColor(100, 116, 139);\r\n      doc.text(`... and ${filteredEntries.length - maxEntries} more entries`, leftMargin, yPosition + 5);\r\n      yPosition += 10;\r\n    }\r\n  }\r\n\r\n  // ===== DISCLAIMER =====\r\n  checkPageBreak(40);\r\n  yPosition += 10;\r\n  doc.setFillColor(254, 249, 195); // yellow-100\r\n  doc.roundedRect(leftMargin, yPosition, contentWidth, 35, 3, 3, 'F');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.setFont('helvetica', 'bold');\r\n  doc.setTextColor(133, 77, 14); // yellow-800\r\n  doc.text('IMPORTANT DISCLAIMER', leftMargin + 5, yPosition + 8);\r\n  \r\n  doc.setFont('helvetica', 'normal');\r\n  doc.setFontSize(8);\r\n  const disclaimerText = 'This report is a structured summary of self-reported pain data for WorkSafe BC reference only. It does not constitute medical advice, diagnosis, or treatment. This document should be reviewed with a qualified healthcare provider. Pain Tracker Pro is not affiliated with WorkSafe BC.';\r\n  const disclaimerLines = doc.splitTextToSize(disclaimerText, contentWidth - 10);\r\n  doc.text(disclaimerLines, leftMargin + 5, yPosition + 15);\r\n\r\n  // ===== FOOTER =====\r\n  const pageCount = doc.getNumberOfPages();\r\n  for (let i = 1; i <= pageCount; i++) {\r\n    doc.setPage(i);\r\n    doc.setFillColor(15, 23, 42);\r\n    doc.rect(0, 282, pageWidth, 15, 'F');\r\n    \r\n    doc.setTextColor(148, 163, 184); // slate-400\r\n    doc.setFontSize(8);\r\n    doc.text(`Pain Tracker Pro | WorkSafe BC Clinical Report | ${reportId}`, leftMargin, 289);\r\n    doc.text(`Page ${i} of ${pageCount}`, rightMargin - 20, 289);\r\n  }\r\n\r\n  return doc.output('datauristring');\r\n}\r\n\r\n/**\r\n * Download the WorkSafe BC PDF report\r\n */\r\nexport async function downloadWorkSafeBCPDF(\r\n  entries: PainEntry[],\r\n  options: WCBExportOptions\r\n): Promise<void> {\r\n  const pdfData = await exportWorkSafeBCPDF(entries, options);\r\n  \r\n  // Create filename with date range\r\n  const startStr = options.startDate.toISOString().split('T')[0];\r\n  const endStr = options.endDate.toISOString().split('T')[0];\r\n  const filename = `PainTracker-WCB-Report-${startStr}-to-${endStr}.pdf`;\r\n  \r\n  // Download the file\r\n  const link = document.createElement('a');\r\n  link.href = pdfData;\r\n  link.download = filename;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n}\r\n\r\nexport default exportWorkSafeBCPDF;\r\n","import React, { useState, useMemo } from 'react';\r\nimport {\r\n  FileText,\r\n  Download,\r\n  FileSpreadsheet,\r\n  FileJson,\r\n  FileType,\r\n  Calendar,\r\n  Clock,\r\n  Shield,\r\n  TrendingUp,\r\n  ChevronRight,\r\n  CheckCircle2,\r\n  AlertCircle,\r\n} from 'lucide-react';\r\nimport { Card, CardContent, CardHeader, CardTitle, Button, Badge } from '../../design-system';\r\nimport type { PainEntry } from '../../types';\r\nimport { exportToCSV, exportToJSON, exportToPDF, downloadData } from '../../utils/pain-tracker/export';\r\nimport { downloadWorkSafeBCPDF } from '../../utils/pain-tracker/wcb-export';\r\nimport { useToast } from '../feedback';\r\n\r\ninterface ReportsPageProps {\r\n  entries: PainEntry[];\r\n}\r\n\r\ninterface ReportType {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: React.ElementType;\r\n  format: string;\r\n  color: string;\r\n  action: () => void;\r\n}\r\n\r\ninterface QuickStat {\r\n  label: string;\r\n  value: string | number;\r\n  icon: React.ElementType;\r\n  trend?: 'up' | 'down' | 'neutral';\r\n}\r\n\r\nexport function ReportsPage({ entries }: ReportsPageProps) {\r\n  const toast = useToast();\r\n  const [isExporting, setIsExporting] = useState<string | null>(null);\r\n  const [dateRange, setDateRange] = useState<'all' | '7d' | '30d' | '90d'>('7d');\r\n  const [showExportPreview, setShowExportPreview] = useState(false);\r\n\r\n  // Filter entries based on date range\r\n  const filteredEntries = useMemo(() => {\r\n    if (dateRange === 'all') return entries;\r\n    \r\n    const now = new Date();\r\n    const daysMap = { '7d': 7, '30d': 30, '90d': 90 };\r\n    const cutoff = new Date(now.getTime() - daysMap[dateRange] * 24 * 60 * 60 * 1000);\r\n    \r\n    return entries.filter(entry => new Date(entry.timestamp) >= cutoff);\r\n  }, [entries, dateRange]);\r\n\r\n  const csvHeaderPreview = useMemo(() => {\r\n    try {\r\n      return exportToCSV([] as unknown as PainEntry[]).split('\\n')[0] ?? '';\r\n    } catch {\r\n      return '';\r\n    }\r\n  }, []);\r\n\r\n  const jsonPreview = useMemo(() => {\r\n    try {\r\n      const raw = exportToJSON([] as unknown as PainEntry[]);\r\n      const parsed = JSON.parse(raw);\r\n      return JSON.stringify(parsed, null, 2);\r\n    } catch {\r\n      return '[]';\r\n    }\r\n  }, []);\r\n\r\n  // Calculate quick stats\r\n  const quickStats: QuickStat[] = useMemo(() => {\r\n    if (filteredEntries.length === 0) {\r\n      return [\r\n        { label: 'Total Entries', value: 0, icon: FileText },\r\n        { label: 'Avg Pain Level', value: '-', icon: TrendingUp },\r\n        { label: 'Date Range', value: 'No data', icon: Calendar },\r\n      ];\r\n    }\r\n\r\n    const avgPain = filteredEntries.reduce((sum, e) => sum + e.baselineData.pain, 0) / filteredEntries.length;\r\n    const sortedEntries = [...filteredEntries].sort((a, b) => \r\n      new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\r\n    );\r\n    const startDate = new Date(sortedEntries[0].timestamp).toLocaleDateString();\r\n    const endDate = new Date(sortedEntries[sortedEntries.length - 1].timestamp).toLocaleDateString();\r\n\r\n    return [\r\n      { label: 'Total Entries', value: filteredEntries.length, icon: FileText },\r\n      { label: 'Avg Pain Level', value: avgPain.toFixed(1), icon: TrendingUp },\r\n      { label: 'Date Range', value: `${startDate} - ${endDate}`, icon: Calendar },\r\n    ];\r\n  }, [filteredEntries]);\r\n\r\n  const handleExport = async (type: string, exportFn: () => string | Promise<string>, filename: string, mimeType: string) => {\r\n    if (filteredEntries.length === 0) {\r\n      toast.error('No Data', 'There are no entries to export for the selected date range.');\r\n      return;\r\n    }\r\n\r\n    setIsExporting(type);\r\n    try {\r\n      // Small delay for UI feedback\r\n      await new Promise(resolve => setTimeout(resolve, 300));\r\n      const data = await exportFn();\r\n      downloadData(data, filename, mimeType);\r\n      toast.success('Export Complete', `Your ${type.toUpperCase()} report has been downloaded.`);\r\n    } catch (error) {\r\n      console.error('Export error:', error);\r\n      toast.error('Export Failed', 'Unable to generate the report. Please try again.');\r\n    } finally {\r\n      setIsExporting(null);\r\n    }\r\n  };\r\n\r\n  const handleWorkSafeBCExport = async () => {\r\n    if (filteredEntries.length === 0) {\r\n      toast.error('No Data', 'There are no entries to include in the report.');\r\n      return;\r\n    }\r\n\r\n    setIsExporting('worksafe-bc');\r\n    try {\r\n      await new Promise(resolve => setTimeout(resolve, 300));\r\n      const sorted = [...filteredEntries].sort(\r\n        (a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\r\n      );\r\n      const startDate = new Date(sorted[0].timestamp);\r\n      const endDate = new Date(sorted[sorted.length - 1].timestamp);\r\n\r\n      await downloadWorkSafeBCPDF(filteredEntries, {\r\n        startDate,\r\n        endDate,\r\n        includeDetailedEntries: true,\r\n      });\r\n      toast.success('Export Complete', 'Your WorkSafe BC report has been downloaded.');\r\n    } catch (error) {\r\n      console.error('WCB export error:', error);\r\n      toast.error('Export Failed', 'Unable to generate the WorkSafe BC report. Please try again.');\r\n    } finally {\r\n      setIsExporting(null);\r\n    }\r\n  };\r\n\r\n  const reportTypes: ReportType[] = [\r\n    {\r\n      id: 'csv',\r\n      name: 'CSV Spreadsheet',\r\n      description: 'Export your data as a CSV file for use in Excel, Google Sheets, or other spreadsheet applications.',\r\n      icon: FileSpreadsheet,\r\n      format: 'CSV',\r\n      color: 'emerald',\r\n      action: () => handleExport(\r\n        'csv',\r\n        () => exportToCSV(filteredEntries),\r\n        `pain-tracker-export-${new Date().toISOString().split('T')[0]}.csv`,\r\n        'text/csv'\r\n      ),\r\n    },\r\n    {\r\n      id: 'json',\r\n      name: 'JSON Data',\r\n      description: 'Export your complete data in JSON format, including all metadata and details.',\r\n      icon: FileJson,\r\n      format: 'JSON',\r\n      color: 'amber',\r\n      action: () => handleExport(\r\n        'json',\r\n        () => exportToJSON(filteredEntries),\r\n        `pain-tracker-export-${new Date().toISOString().split('T')[0]}.json`,\r\n        'application/json'\r\n      ),\r\n    },\r\n    {\r\n      id: 'pdf',\r\n      name: 'PDF Report',\r\n      description: 'Generate a formatted PDF report with summary statistics.',\r\n      icon: FileType,\r\n      format: 'PDF',\r\n      color: 'rose',\r\n      action: () => handleExport(\r\n        'pdf',\r\n        () => exportToPDF(filteredEntries),\r\n        `pain-tracker-report-${new Date().toISOString().split('T')[0]}.pdf`,\r\n        'application/pdf'\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const specializedReports = [\r\n    {\r\n      id: 'worksafe-bc',\r\n      name: 'WorkSafe BC Report',\r\n      description: 'For WorkSafeBC claims in British Columbia (Canada). Includes a structured clinical summary and pain trends (not affiliated with WorkSafeBC).',\r\n      icon: Shield,\r\n      badge: 'WCB',\r\n      available: true,\r\n    },\r\n    {\r\n      id: 'insurance',\r\n      name: 'Insurance Report',\r\n      description: 'Create a comprehensive report for insurance claims with medical documentation support.',\r\n      icon: FileText,\r\n      badge: 'Coming soon',\r\n      available: false,\r\n    },\r\n    {\r\n      id: 'clinical',\r\n      name: 'Clinical Summary',\r\n      description: 'Generate a clinical summary for healthcare providers with a clear timeline and symptom overview.',\r\n      icon: TrendingUp,\r\n      badge: 'Coming soon',\r\n      available: false,\r\n    },\r\n  ];\r\n\r\n  const dateRangeOptions = [\r\n    { value: 'all', label: 'All Time' },\r\n    { value: '7d', label: 'Last 7 Days' },\r\n    { value: '30d', label: 'Last 30 Days' },\r\n    { value: '90d', label: 'Last 90 Days' },\r\n  ] as const;\r\n\r\n  return (\r\n    <div className=\"space-y-6 p-6 max-w-6xl mx-auto\">\r\n      {/* Page Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">Reports & Export</h1>\r\n          <p className=\"text-gray-600 dark:text-gray-400 mt-1\">\r\n            Export your pain tracking data or generate specialized reports\r\n          </p>\r\n        </div>\r\n        \r\n        {/* Date Range Filter */}\r\n        <div className=\"flex items-center gap-2\">\r\n          <Calendar className=\"h-4 w-4 text-gray-500\" />\r\n          <select\r\n            value={dateRange}\r\n            onChange={(e) => setDateRange(e.target.value as typeof dateRange)}\r\n            className=\"px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-sky-500\"\r\n            aria-label=\"Select date range\"\r\n          >\r\n            {dateRangeOptions.map(option => (\r\n              <option key={option.value} value={option.value}>{option.label}</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Export Preview / What's Included */}\r\n      <Card className=\"border-sky-200 dark:border-sky-900 bg-sky-50/60 dark:bg-sky-900/10\">\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center justify-between gap-3\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Shield className=\"h-5 w-5 text-sky-700 dark:text-sky-300\" />\r\n              What exports include\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => setShowExportPreview(v => !v)}\r\n              aria-expanded={showExportPreview}\r\n            >\r\n              {showExportPreview ? 'Hide preview' : 'Show preview'}\r\n            </Button>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-3\">\r\n          <p className=\"text-sm text-sky-900/80 dark:text-sky-100/80\">\r\n            Exports are generated on your device. The preview below shows structure/field names only • it does not display your entries.\r\n          </p>\r\n\r\n          {showExportPreview && (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"rounded-xl border border-sky-200/70 dark:border-sky-800 bg-white/70 dark:bg-gray-900/30 p-4\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <FileSpreadsheet className=\"h-4 w-4 text-emerald-600 dark:text-emerald-400\" />\r\n                  <div className=\"font-medium text-sm\">CSV Spreadsheet</div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-2\">Columns (header row)</div>\r\n                <pre className=\"text-xs whitespace-pre-wrap break-words rounded-lg bg-gray-100/80 dark:bg-gray-800/50 p-3 border border-gray-200 dark:border-gray-700\">\r\n{csvHeaderPreview || '(preview unavailable)'}\r\n                </pre>\r\n              </div>\r\n\r\n              <div className=\"rounded-xl border border-sky-200/70 dark:border-sky-800 bg-white/70 dark:bg-gray-900/30 p-4\">\r\n                <div className=\"flex items-center gap-2 mb-2\">\r\n                  <FileJson className=\"h-4 w-4 text-amber-600 dark:text-amber-400\" />\r\n                  <div className=\"font-medium text-sm\">JSON Data</div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-2\">\r\n                  Top-level structure (empty export)\r\n                </div>\r\n                <pre className=\"text-xs whitespace-pre-wrap break-words rounded-lg bg-gray-100/80 dark:bg-gray-800/50 p-3 border border-gray-200 dark:border-gray-700\">\r\n{jsonPreview}\r\n                </pre>\r\n              </div>\r\n\r\n              <div className=\"rounded-xl border border-sky-200/70 dark:border-sky-800 bg-white/70 dark:bg-gray-900/30 p-4\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <FileType className=\"h-4 w-4 text-rose-600 dark:text-rose-400\" />\r\n                  <div className=\"font-medium text-sm\">PDF Report</div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                  A formatted summary (no preview shown here • PDFs include your selected date range and aggregate statistics).\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"rounded-xl border border-sky-200/70 dark:border-sky-800 bg-white/70 dark:bg-gray-900/30 p-4\">\r\n                <div className=\"flex items-center gap-2 mb-1\">\r\n                  <Shield className=\"h-4 w-4 text-sky-700 dark:text-sky-300\" />\r\n                  <div className=\"font-medium text-sm\">WorkSafeBC (WCB)</div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 dark:text-gray-400\">\r\n                  Built for WorkSafeBC documentation workflows (BC, Canada). Review the PDF before sharing.\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Quick Stats */}\r\n      <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\r\n        {quickStats.map((stat, index) => (\r\n          <Card key={index} className=\"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900\">\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"p-2 bg-sky-100 dark:bg-sky-900/30 rounded-lg\">\r\n                  <stat.icon className=\"h-5 w-5 text-sky-600 dark:text-sky-400\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">{stat.label}</p>\r\n                  <p className=\"text-lg font-semibold text-gray-900 dark:text-white\">{stat.value}</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {/* No Data Warning */}\r\n      {filteredEntries.length === 0 && (\r\n        <Card className=\"border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20\">\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-start gap-3\">\r\n              <AlertCircle className=\"h-5 w-5 text-amber-600 dark:text-amber-400 mt-0.5\" />\r\n              <div>\r\n                <h3 className=\"font-medium text-amber-900 dark:text-amber-100\">No Data Available</h3>\r\n                <p className=\"text-sm text-amber-700 dark:text-amber-300 mt-1\">\r\n                  {dateRange === 'all' \r\n                    ? \"You haven't logged any pain entries yet. Start tracking to generate reports.\"\r\n                    : `No entries found for the selected time period. Try selecting a different date range.`\r\n                  }\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Export Options */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Download className=\"h-5 w-5\" />\r\n            Quick Export\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            {reportTypes.map((report) => (\r\n              <button\r\n                key={report.id}\r\n                onClick={report.action}\r\n                disabled={isExporting !== null || filteredEntries.length === 0}\r\n                className={`\r\n                  relative p-4 rounded-xl border-2 border-dashed transition-all duration-200\r\n                  ${filteredEntries.length === 0 \r\n                    ? 'border-gray-200 dark:border-gray-700 opacity-50 cursor-not-allowed'\r\n                    : `border-${report.color}-200 dark:border-${report.color}-800 hover:border-${report.color}-400 dark:hover:border-${report.color}-600 hover:bg-${report.color}-50 dark:hover:bg-${report.color}-900/20 cursor-pointer`\r\n                  }\r\n                  ${isExporting === report.id ? 'bg-sky-50 dark:bg-sky-900/20 border-sky-400 dark:border-sky-600' : ''}\r\n                `}\r\n              >\r\n                <div className=\"flex flex-col items-center text-center gap-3\">\r\n                  <div className={`p-3 rounded-xl bg-${report.color}-100 dark:bg-${report.color}-900/30`}>\r\n                    {isExporting === report.id ? (\r\n                      <div className=\"h-6 w-6 border-2 border-sky-600 border-t-transparent rounded-full animate-spin\" />\r\n                    ) : (\r\n                      <report.icon className={`h-6 w-6 text-${report.color}-600 dark:text-${report.color}-400`} />\r\n                    )}\r\n                  </div>\r\n                  <div>\r\n                    <h3 className=\"font-medium text-gray-900 dark:text-white\">{report.name}</h3>\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">{report.description}</p>\r\n                  </div>\r\n                  <Badge variant=\"secondary\" className=\"text-xs\">\r\n                    {report.format}\r\n                  </Badge>\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Specialized Reports */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Shield className=\"h-5 w-5\" />\r\n            Specialized Reports\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-3\">\r\n            {specializedReports.map((report) => (\r\n              <button\r\n                key={report.id}\r\n                onClick={() => {\r\n                  if (filteredEntries.length === 0) {\r\n                    toast.error('No Data', 'There are no entries to include in the report.');\r\n                    return;\r\n                  }\r\n                  if (report.id === 'worksafe-bc') {\r\n                    void handleWorkSafeBCExport();\r\n                    return;\r\n                  }\r\n                  if (!report.available) {\r\n                    toast.info('Coming Soon', `${report.name} generation is coming in a future update.`);\r\n                    return;\r\n                  }\r\n\r\n                  toast.info('Coming Soon', `${report.name} generation is coming in a future update.`);\r\n                }}\r\n                disabled={filteredEntries.length === 0}\r\n                className={`\r\n                  w-full flex items-center justify-between p-4 rounded-xl border transition-all duration-200\r\n                  ${filteredEntries.length === 0\r\n                    ? 'border-gray-200 dark:border-gray-700 opacity-50 cursor-not-allowed'\r\n                    : 'border-gray-200 dark:border-gray-700 hover:border-sky-300 dark:hover:border-sky-700 hover:bg-gray-50 dark:hover:bg-gray-800/50 cursor-pointer'\r\n                  }\r\n                `}\r\n              >\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg\">\r\n                    <report.icon className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\r\n                  </div>\r\n                  <div className=\"text-left\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <h3 className=\"font-medium text-gray-900 dark:text-white\">{report.name}</h3>\r\n                      <Badge variant={report.badge === 'WCB' ? 'default' : 'secondary'} className=\"text-xs\">\r\n                        {report.badge}\r\n                      </Badge>\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">{report.description}</p>\r\n                  </div>\r\n                </div>\r\n                <ChevronRight className=\"h-5 w-5 text-gray-400\" />\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Scheduled Reports Section */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Clock className=\"h-5 w-5\" />\r\n            Scheduled Reports\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"inline-flex p-4 bg-gray-100 dark:bg-gray-800 rounded-2xl mb-4\">\r\n              <Calendar className=\"h-8 w-8 text-gray-400\" />\r\n            </div>\r\n            <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">No Scheduled Reports</h3>\r\n            <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-4\">\r\n              Set up automated reports to be generated on a schedule.\r\n            </p>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => toast.info('Coming Soon', 'Scheduled reports will be available in a future update.')}\r\n            >\r\n              <Calendar className=\"h-4 w-4 mr-2\" />\r\n              Schedule a Report\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Export History */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <CheckCircle2 className=\"h-5 w-5\" />\r\n            Recent Exports\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-center py-6\">\r\n            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n              Your export history will appear here.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ReportsPage;\r\n"],"file":"index-BB06s1nm.js"}