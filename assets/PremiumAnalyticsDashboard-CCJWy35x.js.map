{"version":3,"mappings":"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","names":["EmotionalAnalysisService","positiveKeywords","negativeKeywords","neutralKeywords","triggerKeywords","analyzeText","text","words","toLowerCase","split","positiveCount","filter","word","this","some","includes","keyword","length","negativeCount","neutralCount","triggerCount","valence","intensityWords","intensityCount","arousal","confidence","Math","min","max","keywords","concat","triggers","ValidationMessageGenerator","supportiveMessages","emphaticMessages","celebratoryMessages","gentleMessages","generate","emotionalState","messages","tone","icon","color","followUp","Sun","CloudRain","Heart","Sparkles","Shield","id","Date","now","message","floor","random","timestamp","EmotionalValidation","onValidationGenerated","isActive","delay","preferences","useTraumaInformed","currentValidation","setCurrentValidation","useState","isVisible","setIsVisible","analysisService","useRef","messageGenerator","timeoutRef","generateValidation","useCallback","inputText","trim","current","validation","setTimeout","useEffect","realTimeValidation","clearTimeout","IconComponent","jsxDEV","className","role","children","fileName","lineNumber","columnNumber","onClick","ValidationHistory","validations","onClear","slice","reverse","map","toLocaleTimeString","DEFAULT_PATTERN_CONFIG","minEntriesForTrend","minSupportForCorrelation","minConfidenceForDisplay","episodePainThreshold","episodeMinLengthDays","baselineWindowDays","enableLaggedCorrelations","maxLagDays","enableQoLDissonance","analyzePatterns","entries","config","fullConfig","cleanedEntries","entry","pain","baselineData","date","isNaN","getTime","sort","a","b","cleanEntries","baseline","windowDays","value","method","entryCount","windowMs","recentEntries","e","useEntries","sorted","median","calculateBaseline","dailyTrend","dailyMap","Map","forEach","dateKey","getFullYear","String","getMonth","padStart","getDate","has","set","values","count","bucket","get","push","Array","from","data","mean","reduce","sum","v","variance","pow","stdDev","sqrt","range","localeCompare","computeDailyTrend","weeklyTrend","weeklyPoints","window","i","p","totalCount","minVal","maxVal","computeWeeklyTrend","episodes","currentEpisode","threshold","idx","point","points","start","painValues","avgPain","peakPain","recoveryDays","episodeEndDate","j","futurePoint","futureDate","severity","end","round","Number","toFixed","durationDays","associatedTriggers","associatedLocations","detectEpisodes","triggerCorrelations","computeGenericCorrelations","computeTriggerCorrelations","symptomCorrelations","symptoms","computeSymptomCorrelations","medicationCorrelations","meds","medications","m","name","computeMedicationCorrelations","locationCorrelations","locations","computeLocationCorrelations","triggerBundles","bundles","triggerPairs","pair","join","totalDelta","stats","pairKey","avgDelta","strength","bucketCorrelation","combinedDelta","coOccurrence","abs","detectTriggerBundles","qolPatterns","patterns","sleepPattern","analyzeQoLDimension","qualityOfLife","sleepQuality","goodThreshold","poorThreshold","moodPattern","moodImpact","activityPattern","activityLevel","computeQoLPatterns","qolDissonances","dissonances","recentPain","previousPain","recentPainAvg","previousPainAvg","painChange","painTrend","previousEntries","recentSleep","previousSleep","sleepChange","type","description","qolTrend","affectedMetrics","recommendation","detectQoLDissonances","meta","dataWindow","toISOString","dataQuality","assessDataQuality","cautions","generateCautions","generatedAt","extractor","itemStats","items","item","withItem","withoutItem","key","correlations","support","meanWith","meanWithout","delta","stabilityScore","direction","label","formatLabel","deltaPain","charAt","toUpperCase","metric","thresholds","inverse","goodEntries","poorEntries","evidenceCount","magnitude","generateQoLDescription","correlation","condition","localYMD","d","buildDailyAveragePain","byDay","ts","NERVE_SYMPTOMS","NerveSymptoms","period","nerveSymptomAnalysis","acc","symptom","Set","painLevels","add","location","symptomsSummary","Object","frequency","averagePain","formatNumber","FunctionalLimitations","limitationsAnalysis","functionalImpact","limitedActivities","activity","assistanceNeeded","mobilityAids","assistance","aid","limitationsSummary","limitation","parseWeatherString","weather","result","isRaining","tempMatch","match","temp","parseInt","humidityMatch","humidity","kw","conditionMatch","getCorrelationStrength","diff","absDiff","WeatherCorrelationPanel","analysis","useMemo","weatherEntries","parsed","totalAvgPain","tempEntries","coldEntries","warmEntries","rainyEntries","dryEntries","humidEntries","normalHumidityEntries","calcAvg","arr","s","coldAvg","warmAvg","factor","avgPainWith","avgPainWithout","sampleSize","insight","Thermometer","rainyAvg","dryAvg","humidAvg","normalAvg","Droplets","conditionMap","existing","totalPain","weatherStats","getWeatherIcon","totalEntries","coveragePercent","Card","cn","CardHeader","CardTitle","Cloud","Badge","variant","CardContent","corr","CorrelationBadge","stat","style","width","TrendingUp","TrendingDown","Minus","colorClass","lower","Wind","DataComparisonEngine","compareDatasets","datasets","statistics","calculateStatistics","insights","generateInsights","charts","generateCharts","toString","substr","createdAt","updatedAt","Error","comparison","baselinePainLevels","comparisonPainLevels","baselineMean","calculateMean","comparisonMean","difference","percentageChange","statisticalSignificance","calculateStatisticalSignificance","effectSize","calculateEffectSize","painStats","compareMetric","moodStats","compareQualityOfLifeMetric","sleepStats","baselineTrend","calculateTrend","comparisonTrend","overall","byMetric","mood","sleep","trends","trendDifference","comparisonData","baselineStats","calculateStatisticalMeasures","comparisonStats","calculateConfidence","baselineEntries","comparisonEntries","calculateMedian","mode","calculateMode","calculateStandardDeviation","calculatePercentile","sortedData","mid","maxCount","parseFloat","percentile","index","upper","ceil","weight","data1","data2","mean1","mean2","std1","std2","n1","n2","se","t","exp","PI","pooledStd","significance","n","x","_","y","sumX","val","sumY","_config","isImprovement","title","actionable","improvingTrend","moodChange","generateLineChart","generateBarChart","generateBoxPlot","labels","chartDatasets","dataset","borderColor","backgroundColor","fill","maxLength","responsive","plugins","legend","display","position","tooltip","enabled","scales","borderWidth","beginAtZero","q1","q3","flat","ChartWithTableToggle","chartData","tableData","Icon","height","footer","viewMode","setViewMode","Fragment","Table","BarChart","minHeight","Chart","additionalInfo","colSpan","TimePeriodComparisonComponent","onComparisonComplete","defaultComparisonType","comparisonType","setComparisonType","baselineStart","setBaselineStart","baselineEnd","setBaselineEnd","comparisonStart","setComparisonStart","comparisonEnd","setComparisonEnd","isLoading","setIsLoading","setResult","formatDate","yesterday","setDate","dayBeforeYesterday","lastWeekStart","lastWeekEnd","thisWeekStart","lastMonthStart","setMonth","lastMonthEnd","thisMonthStart","thirtyDaysAgo","sixtyDaysAgo","handleCompare","async","entryDate","alert","sortByTimestampAsc","baselineEntriesSorted","comparisonEntriesSorted","metadata","source","dateRange","periodType","baselinePeriod","comparisonPeriod","comparisonResult","error","disabled","buildLineTableData","chart","first","rest","ds","buildBarTableData","renderChart","BarChart3","converted","periodLabels","payload","borderColors","isArray","backgroundColors","bg","boxPlotToBarChart","Activity","Boolean","renderComparisonResults","Calendar","htmlFor","onChange","target","Input","Button","RefreshCw","DAY_LABELS","MEDICATION_WINDOWS","clamp","isRecord","ENABLE_VALIDATION_EXPORT","env","maybeProcess","globalThis","process","getEnv","getEnvValue","ClinicalPDFExportButtonLazy","React","lazy","__vitePreload","import","__VITE_PRELOAD__","then","module","default","ClinicalPDFExportButton","DataExportModalLazy","DataExportModal","PremiumAnalyticsDashboard","timeRange","setTimeRange","view","setView","timeRangeLabel","filteredEntries","cutoff","localDayStart","setFullYear","analytics","trend","volatility","goodDays","badDays","topLocations","topTriggers","topReliefMethods","topActivities","topQualities","stressStats","avg","activityLevelStats","weatherCount","timePatterns","morning","avgIntensity","afternoon","evening","night","dayOfWeekPatterns","monthlyTrend","triggerPainCorrelation","medicationEffectiveness","predictedFlare","riskScore","improvementScore","optimalMedicationWindow","nextWeekForecast","personalizedRecommendations","midpoint","firstHalf","secondHalf","firstHalfAvg","secondHalfAvg","isFinite","dailyBuckets","toLocalDateKey","dailyAverages","daysWithEntries","locationCounts","loc","percentage","triggerCounts","trigger","reliefCounts","reliefMethods","activityCounts","activities","qualityCounts","quality","q","stressValues","stress","activityLevelValues","makeNumericStats","monthlyTrendBuckets","overallAvgPain","triggerPainDeltas","medicationTimingBuckets","hour","getHours","dayOfWeek","getDay","month","deltaSum","keys","dayOfWeekSummary","day","sortedForSequential","medicationData","nextEntry","reduction","windowInfo","find","getWindowForHour","totalReduction","med","uses","medication","avgReduction","effectiveness","recentAvg","isIncreasing","every","probability","timeframe","recommendations","projectedChange","projectedAverage","change","narrative","detail","category","emphasis","toughestDay","aggravatingTrigger","standoutMedication","patternAnalysis","reasoningTree","buildReasoningTree","size","leftIcon","Share2","Download","option","Waves","Brain","tab","OverviewView","PatternsView","PredictionsView","ClinicalReportView","InsightsView","ExportView","comparisonPreset","setComparisonPreset","progressSummary","opts","minDaysPerWindow","stableThresholdPercent","daily","sliceSize","recent","baselineAvg","percentImproved","baselineDays","recentDays","baselineAvgPain","recentAvgPain","computePainProgressSinceStart","progressSparkline","totalDaysWithEntries","year","goodDaysSubtitle","MetricCard","subtitle","CheckCircle","AlertTriangle","CardDescription","viewBox","preserveAspectRatio","stroke","strokeWidth","strokeLinecap","strokeLinejoin","rec","MapPin","Zap","Clock","Moon","badgeVariant","intensity","getIntensityBadgeVariant","padding","barClassName","getEffectivenessBarClassName","reliefLabel","barWidth","timeOfDayOrder","getSeverityBadgeVariant","row","positive","Pill","monthData","flare","forecast","medicationWindow","medicationLeaders","stabilizingTrigger","getEmphasisBadgeVariant","sortedEntries","dateFormatter","toLocaleDateString","rangeStart","rangeEnd","latestEntry","functionalSummary","sleepTotal","sleepCount","moodTotal","moodCount","workSummary","workImpact","missedDays","missedWork","modifiedDuties","workLimitations","careTeamNotes","medicationHighlights","riskLevel","summaryBullets","bullet","note","entryConfidence","latestRecommendation","confidenceBadgeVariant","ReasoningTree","nodes","depth","episode","pattern","caution","node","evidence","action","coverageConfidence","patternNode","riskNode","clinicalNode","isQuickExporting","setIsQuickExporting","quickExportError","setQuickExportError","shareStatus","setShareStatus","copyErrorMessage","setCopyErrorMessage","emailError","setEmailError","showAdvancedModal","setShowAdvancedModal","showValidationHistory","setShowValidationHistory","isOffline","setIsOffline","navigator","onLine","validationHistory","addValidation","clearHistory","setValidationHistory","prev","useEmotionalValidation","updateStatus","addEventListener","removeEventListener","validationIsActive","rangeLabel","rangeSlug","topLocationsSummary","forecastLine","shareSummary","logExportAudit","actionType","outcome","details","hipaaComplianceService","logAuditEvent","userId","userRole","resourceType","handleQuickExport","format","reason","mod","filename","csv","exportToCSV","downloadData","json","exportToJSON","handleCopySummary","clipboard","writeText","document","textarea","createElement","opacity","body","appendChild","focus","select","execCommand","removeChild","channel","handleOpenAdvancedModal","handleEmailShare","subject","encodeURIComponent","open","FileText","Suspense","fallback","fullWidth","Filter","loading","FileSpreadsheet","FileJson","readOnly","ClipboardCheck","Mail","Lock","isOpen","onClose","iconToneClassName","hasTrend","trendValue","trendBadgeVariant","hover"],"ignoreList":[],"sources":["../../src/services/EmotionalValidationService.tsx","../../src/types/pattern-engine.ts","../../src/utils/pain-tracker/pattern-engine.ts","../../src/utils/pain-tracker/progress.ts","../../src/components/pain-tracker/NerveSymptoms.tsx","../../src/components/pain-tracker/FunctionalLimitations.tsx","../../src/components/analytics/WeatherCorrelationPanel.tsx","../../src/utils/comparison/engine.ts","../../src/components/accessibility/ChartWithTableToggle.tsx","../../src/components/comparison/TimePeriodComparison.tsx","../../src/components/analytics/PremiumAnalyticsDashboard.tsx","../../src/hooks/useEmotionalValidation.ts"],"sourcesContent":["/**\n * Real-Time Emotional Validation System\n * Provides immediate emotional acknowledgment and validation\n */\n\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { Heart, Shield, CloudRain, Sun, Sparkles } from 'lucide-react';\nimport { useTraumaInformed } from '../components/accessibility/TraumaInformedHooks';\n\n// Types for emotional validation\nexport interface EmotionalState {\n  valence: 'positive' | 'neutral' | 'negative' | 'mixed';\n  arousal: 'high' | 'medium' | 'low';\n  keywords: string[];\n  confidence: number;\n  triggers?: string[];\n}\n\nexport interface ValidationResponse {\n  id: string;\n  message: string;\n  tone: 'supportive' | 'empathetic' | 'celebratory' | 'gentle';\n  icon: React.ComponentType<{ className?: string }>;\n  color: string;\n  followUp?: string;\n  timestamp: Date;\n}\n\n// Emotional analysis service\nclass EmotionalAnalysisService {\n  private positiveKeywords = [\n    'better',\n    'improved',\n    'good',\n    'great',\n    'healing',\n    'progress',\n    'relief',\n    'comfortable',\n    'manageable',\n    'hopeful',\n    'grateful',\n    'thankful',\n    'blessed',\n    'stronger',\n    'resilient',\n    'capable',\n    'empowered',\n    'peaceful',\n    'calm',\n  ];\n\n  private negativeKeywords = [\n    'pain',\n    'hurt',\n    'suffering',\n    'agony',\n    'terrible',\n    'awful',\n    'unbearable',\n    'frustrated',\n    'angry',\n    'sad',\n    'depressed',\n    'anxious',\n    'worried',\n    'scared',\n    'overwhelmed',\n    'exhausted',\n    'defeated',\n    'hopeless',\n    'alone',\n    'isolated',\n  ];\n\n  private neutralKeywords = [\n    'same',\n    'unchanged',\n    'stable',\n    'managing',\n    'coping',\n    'continuing',\n    'routine',\n    'regular',\n    'normal',\n    'usual',\n    'consistent',\n    'steady',\n  ];\n\n  private triggerKeywords = [\n    'flare',\n    'spike',\n    'increase',\n    'worse',\n    'worsening',\n    'setback',\n    'episode',\n    'attack',\n    'breakthrough',\n    'sudden',\n    'intense',\n    'severe',\n  ];\n\n  analyzeText(text: string): EmotionalState {\n    const words = text.toLowerCase().split(/\\s+/);\n\n    const positiveCount = words.filter(word =>\n      this.positiveKeywords.some(keyword => word.includes(keyword))\n    ).length;\n\n    const negativeCount = words.filter(word =>\n      this.negativeKeywords.some(keyword => word.includes(keyword))\n    ).length;\n\n    const neutralCount = words.filter(word =>\n      this.neutralKeywords.some(keyword => word.includes(keyword))\n    ).length;\n\n    const triggerCount = words.filter(word =>\n      this.triggerKeywords.some(keyword => word.includes(keyword))\n    ).length;\n\n    // Determine valence\n    let valence: EmotionalState['valence'] = 'neutral';\n    if (positiveCount > negativeCount && positiveCount > 0) valence = 'positive';\n    else if (negativeCount > positiveCount && negativeCount > 0) valence = 'negative';\n    else if (positiveCount > 0 && negativeCount > 0) valence = 'mixed';\n\n    // Determine arousal based on intensity words and triggers\n    const intensityWords = ['very', 'extremely', 'incredibly', 'really', 'so', 'quite'];\n    const intensityCount = words.filter(word => intensityWords.includes(word)).length;\n\n    let arousal: EmotionalState['arousal'] = 'low';\n    if (triggerCount > 0 || intensityCount > 2) arousal = 'high';\n    else if (intensityCount > 0 || negativeCount > 1) arousal = 'medium';\n\n    const confidence = Math.min(\n      (positiveCount + negativeCount + neutralCount) / Math.max(words.length / 4, 1),\n      1\n    );\n\n    return {\n      valence,\n      arousal,\n      keywords: words.filter(word =>\n        this.positiveKeywords\n          .concat(this.negativeKeywords, this.neutralKeywords)\n          .some(keyword => word.includes(keyword))\n      ),\n      confidence,\n      triggers:\n        triggerCount > 0\n          ? words.filter(word => this.triggerKeywords.some(keyword => word.includes(keyword)))\n          : undefined,\n    };\n  }\n}\n\n// Validation message generator\nclass ValidationMessageGenerator {\n  private supportiveMessages = [\n    \"I hear that you're going through a challenging time. Your experience is valid and important.\",\n    \"Thank you for sharing what you're experiencing. It takes courage to track difficult moments.\",\n    'Your pain matters, and so do you. Taking time to document this shows incredible strength.',\n    \"I acknowledge how hard this must be for you right now. You're not alone in this journey.\",\n    'Your feelings about this experience are completely understandable and valid.',\n  ];\n\n  private emphaticMessages = [\n    'That sounds really difficult. I want you to know that your struggle is seen and recognized.',\n    'I can sense this is a tough moment for you. Please be gentle with yourself.',\n    \"What you're experiencing sounds overwhelming. You're doing the best you can.\",\n    \"This sounds like a particularly hard day. Remember that difficult days don't last forever.\",\n    'I hear the pain in your words. Your resilience in tracking this is remarkable.',\n  ];\n\n  private celebratoryMessages = [\n    \"This sounds like positive progress! It's wonderful to hear things are improving for you.\",\n    'What encouraging news! Every step forward, no matter how small, is worth celebrating.',\n    \"I'm so glad to hear you're experiencing some relief. You deserve these better moments.\",\n    'This improvement is a testament to your strength and perseverance. Well done!',\n    \"It's beautiful to see progress in your healing journey. Keep nurturing yourself.\",\n  ];\n\n  private gentleMessages = [\n    'Thank you for taking the time to track your experience. Every entry helps build understanding.',\n    'I appreciate you sharing this with me. Your consistency in tracking is admirable.',\n    'This information helps create a clearer picture of your journey. Thank you for your openness.',\n    'Each entry you make is a step toward better understanding your patterns. Well done.',\n    'Your commitment to tracking your experience shows real dedication to your wellbeing.',\n  ];\n\n  generate(emotionalState: EmotionalState): ValidationResponse {\n    let messages: string[];\n    let tone: ValidationResponse['tone'];\n    let icon: React.ComponentType<{ className?: string }>;\n    let color: string;\n    let followUp: string | undefined;\n\n    switch (emotionalState.valence) {\n      case 'positive':\n        messages = this.celebratoryMessages;\n        tone = 'celebratory';\n        icon = Sun;\n        color = 'text-yellow-600 bg-yellow-50 border-yellow-200';\n        followUp = 'Would you like to note what contributed to this positive experience?';\n        break;\n\n      case 'negative':\n        if (emotionalState.arousal === 'high') {\n          messages = this.emphaticMessages;\n          tone = 'empathetic';\n          icon = CloudRain;\n          color = 'text-blue-600 bg-blue-50 border-blue-200';\n          followUp =\n            'Remember, you have support available. Would you like to review your comfort resources?';\n        } else {\n          messages = this.supportiveMessages;\n          tone = 'supportive';\n          icon = Heart;\n          color = 'text-pink-600 bg-pink-50 border-pink-200';\n          followUp = 'Taking care of yourself during difficult times is so important.';\n        }\n        break;\n\n      case 'mixed':\n        messages = this.gentleMessages;\n        tone = 'gentle';\n        icon = Sparkles;\n        color = 'text-purple-600 bg-purple-50 border-purple-200';\n        followUp = 'Complex experiences deserve gentle acknowledgment.';\n        break;\n\n      default:\n        messages = this.gentleMessages;\n        tone = 'gentle';\n        icon = Shield;\n        color = 'text-green-600 bg-green-50 border-green-200';\n        break;\n    }\n\n    return {\n      id: `validation-${Date.now()}`,\n      message: messages[Math.floor(Math.random() * messages.length)],\n      tone,\n      icon,\n      color,\n      followUp,\n      timestamp: new Date(),\n    };\n  }\n}\n\n// Main validation component\ninterface EmotionalValidationProps {\n  text: string;\n  onValidationGenerated?: (response: ValidationResponse) => void;\n  isActive?: boolean;\n  delay?: number;\n}\n\nexport function EmotionalValidation({\n  text,\n  onValidationGenerated,\n  isActive = true,\n  delay = 2000,\n}: EmotionalValidationProps) {\n  const { preferences } = useTraumaInformed();\n  const [currentValidation, setCurrentValidation] = useState<ValidationResponse | null>(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const analysisService = useRef(new EmotionalAnalysisService());\n  const messageGenerator = useRef(new ValidationMessageGenerator());\n  const timeoutRef = useRef<NodeJS.Timeout>();\n\n  const generateValidation = useCallback(\n    (inputText: string) => {\n      if (!inputText.trim() || inputText.length < 10) return;\n\n      const emotionalState = analysisService.current.analyzeText(inputText);\n      if (emotionalState.confidence < 0.2) return;\n\n      const validation = messageGenerator.current.generate(emotionalState);\n      setCurrentValidation(validation);\n      setIsVisible(true);\n      onValidationGenerated?.(validation);\n\n      // Auto-hide after 10 seconds unless it's high arousal negative\n      if (emotionalState.valence !== 'negative' || emotionalState.arousal !== 'high') {\n        setTimeout(() => setIsVisible(false), 10000);\n      }\n    },\n    [onValidationGenerated]\n  );\n\n  useEffect(() => {\n    if (!isActive || !preferences.realTimeValidation) return;\n\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      generateValidation(text);\n    }, delay);\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, [text, isActive, delay, generateValidation, preferences.realTimeValidation]);\n\n  if (!preferences.realTimeValidation || !currentValidation || !isVisible) {\n    return null;\n  }\n\n  const IconComponent = currentValidation.icon;\n\n  return (\n    <div\n      className={`\n        mt-3 p-4 rounded-lg border transition-all duration-300 ease-in-out\n        ${currentValidation.color}\n        ${isVisible ? 'opacity-100 transform translate-y-0' : 'opacity-0 transform translate-y-2'}\n      `}\n      role=\"alert\"\n      aria-live=\"polite\"\n    >\n      <div className=\"flex items-start space-x-3\">\n        <IconComponent className=\"w-5 h-5 mt-0.5 flex-shrink-0\" />\n        <div className=\"flex-1\">\n          <p className=\"text-sm font-medium mb-1\">{currentValidation.message}</p>\n          {currentValidation.followUp && (\n            <p className=\"text-xs opacity-75\">{currentValidation.followUp}</p>\n          )}\n        </div>\n        <button\n          onClick={() => setIsVisible(false)}\n          className=\"text-xs opacity-50 hover:opacity-75 transition-opacity\"\n          aria-label=\"Dismiss validation message\"\n        >\n          \n        </button>\n      </div>\n    </div>\n  );\n}\n\n// Validation history component\ninterface ValidationHistoryProps {\n  validations: ValidationResponse[];\n  onClear?: () => void;\n}\n\nexport function ValidationHistory({ validations, onClear }: ValidationHistoryProps) {\n  const { preferences } = useTraumaInformed();\n\n  if (!preferences.realTimeValidation || validations.length === 0) {\n    return null;\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center justify-between\">\n        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n          Recent Validation Messages\n        </h4>\n        {onClear && (\n          <button\n            onClick={onClear}\n            className=\"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-300\"\n          >\n            Clear History\n          </button>\n        )}\n      </div>\n\n      <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n        {validations\n          .slice(-5)\n          .reverse()\n          .map(validation => {\n            const IconComponent = validation.icon;\n            return (\n              <div key={validation.id} className={`p-2 rounded text-xs border ${validation.color}`}>\n                <div className=\"flex items-start space-x-2\">\n                  <IconComponent className=\"w-3 h-3 mt-0.5 flex-shrink-0\" />\n                  <div className=\"flex-1\">\n                    <p>{validation.message}</p>\n                    <p className=\"text-xs opacity-50 mt-1\">\n                      {validation.timestamp.toLocaleTimeString()}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n      </div>\n    </div>\n  );\n}\n","/**\n * Advanced Pattern Recognition Engine Types\n *\n * Comprehensive type definitions for heuristic-based pain trend analysis,\n * trigger/symptom correlations, episode detection, and Quality of Life insights.\n * All analysis runs locally - no cloud dependencies.\n */\n\nimport type { PainEntry } from './pain-tracker';\n\n// ============================================================================\n// Core Data Types\n// ============================================================================\n\nexport type PainIntensity = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10;\n\nexport type TrendResolution = 'daily' | 'weekly' | 'episode';\n\nexport type CorrelationStrength = 'none' | 'weak' | 'moderate' | 'strong';\n\nexport type CorrelationDirection = 'increases' | 'decreases' | 'neutral';\n\nexport type QoLMetric = 'sleep' | 'mood' | 'activity' | 'fatigue';\n\nexport type ConfidenceLevel = 'low' | 'medium' | 'high';\n\n// ============================================================================\n// Time Series & Trends\n// ============================================================================\n\n/**\n * Single point in a time-series trend\n */\nexport interface TrendPoint {\n  /** Date string (YYYY-MM-DD for daily/weekly) */\n  date: string;\n  /** Aggregated value (e.g., average pain) */\n  value: number;\n  /** Number of entries contributing to this point */\n  count: number;\n  /** Min/max range for visualization */\n  range?: [number, number];\n  /** Optional standard deviation */\n  stdDev?: number;\n}\n\n/**\n * Complete trend data for a given resolution\n */\nexport interface TrendSeries {\n  resolution: TrendResolution;\n  points: TrendPoint[];\n  /** Overall direction: positive = worsening, negative = improving */\n  slope: number;\n  /** Baseline value for comparison */\n  baseline: number;\n  /** Data quality/coverage assessment */\n  confidence: ConfidenceLevel;\n}\n\n// ============================================================================\n// Episode Detection (Flares & Patterns)\n// ============================================================================\n\n/**\n * Detected pain episode (flare or extended period)\n */\nexport interface PainEpisode {\n  id: string;\n  /** Start date (ISO string) */\n  start: string;\n  /** End date (ISO string) */\n  end: string;\n  /** Peak pain intensity during episode */\n  peakPain: PainIntensity;\n  /** Average pain across episode */\n  avgPain: number;\n  /** Number of entries in this episode */\n  entryCount: number;\n  /** Days to return to baseline after episode end (null if ongoing) */\n  recoveryDays: number | null;\n  /** Duration in days */\n  durationDays: number;\n  /** Episode classification */\n  severity: 'mild' | 'moderate' | 'severe';\n  /** Common triggers during this episode */\n  associatedTriggers: string[];\n  /** Common locations during this episode */\n  associatedLocations: string[];\n}\n\n// ============================================================================\n// Correlation Analysis\n// ============================================================================\n\n/**\n * Correlation between a trigger/symptom and pain levels\n */\nexport interface TriggerCorrelation {\n  /** Trigger/symptom identifier */\n  key: string;\n  /** Human-readable label */\n  label: string;\n  /** Average pain delta when present vs absent */\n  deltaPain: number;\n  /** Number of observations where present */\n  support: number;\n  /** Confidence score (0-1) - how stable is this pattern */\n  confidence: number;\n  /** Correlation strength bucket */\n  strength: CorrelationStrength;\n  /** Direction of effect */\n  direction: CorrelationDirection;\n  /** Lag in days (for delayed effects, e.g., sleep affecting next-day pain) */\n  lagDays?: number;\n  /** Stability score: how consistently does this pattern hold */\n  stabilityScore?: number;\n}\n\n/**\n * Bundle of triggers that correlate together\n */\nexport interface TriggerBundle {\n  id: string;\n  /** Triggers that co-occur */\n  triggers: string[];\n  /** Combined effect when bundle is present */\n  combinedDelta: number;\n  /** Co-occurrence frequency */\n  coOccurrence: number;\n  /** Strength of bundle effect */\n  strength: CorrelationStrength;\n}\n\n// ============================================================================\n// Quality of Life Patterns\n// ============================================================================\n\n/**\n * Quality of Life pattern insight\n */\nexport interface QoLPattern {\n  id: string;\n  /** Human-readable description */\n  description: string;\n  /** Which QoL dimension this relates to */\n  metric: QoLMetric;\n  /** Correlation with pain */\n  correlation: CorrelationStrength;\n  /** Number of supporting observations */\n  evidenceCount: number;\n  /** Average change in pain when QoL metric shifts */\n  delta: number;\n  /** Confidence in this pattern */\n  confidence: ConfidenceLevel;\n  /** Specific threshold or condition detected */\n  condition?: string;\n  /** Lag (e.g., poor sleep correlates with next-day pain) */\n  lagDays?: number;\n}\n\n/**\n * QoL vs Pain dissonance detection\n */\nexport interface QoLDissonance {\n  type: 'pain_stable_qol_declining' | 'pain_high_activity_high' | 'pain_improving_qol_stagnant';\n  description: string;\n  painTrend: 'improving' | 'stable' | 'worsening';\n  qolTrend: 'improving' | 'stable' | 'declining';\n  affectedMetrics: QoLMetric[];\n  severity: 'low' | 'medium' | 'high';\n  recommendation: string;\n}\n\n// ============================================================================\n// Insight Metadata\n// ============================================================================\n\n/**\n * Metadata for any generated insight\n */\nexport interface InsightMeta {\n  /** Time window analyzed */\n  dataWindow: {\n    start: string;\n    end: string;\n  };\n  /** Number of entries analyzed */\n  entryCount: number;\n  /** Quality/completeness of data */\n  dataQuality: ConfidenceLevel;\n  /** Warnings or caveats about the insight */\n  cautions: string[];\n  /** When this insight was generated */\n  generatedAt: string;\n}\n\n// ============================================================================\n// Pattern Engine Configuration\n// ============================================================================\n\n/**\n * Configuration for pattern analysis engine\n */\nexport interface PatternEngineConfig {\n  /** Minimum entries required to compute trends */\n  minEntriesForTrend: number;\n  /** Minimum support count to surface a correlation */\n  minSupportForCorrelation: number;\n  /** Minimum confidence (0-1) to display a correlation */\n  minConfidenceForDisplay: number;\n  /** Pain threshold for episode detection (e.g., >= 6) */\n  episodePainThreshold: number;\n  /** Minimum consecutive days for an episode */\n  episodeMinLengthDays: number;\n  /** Days to look back for baseline calculation */\n  baselineWindowDays: number;\n  /** Enable lagged correlation detection (e.g., sleep -> next-day pain) */\n  enableLaggedCorrelations: boolean;\n  /** Maximum lag to test (in days) */\n  maxLagDays: number;\n  /** Enable QoL dissonance detection */\n  enableQoLDissonance: boolean;\n}\n\n/**\n * Default conservative configuration\n */\nexport const DEFAULT_PATTERN_CONFIG: PatternEngineConfig = {\n  minEntriesForTrend: 7,\n  minSupportForCorrelation: 8,\n  minConfidenceForDisplay: 0.6,\n  episodePainThreshold: 6,\n  episodeMinLengthDays: 2,\n  baselineWindowDays: 30,\n  enableLaggedCorrelations: true,\n  maxLagDays: 3,\n  enableQoLDissonance: true,\n};\n\n// ============================================================================\n// Complete Pattern Analysis Result\n// ============================================================================\n\n/**\n * Comprehensive result from pattern analysis engine\n */\nexport interface PatternAnalysisResult {\n  /** Original entries (filtered/cleaned) */\n  cleanedEntries: PainEntry[];\n  /** Daily aggregated trend */\n  dailyTrend: TrendPoint[];\n  /** Weekly rolling trend */\n  weeklyTrend: TrendPoint[];\n  /** Detected episodes/flares */\n  episodes: PainEpisode[];\n  /** Trigger correlations */\n  triggerCorrelations: TriggerCorrelation[];\n  /** Symptom correlations */\n  symptomCorrelations: TriggerCorrelation[];\n  /** Medication correlations */\n  medicationCorrelations: TriggerCorrelation[];\n  /** Location correlations */\n  locationCorrelations: TriggerCorrelation[];\n  /** Trigger bundles (co-occurring triggers) */\n  triggerBundles: TriggerBundle[];\n  /** Quality of Life patterns */\n  qolPatterns: QoLPattern[];\n  /** QoL dissonances detected */\n  qolDissonances: QoLDissonance[];\n  /** Metadata about the analysis */\n  meta: InsightMeta;\n  /** Configuration used */\n  config: PatternEngineConfig;\n}\n\n// ============================================================================\n// Statistical Helpers\n// ============================================================================\n\n/**\n * Basic statistical summary\n */\nexport interface StatisticalSummary {\n  mean: number;\n  median: number;\n  mode: number;\n  stdDev: number;\n  min: number;\n  max: number;\n  count: number;\n}\n\n/**\n * Baseline calculation result\n */\nexport interface BaselineResult {\n  value: number;\n  method: 'median' | 'mean' | 'mode';\n  confidence: ConfidenceLevel;\n  windowDays: number;\n  entryCount: number;\n}\n","/**\r\n * Advanced Pattern Recognition Engine\r\n *\r\n * Heuristic-based engine for detecting pain trends, correlations, episodes,\r\n * and Quality of Life patterns. All computation runs locally - zero cloud deps.\r\n *\r\n * Design principles:\r\n * - Transparent, explainable heuristics (not black-box ML)\r\n * - Trauma-informed messaging (confidence levels, gentle language)\r\n * - Clinically-aligned metrics (validated pain scales, evidence-based)\r\n * - Offline-first (100% local computation)\r\n */\r\n\r\nimport type { PainEntry } from '../../types/pain-tracker';\r\nimport {\r\n  type PatternAnalysisResult,\r\n  type PatternEngineConfig,\r\n  type TrendPoint,\r\n  type PainEpisode,\r\n  type TriggerCorrelation,\r\n  type QoLPattern,\r\n  type QoLDissonance,\r\n  type TriggerBundle,\r\n  type BaselineResult,\r\n  type StatisticalSummary,\r\n  type CorrelationStrength,\r\n  type CorrelationDirection,\r\n  type ConfidenceLevel,\r\n  type InsightMeta,\r\n  type PainIntensity,\r\n  DEFAULT_PATTERN_CONFIG,\r\n} from '../../types/pattern-engine';\r\n\r\n// ============================================================================\r\n// Core Analysis Entry Point\r\n// ============================================================================\r\n\r\n/**\r\n * Analyze pain entries for patterns, correlations, and insights\r\n * @param entries - Raw pain entries\r\n * @param config - Engine configuration (uses defaults if not provided)\r\n * @returns Comprehensive pattern analysis\r\n */\r\nexport function analyzePatterns(\r\n  entries: PainEntry[],\r\n  config: Partial<PatternEngineConfig> = {}\r\n): PatternAnalysisResult {\r\n  const fullConfig: PatternEngineConfig = { ...DEFAULT_PATTERN_CONFIG, ...config };\r\n\r\n  // Step 1: Clean and validate entries\r\n  const cleanedEntries = cleanEntries(entries);\r\n\r\n  // Step 2: Compute baseline\r\n  const baseline = calculateBaseline(cleanedEntries, fullConfig.baselineWindowDays);\r\n\r\n  // Step 3: Build time-series trends\r\n  const dailyTrend = computeDailyTrend(cleanedEntries);\r\n  const weeklyTrend = computeWeeklyTrend(dailyTrend);\r\n\r\n  // Step 4: Detect episodes/flares\r\n  const episodes = detectEpisodes(dailyTrend, baseline, fullConfig);\r\n\r\n  // Step 5: Correlation analysis\r\n  const triggerCorrelations = computeTriggerCorrelations(cleanedEntries, baseline, fullConfig);\r\n  const symptomCorrelations = computeSymptomCorrelations(cleanedEntries, baseline, fullConfig);\r\n  const medicationCorrelations = computeMedicationCorrelations(\r\n    cleanedEntries,\r\n    baseline,\r\n    fullConfig\r\n  );\r\n  const locationCorrelations = computeLocationCorrelations(cleanedEntries, baseline, fullConfig);\r\n\r\n  // Step 6: Trigger bundles (co-occurring triggers)\r\n  const triggerBundles = detectTriggerBundles(cleanedEntries, fullConfig);\r\n\r\n  // Step 7: Quality of Life patterns\r\n  const qolPatterns = computeQoLPatterns(cleanedEntries, baseline, fullConfig);\r\n\r\n  // Step 8: QoL dissonance detection\r\n  const qolDissonances = fullConfig.enableQoLDissonance\r\n    ? detectQoLDissonances(cleanedEntries, dailyTrend, qolPatterns)\r\n    : [];\r\n\r\n  // Step 9: Build metadata\r\n  const meta: InsightMeta = {\r\n    dataWindow: {\r\n      start: cleanedEntries[0]?.timestamp || new Date().toISOString(),\r\n      end: cleanedEntries[cleanedEntries.length - 1]?.timestamp || new Date().toISOString(),\r\n    },\r\n    entryCount: cleanedEntries.length,\r\n    dataQuality: assessDataQuality(cleanedEntries, fullConfig),\r\n    cautions: generateCautions(cleanedEntries, fullConfig),\r\n    generatedAt: new Date().toISOString(),\r\n  };\r\n\r\n  return {\r\n    cleanedEntries,\r\n    dailyTrend,\r\n    weeklyTrend,\r\n    episodes,\r\n    triggerCorrelations,\r\n    symptomCorrelations,\r\n    medicationCorrelations,\r\n    locationCorrelations,\r\n    triggerBundles,\r\n    qolPatterns,\r\n    qolDissonances,\r\n    meta,\r\n    config: fullConfig,\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// Step 1: Data Cleaning & Normalization\r\n// ============================================================================\r\n\r\n/**\r\n * Clean and validate entries, removing invalid data\r\n */\r\nexport function cleanEntries(entries: PainEntry[]): PainEntry[] {\r\n  return entries\r\n    .filter(entry => {\r\n      // Must have valid pain level\r\n      const pain = entry.baselineData?.pain;\r\n      if (pain === undefined || pain === null || pain < 0 || pain > 10) {\r\n        return false;\r\n      }\r\n\r\n      // Must have valid timestamp\r\n      try {\r\n        const date = new Date(entry.timestamp);\r\n        if (isNaN(date.getTime())) {\r\n          return false;\r\n        }\r\n      } catch {\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    })\r\n    .sort((a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime());\r\n}\r\n\r\n// ============================================================================\r\n// Step 2: Baseline Calculation\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate user's baseline pain level (robust to outliers)\r\n */\r\nexport function calculateBaseline(entries: PainEntry[], windowDays: number = 30): BaselineResult {\r\n  if (entries.length === 0) {\r\n    return {\r\n      value: 0,\r\n      method: 'median',\r\n      confidence: 'low',\r\n      windowDays: 0,\r\n      entryCount: 0,\r\n    };\r\n  }\r\n\r\n  // Use recent window for baseline\r\n  const now = Date.now();\r\n  const windowMs = windowDays * 24 * 60 * 60 * 1000;\r\n  const recentEntries = entries.filter(e => now - new Date(e.timestamp).getTime() <= windowMs);\r\n\r\n  const useEntries = recentEntries.length >= 7 ? recentEntries : entries;\r\n  const painValues = useEntries.map(e => e.baselineData.pain);\r\n\r\n  // Use median for robustness\r\n  const sorted = [...painValues].sort((a, b) => a - b);\r\n  const median =\r\n    sorted.length % 2 === 0\r\n      ? (sorted[sorted.length / 2 - 1] + sorted[sorted.length / 2]) / 2\r\n      : sorted[Math.floor(sorted.length / 2)];\r\n\r\n  const confidence: ConfidenceLevel =\r\n    useEntries.length >= 30 ? 'high' : useEntries.length >= 14 ? 'medium' : 'low';\r\n\r\n  return {\r\n    value: median,\r\n    method: 'median',\r\n    confidence,\r\n    windowDays: useEntries === recentEntries ? windowDays : entries.length,\r\n    entryCount: useEntries.length,\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// Step 3: Trend Computation\r\n// ============================================================================\r\n\r\n/**\r\n * Compute daily trend (one point per calendar day)\r\n */\r\nexport function computeDailyTrend(entries: PainEntry[]): TrendPoint[] {\r\n  if (entries.length === 0) return [];\r\n\r\n  const dailyMap = new Map<string, { values: number[]; count: number }>();\r\n\r\n  entries.forEach(entry => {\r\n    const date = new Date(entry.timestamp);\r\n    const dateKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;\r\n\r\n    if (!dailyMap.has(dateKey)) {\r\n      dailyMap.set(dateKey, { values: [], count: 0 });\r\n    }\r\n\r\n    const bucket = dailyMap.get(dateKey)!;\r\n    bucket.values.push(entry.baselineData.pain);\r\n    bucket.count++;\r\n  });\r\n\r\n  return Array.from(dailyMap.entries())\r\n    .map(([date, data]) => {\r\n      const sorted = [...data.values].sort((a, b) => a - b);\r\n      const mean = data.values.reduce((sum, v) => sum + v, 0) / data.count;\r\n      const variance = data.values.reduce((sum, v) => sum + Math.pow(v - mean, 2), 0) / data.count;\r\n      const stdDev = Math.sqrt(variance);\r\n\r\n      return {\r\n        date,\r\n        value: mean,\r\n        count: data.count,\r\n        range: [sorted[0], sorted[sorted.length - 1]] as [number, number],\r\n        stdDev,\r\n      };\r\n    })\r\n    .sort((a, b) => a.date.localeCompare(b.date));\r\n}\r\n\r\n/**\r\n * Compute weekly rolling average trend\r\n */\r\nexport function computeWeeklyTrend(dailyTrend: TrendPoint[]): TrendPoint[] {\r\n  if (dailyTrend.length < 7) return [];\r\n\r\n  const weeklyPoints: TrendPoint[] = [];\r\n  const window = 7;\r\n\r\n  for (let i = window - 1; i < dailyTrend.length; i++) {\r\n    const slice = dailyTrend.slice(i - window + 1, i + 1);\r\n    const values = slice.map(p => p.value);\r\n    const mean = values.reduce((sum, v) => sum + v, 0) / values.length;\r\n    const totalCount = slice.reduce((sum, p) => sum + p.count, 0);\r\n    const minVal = Math.min(...values);\r\n    const maxVal = Math.max(...values);\r\n\r\n    weeklyPoints.push({\r\n      date: dailyTrend[i].date,\r\n      value: mean,\r\n      count: totalCount,\r\n      range: [minVal, maxVal],\r\n    });\r\n  }\r\n\r\n  return weeklyPoints;\r\n}\r\n\r\n// ============================================================================\r\n// Step 4: Episode Detection\r\n// ============================================================================\r\n\r\n/**\r\n * Detect pain episodes (flares or extended high-pain periods)\r\n */\r\nexport function detectEpisodes(\r\n  dailyTrend: TrendPoint[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): PainEpisode[] {\r\n  if (dailyTrend.length === 0) return [];\r\n\r\n  const episodes: PainEpisode[] = [];\r\n  let currentEpisode: {\r\n    start: string;\r\n    points: TrendPoint[];\r\n  } | null = null;\r\n\r\n  const threshold = Math.max(config.episodePainThreshold, baseline.value + 2);\r\n\r\n  for (let idx = 0; idx < dailyTrend.length; idx++) {\r\n    const point = dailyTrend[idx];\r\n    const isHighPain = point.value >= threshold;\r\n\r\n    if (isHighPain) {\r\n      if (!currentEpisode) {\r\n        currentEpisode = {\r\n          start: point.date,\r\n          points: [point],\r\n        };\r\n      } else {\r\n        currentEpisode.points.push(point);\r\n      }\r\n    } else {\r\n      if (currentEpisode && currentEpisode.points.length >= config.episodeMinLengthDays) {\r\n        // Close episode\r\n        const points = currentEpisode.points;\r\n        const painValues = points.map(p => p.value);\r\n        const avgPain = painValues.reduce((sum, v) => sum + v, 0) / painValues.length;\r\n        const peakPain = Math.max(...painValues) as number;\r\n\r\n        // Calculate recovery days\r\n        let recoveryDays: number | null = null;\r\n        const episodeEndDate = new Date(points[points.length - 1].date);\r\n        for (let j = idx; j < dailyTrend.length; j++) {\r\n          const futurePoint = dailyTrend[j];\r\n          const futureDate = new Date(futurePoint.date);\r\n          if (futurePoint.value < baseline.value) {\r\n            recoveryDays = Math.floor(\r\n              (futureDate.getTime() - episodeEndDate.getTime()) / (24 * 60 * 60 * 1000)\r\n            );\r\n            break;\r\n          }\r\n        }\r\n\r\n        const severity: PainEpisode['severity'] =\r\n          peakPain >= 8 ? 'severe' : peakPain >= 6 ? 'moderate' : 'mild';\r\n\r\n        episodes.push({\r\n          id: `episode-${currentEpisode.start}`,\r\n          start: currentEpisode.start,\r\n          end: points[points.length - 1].date,\r\n          peakPain: Math.min(10, Math.round(peakPain)) as PainIntensity,\r\n          avgPain: Number(avgPain.toFixed(1)),\r\n          entryCount: points.reduce((sum, p) => sum + p.count, 0),\r\n          recoveryDays,\r\n          durationDays: points.length,\r\n          severity,\r\n          associatedTriggers: [],\r\n          associatedLocations: [],\r\n        });\r\n      }\r\n\r\n      currentEpisode = null;\r\n    }\r\n  }\r\n\r\n  // Handle ongoing episode at end\r\n  if (currentEpisode && currentEpisode.points.length >= config.episodeMinLengthDays) {\r\n    const points = currentEpisode.points;\r\n    const painValues = points.map((p: TrendPoint) => p.value);\r\n    const avgPain = painValues.reduce((sum: number, v: number) => sum + v, 0) / painValues.length;\r\n    const peakPain = Math.max(...painValues);\r\n\r\n    const severity: PainEpisode['severity'] =\r\n      peakPain >= 8 ? 'severe' : peakPain >= 6 ? 'moderate' : 'mild';\r\n\r\n    episodes.push({\r\n      id: `episode-${currentEpisode.start}`,\r\n      start: currentEpisode.start,\r\n      end: points[points.length - 1].date,\r\n      peakPain: Math.min(10, Math.round(peakPain)) as PainIntensity,\r\n      avgPain: Number(avgPain.toFixed(1)),\r\n      entryCount: points.reduce((sum: number, p: TrendPoint) => sum + p.count, 0),\r\n      recoveryDays: null,\r\n      durationDays: points.length,\r\n      severity,\r\n      associatedTriggers: [],\r\n      associatedLocations: [],\r\n    });\r\n  }\r\n\r\n  return episodes;\r\n}\r\n\r\n// ============================================================================\r\n// Step 5: Correlation Analysis\r\n// ============================================================================\r\n\r\n/**\r\n * Compute correlation between triggers and pain levels\r\n */\r\nexport function computeTriggerCorrelations(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): TriggerCorrelation[] {\r\n  return computeGenericCorrelations(entries, baseline, config, entry => entry.triggers || []);\r\n}\r\n\r\n/**\r\n * Compute correlation between symptoms and pain levels\r\n */\r\nexport function computeSymptomCorrelations(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): TriggerCorrelation[] {\r\n  return computeGenericCorrelations(\r\n    entries,\r\n    baseline,\r\n    config,\r\n    entry => entry.baselineData.symptoms || []\r\n  );\r\n}\r\n\r\n/**\r\n * Compute correlation between medications and pain changes\r\n */\r\nexport function computeMedicationCorrelations(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): TriggerCorrelation[] {\r\n  const meds = entries.map(entry => entry.medications?.current?.map(m => m.name) || []);\r\n\r\n  return computeGenericCorrelations(entries, baseline, config, (entry, idx) => meds[idx] || []);\r\n}\r\n\r\n/**\r\n * Compute correlation between body locations and pain levels\r\n */\r\nexport function computeLocationCorrelations(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): TriggerCorrelation[] {\r\n  return computeGenericCorrelations(\r\n    entries,\r\n    baseline,\r\n    config,\r\n    entry => entry.baselineData.locations || []\r\n  );\r\n}\r\n\r\n/**\r\n * Generic correlation computation (reusable for triggers/symptoms/meds/locations)\r\n */\r\nfunction computeGenericCorrelations(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig,\r\n  extractor: (entry: PainEntry, idx: number) => string[]\r\n): TriggerCorrelation[] {\r\n  const itemStats = new Map<\r\n    string,\r\n    {\r\n      withItem: number[];\r\n      withoutItem: number[];\r\n    }\r\n  >();\r\n\r\n  // Build with/without sets for each item\r\n  entries.forEach((entry, idx) => {\r\n    const items = extractor(entry, idx);\r\n    const pain = entry.baselineData.pain;\r\n\r\n    items.forEach(item => {\r\n      if (!itemStats.has(item)) {\r\n        itemStats.set(item, { withItem: [], withoutItem: [] });\r\n      }\r\n      itemStats.get(item)!.withItem.push(pain);\r\n    });\r\n\r\n    // Add to \"without\" for all other items\r\n    itemStats.forEach((stats, key) => {\r\n      if (!items.includes(key)) {\r\n        stats.withoutItem.push(pain);\r\n      }\r\n    });\r\n  });\r\n\r\n  // Compute correlations\r\n  const correlations: TriggerCorrelation[] = [];\r\n\r\n  itemStats.forEach((stats, key) => {\r\n    const support = stats.withItem.length;\r\n\r\n    if (support < config.minSupportForCorrelation) {\r\n      return;\r\n    }\r\n\r\n    const meanWith = stats.withItem.reduce((sum, v) => sum + v, 0) / stats.withItem.length;\r\n    const meanWithout =\r\n      stats.withoutItem.length > 0\r\n        ? stats.withoutItem.reduce((sum, v) => sum + v, 0) / stats.withoutItem.length\r\n        : baseline.value;\r\n\r\n    const delta = meanWith - meanWithout;\r\n\r\n    // Calculate confidence (how stable is this pattern)\r\n    const aboveBaseline = stats.withItem.filter(v => v > baseline.value).length;\r\n    const confidence = aboveBaseline / stats.withItem.length;\r\n\r\n    // Calculate stability (consistency over time)\r\n    const variance =\r\n      stats.withItem.reduce((sum, v) => sum + Math.pow(v - meanWith, 2), 0) / stats.withItem.length;\r\n    const stabilityScore = Math.max(0, 1 - variance / 10); // Normalize to 0-1\r\n\r\n    const strength = bucketCorrelation(delta, confidence);\r\n    const direction: CorrelationDirection =\r\n      delta > 0.3 ? 'increases' : delta < -0.3 ? 'decreases' : 'neutral';\r\n\r\n    if (strength !== 'none' && confidence >= config.minConfidenceForDisplay) {\r\n      correlations.push({\r\n        key,\r\n        label: formatLabel(key),\r\n        deltaPain: Number(delta.toFixed(2)),\r\n        support,\r\n        confidence: Number(confidence.toFixed(2)),\r\n        strength,\r\n        direction,\r\n        stabilityScore: Number(stabilityScore.toFixed(2)),\r\n      });\r\n    }\r\n  });\r\n\r\n  return correlations.sort((a, b) => Math.abs(b.deltaPain) - Math.abs(a.deltaPain));\r\n}\r\n\r\n/**\r\n * Bucket correlation strength\r\n */\r\nfunction bucketCorrelation(delta: number, confidence: number): CorrelationStrength {\r\n  if (confidence < 0.5 || Math.abs(delta) < 0.3) return 'none';\r\n  if (Math.abs(delta) < 0.7) return 'weak';\r\n  if (Math.abs(delta) < 1.5) return 'moderate';\r\n  return 'strong';\r\n}\r\n\r\n/**\r\n * Format label for display\r\n */\r\nfunction formatLabel(key: string): string {\r\n  return key\r\n    .split(/[-_\\s]+/)\r\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\r\n    .join(' ');\r\n}\r\n\r\n// ============================================================================\r\n// Step 6: Trigger Bundles (Co-occurring Triggers)\r\n// ============================================================================\r\n\r\n/**\r\n * Detect trigger bundles (triggers that often appear together)\r\n */\r\nexport function detectTriggerBundles(\r\n  entries: PainEntry[],\r\n  config: PatternEngineConfig\r\n): TriggerBundle[] {\r\n  const bundles: TriggerBundle[] = [];\r\n  const triggerPairs = new Map<\r\n    string,\r\n    {\r\n      count: number;\r\n      totalDelta: number;\r\n      baseline: number;\r\n    }\r\n  >();\r\n\r\n  // Find all trigger pairs\r\n  entries.forEach(entry => {\r\n    const triggers = entry.triggers || [];\r\n    if (triggers.length < 2) return;\r\n\r\n    for (let i = 0; i < triggers.length; i++) {\r\n      for (let j = i + 1; j < triggers.length; j++) {\r\n        const pair = [triggers[i], triggers[j]].sort().join('|');\r\n        if (!triggerPairs.has(pair)) {\r\n          triggerPairs.set(pair, { count: 0, totalDelta: 0, baseline: 0 });\r\n        }\r\n\r\n        const stats = triggerPairs.get(pair)!;\r\n        stats.count++;\r\n        stats.totalDelta += entry.baselineData.pain;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Filter and format bundles\r\n  triggerPairs.forEach((stats, pairKey) => {\r\n    if (stats.count >= Math.max(3, config.minSupportForCorrelation / 2)) {\r\n      const triggers = pairKey.split('|');\r\n      const avgDelta = stats.totalDelta / stats.count;\r\n      const strength = bucketCorrelation(avgDelta, stats.count / entries.length);\r\n\r\n      if (strength !== 'none') {\r\n        bundles.push({\r\n          id: `bundle-${pairKey}`,\r\n          triggers,\r\n          combinedDelta: Number(avgDelta.toFixed(2)),\r\n          coOccurrence: stats.count,\r\n          strength,\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  return bundles.sort((a, b) => Math.abs(b.combinedDelta) - Math.abs(a.combinedDelta));\r\n}\r\n\r\n// ============================================================================\r\n// Step 7: Quality of Life Patterns\r\n// ============================================================================\r\n\r\n/**\r\n * Compute Quality of Life correlations with pain\r\n */\r\nexport function computeQoLPatterns(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig\r\n): QoLPattern[] {\r\n  const patterns: QoLPattern[] = [];\r\n\r\n  // Sleep quality patterns\r\n  const sleepPattern = analyzeQoLDimension(\r\n    entries,\r\n    baseline,\r\n    config,\r\n    'sleep',\r\n    e => e.qualityOfLife?.sleepQuality,\r\n    { goodThreshold: 7, poorThreshold: 3 }\r\n  );\r\n  if (sleepPattern) patterns.push(sleepPattern);\r\n\r\n  // Mood patterns\r\n  const moodPattern = analyzeQoLDimension(\r\n    entries,\r\n    baseline,\r\n    config,\r\n    'mood',\r\n    e => e.qualityOfLife?.moodImpact,\r\n    { goodThreshold: 3, poorThreshold: -2 }\r\n  );\r\n  if (moodPattern) patterns.push(moodPattern);\r\n\r\n  // Activity patterns\r\n  const activityPattern = analyzeQoLDimension(\r\n    entries,\r\n    baseline,\r\n    config,\r\n    'activity',\r\n    e => e.activityLevel,\r\n    { goodThreshold: 7, poorThreshold: 3 }\r\n  );\r\n  if (activityPattern) patterns.push(activityPattern);\r\n\r\n  // NOTE: Fatigue patterns would require qualityOfLife.fatigueLevel in the type system\r\n  // Can be added when that field is available in PainEntry.qualityOfLife\r\n\r\n  return patterns;\r\n}\r\n\r\n/**\r\n * Analyze a single QoL dimension\r\n */\r\nfunction analyzeQoLDimension(\r\n  entries: PainEntry[],\r\n  baseline: BaselineResult,\r\n  config: PatternEngineConfig,\r\n  metric: 'sleep' | 'mood' | 'activity' | 'fatigue',\r\n  extractor: (entry: PainEntry) => number | undefined,\r\n  thresholds: { goodThreshold: number; poorThreshold: number },\r\n  inverse: boolean = false\r\n): QoLPattern | null {\r\n  const goodEntries: number[] = [];\r\n  const poorEntries: number[] = [];\r\n  let totalCount = 0;\r\n\r\n  entries.forEach(entry => {\r\n    const value = extractor(entry);\r\n    if (value === undefined || value === null) return;\r\n\r\n    totalCount++;\r\n    const pain = entry.baselineData.pain;\r\n\r\n    if (inverse) {\r\n      if (value <= thresholds.goodThreshold) goodEntries.push(pain);\r\n      if (value >= thresholds.poorThreshold) poorEntries.push(pain);\r\n    } else {\r\n      if (value >= thresholds.goodThreshold) goodEntries.push(pain);\r\n      if (value <= thresholds.poorThreshold) poorEntries.push(pain);\r\n    }\r\n  });\r\n\r\n  if (totalCount < config.minSupportForCorrelation) return null;\r\n  if (goodEntries.length < 3 && poorEntries.length < 3) return null;\r\n\r\n  const meanGood =\r\n    goodEntries.length > 0\r\n      ? goodEntries.reduce((sum, v) => sum + v, 0) / goodEntries.length\r\n      : baseline.value;\r\n  const meanPoor =\r\n    poorEntries.length > 0\r\n      ? poorEntries.reduce((sum, v) => sum + v, 0) / poorEntries.length\r\n      : baseline.value;\r\n\r\n  const delta = meanGood - meanPoor;\r\n  const evidenceCount = goodEntries.length + poorEntries.length;\r\n  const confidence: ConfidenceLevel =\r\n    evidenceCount >= 20 ? 'high' : evidenceCount >= 10 ? 'medium' : 'low';\r\n\r\n  const strength = bucketCorrelation(delta, evidenceCount / totalCount);\r\n\r\n  if (strength === 'none') return null;\r\n\r\n  const description = generateQoLDescription(metric, delta, thresholds, inverse);\r\n\r\n  return {\r\n    id: `qol-${metric}`,\r\n    description,\r\n    metric,\r\n    correlation: strength,\r\n    evidenceCount,\r\n    delta: Number(delta.toFixed(2)),\r\n    confidence,\r\n    condition: inverse\r\n      ? `When ${metric}  ${thresholds.goodThreshold}`\r\n      : `When ${metric}  ${thresholds.goodThreshold}`,\r\n  };\r\n}\r\n\r\n/**\r\n * Generate human-readable QoL pattern description\r\n */\r\nfunction generateQoLDescription(\r\n  metric: string,\r\n  delta: number,\r\n  thresholds: { goodThreshold: number; poorThreshold: number },\r\n  inverse: boolean\r\n): string {\r\n  const direction = delta < 0 ? 'lower' : 'higher';\r\n  const magnitude = Math.abs(delta).toFixed(1);\r\n\r\n  if (inverse) {\r\n    return `When ${metric} is low (${thresholds.goodThreshold}), pain averages ${magnitude} points ${direction}.`;\r\n  }\r\n\r\n  return `When ${metric} is good (${thresholds.goodThreshold}), pain averages ${magnitude} points ${direction}.`;\r\n}\r\n\r\n// ============================================================================\r\n// Step 8: QoL Dissonance Detection\r\n// ============================================================================\r\n\r\n/**\r\n * Detect dissonances between pain and QoL trends\r\n * @param entries - Pain entries\r\n * @param dailyTrend - Daily trend data\r\n * @param _qolPatterns - QoL patterns (reserved for future cross-referencing logic)\r\n */\r\nexport function detectQoLDissonances(\r\n  entries: PainEntry[],\r\n  dailyTrend: TrendPoint[],\r\n  _qolPatterns: QoLPattern[]\r\n): QoLDissonance[] {\r\n  const dissonances: QoLDissonance[] = [];\r\n\r\n  if (entries.length < 14 || dailyTrend.length < 7) return dissonances;\r\n\r\n  // Calculate trends\r\n  const recentPain = dailyTrend.slice(-7);\r\n  const previousPain = dailyTrend.slice(-14, -7);\r\n\r\n  const recentPainAvg = recentPain.reduce((sum, p) => sum + p.value, 0) / recentPain.length;\r\n  const previousPainAvg = previousPain.reduce((sum, p) => sum + p.value, 0) / previousPain.length;\r\n\r\n  const painChange = recentPainAvg - previousPainAvg;\r\n  let painTrend: 'improving' | 'stable' | 'worsening';\r\n  if (painChange < -0.5) {\r\n    painTrend = 'improving';\r\n  } else if (painChange > 0.5) {\r\n    painTrend = 'worsening';\r\n  } else {\r\n    painTrend = 'stable';\r\n  }\r\n\r\n  // Check sleep trend\r\n  const recentEntries = entries.slice(-7);\r\n  const previousEntries = entries.slice(-14, -7);\r\n\r\n  const recentSleep = recentEntries\r\n    .map(e => e.qualityOfLife?.sleepQuality)\r\n    .filter((v): v is number => v !== undefined);\r\n  const previousSleep = previousEntries\r\n    .map(e => e.qualityOfLife?.sleepQuality)\r\n    .filter((v): v is number => v !== undefined);\r\n\r\n  if (recentSleep.length >= 3 && previousSleep.length >= 3) {\r\n    const recentSleepAvg = recentSleep.reduce((sum, v) => sum + v, 0) / recentSleep.length;\r\n    const previousSleepAvg = previousSleep.reduce((sum, v) => sum + v, 0) / previousSleep.length;\r\n\r\n    const sleepChange = recentSleepAvg - previousSleepAvg;\r\n\r\n    // Dissonance: Pain stable but sleep declining\r\n    if (painTrend === 'stable' && sleepChange < -1.5) {\r\n      dissonances.push({\r\n        type: 'pain_stable_qol_declining',\r\n        description: `Pain levels holding steady, but sleep quality declined by ${Math.abs(sleepChange).toFixed(1)} points in the past week.`,\r\n        painTrend: 'stable',\r\n        qolTrend: 'declining',\r\n        affectedMetrics: ['sleep'],\r\n        severity: Math.abs(sleepChange) > 2.5 ? 'high' : 'medium',\r\n        recommendation:\r\n          'Consider discussing sleep interventions with care team, as poor sleep may predict future pain increases.',\r\n      });\r\n    }\r\n  }\r\n\r\n  return dissonances;\r\n}\r\n\r\n// ============================================================================\r\n// Utility: Data Quality Assessment\r\n// ============================================================================\r\n\r\n/**\r\n * Assess overall data quality/coverage\r\n */\r\nfunction assessDataQuality(entries: PainEntry[], config: PatternEngineConfig): ConfidenceLevel {\r\n  if (entries.length >= 60) return 'high';\r\n  if (entries.length >= config.minEntriesForTrend * 3) return 'medium';\r\n  return 'low';\r\n}\r\n\r\n/**\r\n * Generate cautions about the analysis\r\n */\r\nfunction generateCautions(entries: PainEntry[], config: PatternEngineConfig): string[] {\r\n  const cautions: string[] = [];\r\n\r\n  if (entries.length < config.minEntriesForTrend) {\r\n    cautions.push(\r\n      `Low sample size (${entries.length} entries). Add more entries for reliable trends.`\r\n    );\r\n  }\r\n\r\n  if (entries.length < config.minSupportForCorrelation) {\r\n    cautions.push('Not enough data for correlation analysis. Keep logging triggers and symptoms.');\r\n  }\r\n\r\n  const hasQoL = entries.some(\r\n    e =>\r\n      e.qualityOfLife?.sleepQuality !== undefined ||\r\n      e.qualityOfLife?.moodImpact !== undefined ||\r\n      e.activityLevel !== undefined\r\n  );\r\n\r\n  if (!hasQoL) {\r\n    cautions.push(\r\n      'Quality of Life data missing. Log sleep, mood, and activity for richer insights.'\r\n    );\r\n  }\r\n\r\n  return cautions;\r\n}\r\n\r\n// ============================================================================\r\n// Statistical Helpers\r\n// ============================================================================\r\n\r\n/**\r\n * Calculate comprehensive statistical summary\r\n */\r\nexport function calculateStatistics(values: number[]): StatisticalSummary {\r\n  if (values.length === 0) {\r\n    return {\r\n      mean: 0,\r\n      median: 0,\r\n      mode: 0,\r\n      stdDev: 0,\r\n      min: 0,\r\n      max: 0,\r\n      count: 0,\r\n    };\r\n  }\r\n\r\n  const sorted = [...values].sort((a, b) => a - b);\r\n  const mean = values.reduce((sum, v) => sum + v, 0) / values.length;\r\n  const median =\r\n    sorted.length % 2 === 0\r\n      ? (sorted[sorted.length / 2 - 1] + sorted[sorted.length / 2]) / 2\r\n      : sorted[Math.floor(sorted.length / 2)];\r\n\r\n  // Calculate mode\r\n  const frequency = new Map<number, number>();\r\n  for (const v of values) {\r\n    frequency.set(v, (frequency.get(v) || 0) + 1);\r\n  }\r\n  const mode = Array.from(frequency.entries()).reduce((a, b) => (b[1] > a[1] ? b : a), [0, 0] as [\r\n    number,\r\n    number,\r\n  ])[0];\r\n\r\n  // Calculate standard deviation\r\n  const variance = values.reduce((sum, v) => sum + Math.pow(v - mean, 2), 0) / values.length;\r\n  const stdDev = Math.sqrt(variance);\r\n\r\n  return {\r\n    mean: Number(mean.toFixed(2)),\r\n    median: Number(median.toFixed(2)),\r\n    mode,\r\n    stdDev: Number(stdDev.toFixed(2)),\r\n    min: sorted[0],\r\n    max: sorted.at(-1)!,\r\n    count: values.length,\r\n  };\r\n}\r\n","import type { PainEntry } from '../../types';\r\n\r\nexport type PainProgressDirection = 'improving' | 'stable' | 'worsening';\r\n\r\nexport interface PainProgressSummary {\r\n  baselineDays: number;\r\n  recentDays: number;\r\n  baselineAvgPain: number;\r\n  recentAvgPain: number;\r\n  /** Positive means pain decreased (improved). Negative means pain increased (worsened). */\r\n  percentImproved: number;\r\n  direction: PainProgressDirection;\r\n}\r\n\r\nfunction localYMD(d: Date): string {\r\n  const y = d.getFullYear();\r\n  const m = String(d.getMonth() + 1).padStart(2, '0');\r\n  const day = String(d.getDate()).padStart(2, '0');\r\n  return `${y}-${m}-${day}`;\r\n}\r\n\r\nexport interface DailyPainAggregate {\r\n  date: string; // YYYY-MM-DD (local)\r\n  avgPain: number;\r\n  entryCount: number;\r\n}\r\n\r\nexport function buildDailyAveragePain(entries: PainEntry[]): DailyPainAggregate[] {\r\n  const byDay = new Map<string, { sum: number; count: number }>();\r\n\r\n  for (const entry of entries) {\r\n    const ts = new Date(entry.timestamp);\r\n    if (Number.isNaN(ts.getTime())) continue;\r\n    const key = localYMD(ts);\r\n    const pain = Number(entry.baselineData?.pain ?? 0);\r\n    const bucket = byDay.get(key) ?? { sum: 0, count: 0 };\r\n    bucket.sum += pain;\r\n    bucket.count += 1;\r\n    byDay.set(key, bucket);\r\n  }\r\n\r\n  return Array.from(byDay.entries())\r\n    .map(([date, bucket]) => ({\r\n      date,\r\n      avgPain: bucket.count > 0 ? bucket.sum / bucket.count : 0,\r\n      entryCount: bucket.count,\r\n    }))\r\n    .sort((a, b) => a.date.localeCompare(b.date));\r\n}\r\n\r\nexport function computePainProgressSinceStart(\r\n  entries: PainEntry[],\r\n  opts?: { windowDays?: number; minDaysPerWindow?: number; stableThresholdPercent?: number }\r\n): PainProgressSummary | null {\r\n  const windowDays = opts?.windowDays ?? 14;\r\n  const minDaysPerWindow = opts?.minDaysPerWindow ?? 3;\r\n  const stableThresholdPercent = opts?.stableThresholdPercent ?? 5;\r\n\r\n  const daily = buildDailyAveragePain(entries);\r\n  if (daily.length < minDaysPerWindow * 2) return null;\r\n\r\n  const sliceSize = Math.min(windowDays, Math.floor(daily.length / 2));\r\n  if (sliceSize < minDaysPerWindow) return null;\r\n\r\n  const baseline = daily.slice(0, sliceSize);\r\n  const recent = daily.slice(daily.length - sliceSize);\r\n\r\n  const mean = (values: DailyPainAggregate[]) => {\r\n    const sum = values.reduce((acc, v) => acc + v.avgPain, 0);\r\n    return sum / Math.max(1, values.length);\r\n  };\r\n\r\n  const baselineAvg = mean(baseline);\r\n  const recentAvg = mean(recent);\r\n\r\n  if (!Number.isFinite(baselineAvg) || baselineAvg <= 0.05) return null;\r\n\r\n  const percentImproved = ((baselineAvg - recentAvg) / baselineAvg) * 100;\r\n\r\n  const direction: PainProgressDirection =\r\n    Math.abs(percentImproved) < stableThresholdPercent\r\n      ? 'stable'\r\n      : percentImproved > 0\r\n        ? 'improving'\r\n        : 'worsening';\r\n\r\n  return {\r\n    baselineDays: baseline.length,\r\n    recentDays: recent.length,\r\n    baselineAvgPain: baselineAvg,\r\n    recentAvgPain: recentAvg,\r\n    percentImproved,\r\n    direction,\r\n  };\r\n}\r\n","import type { PainEntry } from '../../types';\nimport { formatNumber } from '../../utils/formatting';\n\ninterface NerveSymptomsProps {\n  entries: PainEntry[];\n  period?: {\n    start: string;\n    end: string;\n  };\n}\n\nconst NERVE_SYMPTOMS = ['tingling', 'numbness', 'burning', 'radiating'] as const;\n\nexport function NerveSymptoms({ entries, period }: NerveSymptomsProps) {\n  const filteredEntries = period\n    ? entries.filter(entry => {\n        const date = new Date(entry.timestamp);\n        return date >= new Date(period.start) && date <= new Date(period.end);\n      })\n    : entries;\n\n  // Analyze nerve symptoms\n  const nerveSymptomAnalysis = filteredEntries.reduce(\n    (acc, entry) => {\n      const nerveSymptoms = (entry.baselineData.symptoms || []).filter(symptom =>\n        NERVE_SYMPTOMS.includes(symptom as (typeof NERVE_SYMPTOMS)[number])\n      );\n\n      nerveSymptoms.forEach(symptom => {\n        if (!acc[symptom]) {\n          acc[symptom] = {\n            count: 0,\n            locations: new Set<string>(),\n            painLevels: [],\n          };\n        }\n        acc[symptom].count += 1;\n        acc[symptom].painLevels.push(entry.baselineData.pain);\n        (entry.baselineData.locations || []).forEach(location =>\n          acc[symptom].locations.add(location)\n        );\n      });\n      return acc;\n    },\n    {} as Record<\n      string,\n      {\n        count: number;\n        locations: Set<string>;\n        painLevels: number[];\n      }\n    >\n  );\n\n  // Convert analysis to sorted array\n  const symptomsSummary = Object.entries(nerveSymptomAnalysis)\n    .map(([symptom, data]) => ({\n      symptom,\n      frequency: data.count,\n      averagePain: data.painLevels.reduce((a, b) => a + b, 0) / data.painLevels.length,\n      locations: Array.from(data.locations),\n    }))\n    .sort((a, b) => b.frequency - a.frequency);\n\n  return (\n    <div className=\"bg-white p-6 rounded-lg shadow-md\">\n      <h3 className=\"text-lg font-semibold mb-4\">Nerve Symptoms Analysis</h3>\n\n      <div className=\"space-y-6\">\n        {symptomsSummary.map(symptom => (\n          <div key={symptom.symptom} className=\"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg\">\n            <div className=\"flex justify-between items-start mb-2\">\n              <div>\n                <h4 className=\"font-medium capitalize\">{symptom.symptom}</h4>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Reported {symptom.frequency} times\n                </p>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"font-medium\">Avg. Pain: {formatNumber(symptom.averagePain, 1)}</div>\n              </div>\n            </div>\n\n            {symptom.locations.length > 0 && (\n              <div className=\"mt-2\">\n                <h5 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Affected Areas:\n                </h5>\n                <div className=\"flex flex-wrap gap-2 mt-1\">\n                  {symptom.locations.map(location => (\n                    <span\n                      key={location}\n                      className=\"px-2 py-1 bg-purple-100 text-purple-800 text-sm rounded-full\"\n                    >\n                      {location}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        ))}\n\n        {symptomsSummary.length === 0 && (\n          <p className=\"text-gray-500 dark:text-gray-400 text-center py-4\">\n            No nerve symptoms recorded in this period.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","import type { PainEntry } from '../../types';\nimport { formatNumber } from '../../utils/formatting';\n\ninterface FunctionalLimitationsProps {\n  entries: PainEntry[];\n  period?: {\n    start: string;\n    end: string;\n  };\n}\n\nexport function FunctionalLimitations({ entries, period }: FunctionalLimitationsProps) {\n  const filteredEntries = period\n    ? entries.filter(entry => {\n        const date = new Date(entry.timestamp);\n        return date >= new Date(period.start) && date <= new Date(period.end);\n      })\n    : entries;\n\n  // Analyze functional limitations\n  const limitationsAnalysis = filteredEntries.reduce(\n    (acc, entry) => {\n      entry.functionalImpact?.limitedActivities?.forEach(activity => {\n        if (!acc[activity]) {\n          acc[activity] = {\n            count: 0,\n            painLevels: [],\n            assistanceNeeded: new Set<string>(),\n            mobilityAids: new Set<string>(),\n          };\n        }\n        acc[activity].count += 1;\n        acc[activity].painLevels.push(entry.baselineData.pain);\n        entry.functionalImpact?.assistanceNeeded?.forEach(assistance =>\n          acc[activity].assistanceNeeded.add(assistance)\n        );\n        entry.functionalImpact?.mobilityAids?.forEach(aid => acc[activity].mobilityAids.add(aid));\n      });\n      return acc;\n    },\n    {} as Record<\n      string,\n      {\n        count: number;\n        painLevels: number[];\n        assistanceNeeded: Set<string>;\n        mobilityAids: Set<string>;\n      }\n    >\n  );\n\n  // Convert analysis to sorted array\n  const limitationsSummary = Object.entries(limitationsAnalysis)\n    .map(([activity, data]) => ({\n      activity,\n      frequency: data.count,\n      averagePain: data.painLevels.reduce((a, b) => a + b, 0) / data.painLevels.length,\n      assistanceNeeded: Array.from(data.assistanceNeeded),\n      mobilityAids: Array.from(data.mobilityAids),\n    }))\n    .sort((a, b) => b.frequency - a.frequency);\n\n  return (\n    <div className=\"bg-white p-6 rounded-lg shadow-md\">\n      <h3 className=\"text-lg font-semibold mb-4\">Functional Limitations Analysis</h3>\n\n      <div className=\"space-y-6\">\n        {limitationsSummary.map(limitation => (\n          <div key={limitation.activity} className=\"bg-gray-50 dark:bg-gray-900 p-4 rounded-lg\">\n            <div className=\"flex justify-between items-start mb-2\">\n              <div>\n                <h4 className=\"font-medium\">{limitation.activity}</h4>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Reported {limitation.frequency} times\n                </p>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"font-medium\">\n                  Avg. Pain: {formatNumber(limitation.averagePain, 1)}\n                </div>\n              </div>\n            </div>\n\n            {limitation.assistanceNeeded.length > 0 && (\n              <div className=\"mt-2\">\n                <h5 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Assistance Needed:\n                </h5>\n                <div className=\"flex flex-wrap gap-2 mt-1\">\n                  {limitation.assistanceNeeded.map(assistance => (\n                    <span\n                      key={assistance}\n                      className=\"px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded-full\"\n                    >\n                      {assistance}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {limitation.mobilityAids.length > 0 && (\n              <div className=\"mt-2\">\n                <h5 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                  Mobility Aids Used:\n                </h5>\n                <div className=\"flex flex-wrap gap-2 mt-1\">\n                  {limitation.mobilityAids.map(aid => (\n                    <span\n                      key={aid}\n                      className=\"px-2 py-1 bg-green-100 text-green-800 text-sm rounded-full\"\n                    >\n                      {aid}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        ))}\n\n        {limitationsSummary.length === 0 && (\n          <p className=\"text-gray-500 dark:text-gray-400 text-center py-4\">\n            No functional limitations recorded in this period.\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\r\n * Weather Correlation Analytics Component\r\n * \r\n * Displays weather-pain correlation insights including:\r\n * - Temperature correlation\r\n * - Rain/precipitation impact\r\n * - Barometric pressure correlation\r\n * - Humidity correlation\r\n */\r\n\r\nimport React, { useMemo } from 'react';\r\nimport { Cloud, CloudRain, Thermometer, Droplets, Wind, Sun, TrendingUp, TrendingDown, Minus } from 'lucide-react';\r\nimport { Card, CardContent, CardHeader, CardTitle, Badge } from '../../design-system';\r\nimport { cn } from '../../design-system/utils';\r\nimport type { PainEntry } from '../../types';\r\n\r\ninterface WeatherCorrelationProps {\r\n  entries: PainEntry[];\r\n  className?: string;\r\n}\r\n\r\ninterface WeatherStats {\r\n  condition: string;\r\n  count: number;\r\n  avgPain: number;\r\n  icon: React.ReactNode;\r\n}\r\n\r\ninterface CorrelationResult {\r\n  factor: string;\r\n  correlation: 'positive' | 'negative' | 'neutral';\r\n  strength: 'strong' | 'moderate' | 'weak' | 'none';\r\n  avgPainWith: number;\r\n  avgPainWithout: number;\r\n  sampleSize: number;\r\n  insight: string;\r\n  icon: React.ReactNode;\r\n}\r\n\r\n// Parse weather string to extract components\r\nfunction parseWeatherString(weather: string): {\r\n  temp?: number;\r\n  condition?: string;\r\n  humidity?: number;\r\n  isRaining: boolean;\r\n} {\r\n  const result: ReturnType<typeof parseWeatherString> = { isRaining: false };\r\n  \r\n  // Extract temperature (e.g., \"18C\" or \"18\")\r\n  const tempMatch = weather.match(/(-?\\d+)/);\r\n  if (tempMatch) {\r\n    result.temp = parseInt(tempMatch[1], 10);\r\n  }\r\n  \r\n  // Extract humidity (e.g., \"65% humidity\")\r\n  const humidityMatch = weather.match(/(\\d+)%\\s*humidity/i);\r\n  if (humidityMatch) {\r\n    result.humidity = parseInt(humidityMatch[1], 10);\r\n  }\r\n  \r\n  // Detect rain conditions\r\n  const rainKeywords = ['rain', 'drizzle', 'shower', 'thunderstorm', ''];\r\n  result.isRaining = rainKeywords.some(kw => weather.toLowerCase().includes(kw));\r\n  \r\n  // Extract condition (after temp, before humidity)\r\n  const conditionMatch = weather.match(/C?,?\\s*([a-z\\s]+?)(?:,|\\d|$)/i);\r\n  if (conditionMatch) {\r\n    result.condition = conditionMatch[1].trim();\r\n  }\r\n  \r\n  return result;\r\n}\r\n\r\n// Calculate correlation strength\r\nfunction getCorrelationStrength(diff: number): 'strong' | 'moderate' | 'weak' | 'none' {\r\n  const absDiff = Math.abs(diff);\r\n  if (absDiff >= 2) return 'strong';\r\n  if (absDiff >= 1) return 'moderate';\r\n  if (absDiff >= 0.5) return 'weak';\r\n  return 'none';\r\n}\r\n\r\nexport function WeatherCorrelationPanel({ entries, className }: WeatherCorrelationProps) {\r\n  const analysis = useMemo(() => {\r\n    // Filter entries with weather data\r\n    const weatherEntries = entries.filter(e => e.weather && e.weather.trim() !== '');\r\n    \r\n    if (weatherEntries.length < 3) {\r\n      return null;\r\n    }\r\n    \r\n    // Parse all weather data\r\n    const parsed = weatherEntries.map(e => ({\r\n      ...parseWeatherString(e.weather!),\r\n      pain: e.baselineData.pain,\r\n      weather: e.weather!,\r\n    }));\r\n    \r\n    // Overall stats\r\n    const totalAvgPain = entries.reduce((sum, e) => sum + e.baselineData.pain, 0) / entries.length;\r\n    \r\n    // Temperature correlation\r\n    const tempEntries = parsed.filter(p => p.temp !== undefined);\r\n    const coldEntries = tempEntries.filter(p => p.temp! < 10);\r\n    const warmEntries = tempEntries.filter(p => p.temp! >= 10 && p.temp! < 25);\r\n    const hotEntries = tempEntries.filter(p => p.temp! >= 25);\r\n    \r\n    // Rain correlation\r\n    const rainyEntries = parsed.filter(p => p.isRaining);\r\n    const dryEntries = parsed.filter(p => !p.isRaining);\r\n    \r\n    // Humidity correlation\r\n    const humidEntries = parsed.filter(p => p.humidity !== undefined && p.humidity >= 70);\r\n    const normalHumidityEntries = parsed.filter(p => p.humidity !== undefined && p.humidity < 70);\r\n    \r\n    // Calculate averages\r\n    const calcAvg = (arr: { pain: number }[]) => \r\n      arr.length > 0 ? arr.reduce((s, e) => s + e.pain, 0) / arr.length : 0;\r\n    \r\n    // Suppress unused variable warning - hotEntries reserved for future hot weather correlation\r\n    void totalAvgPain;\r\n    void hotEntries;\r\n    \r\n    const correlations: CorrelationResult[] = [];\r\n    \r\n    // Temperature correlation\r\n    if (coldEntries.length >= 2 && warmEntries.length >= 2) {\r\n      const coldAvg = calcAvg(coldEntries);\r\n      const warmAvg = calcAvg(warmEntries);\r\n      const diff = coldAvg - warmAvg;\r\n      \r\n      correlations.push({\r\n        factor: 'Cold Weather',\r\n        correlation: diff > 0.3 ? 'positive' : diff < -0.3 ? 'negative' : 'neutral',\r\n        strength: getCorrelationStrength(diff),\r\n        avgPainWith: coldAvg,\r\n        avgPainWithout: warmAvg,\r\n        sampleSize: coldEntries.length + warmEntries.length,\r\n        insight: diff > 0.5 \r\n          ? `Cold weather increases your pain by ${diff.toFixed(1)} points on average`\r\n          : diff < -0.5\r\n            ? `You experience less pain in cold weather`\r\n            : `Temperature has minimal impact on your pain`,\r\n        icon: <Thermometer className=\"h-5 w-5 text-blue-500\" />,\r\n      });\r\n    }\r\n    \r\n    // Rain correlation\r\n    if (rainyEntries.length >= 2 && dryEntries.length >= 2) {\r\n      const rainyAvg = calcAvg(rainyEntries);\r\n      const dryAvg = calcAvg(dryEntries);\r\n      const diff = rainyAvg - dryAvg;\r\n      \r\n      correlations.push({\r\n        factor: 'Rain/Precipitation',\r\n        correlation: diff > 0.3 ? 'positive' : diff < -0.3 ? 'negative' : 'neutral',\r\n        strength: getCorrelationStrength(diff),\r\n        avgPainWith: rainyAvg,\r\n        avgPainWithout: dryAvg,\r\n        sampleSize: rainyEntries.length + dryEntries.length,\r\n        insight: diff > 0.5 \r\n          ? `Rainy weather increases your pain by ${diff.toFixed(1)} points`\r\n          : diff < -0.5\r\n            ? `You experience less pain during rainy weather`\r\n            : `Rain has minimal impact on your pain levels`,\r\n        icon: <CloudRain className=\"h-5 w-5 text-blue-600\" />,\r\n      });\r\n    }\r\n    \r\n    // Humidity correlation\r\n    if (humidEntries.length >= 2 && normalHumidityEntries.length >= 2) {\r\n      const humidAvg = calcAvg(humidEntries);\r\n      const normalAvg = calcAvg(normalHumidityEntries);\r\n      const diff = humidAvg - normalAvg;\r\n      \r\n      correlations.push({\r\n        factor: 'High Humidity',\r\n        correlation: diff > 0.3 ? 'positive' : diff < -0.3 ? 'negative' : 'neutral',\r\n        strength: getCorrelationStrength(diff),\r\n        avgPainWith: humidAvg,\r\n        avgPainWithout: normalAvg,\r\n        sampleSize: humidEntries.length + normalHumidityEntries.length,\r\n        insight: diff > 0.5 \r\n          ? `High humidity increases your pain by ${diff.toFixed(1)} points`\r\n          : diff < -0.5\r\n            ? `You feel better in humid conditions`\r\n            : `Humidity has minimal impact on your pain`,\r\n        icon: <Droplets className=\"h-5 w-5 text-cyan-500\" />,\r\n      });\r\n    }\r\n    \r\n    // Weather condition breakdown\r\n    const conditionMap = new Map<string, { count: number; totalPain: number }>();\r\n    parsed.forEach(p => {\r\n      const condition = p.condition || (p.isRaining ? 'rainy' : 'unknown');\r\n      const existing = conditionMap.get(condition) || { count: 0, totalPain: 0 };\r\n      conditionMap.set(condition, {\r\n        count: existing.count + 1,\r\n        totalPain: existing.totalPain + p.pain,\r\n      });\r\n    });\r\n    \r\n    const weatherStats: WeatherStats[] = Array.from(conditionMap.entries())\r\n      .map(([condition, data]) => ({\r\n        condition,\r\n        count: data.count,\r\n        avgPain: data.totalPain / data.count,\r\n        icon: getWeatherIcon(condition),\r\n      }))\r\n      .sort((a, b) => b.avgPain - a.avgPain);\r\n    \r\n    return {\r\n      totalEntries: entries.length,\r\n      weatherEntries: weatherEntries.length,\r\n      coveragePercent: Math.round((weatherEntries.length / entries.length) * 100),\r\n      correlations,\r\n      weatherStats,\r\n      totalAvgPain,\r\n    };\r\n  }, [entries]);\r\n  \r\n  if (!analysis) {\r\n    return (\r\n      <Card className={cn('border-blue-200 dark:border-blue-900', className)}>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Cloud className=\"h-5 w-5 text-blue-500\" />\r\n            Weather Correlations\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"text-center py-8 text-muted-foreground\">\r\n            <Cloud className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n            <p className=\"font-medium\">Not enough weather data yet</p>\r\n            <p className=\"text-sm mt-1\">\r\n              Keep logging entries to see how weather affects your pain.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <Card className={cn('border-blue-200 dark:border-blue-900', className)}>\r\n      <CardHeader>\r\n        <div className=\"flex items-center justify-between\">\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Cloud className=\"h-5 w-5 text-blue-500\" />\r\n            Weather Correlations\r\n          </CardTitle>\r\n          <Badge variant=\"outline\" className=\"text-xs\">\r\n            {analysis.coveragePercent}% of entries have weather data\r\n          </Badge>\r\n        </div>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Correlation Cards */}\r\n        {analysis.correlations.length > 0 && (\r\n          <div className=\"space-y-3\">\r\n            <h4 className=\"text-sm font-medium text-muted-foreground\">Pain Correlations</h4>\r\n            <div className=\"grid gap-3\">\r\n              {analysis.correlations.map((corr, idx) => (\r\n                <div\r\n                  key={idx}\r\n                  className={cn(\r\n                    'p-4 rounded-xl border',\r\n                    corr.strength === 'strong' && corr.correlation === 'positive' && 'bg-red-50 border-red-200 dark:bg-red-950/20 dark:border-red-900',\r\n                    corr.strength === 'strong' && corr.correlation === 'negative' && 'bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-900',\r\n                    corr.strength !== 'strong' && 'bg-gray-50 border-gray-200 dark:bg-gray-900 dark:border-gray-800'\r\n                  )}\r\n                >\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <div className=\"mt-0.5\">{corr.icon}</div>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <span className=\"font-medium\">{corr.factor}</span>\r\n                        <CorrelationBadge correlation={corr.correlation} strength={corr.strength} />\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">{corr.insight}</p>\r\n                      <div className=\"flex items-center gap-4 mt-2 text-xs\">\r\n                        <span>\r\n                          With: <strong>{corr.avgPainWith.toFixed(1)}</strong>/10\r\n                        </span>\r\n                        <span>\r\n                          Without: <strong>{corr.avgPainWithout.toFixed(1)}</strong>/10\r\n                        </span>\r\n                        <span className=\"text-muted-foreground\">\r\n                          ({corr.sampleSize} entries)\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Weather Breakdown */}\r\n        {analysis.weatherStats.length > 0 && (\r\n          <div className=\"space-y-3\">\r\n            <h4 className=\"text-sm font-medium text-muted-foreground\">Pain by Weather Condition</h4>\r\n            <div className=\"space-y-2\">\r\n              {analysis.weatherStats.slice(0, 5).map((stat, idx) => (\r\n                <div key={idx} className=\"flex items-center gap-3\">\r\n                  <div className=\"w-8\">{stat.icon}</div>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm font-medium capitalize\">{stat.condition}</span>\r\n                      <span className=\"text-sm\">\r\n                        <strong>{stat.avgPain.toFixed(1)}</strong>/10 avg\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"mt-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\r\n                      <div\r\n                        className={cn(\r\n                          'h-full rounded-full transition-all',\r\n                          stat.avgPain >= 7 && 'bg-red-500',\r\n                          stat.avgPain >= 4 && stat.avgPain < 7 && 'bg-amber-500',\r\n                          stat.avgPain < 4 && 'bg-green-500'\r\n                        )}\r\n                        style={{ width: `${(stat.avgPain / 10) * 100}%` }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <Badge variant=\"secondary\" className=\"text-xs\">\r\n                    {stat.count} entries\r\n                  </Badge>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        {/* Summary */}\r\n        <div className=\"pt-4 border-t border-gray-200 dark:border-gray-800\">\r\n          <p className=\"text-xs text-muted-foreground text-center\">\r\n            Based on {analysis.weatherEntries} entries with weather data out of {analysis.totalEntries} total entries.\r\n            {analysis.coveragePercent < 50 && (\r\n              <span className=\"block mt-1 text-amber-600 dark:text-amber-400\">\r\n                Enable location access to automatically capture weather data.\r\n              </span>\r\n            )}\r\n          </p>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nfunction CorrelationBadge({ \r\n  correlation, \r\n  strength \r\n}: { \r\n  correlation: 'positive' | 'negative' | 'neutral';\r\n  strength: 'strong' | 'moderate' | 'weak' | 'none';\r\n}) {\r\n  const icon = correlation === 'positive' \r\n    ? <TrendingUp className=\"h-3 w-3\" />\r\n    : correlation === 'negative'\r\n      ? <TrendingDown className=\"h-3 w-3\" />\r\n      : <Minus className=\"h-3 w-3\" />;\r\n  \r\n  const colorClass = correlation === 'positive'\r\n    ? 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400'\r\n    : correlation === 'negative'\r\n      ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400'\r\n      : 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400';\r\n  \r\n  const label = strength === 'none' \r\n    ? 'No effect' \r\n    : `${strength.charAt(0).toUpperCase() + strength.slice(1)} ${correlation === 'positive' ? 'increase' : correlation === 'negative' ? 'decrease' : 'effect'}`;\r\n  \r\n  return (\r\n    <Badge variant=\"secondary\" className={cn('text-xs gap-1', colorClass)}>\r\n      {icon}\r\n      {label}\r\n    </Badge>\r\n  );\r\n}\r\n\r\nfunction getWeatherIcon(condition: string): React.ReactNode {\r\n  const lower = condition.toLowerCase();\r\n  if (lower.includes('rain') || lower.includes('drizzle') || lower.includes('shower')) {\r\n    return <CloudRain className=\"h-4 w-4 text-blue-600\" />;\r\n  }\r\n  if (lower.includes('cloud') || lower.includes('overcast')) {\r\n    return <Cloud className=\"h-4 w-4 text-gray-500\" />;\r\n  }\r\n  if (lower.includes('clear') || lower.includes('sunny')) {\r\n    return <Sun className=\"h-4 w-4 text-amber-500\" />;\r\n  }\r\n  if (lower.includes('thunder') || lower.includes('storm')) {\r\n    return <CloudRain className=\"h-4 w-4 text-purple-600\" />;\r\n  }\r\n  if (lower.includes('snow')) {\r\n    return <Cloud className=\"h-4 w-4 text-blue-300\" />;\r\n  }\r\n  if (lower.includes('fog')) {\r\n    return <Wind className=\"h-4 w-4 text-gray-400\" />;\r\n  }\r\n  return <Cloud className=\"h-4 w-4 text-gray-400\" />;\r\n}\r\n\r\nexport default WeatherCorrelationPanel;\r\n","import type {\r\n  ComparisonConfig,\r\n  ComparisonResult,\r\n  ComparisonStatistics,\r\n  ComparisonInsight,\r\n  ComparisonChart,\r\n  ComparisonDataset,\r\n  StatisticalMeasure,\r\n  StatisticalComparison,\r\n} from '../../types/comparison';\r\nimport type { PainEntry } from '../../types';\r\nimport { formatNumber } from '../formatting';\r\n\r\n/**\r\n * Data Comparison Engine\r\n * Core logic for comparing pain data across different dimensions\r\n */\r\nexport class DataComparisonEngine {\r\n  /**\r\n   * Calculate comprehensive comparison between datasets\r\n   */\r\n  static async compareDatasets(\r\n    config: ComparisonConfig,\r\n    datasets: ComparisonDataset[]\r\n  ): Promise<ComparisonResult> {\r\n    const statistics = this.calculateStatistics(datasets);\r\n    const insights = this.generateInsights(statistics, config);\r\n    const charts = this.generateCharts(datasets, config);\r\n\r\n    return {\r\n      id: `comparison_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      config,\r\n      statistics,\r\n      insights,\r\n      charts,\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Calculate statistical measures for comparison\r\n   */\r\n  private static calculateStatistics(datasets: ComparisonDataset[]): ComparisonStatistics {\r\n    if (datasets.length < 2) {\r\n      throw new Error('At least 2 datasets are required for comparison');\r\n    }\r\n\r\n    const [baseline, comparison] = datasets;\r\n\r\n    // Calculate overall statistics\r\n    const baselinePainLevels = baseline.entries.map((e: PainEntry) => e.baselineData.pain);\r\n    const comparisonPainLevels = comparison.entries.map((e: PainEntry) => e.baselineData.pain);\r\n\r\n    const baselineMean = this.calculateMean(baselinePainLevels);\r\n    const comparisonMean = this.calculateMean(comparisonPainLevels);\r\n    const difference = comparisonMean - baselineMean;\r\n    const percentageChange = baselineMean !== 0 ? (difference / baselineMean) * 100 : 0;\r\n\r\n    // Statistical significance (simplified t-test approximation)\r\n    const statisticalSignificance = this.calculateStatisticalSignificance(\r\n      baselinePainLevels,\r\n      comparisonPainLevels\r\n    );\r\n\r\n    // Effect size (Cohen's d)\r\n    const effectSize = this.calculateEffectSize(baselinePainLevels, comparisonPainLevels);\r\n\r\n    // Calculate metrics by type\r\n    const painStats = this.compareMetric(baselinePainLevels, comparisonPainLevels);\r\n\r\n    // Quality of life metrics\r\n    const moodStats = this.compareQualityOfLifeMetric(\r\n      baseline.entries,\r\n      comparison.entries,\r\n      'moodImpact'\r\n    );\r\n\r\n    const sleepStats = this.compareQualityOfLifeMetric(\r\n      baseline.entries,\r\n      comparison.entries,\r\n      'sleepQuality'\r\n    );\r\n\r\n    // Trend analysis\r\n    const baselineTrend = this.calculateTrend(baselinePainLevels);\r\n    const comparisonTrend = this.calculateTrend(comparisonPainLevels);\r\n    const trendDifference = comparisonTrend - baselineTrend;\r\n\r\n    return {\r\n      overall: {\r\n        baselineMean,\r\n        comparisonMean,\r\n        difference,\r\n        percentageChange,\r\n        statisticalSignificance,\r\n        effectSize,\r\n      },\r\n      byMetric: {\r\n        pain: painStats,\r\n        mood: moodStats,\r\n        sleep: sleepStats,\r\n      },\r\n      trends: {\r\n        baselineTrend,\r\n        comparisonTrend,\r\n        trendDifference,\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Compare a specific metric between two datasets\r\n   */\r\n  private static compareMetric(\r\n    baselineData: number[],\r\n    comparisonData: number[]\r\n  ): StatisticalComparison {\r\n    const baselineStats = this.calculateStatisticalMeasures(baselineData);\r\n    const comparisonStats = this.calculateStatisticalMeasures(comparisonData);\r\n\r\n    const baselineMean = this.calculateMean(baselineData);\r\n    const comparisonMean = this.calculateMean(comparisonData);\r\n    const difference = comparisonMean - baselineMean;\r\n    const percentageChange = baselineMean !== 0 ? (difference / baselineMean) * 100 : 0;\r\n\r\n    // Confidence interval (simplified)\r\n    const confidence = this.calculateConfidence(baselineData, comparisonData);\r\n\r\n    return {\r\n      baseline: baselineStats,\r\n      comparison: comparisonStats,\r\n      difference,\r\n      percentageChange,\r\n      confidence,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Compare quality of life metrics\r\n   */\r\n  private static compareQualityOfLifeMetric(\r\n    baselineEntries: PainEntry[],\r\n    comparisonEntries: PainEntry[],\r\n    metric: 'moodImpact' | 'sleepQuality'\r\n  ): StatisticalComparison | undefined {\r\n    const baselineData = baselineEntries\r\n      .map((e: PainEntry) => e.qualityOfLife?.[metric])\r\n      .filter((value): value is number => value !== undefined);\r\n\r\n    const comparisonData = comparisonEntries\r\n      .map((e: PainEntry) => e.qualityOfLife?.[metric])\r\n      .filter((value): value is number => value !== undefined);\r\n\r\n    if (baselineData.length === 0 || comparisonData.length === 0) {\r\n      return undefined;\r\n    }\r\n\r\n    return this.compareMetric(baselineData, comparisonData);\r\n  }\r\n\r\n  /**\r\n   * Calculate statistical measures for a dataset\r\n   */\r\n  private static calculateStatisticalMeasures(data: number[]): StatisticalMeasure[] {\r\n    if (data.length === 0) return [];\r\n\r\n    const sorted = [...data].sort((a, b) => a - b);\r\n    const mean = this.calculateMean(data);\r\n    const median = this.calculateMedian(sorted);\r\n    const mode = this.calculateMode(data);\r\n    const stdDev = this.calculateStandardDeviation(data, mean);\r\n    const variance = stdDev * stdDev;\r\n    const min = Math.min(...data);\r\n    const max = Math.max(...data);\r\n    const range = max - min;\r\n\r\n    // Percentiles\r\n    const p25 = this.calculatePercentile(sorted, 25);\r\n    const p75 = this.calculatePercentile(sorted, 75);\r\n    const p95 = this.calculatePercentile(sorted, 95);\r\n\r\n    return [\r\n      { type: 'mean', value: mean },\r\n      { type: 'median', value: median },\r\n      { type: 'mode', value: mode },\r\n      { type: 'standard-deviation', value: stdDev },\r\n      { type: 'variance', value: variance },\r\n      { type: 'min', value: min },\r\n      { type: 'max', value: max },\r\n      { type: 'range', value: range },\r\n      { type: 'percentile-25', value: p25 },\r\n      { type: 'percentile-75', value: p75 },\r\n      { type: 'percentile-95', value: p95 },\r\n    ];\r\n  }\r\n  /**\r\n   * Calculate mean\r\n   */\r\n  private static calculateMean(data: number[]): number {\r\n    return data.reduce((sum, value) => sum + value, 0) / data.length;\r\n  }\r\n\r\n  /**\r\n   * Calculate median\r\n   */\r\n  private static calculateMedian(sortedData: number[]): number {\r\n    const mid = Math.floor(sortedData.length / 2);\r\n    return sortedData.length % 2 === 0\r\n      ? (sortedData[mid - 1] + sortedData[mid]) / 2\r\n      : sortedData[mid];\r\n  }\r\n\r\n  /**\r\n   * Calculate mode\r\n   */\r\n  private static calculateMode(data: number[]): number {\r\n    const frequency: Record<number, number> = {};\r\n    data.forEach(value => {\r\n      frequency[value] = (frequency[value] || 0) + 1;\r\n    });\r\n\r\n    let mode = data[0];\r\n    let maxCount = 0;\r\n\r\n    for (const [value, count] of Object.entries(frequency)) {\r\n      if (count > maxCount) {\r\n        maxCount = count;\r\n        mode = parseFloat(value);\r\n      }\r\n    }\r\n\r\n    return mode;\r\n  }\r\n\r\n  /**\r\n   * Calculate standard deviation\r\n   */\r\n  private static calculateStandardDeviation(data: number[], mean: number): number {\r\n    const variance = data.reduce((sum, value) => sum + Math.pow(value - mean, 2), 0) / data.length;\r\n    return Math.sqrt(variance);\r\n  }\r\n\r\n  /**\r\n   * Calculate percentile\r\n   */\r\n  private static calculatePercentile(sortedData: number[], percentile: number): number {\r\n    const index = (percentile / 100) * (sortedData.length - 1);\r\n    const lower = Math.floor(index);\r\n    const upper = Math.ceil(index);\r\n\r\n    if (lower === upper) {\r\n      return sortedData[lower];\r\n    }\r\n\r\n    const weight = index - lower;\r\n    return sortedData[lower] * (1 - weight) + sortedData[upper] * weight;\r\n  }\r\n\r\n  /**\r\n   * Calculate statistical significance (simplified)\r\n   */\r\n  private static calculateStatisticalSignificance(data1: number[], data2: number[]): number {\r\n    // Simplified p-value calculation using t-test approximation\r\n    const mean1 = this.calculateMean(data1);\r\n    const mean2 = this.calculateMean(data2);\r\n    const std1 = this.calculateStandardDeviation(data1, mean1);\r\n    const std2 = this.calculateStandardDeviation(data2, mean2);\r\n\r\n    const n1 = data1.length;\r\n    const n2 = data2.length;\r\n\r\n    if (n1 < 2 || n2 < 2) return 1; // Not enough data\r\n\r\n    const pooledStd = Math.sqrt(((n1 - 1) * std1 * std1 + (n2 - 1) * std2 * std2) / (n1 + n2 - 2));\r\n    const se = pooledStd * Math.sqrt(1 / n1 + 1 / n2);\r\n    const t = Math.abs(mean1 - mean2) / se;\r\n\r\n    // Approximate p-value (simplified)\r\n    return Math.max(0.001, Math.exp((-t * t) / 2) / Math.sqrt(2 * Math.PI));\r\n  }\r\n\r\n  /**\r\n   * Calculate effect size (Cohen's d)\r\n   */\r\n  private static calculateEffectSize(data1: number[], data2: number[]): number {\r\n    const mean1 = this.calculateMean(data1);\r\n    const mean2 = this.calculateMean(data2);\r\n    const std1 = this.calculateStandardDeviation(data1, mean1);\r\n    const std2 = this.calculateStandardDeviation(data2, mean2);\r\n\r\n    const pooledStd = Math.sqrt((std1 * std1 + std2 * std2) / 2);\r\n    return pooledStd !== 0 ? Math.abs(mean1 - mean2) / pooledStd : 0;\r\n  }\r\n\r\n  /**\r\n   * Calculate confidence interval\r\n   */\r\n  private static calculateConfidence(data1: number[], data2: number[]): number {\r\n    // Simplified confidence calculation\r\n    const significance = this.calculateStatisticalSignificance(data1, data2);\r\n    return Math.max(0, Math.min(100, (1 - significance) * 100));\r\n  }\r\n\r\n  /**\r\n   * Calculate trend (linear regression slope)\r\n   */\r\n  private static calculateTrend(data: number[]): number {\r\n    if (data.length < 2) return 0;\r\n\r\n    const n = data.length;\r\n    const x = Array.from({ length: n }, (_, i) => i);\r\n    const y = data;\r\n\r\n    const sumX = x.reduce((sum, val) => sum + val, 0);\r\n    const sumY = y.reduce((sum, val) => sum + val, 0);\r\n    const sumXY = x.reduce((sum, val, i) => sum + val * y[i], 0);\r\n    const sumXX = x.reduce((sum, val) => sum + val * val, 0);\r\n\r\n    const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\r\n    return slope;\r\n  }\r\n\r\n  /**\r\n   * Generate insights from comparison statistics\r\n   */\r\n  private static generateInsights(\r\n    statistics: ComparisonStatistics,\r\n    _config: ComparisonConfig\r\n  ): ComparisonInsight[] {\r\n    const insights: ComparisonInsight[] = [];\r\n\r\n    // Overall improvement/worsening insight\r\n    const { percentageChange, statisticalSignificance } = statistics.overall;\r\n\r\n    if (Math.abs(percentageChange) > 10 && statisticalSignificance < 0.05) {\r\n      const isImprovement = percentageChange < 0;\r\n      insights.push({\r\n        id: `overall-${isImprovement ? 'improvement' : 'worsening'}`,\r\n        type: isImprovement ? 'improvement' : 'worsening',\r\n        title: `Overall ${isImprovement ? 'Improvement' : 'Worsening'} Detected`,\r\n        description: `Pain levels ${isImprovement ? 'decreased' : 'increased'} by ${formatNumber(Math.abs(percentageChange), 1)}% compared to baseline`,\r\n        severity: Math.abs(percentageChange) > 25 ? 'high' : 'medium',\r\n        confidence: (1 - statisticalSignificance) * 100,\r\n        actionable: true,\r\n        recommendation: isImprovement\r\n          ? 'Consider maintaining current treatment approach'\r\n          : 'May need to adjust treatment or investigate contributing factors',\r\n      });\r\n    }\r\n\r\n    // Trend analysis insight\r\n    const { trendDifference } = statistics.trends;\r\n    if (Math.abs(trendDifference) > 0.1) {\r\n      const improvingTrend = trendDifference < 0;\r\n      insights.push({\r\n        id: 'trend-analysis',\r\n        type: improvingTrend ? 'improvement' : 'worsening',\r\n        title: `Trend ${improvingTrend ? 'Improving' : 'Worsening'}`,\r\n        description: `Pain trend is ${improvingTrend ? 'improving' : 'worsening'} over time`,\r\n        severity: 'medium',\r\n        confidence: 75,\r\n        actionable: true,\r\n      });\r\n    }\r\n\r\n    // Quality of life insights\r\n    if (statistics.byMetric.mood) {\r\n      const moodChange = statistics.byMetric.mood.percentageChange;\r\n      if (Math.abs(moodChange) > 15) {\r\n        insights.push({\r\n          id: 'mood-impact',\r\n          type: moodChange < 0 ? 'improvement' : 'worsening',\r\n          title: 'Mood Impact Changes',\r\n          description: `Mood impact ${moodChange < 0 ? 'improved' : 'worsened'} by ${formatNumber(Math.abs(moodChange), 1)}%`,\r\n          severity: 'medium',\r\n          confidence: 70,\r\n          actionable: true,\r\n        });\r\n      }\r\n    }\r\n\r\n    return insights;\r\n  }\r\n\r\n  /**\r\n   * Generate comparison charts\r\n   */\r\n  private static generateCharts(\r\n    datasets: ComparisonDataset[],\r\n    _config: ComparisonConfig\r\n  ): ComparisonChart[] {\r\n    const charts: ComparisonChart[] = [];\r\n\r\n    // Line chart for pain levels over time\r\n    charts.push(this.generateLineChart(datasets, 'Pain Levels Over Time'));\r\n\r\n    // Bar chart for average comparisons\r\n    charts.push(this.generateBarChart(datasets, 'Average Pain Comparison'));\r\n\r\n    // Box plot for distribution comparison\r\n    charts.push(this.generateBoxPlot(datasets, 'Pain Distribution'));\r\n\r\n    return charts;\r\n  }\r\n\r\n  /**\r\n   * Generate line chart\r\n   */\r\n  private static generateLineChart(datasets: ComparisonDataset[], title: string): ComparisonChart {\r\n    const labels: string[] = [];\r\n    const chartDatasets = datasets.map(dataset => ({\r\n      label: dataset.name,\r\n      data: dataset.entries.map((entry: PainEntry) => entry.baselineData.pain),\r\n      borderColor: dataset.color,\r\n      backgroundColor: dataset.color + '20',\r\n      fill: false,\r\n    }));\r\n\r\n    // Generate time labels\r\n    const maxLength = Math.max(...datasets.map(d => d.entries.length));\r\n    for (let i = 0; i < maxLength; i++) {\r\n      labels.push(`Entry ${i + 1}`);\r\n    }\r\n\r\n    return {\r\n      id: `line-chart-${Date.now()}`,\r\n      type: 'line',\r\n      title,\r\n      data: {\r\n        labels,\r\n        datasets: chartDatasets,\r\n      },\r\n      config: {\r\n        responsive: true,\r\n        plugins: {\r\n          legend: {\r\n            display: true,\r\n            position: 'top',\r\n          },\r\n          tooltip: {\r\n            enabled: true,\r\n          },\r\n        },\r\n        scales: {\r\n          x: {\r\n            title: {\r\n              display: true,\r\n              text: 'Time',\r\n            },\r\n          },\r\n          y: {\r\n            title: {\r\n              display: true,\r\n              text: 'Pain Level',\r\n            },\r\n          },\r\n        },\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate bar chart\r\n   */\r\n  private static generateBarChart(datasets: ComparisonDataset[], title: string): ComparisonChart {\r\n    const labels = datasets.map(d => d.name);\r\n    const data = datasets.map(dataset => {\r\n      const painLevels = dataset.entries.map((e: PainEntry) => e.baselineData.pain);\r\n      return this.calculateMean(painLevels);\r\n    });\r\n\r\n    return {\r\n      id: `bar-chart-${Date.now()}`,\r\n      type: 'bar',\r\n      title,\r\n      data: {\r\n        labels,\r\n        datasets: [\r\n          {\r\n            label: 'Average Pain Level',\r\n            data,\r\n            backgroundColor: datasets.map(d => d.color),\r\n            borderColor: datasets.map(d => d.color),\r\n            borderWidth: 1,\r\n          },\r\n        ],\r\n      },\r\n      config: {\r\n        responsive: true,\r\n        plugins: {\r\n          legend: {\r\n            display: false,\r\n          },\r\n        },\r\n        scales: {\r\n          y: {\r\n            beginAtZero: true,\r\n            title: {\r\n              display: true,\r\n              text: 'Pain Level',\r\n            },\r\n          },\r\n        },\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate box plot\r\n   */\r\n  private static generateBoxPlot(datasets: ComparisonDataset[], title: string): ComparisonChart {\r\n    const labels = datasets.map(d => d.name);\r\n    const data = datasets.map(dataset => {\r\n      const painLevels = dataset.entries.map((e: PainEntry) => e.baselineData.pain);\r\n      const sorted = [...painLevels].sort((a, b) => a - b);\r\n      const q1 = this.calculatePercentile(sorted, 25);\r\n      const median = this.calculateMedian(sorted);\r\n      const q3 = this.calculatePercentile(sorted, 75);\r\n      const min = Math.min(...painLevels);\r\n      const max = Math.max(...painLevels);\r\n\r\n      return [min, q1, median, q3, max];\r\n    });\r\n\r\n    return {\r\n      id: `box-plot-${Date.now()}`,\r\n      type: 'box-plot',\r\n      title,\r\n      data: {\r\n        labels,\r\n        datasets: [\r\n          {\r\n            label: 'Pain Distribution',\r\n            data: data.flat(),\r\n            backgroundColor: datasets.map(d => d.color + '40'),\r\n            borderColor: datasets.map(d => d.color),\r\n            borderWidth: 1,\r\n          },\r\n        ],\r\n      },\r\n      config: {\r\n        responsive: true,\r\n        plugins: {\r\n          legend: {\r\n            display: false,\r\n          },\r\n        },\r\n      },\r\n    };\r\n  }\r\n}\r\n","import React, { useState } from 'react';\nimport { Table, BarChart } from 'lucide-react';\nimport { cn } from '../../design-system/utils';\nimport Chart from '../../design-system/components/Chart';\n\n/**\n * Accessible chart component with table view toggle\n * Provides dual-path access to data visualization for screen reader users\n *\n * WCAG 2.2 AA: Complex graphics must have text alternatives\n */\n\nexport interface ChartDataPoint {\n  label: string;\n  value: number;\n  additionalInfo?: string;\n}\n\nexport interface ChartWithTableToggleProps {\n  /** Chart title */\n  title: string;\n  /** Chart description for screen readers */\n  description: string;\n  /** Chart type from Chart component */\n  type: 'line' | 'bar' | 'doughnut' | 'pie' | 'radar';\n  /** Chart.js data object */\n  chartData: {\n    labels: string[];\n    datasets: Array<{\n      label: string;\n      data: number[];\n      [key: string]: unknown;\n    }>;\n  };\n  /** Tabular data for accessible view */\n  tableData: ChartDataPoint[];\n  /** Icon component (Lucide) */\n  icon?: React.ComponentType<{ className?: string }>;\n  /** Height of chart in pixels */\n  height?: number;\n  /** Additional class names */\n  className?: string;\n  /** Optional footer content */\n  footer?: React.ReactNode;\n}\n\nexport function ChartWithTableToggle({\n  title,\n  description,\n  type,\n  chartData,\n  tableData,\n  icon: Icon,\n  height = 256,\n  className,\n  footer,\n}: ChartWithTableToggleProps) {\n  const [viewMode, setViewMode] = useState<'chart' | 'table'>('chart');\n\n  return (\n    <div\n      className={cn(\n        'bg-white dark:bg-gray-900 rounded-2xl border border-gray-200 dark:border-gray-800 p-6 shadow-lg',\n        className\n      )}\n    >\n      {/* Header with Toggle */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex-1\">\n          <h3 className=\"text-xl font-bold text-gray-900 dark:text-white\">{title}</h3>\n          <p className=\"text-sm text-gray-500 dark:text-gray-400\">{description}</p>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {Icon && <Icon className=\"h-6 w-6 text-gray-400 dark:text-gray-500\" aria-hidden=\"true\" />}\n\n          {/* View Toggle Button */}\n          <button\n            onClick={() => setViewMode(viewMode === 'chart' ? 'table' : 'chart')}\n            className={cn(\n              'flex items-center gap-2 px-3 py-2 rounded-lg transition-all',\n              'min-h-[44px] min-w-[44px]',\n              'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2',\n              'hover:bg-gray-100 dark:hover:bg-gray-800',\n              'text-sm font-medium text-gray-700 dark:text-gray-300'\n            )}\n            aria-label={viewMode === 'chart' ? 'Switch to table view' : 'Switch to chart view'}\n            aria-pressed={viewMode === 'table'}\n          >\n            {viewMode === 'chart' ? (\n              <>\n                <Table className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline\">Table</span>\n              </>\n            ) : (\n              <>\n                <BarChart className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline\">Chart</span>\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Content Area */}\n      <div style={{ minHeight: height }}>\n        {viewMode === 'chart' ? (\n          <div className=\"h-64\" role=\"img\" aria-label={`${title}. ${description}`}>\n            <Chart type={type} data={chartData} height={height} />\n            {/* Screen reader summary */}\n            <div className=\"sr-only\">\n              {title}. {description}. Data summary: {tableData.length} items.\n              {tableData.slice(0, 3).map((item, i) => (\n                <span key={i}>\n                  {item.label}: {item.value}.\n                </span>\n              ))}\n              {tableData.length > 3 && `And ${tableData.length - 3} more items.`}\n              Use the table view button to see all data in a table format.\n            </div>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b border-gray-200 dark:border-gray-700\">\n                  <th className=\"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white\">\n                    Category\n                  </th>\n                  <th className=\"text-right py-3 px-4 font-semibold text-gray-900 dark:text-white\">\n                    Value\n                  </th>\n                  {tableData.some(d => d.additionalInfo) && (\n                    <th className=\"text-left py-3 px-4 font-semibold text-gray-900 dark:text-white\">\n                      Details\n                    </th>\n                  )}\n                </tr>\n              </thead>\n              <tbody>\n                {tableData.map((item, index) => (\n                  <tr\n                    key={index}\n                    className={cn(\n                      'border-b border-gray-100 dark:border-gray-800',\n                      'hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors'\n                    )}\n                  >\n                    <td className=\"py-3 px-4 text-gray-700 dark:text-gray-300\">{item.label}</td>\n                    <td className=\"py-3 px-4 text-right font-mono text-gray-900 dark:text-white\">\n                      {typeof item.value === 'number' ? item.value.toFixed(1) : item.value}\n                    </td>\n                    {tableData.some(d => d.additionalInfo) && (\n                      <td className=\"py-3 px-4 text-gray-600 dark:text-gray-400 text-xs\">\n                        {item.additionalInfo || ''}\n                      </td>\n                    )}\n                  </tr>\n                ))}\n              </tbody>\n              {tableData.length > 0 && (\n                <tfoot>\n                  <tr>\n                    <td\n                      colSpan={tableData.some(d => d.additionalInfo) ? 3 : 2}\n                      className=\"py-3 px-4 text-xs text-gray-500 dark:text-gray-400\"\n                    >\n                      {tableData.length} {tableData.length === 1 ? 'row' : 'rows'} total\n                    </td>\n                  </tr>\n                </tfoot>\n              )}\n            </table>\n          </div>\n        )}\n      </div>\n\n      {/* Optional Footer */}\n      {footer && (\n        <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">{footer}</div>\n      )}\n    </div>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { formatNumber } from '../../utils/formatting';\nimport type { PainEntry } from '../../types';\nimport type {\n  TimePeriodComparison,\n  ComparisonDataset,\n  ComparisonResult,\n} from '../../types/comparison';\nimport { DataComparisonEngine } from '../../utils/comparison/engine';\nimport { Card, CardContent, CardHeader, CardTitle } from '../../design-system/components/Card';\nimport { Button } from '../../design-system/components/Button';\nimport { Input } from '../../design-system/components/Input';\nimport { Badge } from '../../design-system/components/Badge';\nimport { Calendar, TrendingUp, BarChart3, Activity, RefreshCw } from 'lucide-react';\nimport {\n  ChartWithTableToggle,\n  type ChartDataPoint,\n} from '../accessibility/ChartWithTableToggle';\nimport type { ComparisonChart } from '../../types/comparison';\n\ninterface TimePeriodComparisonProps {\n  entries: PainEntry[];\n  onComparisonComplete?: (result: ComparisonResult) => void;\n  className?: string;\n  defaultComparisonType?: 'day-to-day' | 'week-to-week' | 'month-to-month' | 'custom-range';\n}\n\nexport const TimePeriodComparisonComponent: React.FC<TimePeriodComparisonProps> = ({\n  entries,\n  onComparisonComplete,\n  className = '',\n  defaultComparisonType = 'week-to-week',\n}) => {\n  const [comparisonType, setComparisonType] = useState<\n    'day-to-day' | 'week-to-week' | 'month-to-month' | 'custom-range'\n  >(defaultComparisonType);\n  const [baselineStart, setBaselineStart] = useState('');\n  const [baselineEnd, setBaselineEnd] = useState('');\n  const [comparisonStart, setComparisonStart] = useState('');\n  const [comparisonEnd, setComparisonEnd] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [result, setResult] = useState<ComparisonResult | null>(null);\n\n  // Get insights from result for easier access\n  const insights = result?.insights || [];\n\n  // Set default date ranges based on comparison type\n  useEffect(() => {\n    const now = new Date();\n    const formatDate = (date: Date) => date.toISOString().split('T')[0];\n\n    switch (comparisonType) {\n      case 'day-to-day': {\n        // Yesterday vs Today\n        const yesterday = new Date(now);\n        yesterday.setDate(yesterday.getDate() - 1);\n        const dayBeforeYesterday = new Date(yesterday);\n        dayBeforeYesterday.setDate(dayBeforeYesterday.getDate() - 1);\n\n        setBaselineStart(formatDate(dayBeforeYesterday));\n        setBaselineEnd(formatDate(yesterday));\n        setComparisonStart(formatDate(yesterday));\n        setComparisonEnd(formatDate(now));\n        break;\n      }\n\n      case 'week-to-week': {\n        // Last week vs This week\n        const lastWeekStart = new Date(now);\n        lastWeekStart.setDate(lastWeekStart.getDate() - 14);\n        const lastWeekEnd = new Date(now);\n        lastWeekEnd.setDate(lastWeekEnd.getDate() - 7);\n        const thisWeekStart = new Date(now);\n        thisWeekStart.setDate(thisWeekStart.getDate() - 7);\n\n        setBaselineStart(formatDate(lastWeekStart));\n        setBaselineEnd(formatDate(lastWeekEnd));\n        setComparisonStart(formatDate(thisWeekStart));\n        setComparisonEnd(formatDate(now));\n        break;\n      }\n\n      case 'month-to-month': {\n        // Last month vs This month\n        const lastMonthStart = new Date(now);\n        lastMonthStart.setMonth(lastMonthStart.getMonth() - 2);\n        lastMonthStart.setDate(1);\n        const lastMonthEnd = new Date(now);\n        lastMonthEnd.setMonth(lastMonthEnd.getMonth() - 1);\n        lastMonthEnd.setDate(0);\n        const thisMonthStart = new Date(now);\n        thisMonthStart.setMonth(thisMonthStart.getMonth() - 1);\n        thisMonthStart.setDate(1);\n\n        setBaselineStart(formatDate(lastMonthStart));\n        setBaselineEnd(formatDate(lastMonthEnd));\n        setComparisonStart(formatDate(thisMonthStart));\n        setComparisonEnd(formatDate(now));\n        break;\n      }\n\n      case 'custom-range': {\n        // Last 30 days vs Previous 30 days\n        const thirtyDaysAgo = new Date(now);\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n        const sixtyDaysAgo = new Date(now);\n        sixtyDaysAgo.setDate(sixtyDaysAgo.getDate() - 60);\n\n        setBaselineStart(formatDate(sixtyDaysAgo));\n        setBaselineEnd(formatDate(thirtyDaysAgo));\n        setComparisonStart(formatDate(thirtyDaysAgo));\n        setComparisonEnd(formatDate(now));\n        break;\n      }\n    }\n  }, [comparisonType]);\n\n  const handleCompare = async () => {\n    if (!baselineStart || !baselineEnd || !comparisonStart || !comparisonEnd) {\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      // Filter entries for each period\n      const baselineEntries = entries.filter(entry => {\n        const entryDate = new Date(entry.timestamp);\n        return entryDate >= new Date(baselineStart) && entryDate <= new Date(baselineEnd);\n      });\n\n      const comparisonEntries = entries.filter(entry => {\n        const entryDate = new Date(entry.timestamp);\n        return entryDate >= new Date(comparisonStart) && entryDate <= new Date(comparisonEnd);\n      });\n\n      if (baselineEntries.length === 0 || comparisonEntries.length === 0) {\n        alert('Not enough data for the selected time periods. Please adjust the date ranges.');\n        return;\n      }\n\n      // Create datasets\n      const sortByTimestampAsc = (a: PainEntry, b: PainEntry) =>\n        new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime();\n\n      const baselineEntriesSorted = [...baselineEntries].sort(sortByTimestampAsc);\n      const comparisonEntriesSorted = [...comparisonEntries].sort(sortByTimestampAsc);\n\n      const datasets: ComparisonDataset[] = [\n        {\n          id: 'baseline',\n          name: 'Baseline Period',\n          description: `${baselineStart} to ${baselineEnd}`,\n          entries: baselineEntriesSorted,\n          color: '#3B82F6', // Blue\n          metadata: {\n            source: 'time-period-comparison',\n            dateRange: {\n              start: new Date(baselineStart),\n              end: new Date(baselineEnd),\n            },\n          },\n        },\n        {\n          id: 'comparison',\n          name: 'Comparison Period',\n          description: `${comparisonStart} to ${comparisonEnd}`,\n          entries: comparisonEntriesSorted,\n          color: '#EF4444', // Red\n          metadata: {\n            source: 'time-period-comparison',\n            dateRange: {\n              start: new Date(comparisonStart),\n              end: new Date(comparisonEnd),\n            },\n          },\n        },\n      ];\n\n      // Create comparison config\n      const config: TimePeriodComparison = {\n        type: 'time-period',\n        periodType: comparisonType,\n        baselinePeriod: {\n          start: new Date(baselineStart),\n          end: new Date(baselineEnd),\n        },\n        comparisonPeriod: {\n          start: new Date(comparisonStart),\n          end: new Date(comparisonEnd),\n        },\n        datasets,\n      };\n\n      // Run comparison\n      const comparisonResult = await DataComparisonEngine.compareDatasets(config, datasets);\n      setResult(comparisonResult);\n\n      if (onComparisonComplete) {\n        onComparisonComplete(comparisonResult);\n      }\n    } catch (error) {\n      console.error('Comparison failed:', error);\n      alert('Failed to perform comparison. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const renderComparisonForm = () => (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Calendar className=\"w-5 h-5\" />\n          Time Period Comparison\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        {/* Comparison Type Selection */}\n        <div>\n          <label htmlFor=\"comparison-type\" className=\"text-sm font-medium\">\n            Comparison Type\n          </label>\n          <select\n            id=\"comparison-type\"\n            className=\"mt-1 block w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n            value={comparisonType}\n            onChange={e => setComparisonType(e.target.value as typeof comparisonType)}\n          >\n            <option value=\"day-to-day\">Day-to-Day (Yesterday vs Today)</option>\n            <option value=\"week-to-week\">Week-to-Week (Last Week vs This Week)</option>\n            <option value=\"month-to-month\">Month-to-Month (Last Month vs This Month)</option>\n            <option value=\"custom-range\">Custom Date Range</option>\n          </select>\n        </div>\n\n        {/* Date Range Inputs */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* Baseline Period */}\n          <div className=\"space-y-3\">\n            <h3 className=\"font-medium text-sm flex items-center gap-2\">\n              <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n              Baseline Period\n            </h3>\n            <div className=\"space-y-2\">\n              <div>\n                <label htmlFor=\"baseline-start\" className=\"text-sm font-medium\">\n                  Start Date\n                </label>\n                <Input\n                  id=\"baseline-start\"\n                  type=\"date\"\n                  value={baselineStart}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                    setBaselineStart(e.target.value)\n                  }\n                />\n              </div>\n              <div>\n                <label htmlFor=\"baseline-end\" className=\"text-sm font-medium\">\n                  End Date\n                </label>\n                <Input\n                  id=\"baseline-end\"\n                  type=\"date\"\n                  value={baselineEnd}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                    setBaselineEnd(e.target.value)\n                  }\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Comparison Period */}\n          <div className=\"space-y-3\">\n            <h3 className=\"font-medium text-sm flex items-center gap-2\">\n              <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\n              Comparison Period\n            </h3>\n            <div className=\"space-y-2\">\n              <div>\n                <label htmlFor=\"comparison-start\" className=\"text-sm font-medium\">\n                  Start Date\n                </label>\n                <Input\n                  id=\"comparison-start\"\n                  type=\"date\"\n                  value={comparisonStart}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                    setComparisonStart(e.target.value)\n                  }\n                />\n              </div>\n              <div>\n                <label htmlFor=\"comparison-end\" className=\"text-sm font-medium\">\n                  End Date\n                </label>\n                <Input\n                  id=\"comparison-end\"\n                  type=\"date\"\n                  value={comparisonEnd}\n                  onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\n                    setComparisonEnd(e.target.value)\n                  }\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Action Button */}\n        <div className=\"flex justify-center\">\n          <Button onClick={handleCompare} disabled={isLoading} className=\"min-w-32\">\n            {isLoading ? (\n              <>\n                <RefreshCw className=\"w-4 h-4 mr-2 animate-spin\" />\n                Comparing...\n              </>\n            ) : (\n              <>\n                <BarChart3 className=\"w-4 h-4 mr-2\" />\n                Compare Periods\n              </>\n            )}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n\n  const renderComparisonResults = () => {\n    if (!result) return null;\n\n    const { statistics } = result;\n\n    const buildLineTableData = (chart: ComparisonChart): ChartDataPoint[] => {\n      const labels = chart.data.labels ?? [];\n      const datasets = chart.data.datasets ?? [];\n      const first = datasets[0];\n      const rest = datasets.slice(1);\n\n      return labels.map((label, index) => {\n        const firstValue = Number(first?.data?.[index] ?? 0);\n        const additionalInfo = rest\n          .map(ds => {\n            const value = Number(ds?.data?.[index] ?? 0);\n            return `${ds.label ?? 'Series'}: ${value.toFixed(1)}`;\n          })\n          .join('  ');\n\n        return {\n          label,\n          value: firstValue,\n          additionalInfo: additionalInfo || undefined,\n        };\n      });\n    };\n\n    const buildBarTableData = (chart: ComparisonChart): ChartDataPoint[] => {\n      const labels = chart.data.labels ?? [];\n      const dataset = chart.data.datasets?.[0];\n      const values = dataset?.data ?? [];\n\n      return labels.map((label, index) => ({\n        label,\n        value: Number(values[index] ?? 0),\n      }));\n    };\n\n    const boxPlotToBarChart = (\n      chart: ComparisonChart\n    ): { chartData: { labels: string[]; datasets: Array<{ label: string; data: number[]; [key: string]: unknown }> }; tableData: ChartDataPoint[] } => {\n      const periodLabels = chart.data.labels ?? [];\n      const payload = chart.data.datasets?.[0];\n      const flat = (payload?.data ?? []).map(n => Number(n ?? 0));\n      const borderColors = Array.isArray(payload?.borderColor) ? payload.borderColor : undefined;\n      const backgroundColors = Array.isArray(payload?.backgroundColor)\n        ? payload.backgroundColor\n        : undefined;\n\n      const labels = ['min', 'q1', 'median', 'q3', 'max'];\n      const datasets = periodLabels.map((period, idx) => {\n        const start = idx * 5;\n        const slice = flat.slice(start, start + 5);\n        const color = borderColors?.[idx] ?? undefined;\n        const bg = backgroundColors?.[idx] ?? undefined;\n        return {\n          label: period,\n          data: slice.length === 5 ? slice : [0, 0, 0, 0, 0],\n          borderColor: color,\n          backgroundColor: bg,\n        };\n      });\n\n      const tableData: ChartDataPoint[] = periodLabels.map((period, idx) => {\n        const start = idx * 5;\n        const [min, q1, median, q3, max] = flat.slice(start, start + 5);\n\n        return {\n          label: period,\n          value: Number(median ?? 0),\n          additionalInfo:\n            min === undefined\n              ? undefined\n              : `min ${Number(min).toFixed(1)}  q1 ${Number(q1).toFixed(1)}  q3 ${Number(q3).toFixed(1)}  max ${Number(max).toFixed(1)}`,\n        };\n      });\n\n      return { chartData: { labels, datasets }, tableData };\n    };\n\n    const renderChart = (chart: ComparisonChart) => {\n      if (chart.type === 'line') {\n        return (\n          <ChartWithTableToggle\n            key={chart.id}\n            title={chart.title}\n            description=\"Baseline vs comparison pain values over time.\"\n            type=\"line\"\n            chartData={chart.data}\n            tableData={buildLineTableData(chart)}\n            height={300}\n            icon={BarChart3}\n          />\n        );\n      }\n\n      if (chart.type === 'bar') {\n        return (\n          <ChartWithTableToggle\n            key={chart.id}\n            title={chart.title}\n            description=\"Average pain levels for baseline and comparison periods.\"\n            type=\"bar\"\n            chartData={chart.data}\n            tableData={buildBarTableData(chart)}\n            height={300}\n            icon={BarChart3}\n          />\n        );\n      }\n\n      if (chart.type === 'box-plot') {\n        const converted = boxPlotToBarChart(chart);\n        return (\n          <ChartWithTableToggle\n            key={chart.id}\n            title={chart.title}\n            description=\"Distribution summary (min, quartiles, max) for baseline and comparison periods.\"\n            type=\"bar\"\n            chartData={converted.chartData}\n            tableData={converted.tableData}\n            height={300}\n            icon={BarChart3}\n          />\n        );\n      }\n\n      return null;\n    };\n\n    return (\n      <div className=\"space-y-6\">\n        {/* Overview Statistics */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <TrendingUp className=\"w-5 h-5\" />\n              Comparison Overview\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">\n                  {formatNumber(statistics.overall.baselineMean, 1)}\n                </div>\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">Baseline Avg</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-red-600\">\n                  {formatNumber(statistics.overall.comparisonMean, 1)}\n                </div>\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">Comparison Avg</div>\n              </div>\n              <div className=\"text-center\">\n                <div\n                  className={`text-2xl font-bold ${\n                    statistics.overall.percentageChange < 0 ? 'text-green-600' : 'text-red-600'\n                  }`}\n                >\n                  {statistics.overall.percentageChange > 0 ? '+' : ''}\n                  {formatNumber(statistics.overall.percentageChange, 1)}%\n                </div>\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">Change</div>\n              </div>\n            </div>\n\n            {/* Statistical Significance */}\n            <div className=\"mt-4 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium\">Statistical Significance</span>\n                <Badge\n                  variant={\n                    statistics.overall.statisticalSignificance < 0.05 ? 'default' : 'secondary'\n                  }\n                >\n                  {statistics.overall.statisticalSignificance < 0.05\n                    ? 'Significant'\n                    : 'Not Significant'}\n                </Badge>\n              </div>\n              <div className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                p-value: {formatNumber(statistics.overall.statisticalSignificance, 3)}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Insights */}\n        {insights.length > 0 && (\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Activity className=\"w-5 h-5\" />\n                Key Insights\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {insights.map(insight => (\n                  <div key={insight.id} className=\"p-3 border rounded-lg\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <h4 className=\"font-medium text-sm\">{insight.title}</h4>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                          {insight.description}\n                        </p>\n                        {insight.recommendation && (\n                          <p className=\"text-sm text-blue-600 mt-2 font-medium\">\n                             {insight.recommendation}\n                          </p>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-2 ml-4\">\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {Math.round(insight.confidence)}% confidence\n                        </Badge>\n                        <Badge\n                          variant={\n                            insight.severity === 'high'\n                              ? 'destructive'\n                              : insight.severity === 'medium'\n                                ? 'default'\n                                : 'secondary'\n                          }\n                          className=\"text-xs\"\n                        >\n                          {insight.severity}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Visual Comparison */}\n        {result.charts.length > 0 && (\n          <div className=\"space-y-4\">\n            {result.charts.map(chart => renderChart(chart)).filter(Boolean)}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <div className={`max-w-6xl mx-auto ${className}`}>\n      <div className=\"w-full\">\n        <div className=\"grid w-full grid-cols-2 gap-2 border-b\">\n          <button\n            className={`py-2 text-sm font-medium ${!result ? 'border-b-2 border-primary text-primary' : 'text-muted-foreground'}`}\n            aria-selected={!result}\n          >\n            Setup Comparison\n          </button>\n          <button\n            className={`py-2 text-sm font-medium ${result ? 'border-b-2 border-primary text-primary' : 'text-muted-foreground'}`}\n            aria-selected={!!result}\n            disabled={!result}\n          >\n            Results{' '}\n            {result && (\n              <Badge variant=\"outline\" className=\"ml-2\">\n                {insights.length}\n              </Badge>\n            )}\n          </button>\n        </div>\n\n        <div className=\"mt-6\">{!result ? renderComparisonForm() : renderComparisonResults()}</div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState, useMemo, useCallback, useEffect } from 'react';\r\nimport {\r\n  TrendingUp,\r\n  TrendingDown,\r\n  Activity,\r\n  Calendar,\r\n  Clock,\r\n  MapPin,\r\n  Zap,\r\n  Brain,\r\n  AlertTriangle,\r\n  CheckCircle,\r\n  Download,\r\n  Share2,\r\n  Filter,\r\n  FileSpreadsheet,\r\n  FileJson,\r\n  ClipboardCheck,\r\n  Shield,\r\n  Lock,\r\n  Mail,\r\n  FileText,\r\n  Sparkles,\r\n  BarChart3,\r\n  Waves,\r\n  Moon,\r\n  Sun,\r\n  Heart,\r\n  Pill,\r\n} from 'lucide-react';\r\nimport type { PainEntry } from '../../types';\r\nimport {\r\n  EmotionalValidation,\r\n  ValidationHistory,\r\n  useEmotionalValidation,\r\n} from '../../validation-technology';\r\nimport { useTraumaInformed } from '../accessibility/TraumaInformedHooks';\r\nimport { hipaaComplianceService } from '../../services/HIPAACompliance';\r\nimport type { AuditTrail } from '../../services/HIPAACompliance';\r\nimport { analyzePatterns } from '../../utils/pain-tracker/pattern-engine';\r\nimport type { PatternAnalysisResult } from '../../types/pattern-engine';\r\nimport { localDayStart } from '../../utils/dates';\r\nimport {\r\n  computePainProgressSinceStart,\r\n  buildDailyAveragePain,\r\n} from '../../utils/pain-tracker/progress';\r\nimport { NerveSymptoms } from '../pain-tracker/NerveSymptoms';\r\nimport { FunctionalLimitations } from '../pain-tracker/FunctionalLimitations';\r\nimport { WeatherCorrelationPanel } from './WeatherCorrelationPanel';\r\nimport { TimePeriodComparisonComponent } from '../comparison/TimePeriodComparison';\r\nimport {\r\n  Badge,\r\n  type BadgeProps,\r\n  Button,\r\n  Card,\r\n  CardContent,\r\n  CardDescription,\r\n  CardHeader,\r\n  CardTitle,\r\n} from '../../design-system';\r\n\r\ntype TimePeriod = 'morning' | 'afternoon' | 'evening' | 'night';\r\n\r\ninterface TimePatternStats {\r\n  count: number;\r\n  avgIntensity: number;\r\n}\r\n\r\ntype TimePatterns = Record<TimePeriod, TimePatternStats>;\r\n\r\ninterface LocationStat {\r\n  location: string;\r\n  count: number;\r\n  percentage: number;\r\n}\r\n\r\ninterface TriggerStat {\r\n  trigger: string;\r\n  count: number;\r\n  percentage: number;\r\n}\r\n\r\ninterface DayOfWeekPattern {\r\n  day: number;\r\n  count: number;\r\n  avgPain: number;\r\n}\r\n\r\ninterface MonthlyTrendPoint {\r\n  month: number;\r\n  count: number;\r\n  avgPain: number;\r\n}\r\n\r\ninterface TriggerPainCorrelation {\r\n  trigger: string;\r\n  count: number;\r\n  avgDelta: number;\r\n}\r\n\r\ninterface MedicationEffectStat {\r\n  medication: string;\r\n  uses: number;\r\n  avgReduction: number;\r\n  effectiveness: number;\r\n}\r\n\r\ninterface MedicationWindowInsight {\r\n  id: string;\r\n  label: string;\r\n  avgReduction: number;\r\n  confidence: number;\r\n  count: number;\r\n}\r\n\r\ninterface PredictedFlare {\r\n  probability: number;\r\n  timeframe: string;\r\n  severity: 'high' | 'moderate' | 'low';\r\n  recommendations: string[];\r\n}\r\n\r\ninterface NextWeekForecast {\r\n  projectedAverage: number;\r\n  change: number;\r\n  confidence: 'high' | 'medium' | 'low';\r\n  narrative: string;\r\n}\r\n\r\ninterface PersonalizedRecommendation {\r\n  title: string;\r\n  detail: string;\r\n  category: 'flare' | 'trigger' | 'medication' | 'routine';\r\n  emphasis: 'high' | 'medium' | 'low';\r\n}\r\n\r\ninterface NumericSignalStats {\r\n  count: number;\r\n  avg: number;\r\n  min: number;\r\n  max: number;\r\n}\r\n\r\ninterface AnalyticsSnapshot {\r\n  avgPain: number;\r\n  trend: number;\r\n  volatility: number;\r\n  goodDays: number;\r\n  badDays: number;\r\n  topLocations: LocationStat[];\r\n  topTriggers: TriggerStat[];\r\n  topReliefMethods: TriggerStat[];\r\n  topActivities: TriggerStat[];\r\n  topQualities: TriggerStat[];\r\n  stressStats: NumericSignalStats;\r\n  activityLevelStats: NumericSignalStats;\r\n  weatherCount: number;\r\n  timePatterns: TimePatterns;\r\n  dayOfWeekPatterns: DayOfWeekPattern[];\r\n  monthlyTrend: MonthlyTrendPoint[];\r\n  triggerPainCorrelation: TriggerPainCorrelation[];\r\n  medicationEffectiveness: MedicationEffectStat[];\r\n  predictedFlare: PredictedFlare | null;\r\n  riskScore: number;\r\n  improvementScore: number;\r\n  optimalMedicationWindow: MedicationWindowInsight | null;\r\n  nextWeekForecast: NextWeekForecast | null;\r\n  personalizedRecommendations: PersonalizedRecommendation[];\r\n}\r\n\r\ninterface ReasoningNode {\r\n  id: string;\r\n  title: string;\r\n  insight: string;\r\n  confidence: 'high' | 'medium' | 'low';\r\n  evidence?: string;\r\n  action?: string;\r\n  children?: ReasoningNode[];\r\n}\r\n\r\nconst DAY_LABELS = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n\r\nconst MEDICATION_WINDOWS = [\r\n  { id: 'overnight', start: 0, end: 5, label: 'Midnight  5 AM' },\r\n  { id: 'early-morning', start: 5, end: 9, label: '5 AM  9 AM' },\r\n  { id: 'late-morning', start: 9, end: 12, label: '9 AM  Noon' },\r\n  { id: 'early-afternoon', start: 12, end: 16, label: 'Noon  4 PM' },\r\n  { id: 'late-afternoon', start: 16, end: 19, label: '4 PM  7 PM' },\r\n  { id: 'evening', start: 19, end: 23, label: '7 PM  11 PM' },\r\n  { id: 'late-night', start: 23, end: 24, label: '11 PM  Midnight' },\r\n];\r\n\r\nconst clamp = (value: number, min: number, max: number) => Math.min(max, Math.max(min, value));\r\n\r\nconst createInitialTimePatterns = (): TimePatterns => ({\r\n  morning: { count: 0, avgIntensity: 0 },\r\n  afternoon: { count: 0, avgIntensity: 0 },\r\n  evening: { count: 0, avgIntensity: 0 },\r\n  night: { count: 0, avgIntensity: 0 },\r\n});\r\n\r\nconst createEmptyAnalyticsSnapshot = (): AnalyticsSnapshot => ({\r\n  avgPain: 0,\r\n  trend: 0,\r\n  volatility: 0,\r\n  goodDays: 0,\r\n  badDays: 0,\r\n  topLocations: [],\r\n  topTriggers: [],\r\n  topReliefMethods: [],\r\n  topActivities: [],\r\n  topQualities: [],\r\n  stressStats: { count: 0, avg: 0, min: 0, max: 0 },\r\n  activityLevelStats: { count: 0, avg: 0, min: 0, max: 0 },\r\n  weatherCount: 0,\r\n  timePatterns: createInitialTimePatterns(),\r\n  dayOfWeekPatterns: [],\r\n  monthlyTrend: [],\r\n  triggerPainCorrelation: [],\r\n  medicationEffectiveness: [],\r\n  predictedFlare: null,\r\n  riskScore: 0,\r\n  improvementScore: 0,\r\n  optimalMedicationWindow: null,\r\n  nextWeekForecast: null,\r\n  personalizedRecommendations: [],\r\n});\r\n\r\ntype EnvRecord = Record<string, unknown>;\r\n\r\nfunction isRecord(value: unknown): value is Record<string, unknown> {\r\n  return typeof value === 'object' && value !== null;\r\n}\r\n\r\nconst getEnv = () => {\r\n  try {\r\n    const meta = import.meta as unknown;\r\n    if (isRecord(meta) && 'env' in meta) {\r\n      const env = (meta as { env?: unknown }).env;\r\n      if (isRecord(env)) return env as EnvRecord;\r\n    }\r\n  } catch (_) {\r\n    // ignore\r\n  }\r\n\r\n  const maybeProcess = (globalThis as unknown as { process?: unknown }).process;\r\n  if (isRecord(maybeProcess) && 'env' in maybeProcess) {\r\n    const env = (maybeProcess as { env?: unknown }).env;\r\n    if (isRecord(env)) return env as EnvRecord;\r\n  }\r\n\r\n  return {} as EnvRecord;\r\n};\r\n\r\nconst ENABLE_VALIDATION_EXPORT = (() => {\r\n  const env = getEnv();\r\n\r\n  const getEnvValue = (key: string): string | undefined => {\r\n    const value = env[key];\r\n    return typeof value === 'string' ? value : undefined;\r\n  };\r\n\r\n  return (\r\n    getEnvValue('VITE_REACT_APP_ENABLE_VALIDATION') !== 'false' &&\r\n    getEnvValue('REACT_APP_ENABLE_VALIDATION') !== 'false'\r\n  );\r\n})();\r\n\r\ntype AuditActionType = AuditTrail['actionType'];\r\ntype AuditOutcome = AuditTrail['outcome'];\r\n\r\nconst ClinicalPDFExportButtonLazy = React.lazy(() =>\r\n  import('../export/ClinicalPDFExportButton').then(module => ({\r\n    default: module.ClinicalPDFExportButton,\r\n  }))\r\n);\r\n\r\nconst DataExportModalLazy = React.lazy(() =>\r\n  import('../export/DataExportModal').then(module => ({ default: module.DataExportModal }))\r\n);\r\n\r\ninterface PremiumAnalyticsDashboardProps {\r\n  entries: PainEntry[];\r\n}\r\n\r\nexport const PremiumAnalyticsDashboard: React.FC<PremiumAnalyticsDashboardProps> = ({\r\n  entries,\r\n}) => {\r\n  const [timeRange, setTimeRange] = useState<'7d' | '30d' | '90d' | '1y' | 'all'>('7d');\r\n  const [view, setView] = useState<\r\n    'overview' | 'patterns' | 'predictions' | 'clinical' | 'export' | 'insights'\r\n  >('overview');\r\n\r\n  const timeRangeLabel = useMemo(() => {\r\n    switch (timeRange) {\r\n      case '7d':\r\n        return 'last 7 days';\r\n      case '30d':\r\n        return 'last 30 days';\r\n      case '90d':\r\n        return 'last 90 days';\r\n      case '1y':\r\n        return 'last year';\r\n      case 'all':\r\n        return 'all time';\r\n    }\r\n  }, [timeRange]);\r\n\r\n  // Filter entries by time range\r\n  const filteredEntries = useMemo(() => {\r\n    if (timeRange === 'all') return entries;\r\n\r\n    // Use local calendar-day boundaries (matches dashboard cards) rather than a rolling window.\r\n    const now = new Date();\r\n    const cutoff = new Date(localDayStart(now));\r\n\r\n    switch (timeRange) {\r\n      case '7d':\r\n        cutoff.setDate(cutoff.getDate() - 7);\r\n        break;\r\n      case '30d':\r\n        cutoff.setDate(cutoff.getDate() - 30);\r\n        break;\r\n      case '90d':\r\n        cutoff.setDate(cutoff.getDate() - 90);\r\n        break;\r\n      case '1y':\r\n        cutoff.setFullYear(cutoff.getFullYear() - 1);\r\n        break;\r\n    }\r\n\r\n    return entries.filter(e => new Date(e.timestamp) >= cutoff);\r\n  }, [entries, timeRange]);\r\n\r\n  // Advanced Analytics Calculations\r\n  const analytics = useMemo<AnalyticsSnapshot>(() => {\r\n    if (filteredEntries.length === 0) {\r\n      return createEmptyAnalyticsSnapshot();\r\n    }\r\n\r\n    const toLocalDateKey = (timestamp: string) => {\r\n      const date = new Date(timestamp);\r\n      const year = date.getFullYear();\r\n      const month = String(date.getMonth() + 1).padStart(2, '0');\r\n      const day = String(date.getDate()).padStart(2, '0');\r\n      return `${year}-${month}-${day}`;\r\n    };\r\n\r\n    // Basic metrics\r\n    const avgPain =\r\n      filteredEntries.reduce((sum, e) => sum + e.baselineData.pain, 0) / filteredEntries.length;\r\n\r\n    // Trend calculation (comparing first half to second half)\r\n    // Guard against tiny datasets where midpoint can be 0.\r\n    const midpoint = Math.floor(filteredEntries.length / 2);\r\n    const trend = (() => {\r\n      if (filteredEntries.length < 2 || midpoint === 0) return 0;\r\n\r\n      const firstHalf = filteredEntries.slice(0, midpoint);\r\n      const secondHalf = filteredEntries.slice(midpoint);\r\n\r\n      const firstHalfAvg =\r\n        firstHalf.reduce((sum, e) => sum + e.baselineData.pain, 0) / firstHalf.length;\r\n      const secondHalfAvg =\r\n        secondHalf.reduce((sum, e) => sum + e.baselineData.pain, 0) / secondHalf.length;\r\n\r\n      if (!Number.isFinite(firstHalfAvg) || firstHalfAvg === 0) return 0;\r\n      return ((secondHalfAvg - firstHalfAvg) / firstHalfAvg) * 100;\r\n    })();\r\n\r\n    // Volatility (standard deviation)\r\n    const variance =\r\n      filteredEntries.reduce((sum, e) => sum + Math.pow(e.baselineData.pain - avgPain, 2), 0) /\r\n      filteredEntries.length;\r\n    const volatility = Math.sqrt(variance);\r\n\r\n    // Good vs Bad days (counted by day using daily average pain)\r\n    const dailyBuckets: Record<string, { totalPain: number; count: number }> = {};\r\n    filteredEntries.forEach(entry => {\r\n      const key = toLocalDateKey(entry.timestamp);\r\n      if (!dailyBuckets[key]) {\r\n        dailyBuckets[key] = { totalPain: 0, count: 0 };\r\n      }\r\n      dailyBuckets[key].totalPain += entry.baselineData.pain;\r\n      dailyBuckets[key].count += 1;\r\n    });\r\n\r\n    const dailyAverages = Object.values(dailyBuckets).map(bucket => bucket.totalPain / bucket.count);\r\n    const daysWithEntries = dailyAverages.length;\r\n    const goodDays = dailyAverages.filter(avg => avg <= 3).length;\r\n    const badDays = dailyAverages.filter(avg => avg >= 7).length;\r\n\r\n    // Location frequency analysis\r\n    const locationCounts: Record<string, number> = {};\r\n    filteredEntries.forEach(entry => {\r\n      entry.baselineData.locations?.forEach((loc: string) => {\r\n        locationCounts[loc] = (locationCounts[loc] || 0) + 1;\r\n      });\r\n    });\r\n    const topLocations: LocationStat[] = Object.entries(locationCounts)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([location, count]) => ({\r\n        location,\r\n        count,\r\n        percentage: (count / filteredEntries.length) * 100,\r\n      }));\r\n\r\n    // Trigger frequency analysis\r\n    const triggerCounts: Record<string, number> = {};\r\n    filteredEntries.forEach(entry => {\r\n      entry.triggers?.forEach(trigger => {\r\n        triggerCounts[trigger] = (triggerCounts[trigger] || 0) + 1;\r\n      });\r\n    });\r\n    const topTriggers: TriggerStat[] = Object.entries(triggerCounts)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([trigger, count]) => ({\r\n        trigger,\r\n        count,\r\n        percentage: (count / filteredEntries.length) * 100,\r\n      }));\r\n\r\n    // Relief methods frequency analysis\r\n    const reliefCounts: Record<string, number> = {};\r\n    filteredEntries.forEach(entry => {\r\n      entry.reliefMethods?.forEach(method => {\r\n        reliefCounts[method] = (reliefCounts[method] || 0) + 1;\r\n      });\r\n    });\r\n    const topReliefMethods: TriggerStat[] = Object.entries(reliefCounts)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([trigger, count]) => ({\r\n        trigger,\r\n        count,\r\n        percentage: (count / filteredEntries.length) * 100,\r\n      }));\r\n\r\n    // Activities frequency analysis\r\n    const activityCounts: Record<string, number> = {};\r\n    filteredEntries.forEach(entry => {\r\n      entry.activities?.forEach(activity => {\r\n        activityCounts[activity] = (activityCounts[activity] || 0) + 1;\r\n      });\r\n    });\r\n    const topActivities: TriggerStat[] = Object.entries(activityCounts)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([trigger, count]) => ({\r\n        trigger,\r\n        count,\r\n        percentage: (count / filteredEntries.length) * 100,\r\n      }));\r\n\r\n    // Pain quality descriptors frequency analysis\r\n    const qualityCounts: Record<string, number> = {};\r\n    filteredEntries.forEach(entry => {\r\n      entry.quality?.forEach(q => {\r\n        qualityCounts[q] = (qualityCounts[q] || 0) + 1;\r\n      });\r\n    });\r\n    const topQualities: TriggerStat[] = Object.entries(qualityCounts)\r\n      .sort(([, a], [, b]) => b - a)\r\n      .slice(0, 5)\r\n      .map(([trigger, count]) => ({\r\n        trigger,\r\n        count,\r\n        percentage: (count / filteredEntries.length) * 100,\r\n      }));\r\n\r\n    // Numeric signal coverage (stress/activityLevel)\r\n    const stressValues = filteredEntries\r\n      .map(e => e.stress)\r\n      .filter((v): v is number => typeof v === 'number' && Number.isFinite(v));\r\n    const activityLevelValues = filteredEntries\r\n      .map(e => e.activityLevel)\r\n      .filter((v): v is number => typeof v === 'number' && Number.isFinite(v));\r\n\r\n    const makeNumericStats = (values: number[]): NumericSignalStats => {\r\n      if (values.length === 0) return { count: 0, avg: 0, min: 0, max: 0 };\r\n      const sum = values.reduce((s, v) => s + v, 0);\r\n      return {\r\n        count: values.length,\r\n        avg: sum / values.length,\r\n        min: Math.min(...values),\r\n        max: Math.max(...values),\r\n      };\r\n    };\r\n\r\n    const stressStats = makeNumericStats(stressValues);\r\n    const activityLevelStats = makeNumericStats(activityLevelValues);\r\n\r\n    const weatherCount = filteredEntries.filter(e => !!e.weather && e.weather.trim() !== '').length;\r\n\r\n    // Time-of-day patterns\r\n    const timePatterns: TimePatterns = createInitialTimePatterns();\r\n\r\n    // Day-of-week (0 Sunday - 6 Saturday)\r\n    const dayOfWeekPatterns: Record<number, { count: number; totalPain: number }> = {\r\n      0: { count: 0, totalPain: 0 },\r\n      1: { count: 0, totalPain: 0 },\r\n      2: { count: 0, totalPain: 0 },\r\n      3: { count: 0, totalPain: 0 },\r\n      4: { count: 0, totalPain: 0 },\r\n      5: { count: 0, totalPain: 0 },\r\n      6: { count: 0, totalPain: 0 },\r\n    };\r\n\r\n    // Monthly trend (1-12)\r\n    const monthlyTrendBuckets: Record<number, { count: number; totalPain: number }> = {};\r\n\r\n    // Trigger correlation accumulators\r\n    const overallAvgPain = avgPain;\r\n    const triggerPainDeltas: Record<string, { count: number; deltaSum: number }> = {};\r\n\r\n    // Medication timing windows\r\n    const medicationTimingBuckets: Record<\r\n      string,\r\n      { count: number; totalReduction: number; label: string }\r\n    > = {};\r\n    const getWindowForHour = (hour: number) => {\r\n      return (\r\n        MEDICATION_WINDOWS.find(window => hour >= window.start && hour < window.end) ??\r\n        MEDICATION_WINDOWS[MEDICATION_WINDOWS.length - 1]\r\n      );\r\n    };\r\n\r\n    filteredEntries.forEach(entry => {\r\n      const hour = new Date(entry.timestamp).getHours();\r\n      const date = new Date(entry.timestamp);\r\n      const dayOfWeek = date.getDay();\r\n      const month = date.getMonth() + 1;\r\n      let period: keyof typeof timePatterns;\r\n      if (hour >= 5 && hour < 12) period = 'morning';\r\n      else if (hour >= 12 && hour < 17) period = 'afternoon';\r\n      else if (hour >= 17 && hour < 21) period = 'evening';\r\n      else period = 'night';\r\n\r\n      timePatterns[period].count++;\r\n      timePatterns[period].avgIntensity += entry.baselineData.pain;\r\n\r\n      dayOfWeekPatterns[dayOfWeek].count++;\r\n      dayOfWeekPatterns[dayOfWeek].totalPain += entry.baselineData.pain;\r\n\r\n      if (!monthlyTrendBuckets[month]) {\r\n        monthlyTrendBuckets[month] = { count: 0, totalPain: 0 };\r\n      }\r\n      monthlyTrendBuckets[month].count++;\r\n      monthlyTrendBuckets[month].totalPain += entry.baselineData.pain;\r\n\r\n      if (entry.triggers && entry.triggers.length > 0) {\r\n        const delta = entry.baselineData.pain - overallAvgPain;\r\n        entry.triggers.forEach(trigger => {\r\n          if (!triggerPainDeltas[trigger]) {\r\n            triggerPainDeltas[trigger] = { count: 0, deltaSum: 0 };\r\n          }\r\n          triggerPainDeltas[trigger].count++;\r\n          triggerPainDeltas[trigger].deltaSum += delta;\r\n        });\r\n      }\r\n    });\r\n\r\n    Object.keys(timePatterns).forEach(period => {\r\n      const p = period as keyof typeof timePatterns;\r\n      if (timePatterns[p].count > 0) {\r\n        timePatterns[p].avgIntensity /= timePatterns[p].count;\r\n      }\r\n    });\r\n\r\n    const dayOfWeekSummary: DayOfWeekPattern[] = Object.entries(dayOfWeekPatterns).map(\r\n      ([day, data]) => ({\r\n        day: Number(day),\r\n        count: data.count,\r\n        avgPain: data.count > 0 ? data.totalPain / data.count : 0,\r\n      })\r\n    );\r\n\r\n    const monthlyTrend: MonthlyTrendPoint[] = Object.entries(monthlyTrendBuckets)\r\n      .map(([month, data]) => ({\r\n        month: Number(month),\r\n        count: data.count,\r\n        avgPain: data.count > 0 ? data.totalPain / data.count : 0,\r\n      }))\r\n      .sort((a, b) => a.month - b.month);\r\n\r\n    const triggerPainCorrelation: TriggerPainCorrelation[] = Object.entries(triggerPainDeltas)\r\n      .map(([trigger, data]) => ({\r\n        trigger,\r\n        count: data.count,\r\n        avgDelta: data.deltaSum / data.count,\r\n      }))\r\n      .sort((a, b) => Math.abs(b.avgDelta) - Math.abs(a.avgDelta))\r\n      .slice(0, 8);\r\n\r\n    // Medication effectiveness (if tracked)\r\n    const sortedForSequential = [...filteredEntries].sort(\r\n      (a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\r\n    );\r\n    const medicationData: Record<string, { uses: number; totalReduction: number }> = {};\r\n    sortedForSequential.forEach((entry, idx) => {\r\n      if (\r\n        entry.medications &&\r\n        entry.medications.current.length > 0 &&\r\n        idx < sortedForSequential.length - 1\r\n      ) {\r\n        const nextEntry = sortedForSequential[idx + 1];\r\n        const reduction = entry.baselineData.pain - nextEntry.baselineData.pain;\r\n        if (!Number.isFinite(reduction) || reduction <= 0) return;\r\n        const hour = new Date(entry.timestamp).getHours();\r\n        const windowInfo = getWindowForHour(hour);\r\n\r\n        if (!medicationTimingBuckets[windowInfo.id]) {\r\n          medicationTimingBuckets[windowInfo.id] = {\r\n            count: 0,\r\n            totalReduction: 0,\r\n            label: windowInfo.label,\r\n          };\r\n        }\r\n        medicationTimingBuckets[windowInfo.id].count++;\r\n        medicationTimingBuckets[windowInfo.id].totalReduction += reduction;\r\n\r\n        // Only attribute reduction to a specific medication when it was logged alone.\r\n        // If multiple meds are taken together, a single next-entry change can't be attributed.\r\n        if (entry.medications.current.length === 1) {\r\n          const med = entry.medications.current[0];\r\n          if (med?.name) {\r\n            if (!medicationData[med.name]) {\r\n              medicationData[med.name] = { uses: 0, totalReduction: 0 };\r\n            }\r\n            medicationData[med.name].uses++;\r\n            medicationData[med.name].totalReduction += reduction;\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    const medicationEffectiveness: MedicationEffectStat[] = Object.entries(medicationData)\r\n      .map(([medication, data]) => {\r\n        const avgReduction = data.totalReduction / data.uses;\r\n        // A lightweight, non-clinical visualization score derived from observed pain score changes.\r\n        // This is intentionally NOT a % effective claim.\r\n        const effectiveness = clamp((avgReduction / 3) * 100, 0, 100);\r\n        return {\r\n          medication,\r\n          uses: data.uses,\r\n          avgReduction,\r\n          effectiveness,\r\n        };\r\n      })\r\n      .sort((a, b) => b.effectiveness - a.effectiveness);\r\n\r\n    const medicationTimingInsights: MedicationWindowInsight[] = Object.entries(\r\n      medicationTimingBuckets\r\n    )\r\n      .map(([id, data]) => ({\r\n        id,\r\n        label: data.label,\r\n        avgReduction: data.totalReduction / data.count,\r\n        confidence: Math.min(1, data.count / 4),\r\n        count: data.count,\r\n      }))\r\n      .filter(entry => entry.avgReduction > 0)\r\n      .sort((a, b) => b.avgReduction - a.avgReduction);\r\n\r\n    const optimalMedicationWindow = medicationTimingInsights[0] ?? null;\r\n\r\n    // Flare prediction (simple heuristic)\r\n    const recentEntries = filteredEntries.slice(-7); // Last 7 entries\r\n    const recentAvg =\r\n      recentEntries.reduce((sum, e) => sum + e.baselineData.pain, 0) / recentEntries.length;\r\n    const isIncreasing = recentEntries\r\n      .slice(-3)\r\n      .every((e, i, arr) => i === 0 || e.baselineData.pain >= arr[i - 1].baselineData.pain);\r\n\r\n    const predictedFlare: PredictedFlare | null =\r\n      recentAvg > 6 && isIncreasing\r\n        ? {\r\n            probability: Math.min(95, Math.round((recentAvg / 10) * 100)),\r\n            timeframe: '24-48 hours',\r\n            severity: recentAvg > 8 ? 'high' : 'moderate',\r\n            recommendations: [\r\n              'Consider preventive medication',\r\n              'Reduce strenuous activities',\r\n              'Ensure adequate rest',\r\n              'Monitor trigger exposure',\r\n            ],\r\n          }\r\n        : null;\r\n\r\n    // Risk score (0-100)\r\n    const riskScore = Math.min(\r\n      100,\r\n      Math.round(\r\n        avgPain * 10 +\r\n          volatility * 5 +\r\n          (badDays / daysWithEntries) * 30 +\r\n          (isIncreasing ? 20 : 0)\r\n      )\r\n    );\r\n\r\n    // Improvement score (0-100)\r\n    const improvementScore = Math.max(\r\n      0,\r\n      Math.min(\r\n        100,\r\n        Math.round(\r\n          100 -\r\n            avgPain * 10 -\r\n            (trend > 0 ? trend : 0) +\r\n            (goodDays / daysWithEntries) * 30 -\r\n            volatility * 5\r\n        )\r\n      )\r\n    );\r\n\r\n    const projectedChange =\r\n      trend > 5 ? 0.8 : trend > 0 ? 0.4 : trend < -5 ? -0.7 : trend < 0 ? -0.3 : 0;\r\n    const projectedAverage = clamp(avgPain + projectedChange, 0, 10);\r\n    const confidence =\r\n      filteredEntries.length >= 40 ? 'high' : filteredEntries.length >= 20 ? 'medium' : 'low';\r\n    const trendDescriptor =\r\n      projectedChange > 0.3 ? 'worsening' : projectedChange < -0.3 ? 'improving' : 'holding steady';\r\n    const nextWeekForecast: NextWeekForecast = {\r\n      projectedAverage,\r\n      change: projectedChange,\r\n      confidence,\r\n      narrative: `Pain levels are ${trendDescriptor} based on the last ${filteredEntries.length} entries.`,\r\n    };\r\n\r\n    const personalizedRecommendations: PersonalizedRecommendation[] = [];\r\n\r\n    if (predictedFlare) {\r\n      personalizedRecommendations.push({\r\n        title: 'Flare alert (pattern-based)',\r\n        detail: `Heuristic estimate ${predictedFlare.probability}% within ${predictedFlare.timeframe}. Consider pacing and preventive care now.`,\r\n        category: 'flare',\r\n        emphasis: predictedFlare.severity === 'high' ? 'high' : 'medium',\r\n      });\r\n    }\r\n\r\n    const toughestDay = [...dayOfWeekSummary]\r\n      .filter(day => day.count > 0)\r\n      .sort((a, b) => b.avgPain - a.avgPain)[0];\r\n\r\n    if (toughestDay && toughestDay.avgPain - avgPain >= 1) {\r\n      personalizedRecommendations.push({\r\n        title: `${DAY_LABELS[toughestDay.day]} pattern`,\r\n        detail: `Average pain ${toughestDay.avgPain.toFixed(1)} on ${DAY_LABELS[toughestDay.day]}. Schedule lighter duties or recovery blocks.`,\r\n        category: 'routine',\r\n        emphasis: 'medium',\r\n      });\r\n    }\r\n\r\n    const aggravatingTrigger = triggerPainCorrelation.find(trigger => trigger.avgDelta > 1);\r\n    if (aggravatingTrigger) {\r\n      personalizedRecommendations.push({\r\n        title: `${aggravatingTrigger.trigger} drives pain`,\r\n        detail: `Pain averages +${aggravatingTrigger.avgDelta.toFixed(1)} when this trigger appears. Create a mitigation plan or log exposure notes.`,\r\n        category: 'trigger',\r\n        emphasis: 'high',\r\n      });\r\n    }\r\n\r\n    const standoutMedication = medicationEffectiveness.find(med => med.avgReduction > 0.5);\r\n    if (standoutMedication) {\r\n      personalizedRecommendations.push({\r\n        title: `${standoutMedication.medication} shows relief`,\r\n        detail: `Average reduction ${standoutMedication.avgReduction.toFixed(1)} points across ${standoutMedication.uses} uses. Remember to document dosing accuracy.`,\r\n        category: 'medication',\r\n        emphasis: 'medium',\r\n      });\r\n    }\r\n\r\n    if (optimalMedicationWindow && optimalMedicationWindow.avgReduction > 0.3) {\r\n      personalizedRecommendations.push({\r\n        title: 'Optimize medication timing',\r\n        detail: `Greatest relief occurs around ${optimalMedicationWindow.label}. Aim to medicate within this window when feasible.`,\r\n        category: 'medication',\r\n        emphasis: 'medium',\r\n      });\r\n    }\r\n\r\n    if (personalizedRecommendations.length === 0) {\r\n      personalizedRecommendations.push({\r\n        title: 'Keep logging for smarter predictions',\r\n        detail:\r\n          'More varied entries (triggers, medication notes, sleep quality) will unlock individualized recommendations.',\r\n        category: 'routine',\r\n        emphasis: 'low',\r\n      });\r\n    }\r\n\r\n    return {\r\n      avgPain,\r\n      trend,\r\n      volatility,\r\n      goodDays,\r\n      badDays,\r\n      topLocations,\r\n      topTriggers,\r\n      topReliefMethods,\r\n      topActivities,\r\n      topQualities,\r\n      stressStats,\r\n      activityLevelStats,\r\n      weatherCount,\r\n      timePatterns,\r\n      dayOfWeekPatterns: dayOfWeekSummary,\r\n      monthlyTrend,\r\n      triggerPainCorrelation,\r\n      medicationEffectiveness,\r\n      predictedFlare,\r\n      riskScore,\r\n      improvementScore,\r\n      optimalMedicationWindow,\r\n      nextWeekForecast,\r\n      personalizedRecommendations,\r\n    };\r\n  }, [filteredEntries]);\r\n\r\n  // Advanced pattern recognition using heuristic engine\r\n  const patternAnalysis = useMemo<PatternAnalysisResult | null>(() => {\r\n    if (filteredEntries.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      return analyzePatterns(filteredEntries);\r\n    } catch (error) {\r\n      console.error('Pattern analysis failed:', error);\r\n      return null;\r\n    }\r\n  }, [filteredEntries]);\r\n\r\n  const reasoningTree = useMemo<ReasoningNode[]>(\r\n    () => buildReasoningTree(analytics, filteredEntries.length),\r\n    [analytics, filteredEntries.length]\r\n  );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <header className=\"border-b bg-card\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n          <div className=\"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <div className=\"h-12 w-12 rounded-lg bg-primary/10 text-primary flex items-center justify-center\">\r\n                <Sparkles className=\"w-7 h-7\" aria-hidden />\r\n              </div>\r\n              <div>\r\n                <h1 className=\"text-3xl font-semibold text-foreground\">Premium Analytics</h1>\r\n                <p className=\"text-muted-foreground mt-1\">\r\n                  Advanced pattern recognition using statistical analysis\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-wrap items-center gap-3\">\r\n              <Button\r\n                variant=\"secondary\"\r\n                size=\"sm\"\r\n                leftIcon={<Share2 className=\"w-4 h-4\" aria-hidden />}\r\n                onClick={() => setView('export')}\r\n              >\r\n                Share\r\n              </Button>\r\n              <Button\r\n                variant=\"default\"\r\n                size=\"sm\"\r\n                leftIcon={<Download className=\"w-4 h-4\" aria-hidden />}\r\n                onClick={() => setView('export')}\r\n              >\r\n                Export\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6 flex flex-wrap gap-2\" aria-label=\"Time range\">\r\n            {[\r\n              { value: '7d', label: '7 days' },\r\n              { value: '30d', label: '30 days' },\r\n              { value: '90d', label: '90 days' },\r\n              { value: '1y', label: '1 year' },\r\n              { value: 'all', label: 'All time' },\r\n            ].map(option => (\r\n              <Button\r\n                key={option.value}\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={timeRange === option.value ? 'secondary' : 'ghost'}\r\n                aria-pressed={timeRange === option.value}\r\n                onClick={() => setTimeRange(option.value as typeof timeRange)}\r\n              >\r\n                {option.label}\r\n              </Button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <nav className=\"sticky top-0 z-40 border-b bg-background/80 backdrop-blur\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex gap-1 overflow-x-auto py-2\" aria-label=\"Analytics sections\">\r\n            {[\r\n              { id: 'overview', label: 'Overview', icon: BarChart3 },\r\n              { id: 'patterns', label: 'Pattern analysis', icon: Waves },\r\n              { id: 'predictions', label: 'Predictions', icon: Brain },\r\n              { id: 'clinical', label: 'Clinical report', icon: Heart },\r\n              { id: 'insights', label: 'AI insights', icon: Sparkles },\r\n              { id: 'export', label: 'Export & share', icon: Download },\r\n            ].map(tab => {\r\n              const Icon = tab.icon;\r\n              const isActive = view === tab.id;\r\n              return (\r\n                <Button\r\n                  key={tab.id}\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant={isActive ? 'secondary' : 'ghost'}\r\n                  aria-current={isActive ? 'page' : undefined}\r\n                  leftIcon={<Icon className=\"w-4 h-4\" aria-hidden />}\r\n                  onClick={() => setView(tab.id as typeof view)}\r\n                  className=\"whitespace-nowrap\"\r\n                >\r\n                  {tab.label}\r\n                </Button>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {view === 'overview' && (\r\n          <OverviewView\r\n            analytics={analytics}\r\n            entries={filteredEntries}\r\n            timeRangeLabel={timeRangeLabel}\r\n          />\r\n        )}\r\n        {view === 'patterns' && (\r\n          <PatternsView\r\n            analytics={analytics}\r\n            entries={filteredEntries}\r\n            timeRangeLabel={timeRangeLabel}\r\n          />\r\n        )}\r\n        {view === 'predictions' && <PredictionsView analytics={analytics} />}\r\n        {view === 'clinical' && (\r\n          <ClinicalReportView analytics={analytics} entries={filteredEntries} />\r\n        )}\r\n        {view === 'insights' && (\r\n          <InsightsView\r\n            analytics={analytics}\r\n            entries={filteredEntries}\r\n            reasoningTree={reasoningTree}\r\n            patternAnalysis={patternAnalysis}\r\n          />\r\n        )}\r\n        {view === 'export' && <ExportView analytics={analytics} entries={filteredEntries} />}\r\n      </main>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Overview View Component\r\nconst OverviewView: React.FC<{\r\n  analytics: AnalyticsSnapshot;\r\n  entries: PainEntry[];\r\n  timeRangeLabel: string;\r\n}> = ({ analytics, entries, timeRangeLabel }) => {\r\n  const [comparisonPreset, setComparisonPreset] = useState<'week-to-week' | 'month-to-month'>(\r\n    'week-to-week'\r\n  );\r\n\r\n  const progressSummary = useMemo(\r\n    () => computePainProgressSinceStart(entries, { windowDays: 14 }),\r\n    [entries]\r\n  );\r\n\r\n  const progressSparkline = useMemo(() => {\r\n    const daily = buildDailyAveragePain(entries);\r\n    return daily.map(point => point.avgPain).slice(-30);\r\n  }, [entries]);\r\n\r\n  const totalDaysWithEntries = useMemo(() => {\r\n    const keys = new Set<string>();\r\n    entries.forEach(entry => {\r\n      const date = new Date(entry.timestamp);\r\n      const year = date.getFullYear();\r\n      const month = String(date.getMonth() + 1).padStart(2, '0');\r\n      const day = String(date.getDate()).padStart(2, '0');\r\n      keys.add(`${year}-${month}-${day}`);\r\n    });\r\n    return keys.size;\r\n  }, [entries]);\r\n\r\n  const goodDaysSubtitle =\r\n    totalDaysWithEntries > 0\r\n      ? `pain  3 (daily avg)  ${((analytics.goodDays / totalDaysWithEntries) * 100).toFixed(0)}% of days`\r\n      : 'pain  3 (daily avg)  No days yet';\r\n\r\n  const getIntensityBadgeVariant = (intensity: number) => {\r\n    if (intensity >= 7) return 'destructive' as const;\r\n    if (intensity >= 5) return 'warning' as const;\r\n    if (intensity >= 3) return 'info' as const;\r\n    return 'success' as const;\r\n  };\r\n\r\n  const getEffectivenessBadgeVariant = (effectiveness: number) => {\r\n    if (effectiveness > 50) return 'success' as const;\r\n    if (effectiveness > 20) return 'warning' as const;\r\n    return 'destructive' as const;\r\n  };\r\n\r\n  const getEffectivenessBarClassName = (effectiveness: number) => {\r\n    if (effectiveness > 50) return 'bg-success';\r\n    if (effectiveness > 20) return 'bg-warning';\r\n    return 'bg-destructive';\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Key Metrics Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n        <MetricCard\r\n          title=\"Average Pain Level\"\r\n          value={analytics.avgPain.toFixed(1)}\r\n          subtitle={`out of 10  ${timeRangeLabel}`}\r\n          trend={analytics.trend}\r\n          icon={Activity}\r\n          color=\"blue\"\r\n        />\r\n\r\n        <MetricCard\r\n          title=\"Pain Volatility\"\r\n          value={analytics.volatility.toFixed(1)}\r\n          subtitle=\"standard deviation\"\r\n          icon={Waves}\r\n          color=\"purple\"\r\n        />\r\n\r\n        <MetricCard\r\n          title=\"Good Days\"\r\n          value={analytics.goodDays.toString()}\r\n          subtitle={goodDaysSubtitle}\r\n          icon={CheckCircle}\r\n          color=\"green\"\r\n        />\r\n\r\n        <MetricCard\r\n          title=\"Pain Burden Score\"\r\n          value={analytics.riskScore.toString()}\r\n          subtitle={`0100 (heuristic; higher = more burden)  ${timeRangeLabel}`}\r\n          icon={AlertTriangle}\r\n          color={analytics.riskScore > 70 ? 'red' : analytics.riskScore > 40 ? 'yellow' : 'green'}\r\n        />\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-start justify-between gap-4 w-full\">\r\n            <div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <TrendingDown className=\"w-5 h-5 text-primary\" aria-hidden />\r\n                <CardTitle className=\"text-lg\">Progress since starting</CardTitle>\r\n              </div>\r\n              <CardDescription>\r\n                Compares your first 2 weeks of logs to your most recent 2 weeks.\r\n              </CardDescription>\r\n            </div>\r\n            {progressSummary ? (\r\n              <Badge\r\n                variant={\r\n                  progressSummary.direction === 'improving'\r\n                    ? 'success'\r\n                    : progressSummary.direction === 'worsening'\r\n                      ? 'destructive'\r\n                      : 'secondary'\r\n                }\r\n                title=\"This is a simple estimate based on daily averages. It may shift as you log more days.\"\r\n              >\r\n                {progressSummary.direction === 'improving'\r\n                  ? 'Improving'\r\n                  : progressSummary.direction === 'worsening'\r\n                    ? 'Worsening'\r\n                    : 'Stable'}\r\n              </Badge>\r\n            ) : null}\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          {!progressSummary ? (\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Keep logging for a bit longer to see a \"since starting\" progress estimate.\r\n            </p>\r\n          ) : (\r\n            <>\r\n              <div className=\"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3\">\r\n                <div>\r\n                  <p className=\"text-sm text-muted-foreground\">Estimated change</p>\r\n                  <p className=\"text-2xl font-semibold text-foreground\">\r\n                    {progressSummary.percentImproved >= 0 ? 'You\\'ve improved ' : 'Pain has increased '}\r\n                    {Math.min(100, Math.abs(progressSummary.percentImproved)).toFixed(0)}%\r\n                  </p>\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Baseline avg {progressSummary.baselineAvgPain.toFixed(1)}  Recent avg{' '}\r\n                    {progressSummary.recentAvgPain.toFixed(1)} (010)\r\n                  </p>\r\n                </div>\r\n\r\n                {progressSparkline.length > 1 ? (\r\n                  <div className=\"h-10 w-full sm:w-56\" aria-hidden>\r\n                    <svg\r\n                      width=\"100%\"\r\n                      height=\"100%\"\r\n                      viewBox=\"0 0 100 40\"\r\n                      preserveAspectRatio=\"none\"\r\n                      className=\"overflow-visible\"\r\n                    >\r\n                      <polyline\r\n                        fill=\"none\"\r\n                        stroke=\"currentColor\"\r\n                        className={\r\n                          progressSummary.direction === 'improving'\r\n                            ? 'text-success'\r\n                            : progressSummary.direction === 'worsening'\r\n                              ? 'text-destructive'\r\n                              : 'text-muted-foreground'\r\n                        }\r\n                        strokeWidth=\"2\"\r\n                        strokeLinecap=\"round\"\r\n                        strokeLinejoin=\"round\"\r\n                        points={(() => {\r\n                          const values = progressSparkline;\r\n                          const max = Math.max(...values);\r\n                          const min = Math.min(...values);\r\n                          const range = max - min || 1;\r\n                          return values\r\n                            .map((val, i) => {\r\n                              const x = (i / (values.length - 1)) * 100;\r\n                              const y = 40 - ((val - min) / range) * 34 - 3;\r\n                              return `${x},${y}`;\r\n                            })\r\n                            .join(' ');\r\n                        })()}\r\n                      />\r\n                    </svg>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n\r\n              <div className=\"space-y-1 text-sm text-muted-foreground\">\r\n                <p>\r\n                  Baseline window: {progressSummary.baselineDays} logged days  Recent window:{' '}\r\n                  {progressSummary.recentDays} logged days\r\n                </p>\r\n                <p>\r\n                  Tip: This view is meant to be gentle and directional, not a scorecard.\r\n                </p>\r\n              </div>\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-start justify-between gap-4 w-full\">\r\n            <div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Calendar className=\"w-5 h-5 text-primary\" aria-hidden />\r\n                <CardTitle className=\"text-lg\">Quick comparisons</CardTitle>\r\n              </div>\r\n              <CardDescription>\r\n                Compare this week vs last week, or this month vs last month.\r\n              </CardDescription>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={comparisonPreset === 'week-to-week' ? 'secondary' : 'ghost'}\r\n                aria-pressed={comparisonPreset === 'week-to-week'}\r\n                onClick={() => setComparisonPreset('week-to-week')}\r\n              >\r\n                Week\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={comparisonPreset === 'month-to-month' ? 'secondary' : 'ghost'}\r\n                aria-pressed={comparisonPreset === 'month-to-month'}\r\n                onClick={() => setComparisonPreset('month-to-month')}\r\n              >\r\n                Month\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <TimePeriodComparisonComponent\r\n            key={comparisonPreset}\r\n            entries={entries}\r\n            defaultComparisonType={comparisonPreset}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Flare Prediction Alert */}\r\n      {analytics.predictedFlare && (\r\n        <Card variant=\"outlined\" className=\"border-destructive/30 bg-destructive/5\">\r\n          <CardHeader className=\"pb-3\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-destructive/10 text-destructive\">\r\n                  <AlertTriangle className=\"w-6 h-6\" aria-hidden />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-xl\">Flare alert (pattern-based)</CardTitle>\r\n                  <CardDescription>\r\n                    Possible within the next {analytics.predictedFlare.timeframe}\r\n                  </CardDescription>\r\n                </div>\r\n              </div>\r\n              <Badge variant=\"destructive\" className=\"shrink-0\">\r\n                {analytics.predictedFlare.probability}% (heuristic)\r\n              </Badge>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              This alert reflects recent patterns in your logs. It is a heuristic estimate, not a\r\n              clinical diagnosis or medical advice.\r\n            </p>\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-sm font-semibold text-foreground\">Recommended actions</p>\r\n              <ul className=\"space-y-1 text-sm text-muted-foreground\">\r\n                {analytics.predictedFlare.recommendations.map((rec: string, idx: number) => (\r\n                  <li key={idx} className=\"flex items-start gap-2\">\r\n                    <CheckCircle className=\"w-4 h-4 mt-0.5 flex-shrink-0 text-success\" aria-hidden />\r\n                    <span>{rec}</span>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Top Locations & Triggers */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Top Pain Locations */}\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <MapPin className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Most affected areas</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              {analytics.topLocations.map((loc, idx) => (\r\n                <div key={idx} className=\"flex items-center gap-3\">\r\n                  <Badge\r\n                    variant=\"secondary\"\r\n                    className=\"h-8 w-8 justify-center rounded-lg flex-shrink-0\"\r\n                  >\r\n                    {idx + 1}\r\n                  </Badge>\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center justify-between mb-1\">\r\n                      <span className=\"font-medium text-foreground capitalize\">{loc.location}</span>\r\n                      <span className=\"text-sm text-muted-foreground\">{loc.count} times</span>\r\n                    </div>\r\n                    <div className=\"w-full bg-muted rounded-full h-2\">\r\n                      <div\r\n                        className=\"bg-primary h-2 rounded-full transition-all\"\r\n                        style={{ width: `${loc.percentage}%` }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Top Triggers */}\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Zap className=\"w-5 h-5 text-warning\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Common triggers</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              {analytics.topTriggers.length > 0 ? (\r\n                analytics.topTriggers.map((trigger, idx) => (\r\n                  <div key={idx} className=\"flex items-center gap-3\">\r\n                    <Badge\r\n                      variant=\"secondary\"\r\n                      className=\"h-8 w-8 justify-center rounded-lg flex-shrink-0\"\r\n                    >\r\n                      {idx + 1}\r\n                    </Badge>\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center justify-between mb-1\">\r\n                        <span className=\"font-medium text-foreground capitalize\">\r\n                          {trigger.trigger}\r\n                        </span>\r\n                        <span className=\"text-sm text-muted-foreground\">{trigger.count} times</span>\r\n                      </div>\r\n                      <div className=\"w-full bg-muted rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-warning h-2 rounded-full transition-all\"\r\n                          style={{ width: `${trigger.percentage}%` }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                  No triggers tracked yet. Start logging triggers to see patterns.\r\n                </p>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Time of Day Patterns */}\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Clock className=\"w-5 h-5 text-primary\" aria-hidden />\r\n            <CardTitle className=\"text-lg\">Pain patterns by time of day</CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            {Object.entries(analytics.timePatterns).map(([period, data]) => {\r\n              const icons: Record<TimePeriod, typeof Sun> = {\r\n                morning: Sun,\r\n                afternoon: Sun,\r\n                evening: Moon,\r\n                night: Moon,\r\n              };\r\n              const typedPeriod = period as TimePeriod;\r\n              const Icon = icons[typedPeriod];\r\n              const intensity = data.avgIntensity;\r\n              const badgeVariant = getIntensityBadgeVariant(intensity);\r\n\r\n              return (\r\n                <Card key={period} variant=\"filled\" padding=\"sm\" className=\"flex items-start justify-between gap-3\">\r\n                  <div>\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <Icon className=\"w-4 h-4 text-muted-foreground\" aria-hidden />\r\n                      <span className=\"text-sm font-semibold text-foreground capitalize\">{period}</span>\r\n                    </div>\r\n                    <div className=\"text-3xl font-semibold text-foreground\">{data.avgIntensity.toFixed(1)}</div>\r\n                    <div className=\"text-xs text-muted-foreground\">{data.count} entries</div>\r\n                  </div>\r\n                  <Badge variant={badgeVariant} className=\"shrink-0\">\r\n                    {badgeVariant === 'destructive'\r\n                      ? 'High'\r\n                      : badgeVariant === 'warning'\r\n                        ? 'Moderate'\r\n                        : badgeVariant === 'info'\r\n                          ? 'Elevated'\r\n                          : 'Low'}\r\n                  </Badge>\r\n                </Card>\r\n              );\r\n            })}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Medication Effectiveness */}\r\n      {analytics.medicationEffectiveness.length > 0 && (\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Heart className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Observed relief after medication</CardTitle>\r\n            </div>\r\n            <CardDescription>\r\n              Estimated from entries where exactly one medication was logged, using pain score\r\n              change in the next entry (observational).\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3\">\r\n              {analytics.medicationEffectiveness.map((med, idx) => {\r\n                const badgeVariant = getEffectivenessBadgeVariant(med.effectiveness);\r\n                const barClassName = getEffectivenessBarClassName(med.effectiveness);\r\n                const reliefLabel =\r\n                  med.avgReduction > 0 && med.avgReduction < 0.1\r\n                    ? '<0.1'\r\n                    : med.avgReduction.toFixed(1);\r\n                const barWidth =\r\n                  med.effectiveness > 0 && med.effectiveness < 1\r\n                    ? 1\r\n                    : Math.min(100, med.effectiveness);\r\n                return (\r\n                  <Card key={idx} variant=\"filled\" padding=\"sm\">\r\n                    <div className=\"flex items-center justify-between gap-3 mb-2\">\r\n                      <div className=\"min-w-0\">\r\n                        <div className=\"font-medium text-foreground truncate\">{med.medication}</div>\r\n                        <div className=\"text-xs text-muted-foreground\">{med.uses} uses</div>\r\n                      </div>\r\n                      <Badge variant={badgeVariant} className=\"shrink-0\">\r\n                        {reliefLabel} pts\r\n                      </Badge>\r\n                    </div>\r\n\r\n                    <div className=\"w-full bg-muted rounded-full h-3\">\r\n                      <div\r\n                        className={`h-3 rounded-full transition-all ${barClassName}`}\r\n                        style={{ width: `${barWidth}%` }}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"mt-2 text-xs text-muted-foreground\">\r\n                      Avg reduction: {reliefLabel} points\r\n                    </div>\r\n                  </Card>\r\n                );\r\n              })}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Patterns View - Advanced Analytics\r\nconst PatternsView: React.FC<{\r\n  analytics: AnalyticsSnapshot;\r\n  entries: PainEntry[];\r\n  timeRangeLabel: string;\r\n}> = ({ analytics, entries, timeRangeLabel }) => {\r\n  const dayLabels = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n  const monthLabels = [\r\n    'Jan',\r\n    'Feb',\r\n    'Mar',\r\n    'Apr',\r\n    'May',\r\n    'Jun',\r\n    'Jul',\r\n    'Aug',\r\n    'Sep',\r\n    'Oct',\r\n    'Nov',\r\n    'Dec',\r\n  ];\r\n\r\n  const timeOfDayOrder: Array<{\r\n    key: keyof typeof analytics.timePatterns;\r\n    label: string;\r\n    window: string;\r\n    Icon: typeof Sun;\r\n  }> = [\r\n    { key: 'morning', label: 'Morning', window: '5a - 12p', Icon: Sun },\r\n    { key: 'afternoon', label: 'Afternoon', window: '12p - 5p', Icon: Sun },\r\n    { key: 'evening', label: 'Evening', window: '5p - 9p', Icon: Moon },\r\n    { key: 'night', label: 'Night', window: '9p - 5a', Icon: Moon },\r\n  ];\r\n\r\n  const getSeverityBadgeVariant = (value: number) => {\r\n    if (value >= 7) return 'destructive' as const;\r\n    if (value >= 5) return 'warning' as const;\r\n    if (value >= 3) return 'info' as const;\r\n    return 'success' as const;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-6\">\r\n        {/* Time & Day Patterns */}\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <Waves className=\"w-5 h-5 text-primary\" aria-hidden />\r\n                <CardTitle className=\"text-lg\">Time & day patterns</CardTitle>\r\n              </div>\r\n              <Badge variant=\"info\" className=\"shrink-0\">\r\n                Live\r\n              </Badge>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <CardDescription className=\"mb-5\">\r\n              Highlighting when pain is most likely to spike based on your historical entries.\r\n            </CardDescription>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground mb-2\">\r\n                  Time of day\r\n                </h4>\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  {timeOfDayOrder.map(({ key, label, window, Icon }) => {\r\n                    const data = analytics.timePatterns[key];\r\n                    const avg = data && data.count > 0 ? data.avgIntensity : null;\r\n                    const badgeVariant = avg === null ? 'secondary' : getSeverityBadgeVariant(avg);\r\n                    return (\r\n                      <Card\r\n                        key={String(key)}\r\n                        variant=\"filled\"\r\n                        padding=\"sm\"\r\n                        className=\"flex items-center justify-between gap-2\"\r\n                      >\r\n                        <div>\r\n                          <p className=\"text-sm font-semibold text-foreground\">{label}</p>\r\n                          <p className=\"text-xs text-muted-foreground\">{window}</p>\r\n                        </div>\r\n                        <Badge variant={badgeVariant}>\r\n                          {avg === null ? '' : avg.toFixed(1)}\r\n                        </Badge>\r\n                        <Icon className=\"w-4 h-4 text-muted-foreground\" aria-hidden />\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <h4 className=\"text-xs font-semibold uppercase text-muted-foreground mb-2\">\r\n                  Day of week\r\n                </h4>\r\n                <div className=\"grid grid-cols-7 gap-1\">\r\n                  {dayLabels.map((label, idx) => {\r\n                    const data = analytics.dayOfWeekPatterns?.find(d => d.day === idx);\r\n                    const avg = data && data.count > 0 ? data.avgPain : null;\r\n                    const badgeVariant = avg === null ? 'secondary' : getSeverityBadgeVariant(avg);\r\n                    return (\r\n                      <Card\r\n                        key={`${label}-${idx}`}\r\n                        variant=\"filled\"\r\n                        padding=\"sm\"\r\n                        className=\"text-center\"\r\n                      >\r\n                        <div className=\"text-xs font-semibold text-muted-foreground\">{label}</div>\r\n                        <div className=\"mt-2 flex justify-center\">\r\n                          <Badge variant={badgeVariant}>{avg === null ? '' : avg.toFixed(1)}</Badge>\r\n                        </div>\r\n                      </Card>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Trigger Impact Matrix */}\r\n        <Card className=\"xl:col-span-2\">\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <BarChart3 className=\"w-5 h-5 text-primary\" aria-hidden />\r\n                <CardTitle className=\"text-lg\">Trigger impact matrix</CardTitle>\r\n              </div>\r\n              <span\r\n                className=\"text-xs text-muted-foreground\"\r\n                title=\" is computed as: (average pain when this trigger is logged) minus (overall average pain) within the selected time range. Negative values mean lower-than-average pain when the trigger appears. This is observational and may be confounded by when/how you log.\"\r\n              >\r\n                 Pain vs average  {timeRangeLabel}\r\n              </span>\r\n            </div>\r\n            <CardDescription>\r\n              Negative  means lower-than-average pain when the trigger is logged (association, not\r\n              causation).\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n\r\n          {analytics.triggerPainCorrelation && analytics.triggerPainCorrelation.length > 0 ? (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full text-sm\">\r\n                <thead>\r\n                  <tr className=\"text-left text-muted-foreground border-b border-border\">\r\n                    <th className=\"py-2 pr-4 font-medium\">Trigger</th>\r\n                    <th className=\"py-2 pr-4 font-medium\">Observations</th>\r\n                    <th className=\"py-2 pr-4 font-medium\">Avg  Pain</th>\r\n                    <th className=\"py-2 pr-4 font-medium\">Interpretation</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {analytics.triggerPainCorrelation.map(row => {\r\n                    const severity =\r\n                      Math.abs(row.avgDelta) >= 2\r\n                        ? 'strong'\r\n                        : Math.abs(row.avgDelta) >= 1\r\n                          ? 'moderate'\r\n                          : 'mild';\r\n                    const positive = row.avgDelta > 0;\r\n                    return (\r\n                      <tr\r\n                        key={row.trigger}\r\n                        className=\"border-b border-border/60 last:border-0\"\r\n                      >\r\n                        <td className=\"py-3 pr-4 text-foreground capitalize\">\r\n                          {row.trigger}\r\n                        </td>\r\n                        <td className=\"py-3 pr-4 text-muted-foreground\">{row.count}</td>\r\n                        <td className=\"py-3 pr-4\">\r\n                          <Badge variant={positive ? 'destructive' : 'success'}>\r\n                            {positive ? '+' : ''}\r\n                            {row.avgDelta.toFixed(1)}\r\n                          </Badge>\r\n                        </td>\r\n                        <td className=\"py-3 pr-4 text-xs text-muted-foreground\">\r\n                          {positive\r\n                            ? `${severity} association with higher-than-average pain`\r\n                            : `${severity} association with lower-than-average pain`}\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-sm text-muted-foreground\">\r\n              Log triggers alongside your entries to quantify how each factor raises or lowers your\r\n              average pain (within the selected time range).\r\n            </div>\r\n          )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Context signals (optional fields) */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Pill className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Relief methods</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {analytics.topReliefMethods.length > 0 ? (\r\n              <div className=\"space-y-3\">\r\n                {analytics.topReliefMethods.map((item, idx) => (\r\n                  <div key={`${item.trigger}-${idx}`} className=\"flex items-center gap-3\">\r\n                    <Badge variant=\"secondary\" className=\"h-8 w-8 justify-center rounded-lg flex-shrink-0\">\r\n                      {idx + 1}\r\n                    </Badge>\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center justify-between mb-1\">\r\n                        <span className=\"font-medium text-foreground\">{item.trigger}</span>\r\n                        <span className=\"text-sm text-muted-foreground\">{item.count}</span>\r\n                      </div>\r\n                      <div className=\"w-full bg-muted rounded-full h-2\">\r\n                        <div\r\n                          className=\"bg-primary h-2 rounded-full transition-all\"\r\n                          style={{ width: `${Math.min(100, item.percentage)}%` }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Add relief methods to entries to understand what consistently helps.\r\n              </p>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Zap className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Pain quality</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {analytics.topQualities.length > 0 ? (\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {analytics.topQualities.map(item => (\r\n                  <Badge key={item.trigger} variant=\"outline\" className=\"capitalize\">\r\n                    {item.trigger} ({item.count})\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Log pain quality (e.g., sharp, burning) to spot patterns.\r\n              </p>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Activity className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Activities</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {analytics.topActivities.length > 0 ? (\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                {analytics.topActivities.map(item => (\r\n                  <Badge key={item.trigger} variant=\"outline\" className=\"capitalize\">\r\n                    {item.trigger} ({item.count})\r\n                  </Badge>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Log activities to see which ones correlate with flare-ups or relief.\r\n              </p>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Brain className=\"w-5 h-5 text-primary\" aria-hidden />\r\n            <CardTitle className=\"text-lg\">Stress & activity level</CardTitle>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <CardDescription className=\"mb-4\">\r\n            Optional signals that help explain why pain changes day-to-day.\r\n          </CardDescription>\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n            <Card variant=\"filled\" padding=\"sm\" className=\"flex items-center justify-between gap-3\">\r\n              <div>\r\n                <p className=\"text-sm font-semibold text-foreground\">Activity level</p>\r\n                <p\r\n                  className={\r\n                    analytics.activityLevelStats.count > 0\r\n                      ? 'text-xs text-muted-foreground'\r\n                      : 'text-xs font-semibold text-foreground'\r\n                  }\r\n                >\r\n                  {analytics.activityLevelStats.count > 0\r\n                    ? `${analytics.activityLevelStats.count} logs  min ${analytics.activityLevelStats.min}  max ${analytics.activityLevelStats.max}`\r\n                    : 'Not logged yet'}\r\n                </p>\r\n              </div>\r\n              <Badge variant={analytics.activityLevelStats.count > 0 ? getSeverityBadgeVariant(analytics.activityLevelStats.avg) : 'secondary'}>\r\n                {analytics.activityLevelStats.count > 0 ? analytics.activityLevelStats.avg.toFixed(1) : ''}\r\n              </Badge>\r\n            </Card>\r\n\r\n            <Card variant=\"filled\" padding=\"sm\" className=\"flex items-center justify-between gap-3\">\r\n              <div>\r\n                <p className=\"text-sm font-semibold text-foreground\">Stress</p>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {analytics.stressStats.count > 0\r\n                    ? `${analytics.stressStats.count} logs  min ${analytics.stressStats.min}  max ${analytics.stressStats.max}`\r\n                    : 'Not logged yet'}\r\n                </p>\r\n              </div>\r\n              <Badge variant={analytics.stressStats.count > 0 ? getSeverityBadgeVariant(analytics.stressStats.avg) : 'secondary'}>\r\n                {analytics.stressStats.count > 0 ? analytics.stressStats.avg.toFixed(1) : ''}\r\n              </Badge>\r\n            </Card>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Seasonality Insight */}\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-start justify-between gap-4 w-full\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Calendar className=\"w-5 h-5 text-primary\" aria-hidden />\r\n              <CardTitle className=\"text-lg\">Seasonality & cyclical patterns</CardTitle>\r\n            </div>\r\n            <span className=\"text-xs text-muted-foreground\">Based on monthly averages</span>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n\r\n        {analytics.monthlyTrend && analytics.monthlyTrend.length > 0 ? (\r\n          <div className=\"flex flex-wrap gap-3\">\r\n            {monthLabels.map((label, idx) => {\r\n              const monthData = analytics.monthlyTrend.find(m => m.month === idx + 1);\r\n              if (!monthData) {\r\n                return (\r\n                  <div\r\n                    key={label}\r\n                    className=\"px-4 py-2 rounded-full border border-dashed border-border text-muted-foreground text-sm\"\r\n                  >\r\n                    {label}\r\n                  </div>\r\n                );\r\n              }\r\n              const value = monthData.avgPain;\r\n              const badgeVariant = getSeverityBadgeVariant(value);\r\n              return (\r\n                <Badge key={label} variant={badgeVariant} className=\"px-4 py-2\">\r\n                  {label}  {value.toFixed(1)}\r\n                </Badge>\r\n              );\r\n            })}\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-sm text-muted-foreground\">\r\n            Add entries across different months to spot seasonal pain cycles (e.g., winter\r\n            flare-ups, summer relief).\r\n          </p>\r\n        )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Weather correlation */}\r\n      <WeatherCorrelationPanel entries={entries} />\r\n\r\n      {/* Nerve Symptoms Analysis */}\r\n      {entries.length > 0 && (\r\n        <Card padding=\"none\" className=\"overflow-hidden\">\r\n          <NerveSymptoms entries={entries} />\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Predictions View\r\nconst PredictionsView: React.FC<{ analytics: AnalyticsSnapshot }> = ({ analytics }) => {\r\n  const flare = analytics.predictedFlare;\r\n  const forecast = analytics.nextWeekForecast;\r\n  const medicationWindow = analytics.optimalMedicationWindow;\r\n  const recommendations = analytics.personalizedRecommendations || [];\r\n  const medicationLeaders = (analytics.medicationEffectiveness || []).slice(0, 3);\r\n\r\n  const aggravatingTrigger = analytics.triggerPainCorrelation?.find(item => item.avgDelta > 0);\r\n  const stabilizingTrigger = analytics.triggerPainCorrelation\r\n    ?.slice()\r\n    .reverse()\r\n    .find(item => item.avgDelta < 0);\r\n  const toughestDay = analytics.dayOfWeekPatterns\r\n    ?.filter(d => d.count > 0)\r\n    .sort((a, b) => b.avgPain - a.avgPain)[0];\r\n\r\n  const getSeverityBadgeVariant = (value: number) => {\r\n    if (value >= 7) return 'destructive' as const;\r\n    if (value >= 5) return 'warning' as const;\r\n    if (value >= 3) return 'info' as const;\r\n    return 'success' as const;\r\n  };\r\n\r\n  const getConfidenceBadgeVariant = (value?: 'high' | 'medium' | 'low') => {\r\n    if (value === 'high') return 'success' as const;\r\n    if (value === 'medium') return 'warning' as const;\r\n    if (value === 'low') return 'secondary' as const;\r\n    return 'secondary' as const;\r\n  };\r\n\r\n  const getEmphasisBadgeVariant = (value: 'high' | 'medium' | 'low') => {\r\n    if (value === 'high') return 'destructive' as const;\r\n    if (value === 'medium') return 'warning' as const;\r\n    return 'secondary' as const;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <Card\r\n          variant=\"outlined\"\r\n          className={\r\n            flare ? 'border-destructive/30 bg-destructive/5' : 'border-success/30 bg-success/5'\r\n          }\r\n        >\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div>\r\n                <CardDescription className=\"uppercase tracking-wide\">Flare risk</CardDescription>\r\n                <CardTitle className=\"text-2xl mt-1\">\r\n                  {flare ? `${flare.probability}%` : 'Stable'}\r\n                </CardTitle>\r\n              </div>\r\n              <div\r\n                className={`h-12 w-12 rounded-lg flex items-center justify-center ${\r\n                  flare ? 'bg-destructive/10 text-destructive' : 'bg-success/10 text-success'\r\n                }`}\r\n              >\r\n                <AlertTriangle className=\"w-6 h-6\" aria-hidden />\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {flare\r\n                ? `Next ${flare.timeframe}  Severity ${flare.severity}`\r\n                : 'No immediate flare risk detected. Keep logging to maintain accuracy.'}\r\n            </p>\r\n            <div className=\"mt-4\">\r\n              <div className=\"h-2 bg-muted rounded-full overflow-hidden\">\r\n                <div\r\n                  className={`h-full ${flare ? 'bg-destructive' : 'bg-success'}`}\r\n                  style={{ width: `${flare ? flare.probability : 20}%` }}\r\n                />\r\n              </div>\r\n              {flare && (\r\n                <ul className=\"mt-3 text-sm space-y-1 text-muted-foreground list-disc list-inside\">\r\n                  {flare.recommendations.map((rec: string) => (\r\n                    <li key={rec}>{rec}</li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div>\r\n                <CardDescription className=\"uppercase tracking-wide\">7-day outlook</CardDescription>\r\n                <CardTitle className=\"text-2xl mt-1\">\r\n                  {forecast?.projectedAverage?.toFixed(1) ?? ''} / 10\r\n                </CardTitle>\r\n              </div>\r\n              <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-primary/10 text-primary\">\r\n                <Brain className=\"w-6 h-6\" aria-hidden />\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {forecast ? (\r\n                <>\r\n                  {`${forecast.change >= 0 ? '+' : ''}${forecast.change.toFixed(1)} change vs current average  `}\r\n                  <Badge variant={getConfidenceBadgeVariant(forecast.confidence)}>\r\n                    {forecast.confidence} confidence\r\n                  </Badge>\r\n                </>\r\n              ) : (\r\n                'Need more entries to project forward.'\r\n              )}\r\n            </p>\r\n            {forecast?.narrative ? (\r\n              <p className=\"text-sm text-muted-foreground mt-3\">{forecast.narrative}</p>\r\n            ) : null}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div>\r\n                <CardDescription className=\"uppercase tracking-wide\">\r\n                  Optimal medication window\r\n                </CardDescription>\r\n                <CardTitle className=\"text-xl mt-1\">\r\n                  {medicationWindow ? medicationWindow.label : 'Need more data'}\r\n                </CardTitle>\r\n              </div>\r\n              <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-warning/10 text-warning\">\r\n                <Pill className=\"w-6 h-6\" aria-hidden />\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {medicationWindow\r\n                ? `Avg relief ${medicationWindow.avgReduction.toFixed(1)} points across ${medicationWindow.count} documented doses. Confidence ${(medicationWindow.confidence * 100).toFixed(0)}%.`\r\n                : 'Log medication usage alongside pain levels to unlock timing insights.'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <Card className=\"lg:col-span-2\">\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <div>\r\n                <CardDescription className=\"uppercase tracking-wide\">\r\n                  Personalized recommendations\r\n                </CardDescription>\r\n                <CardTitle className=\"text-2xl mt-1\">Next best actions</CardTitle>\r\n              </div>\r\n              <Sparkles className=\"w-6 h-6 text-primary\" aria-hidden />\r\n            </div>\r\n          </CardHeader>\r\n\r\n          <CardContent>\r\n            {recommendations.length === 0 ? (\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                Keep logging detailed entries (triggers, meds, sleep) to unlock personalized\r\n                guidance.\r\n              </p>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                {recommendations.map((rec, idx) => (\r\n                  <Card key={`${rec.title}-${idx}`} variant=\"filled\" padding=\"sm\">\r\n                    <div className=\"flex items-start justify-between gap-3 mb-2\">\r\n                      <div className=\"text-sm font-semibold text-foreground\">{rec.title}</div>\r\n                      <Badge variant={getEmphasisBadgeVariant(rec.emphasis)} className=\"shrink-0\">\r\n                        {rec.category}\r\n                      </Badge>\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground leading-relaxed\">{rec.detail}</p>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div>\r\n              <CardDescription className=\"uppercase tracking-wide\">Supporting signals</CardDescription>\r\n              <CardTitle className=\"text-lg mt-1\">What drives the model</CardTitle>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-5\">\r\n            <div className=\"space-y-3\">\r\n              <Card variant=\"filled\" padding=\"sm\" className=\"flex items-center justify-between gap-2\">\r\n                <div>\r\n                  <p className=\"text-xs text-muted-foreground\">Most sensitive trigger</p>\r\n                  <p className=\"text-sm font-semibold text-foreground\">\r\n                    {aggravatingTrigger ? aggravatingTrigger.trigger : 'Need more data'}\r\n                  </p>\r\n                </div>\r\n                {aggravatingTrigger ? (\r\n                  <Badge variant=\"destructive\">+{aggravatingTrigger.avgDelta.toFixed(1)}</Badge>\r\n                ) : null}\r\n              </Card>\r\n\r\n              <Card variant=\"filled\" padding=\"sm\" className=\"flex items-center justify-between gap-2\">\r\n                <div>\r\n                  <p className=\"text-xs text-muted-foreground\">Most stable trigger</p>\r\n                  <p className=\"text-sm font-semibold text-foreground\">\r\n                    {stabilizingTrigger ? stabilizingTrigger.trigger : 'Logging needed'}\r\n                  </p>\r\n                </div>\r\n                {stabilizingTrigger ? (\r\n                  <Badge variant=\"success\">{stabilizingTrigger.avgDelta.toFixed(1)}</Badge>\r\n                ) : null}\r\n              </Card>\r\n\r\n              <Card variant=\"filled\" padding=\"sm\" className=\"flex items-center justify-between gap-2\">\r\n                <div>\r\n                  <p className=\"text-xs text-muted-foreground\">Peak pain day</p>\r\n                  <p className=\"text-sm font-semibold text-foreground\">\r\n                    {toughestDay ? DAY_LABELS[toughestDay.day] : 'Need weekly coverage'}\r\n                  </p>\r\n                </div>\r\n                {toughestDay ? (\r\n                  <Badge variant={getSeverityBadgeVariant(toughestDay.avgPain)}>\r\n                    {toughestDay.avgPain.toFixed(1)}\r\n                  </Badge>\r\n                ) : null}\r\n              </Card>\r\n            </div>\r\n\r\n            <div>\r\n              <p className=\"text-xs uppercase tracking-wide text-muted-foreground mb-2\">\r\n                Top relief sources\r\n              </p>\r\n              <div className=\"space-y-2\">\r\n                {medicationLeaders.length === 0 ? (\r\n                  <p className=\"text-sm text-muted-foreground\">\r\n                    Track medication usage to see which options your body responds to best.\r\n                  </p>\r\n                ) : (\r\n                  medicationLeaders.map(med => (\r\n                    <div key={med.medication} className=\"flex items-center justify-between text-sm\">\r\n                      <span className=\"font-medium text-foreground\">{med.medication}</span>\r\n                      <Badge variant=\"success\">-{med.avgReduction.toFixed(1)}</Badge>\r\n                    </div>\r\n                  ))\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Clinical Report View\r\nconst ClinicalReportView: React.FC<{ analytics: AnalyticsSnapshot; entries: PainEntry[] }> = ({\r\n  analytics,\r\n  entries,\r\n}) => {\r\n  const totalEntries = entries.length;\r\n  const sortedEntries = [...entries].sort(\r\n    (a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\r\n  );\r\n  const dateFormatter = (value?: string) =>\r\n    value\r\n      ? new Date(value).toLocaleDateString(undefined, {\r\n          month: 'short',\r\n          day: 'numeric',\r\n          year: 'numeric',\r\n        })\r\n      : '';\r\n  const rangeStart = sortedEntries[0]?.timestamp;\r\n  const rangeEnd = sortedEntries[sortedEntries.length - 1]?.timestamp;\r\n  const latestEntry = sortedEntries[sortedEntries.length - 1];\r\n\r\n  const functionalSummary = entries.reduce(\r\n    (acc, entry) => {\r\n      if (entry.functionalImpact) {\r\n        entry.functionalImpact.limitedActivities?.forEach(item => acc.limitedActivities.add(item));\r\n        entry.functionalImpact.assistanceNeeded?.forEach(item => acc.assistanceNeeded.add(item));\r\n        entry.functionalImpact.mobilityAids?.forEach(item => acc.mobilityAids.add(item));\r\n      }\r\n      if (entry.qualityOfLife) {\r\n        if (typeof entry.qualityOfLife.sleepQuality === 'number') {\r\n          acc.sleepTotal += entry.qualityOfLife.sleepQuality;\r\n          acc.sleepCount += 1;\r\n        }\r\n        if (typeof entry.qualityOfLife.moodImpact === 'number') {\r\n          acc.moodTotal += entry.qualityOfLife.moodImpact;\r\n          acc.moodCount += 1;\r\n        }\r\n      }\r\n      return acc;\r\n    },\r\n    {\r\n      limitedActivities: new Set<string>(),\r\n      assistanceNeeded: new Set<string>(),\r\n      mobilityAids: new Set<string>(),\r\n      sleepTotal: 0,\r\n      sleepCount: 0,\r\n      moodTotal: 0,\r\n      moodCount: 0,\r\n    }\r\n  );\r\n\r\n  const workSummary = entries.reduce(\r\n    (acc, entry) => {\r\n      if (entry.workImpact) {\r\n        acc.missedDays += entry.workImpact.missedWork ?? 0;\r\n        entry.workImpact.modifiedDuties?.forEach(item => acc.modifiedDuties.add(item));\r\n        entry.workImpact.workLimitations?.forEach(item => acc.workLimitations.add(item));\r\n      }\r\n      return acc;\r\n    },\r\n    {\r\n      missedDays: 0,\r\n      modifiedDuties: new Set<string>(),\r\n      workLimitations: new Set<string>(),\r\n    }\r\n  );\r\n\r\n  const careTeamNotes = analytics.personalizedRecommendations?.slice(0, 3) ?? [];\r\n  const medicationHighlights = analytics.medicationEffectiveness?.slice(0, 3) ?? [];\r\n  const riskLevel =\r\n    analytics.riskScore > 75 ? 'High' : analytics.riskScore > 50 ? 'Elevated' : 'Managed';\r\n\r\n  const summaryBullets = [\r\n    `Average reported pain ${analytics.avgPain.toFixed(1)}/10 with ${analytics.volatility.toFixed(1)} volatility`,\r\n    `${analytics.goodDays} good days (${((analytics.goodDays / Math.max(totalEntries, 1)) * 100).toFixed(0)}% of period)`,\r\n    analytics.predictedFlare\r\n      ? `Flare risk ${analytics.predictedFlare.probability}% in next ${analytics.predictedFlare.timeframe}`\r\n      : 'No imminent flare risk detected',\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4 w-full\">\r\n            <div>\r\n              <CardDescription className=\"text-xs uppercase tracking-[0.2em]\">\r\n                Clinical summary\r\n              </CardDescription>\r\n              <CardTitle className=\"text-2xl mt-2\">Pain management report</CardTitle>\r\n              <p className=\"text-sm text-muted-foreground mt-2\">\r\n                {totalEntries > 0\r\n                  ? `${dateFormatter(rangeStart)}  ${dateFormatter(rangeEnd)} (${totalEntries} entries)`\r\n                  : 'Awaiting entries to generate report.'}\r\n              </p>\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-3\">\r\n              <Card variant=\"filled\" padding=\"sm\" className=\"min-w-[140px]\">\r\n                <p className=\"text-xs text-muted-foreground\">Risk level</p>\r\n                <p className=\"font-semibold text-foreground\">{riskLevel}</p>\r\n              </Card>\r\n              <Card variant=\"filled\" padding=\"sm\" className=\"min-w-[140px]\">\r\n                <p className=\"text-xs text-muted-foreground\">Latest entry</p>\r\n                <p className=\"font-semibold text-foreground\">{dateFormatter(latestEntry?.timestamp)}</p>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n        </CardHeader>\r\n      </Card>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-semibold uppercase tracking-wide text-muted-foreground\">\r\n              Pain overview\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n          {summaryBullets.map(bullet => (\r\n            <div key={bullet} className=\"flex items-start gap-3\">\r\n              <div className=\"w-2 h-2 rounded-full bg-primary mt-2\" aria-hidden />\r\n              <p className=\"text-sm text-muted-foreground\">{bullet}</p>\r\n            </div>\r\n          ))}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-semibold uppercase tracking-wide text-muted-foreground\">\r\n              Functional impact\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-2 text-sm text-muted-foreground\">\r\n            <p>\r\n              <span className=\"font-semibold\">Limited Activities:</span>{' '}\r\n              {functionalSummary.limitedActivities.size > 0\r\n                ? Array.from(functionalSummary.limitedActivities).join(', ')\r\n                : 'Not documented'}\r\n            </p>\r\n            <p>\r\n              <span className=\"font-semibold\">Assistance Needed:</span>{' '}\r\n              {functionalSummary.assistanceNeeded.size > 0\r\n                ? Array.from(functionalSummary.assistanceNeeded).join(', ')\r\n                : 'Not documented'}\r\n            </p>\r\n            <p>\r\n              <span className=\"font-semibold\">Mobility Aids:</span>{' '}\r\n              {functionalSummary.mobilityAids.size > 0\r\n                ? Array.from(functionalSummary.mobilityAids).join(', ')\r\n                : 'Not documented'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-3\">\r\n            <CardTitle className=\"text-sm font-semibold uppercase tracking-wide text-muted-foreground\">\r\n              WorkSafe BC readiness\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\r\n            <li>\r\n              <span className=\"font-semibold\">Missed days:</span> {workSummary.missedDays}\r\n            </li>\r\n            <li>\r\n              <span className=\"font-semibold\">Modified duties:</span>{' '}\r\n              {workSummary.modifiedDuties.size > 0\r\n                ? Array.from(workSummary.modifiedDuties).join(', ')\r\n                : 'None recorded'}\r\n            </li>\r\n            <li>\r\n              <span className=\"font-semibold\">Limitations:</span>{' '}\r\n              {workSummary.workLimitations.size > 0\r\n                ? Array.from(workSummary.workLimitations).join(', ')\r\n                : 'None recorded'}\r\n            </li>\r\n            </ul>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start justify-between gap-4 w-full\">\r\n              <CardTitle className=\"text-sm font-semibold uppercase tracking-wide text-muted-foreground\">\r\n                Medication & treatment summary\r\n              </CardTitle>\r\n              <span className=\"text-xs text-muted-foreground\">\r\n                Last documented: {dateFormatter(latestEntry?.timestamp)}\r\n              </span>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n          {medicationHighlights.length === 0 ? (\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Document medication usage along with pain score changes to surface effectiveness\r\n              insights.\r\n            </p>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {medicationHighlights.map(med => (\r\n                <Card key={med.medication} variant=\"filled\" padding=\"sm\">\r\n                  <div className=\"flex items-center justify-between gap-4\">\r\n                  <div>\r\n                    <p className=\"font-semibold text-foreground\">{med.medication}</p>\r\n                    <p className=\"text-xs text-muted-foreground\">{med.uses} entries</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <Badge variant=\"success\">-{med.avgReduction.toFixed(1)}</Badge>\r\n                    <p className=\"text-xs text-muted-foreground mt-1\">Avg pain change</p>\r\n                  </div>\r\n                  </div>\r\n                </Card>\r\n              ))}\r\n            </div>\r\n          )}\r\n          {analytics.optimalMedicationWindow && (\r\n            <Card\r\n              variant=\"filled\"\r\n              padding=\"sm\"\r\n              className=\"mt-4 border-primary/20 bg-primary/5\"\r\n            >\r\n              <p className=\"text-sm text-foreground\">\r\n                Optimal timing:{' '}\r\n                <span className=\"font-semibold\">{analytics.optimalMedicationWindow.label}</span> \r\n                Avg relief {analytics.optimalMedicationWindow.avgReduction.toFixed(1)}  Confidence{' '}\r\n                {(analytics.optimalMedicationWindow.confidence * 100).toFixed(0)}%\r\n              </p>\r\n            </Card>\r\n          )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <CardTitle className=\"text-sm font-semibold uppercase tracking-wide text-muted-foreground\">\r\n              Provider notes & next steps\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n          {careTeamNotes.length === 0 ? (\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Log detailed context (triggers, interventions) to unlock provider-ready\r\n              recommendations.\r\n            </p>\r\n          ) : (\r\n            <ol className=\"list-decimal list-inside space-y-3 text-sm text-muted-foreground\">\r\n              {careTeamNotes.map((note, idx) => (\r\n                <li key={`${note.title}-${idx}`}>\r\n                  <p className=\"font-semibold text-foreground\">{note.title}</p>\r\n                  <p className=\"text-muted-foreground\">{note.detail}</p>\r\n                </li>\r\n              ))}\r\n            </ol>\r\n          )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card variant=\"filled\">\r\n        <CardHeader className=\"pb-3\">\r\n          <CardTitle className=\"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground\">\r\n            Supporting evidence\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-muted-foreground\">\r\n          <div>\r\n            <p className=\"text-xs uppercase\">Top pain locations</p>\r\n            <p>\r\n              {analytics.topLocations.length > 0\r\n                ? analytics.topLocations.map(loc => `${loc.location} (${loc.count})`).join(', ')\r\n                : 'Not captured'}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-xs uppercase\">Primary triggers</p>\r\n            <p>\r\n              {analytics.topTriggers.length > 0\r\n                ? analytics.topTriggers\r\n                    .map(trigger => `${trigger.trigger} (${trigger.count})`)\r\n                    .join(', ')\r\n                : 'Not documented'}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-xs uppercase\">Quality-of-life metrics</p>\r\n            <p>\r\n              Sleep avg:{' '}\r\n              {functionalSummary.sleepCount > 0\r\n                ? (functionalSummary.sleepTotal / functionalSummary.sleepCount).toFixed(1)\r\n                : ''}{' '}\r\n               Mood impact avg:{' '}\r\n              {functionalSummary.moodCount > 0\r\n                ? (functionalSummary.moodTotal / functionalSummary.moodCount).toFixed(1)\r\n                : ''}\r\n            </p>\r\n          </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Functional Limitations Analysis */}\r\n      {entries.length > 0 && (\r\n        <Card padding=\"none\" className=\"overflow-hidden\">\r\n          <FunctionalLimitations entries={entries} />\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Insights View - Tree of Thought reasoning\r\nconst InsightsView: React.FC<{\r\n  analytics: AnalyticsSnapshot;\r\n  entries: PainEntry[];\r\n  reasoningTree: ReasoningNode[];\r\n  patternAnalysis: PatternAnalysisResult | null;\r\n}> = ({ analytics, entries, reasoningTree, patternAnalysis }) => {\r\n  const entryConfidence = entries.length >= 60 ? 'high' : entries.length >= 25 ? 'medium' : 'low';\r\n  const latestRecommendation = analytics.personalizedRecommendations[0];\r\n  const confidenceBadgeVariant =\r\n    entryConfidence === 'high' ? 'success' : entryConfidence === 'medium' ? 'warning' : 'destructive';\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <div className=\"flex items-start justify-between gap-4 w-full\">\r\n            <div>\r\n              <CardDescription className=\"text-xs uppercase tracking-[0.3em]\">\r\n                Tree-of-thought reasoning\r\n              </CardDescription>\r\n              <CardTitle className=\"text-2xl mt-2\">How conclusions are formed</CardTitle>\r\n              <p className=\"text-sm text-muted-foreground mt-2\">\r\n                Each branch represents a reasoning step that connects raw entries to clinical\r\n                guidance. Confidence is weighted by data coverage.\r\n              </p>\r\n            </div>\r\n            <Badge variant={confidenceBadgeVariant} className=\"shrink-0\">\r\n              Data confidence: {entryConfidence}\r\n            </Badge>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ReasoningTree nodes={reasoningTree} depth={0} />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        <Card className=\"col-span-2\" variant=\"accented\">\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start gap-3\">\r\n              <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-primary/10 text-primary\">\r\n                <Sparkles className=\"w-6 h-6\" aria-hidden />\r\n              </div>\r\n              <div>\r\n                <CardDescription className=\"text-xs uppercase tracking-[0.4em]\">\r\n                  Highlighted thought\r\n                </CardDescription>\r\n                <CardTitle className=\"text-xl mt-1\">\r\n                  {latestRecommendation ? latestRecommendation.title : 'Keep logging insights'}\r\n                </CardTitle>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              {latestRecommendation\r\n                ? latestRecommendation.detail\r\n                : 'Log triggers, medications, and recovery context to unlock actionable insights.'}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"pb-4\">\r\n            <CardTitle className=\"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground\">\r\n              Coverage snapshot\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3 text-sm text-muted-foreground\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span>Total entries analyzed</span>\r\n              <span className=\"font-semibold text-foreground\">{entries.length}</span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <span>Day-of-week coverage</span>\r\n              <span className=\"font-semibold text-foreground\">\r\n                {analytics.dayOfWeekPatterns.filter(d => d.count > 0).length}/7 days\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <span>Trigger signals tracked</span>\r\n              <span className=\"font-semibold text-foreground\">\r\n                {analytics.triggerPainCorrelation.length}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex items-center justify-between\">\r\n              <span>Medication experiments</span>\r\n              <span className=\"font-semibold text-foreground\">\r\n                {analytics.medicationEffectiveness.length}\r\n              </span>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Advanced Pattern Recognition Results */}\r\n      {patternAnalysis && (\r\n        <div className=\"space-y-6\">\r\n          <Card variant=\"accented\">\r\n            <CardHeader className=\"pb-4\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-primary/10 text-primary\">\r\n                  <Brain className=\"w-6 h-6\" aria-hidden />\r\n                </div>\r\n                <div>\r\n                  <CardTitle className=\"text-xl\">Heuristic pattern recognition</CardTitle>\r\n                  <CardDescription>Advanced analysis powered by local algorithms</CardDescription>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n\r\n            <CardContent>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <Card variant=\"filled\" padding=\"sm\">\r\n                  <p className=\"text-xs uppercase tracking-wider text-muted-foreground\">Trend slope</p>\r\n                  <p className=\"text-2xl font-semibold text-foreground mt-1\">\r\n                    {patternAnalysis.dailyTrend.length > 0\r\n                      ? (\r\n                          patternAnalysis.dailyTrend[patternAnalysis.dailyTrend.length - 1].value -\r\n                          patternAnalysis.dailyTrend[0].value\r\n                        ).toFixed(1)\r\n                      : '0.0'}\r\n                  </p>\r\n                  <p className=\"text-xs text-muted-foreground mt-1\">Recent trend direction</p>\r\n                </Card>\r\n\r\n                <Card variant=\"filled\" padding=\"sm\">\r\n                  <p className=\"text-xs uppercase tracking-wider text-muted-foreground\">\r\n                    Episodes detected\r\n                  </p>\r\n                  <p className=\"text-2xl font-semibold text-foreground mt-1\">\r\n                    {patternAnalysis.episodes.length}\r\n                  </p>\r\n                  <p className=\"text-xs text-muted-foreground mt-1\">Flare patterns identified</p>\r\n                </Card>\r\n\r\n                <Card variant=\"filled\" padding=\"sm\">\r\n                  <p className=\"text-xs uppercase tracking-wider text-muted-foreground\">Data quality</p>\r\n                  <p className=\"text-2xl font-semibold text-foreground mt-1 capitalize\">\r\n                    {patternAnalysis.meta.dataQuality}\r\n                  </p>\r\n                  <p className=\"text-xs text-muted-foreground mt-1\">\r\n                    {patternAnalysis.meta.entryCount} entries analyzed\r\n                  </p>\r\n                </Card>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          {/* Episodes Timeline */}\r\n          {patternAnalysis.episodes.length > 0 && (\r\n            <Card>\r\n              <CardHeader className=\"pb-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <AlertTriangle className=\"w-5 h-5 text-destructive\" aria-hidden />\r\n                  <CardTitle className=\"text-lg\">\r\n                    Pain episodes ({patternAnalysis.episodes.length})\r\n                  </CardTitle>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {patternAnalysis.episodes.slice(0, 5).map((episode, idx) => (\r\n                    <div key={idx} className=\"border-l-4 border-l-destructive pl-4 py-2\">\r\n                      <div className=\"flex items-center justify-between gap-3\">\r\n                        <div>\r\n                          <p className=\"font-semibold text-foreground capitalize\">\r\n                            {episode.severity} severity\r\n                          </p>\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {episode.durationDays} days  Peak: {episode.peakPain.toFixed(1)}/10\r\n                          </p>\r\n                        </div>\r\n                        {episode.recoveryDays !== null && (\r\n                          <div className=\"text-sm text-muted-foreground\">\r\n                            Recovery: {episode.recoveryDays}d\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Trigger Correlations */}\r\n          {patternAnalysis.triggerCorrelations.length > 0 && (\r\n            <Card>\r\n              <CardHeader className=\"pb-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Zap className=\"w-5 h-5 text-warning\" aria-hidden />\r\n                  <CardTitle className=\"text-lg\">Trigger correlations</CardTitle>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-3\">\r\n                  {patternAnalysis.triggerCorrelations.slice(0, 5).map((corr, idx) => (\r\n                    <div key={idx} className=\"flex items-center justify-between gap-3\">\r\n                      <div className=\"flex-1 min-w-0\">\r\n                        <p className=\"font-medium text-foreground truncate\">{corr.label}</p>\r\n                        <p className=\"text-sm text-muted-foreground\">\r\n                          {corr.support} occurrences  {corr.confidence.toFixed(0)}% confidence\r\n                        </p>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Badge variant={corr.deltaPain > 0 ? 'destructive' : 'success'}>\r\n                          {corr.deltaPain > 0 ? '+' : ''}\r\n                          {corr.deltaPain.toFixed(1)}\r\n                        </Badge>\r\n                        <span className=\"text-xs text-muted-foreground capitalize\">{corr.strength}</span>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* QoL Patterns */}\r\n          {patternAnalysis.qolPatterns.length > 0 && (\r\n            <Card>\r\n              <CardHeader className=\"pb-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Heart className=\"w-5 h-5 text-primary\" aria-hidden />\r\n                  <CardTitle className=\"text-lg\">Quality of life insights</CardTitle>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  {patternAnalysis.qolPatterns.map((pattern, idx) => (\r\n                    <Card key={idx} variant=\"filled\" padding=\"sm\">\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        {pattern.metric === 'sleep' && <Moon className=\"w-4 h-4\" aria-hidden />}\r\n                        {pattern.metric === 'mood' && <Sun className=\"w-4 h-4\" aria-hidden />}\r\n                        {pattern.metric === 'activity' && (\r\n                          <Activity className=\"w-4 h-4\" aria-hidden />\r\n                        )}\r\n                        <p className=\"font-semibold text-foreground capitalize\">{pattern.metric}</p>\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">{pattern.description}</p>\r\n                      <p className=\"text-xs text-muted-foreground mt-2 capitalize\">\r\n                        {pattern.correlation} correlation\r\n                      </p>\r\n                    </Card>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          {/* Cautions */}\r\n          {patternAnalysis.meta.cautions.length > 0 && (\r\n            <Card variant=\"outlined\" className=\"border-warning/30 bg-warning/10\" padding=\"sm\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <AlertTriangle className=\"w-5 h-5 text-warning flex-shrink-0 mt-0.5\" aria-hidden />\r\n                <div className=\"flex-1\">\r\n                  <p className=\"font-semibold text-foreground\">Analysis notes</p>\r\n                  <ul className=\"mt-2 space-y-1 text-sm text-muted-foreground\">\r\n                    {patternAnalysis.meta.cautions.map((caution, idx) => (\r\n                      <li key={idx}> {caution}</li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ReasoningTree: React.FC<{ nodes: ReasoningNode[]; depth: number }> = ({ nodes, depth }) => {\r\n  if (!nodes.length) {\r\n    return (\r\n      <div className=\"rounded-xl border border-dashed border-border p-4 text-sm text-muted-foreground\">\r\n        Not enough data yet. Add a few detailed entries to unlock automated reasoning.\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {nodes.map(node => (\r\n        <Card key={node.id} variant=\"filled\" padding=\"sm\">\r\n          <div className=\"flex items-start justify-between gap-3\">\r\n            <div>\r\n              <p className=\"text-xs uppercase tracking-[0.3em] text-muted-foreground\">\r\n                Step {depth + 1}\r\n              </p>\r\n              <h4 className=\"text-lg font-semibold text-foreground mt-1\">{node.title}</h4>\r\n              <p className=\"text-sm text-muted-foreground mt-1\">{node.insight}</p>\r\n              {node.evidence && (\r\n                <p className=\"mt-2 text-xs text-muted-foreground\">Evidence: {node.evidence}</p>\r\n              )}\r\n              {node.action && (\r\n                <p className=\"mt-2 text-sm text-primary font-medium\">Next action: {node.action}</p>\r\n              )}\r\n            </div>\r\n            <Badge\r\n              variant={\r\n                node.confidence === 'high'\r\n                  ? 'success'\r\n                  : node.confidence === 'medium'\r\n                    ? 'warning'\r\n                    : 'destructive'\r\n              }\r\n              className=\"shrink-0\"\r\n            >\r\n              {node.confidence} confidence\r\n            </Badge>\r\n          </div>\r\n\r\n          {node.children && node.children.length > 0 && (\r\n            <div className=\"mt-4 pl-4 border-l-2 border-dashed border-border space-y-4\">\r\n              <ReasoningTree nodes={node.children} depth={depth + 1} />\r\n            </div>\r\n          )}\r\n        </Card>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nconst buildReasoningTree = (analytics: AnalyticsSnapshot, entryCount: number): ReasoningNode[] => {\r\n  if (entryCount === 0) {\r\n    return [\r\n      {\r\n        id: 'empty-state',\r\n        title: 'No evidence yet',\r\n        insight: 'Log at least one pain entry to begin automated reasoning.',\r\n        confidence: 'low',\r\n        action: 'Capture todays pain level and triggers.',\r\n      },\r\n    ];\r\n  }\r\n\r\n  const coverageConfidence: ReasoningNode['confidence'] =\r\n    entryCount >= 60 ? 'high' : entryCount >= 25 ? 'medium' : 'low';\r\n\r\n  const patternNode: ReasoningNode = {\r\n    id: 'patterns',\r\n    title: 'Temporal & trigger patterns',\r\n    insight: `Detected ${analytics.dayOfWeekPatterns.filter(d => d.count > 0).length}/7 day patterns and ${analytics.timePatterns.morning.count + analytics.timePatterns.afternoon.count + analytics.timePatterns.evening.count + analytics.timePatterns.night.count} time-of-day observations.`,\r\n    confidence: coverageConfidence,\r\n    evidence: analytics.triggerPainCorrelation[0]\r\n      ? `${analytics.triggerPainCorrelation[0].trigger} shifts pain by ${analytics.triggerPainCorrelation[0].avgDelta.toFixed(1)}`\r\n      : 'Need more trigger tagging',\r\n    action: analytics.triggerPainCorrelation[0]\r\n      ? `Mitigate ${analytics.triggerPainCorrelation[0].trigger} exposure on ${DAY_LABELS[analytics.dayOfWeekPatterns.sort((a, b) => b.avgPain - a.avgPain)[0]?.day ?? 0]}`\r\n      : 'Log triggers alongside entries for richer pattern detection.',\r\n    children: analytics.dayOfWeekPatterns\r\n      .filter(day => day.count > 0)\r\n      .slice(0, 2)\r\n      .map(day => ({\r\n        id: `day-${day.day}`,\r\n        title: `${DAY_LABELS[day.day]} trend`,\r\n        insight: `Average pain ${day.avgPain.toFixed(1)} with ${day.count} observations`,\r\n        confidence: day.count >= 4 ? 'medium' : 'low',\r\n        action:\r\n          day.avgPain >= analytics.avgPain\r\n            ? 'Prep pacing plan ahead of this day.'\r\n            : 'Consider scheduling recovery work here.',\r\n      })),\r\n  };\r\n\r\n  const riskNode: ReasoningNode = {\r\n    id: 'risk',\r\n    title: 'Risk posture & flare outlook',\r\n    insight: `Risk score ${analytics.riskScore} with ${analytics.badDays} high-pain days.`,\r\n    confidence: analytics.riskScore >= 70 ? 'high' : analytics.riskScore >= 40 ? 'medium' : 'low',\r\n    evidence: analytics.predictedFlare\r\n      ? `Flare probability ${analytics.predictedFlare.probability}% (${analytics.predictedFlare.timeframe})`\r\n      : 'No imminent flare detected',\r\n    action: analytics.predictedFlare\r\n      ? analytics.predictedFlare.recommendations[0]\r\n      : 'Maintain current pacing plan and continue monitoring.',\r\n    children: [\r\n      analytics.optimalMedicationWindow && {\r\n        id: 'med-window',\r\n        title: 'Medication timing',\r\n        insight: `Best relief around ${analytics.optimalMedicationWindow.label}.`,\r\n        confidence: analytics.optimalMedicationWindow.confidence >= 0.75 ? 'high' : 'medium',\r\n        action: 'Align doses with this window when medically appropriate.',\r\n      },\r\n      analytics.medicationEffectiveness[0] && {\r\n        id: 'med-effectiveness',\r\n        title: `${analytics.medicationEffectiveness[0].medication} response`,\r\n        insight: `Avg reduction ${analytics.medicationEffectiveness[0].avgReduction.toFixed(1)} points.`,\r\n        confidence: analytics.medicationEffectiveness[0].uses >= 3 ? 'high' : 'medium',\r\n        action: 'Document dosage notes for provider review.',\r\n      },\r\n    ].filter(Boolean) as ReasoningNode[],\r\n  };\r\n\r\n  const clinicalNode: ReasoningNode = {\r\n    id: 'clinical',\r\n    title: 'Clinical + WorkSafe readiness',\r\n    insight: `${analytics.goodDays} managed days vs ${analytics.badDays} tough days.`,\r\n    confidence: coverageConfidence,\r\n    evidence: `Top locations: ${\r\n      analytics.topLocations\r\n        .slice(0, 2)\r\n        .map(loc => loc.location)\r\n        .join(', ') || 'N/A'\r\n    }`,\r\n    action: 'Use export tab to share WorkSafe-ready PDF.',\r\n    children: analytics.personalizedRecommendations.slice(0, 2).map(rec => ({\r\n      id: `rec-${rec.title}`,\r\n      title: rec.title,\r\n      insight: rec.detail,\r\n      confidence: rec.emphasis === 'high' ? 'high' : rec.emphasis === 'medium' ? 'medium' : 'low',\r\n      action:\r\n        rec.category === 'medication'\r\n          ? 'Confirm with care team before adjusting meds.'\r\n          : 'Add notes after acting on this insight.',\r\n    })),\r\n  };\r\n\r\n  return [\r\n    {\r\n      id: 'root',\r\n      title: 'Premium analytics reasoning loop',\r\n      insight: `Analyzed ${entryCount} entries with average pain ${analytics.avgPain.toFixed(1)}/10 and volatility ${analytics.volatility.toFixed(1)}.`,\r\n      confidence: coverageConfidence,\r\n      children: [patternNode, riskNode, clinicalNode],\r\n    },\r\n  ];\r\n};\r\n\r\n// Export View - Full workflow\r\nconst ExportView: React.FC<{ analytics: AnalyticsSnapshot; entries: PainEntry[] }> = ({\r\n  analytics,\r\n  entries,\r\n}) => {\r\n  const [isQuickExporting, setIsQuickExporting] = useState<'csv' | 'json' | null>(null);\r\n  const [quickExportError, setQuickExportError] = useState<string | null>(null);\r\n  const [shareStatus, setShareStatus] = useState<'idle' | 'copied' | 'error'>('idle');\r\n  const [copyErrorMessage, setCopyErrorMessage] = useState<string>(\r\n    'Clipboard unavailable. You can still select this summary and copy it whenever you feel ready to share.'\r\n  );\r\n  const [emailError, setEmailError] = useState<string | null>(null);\r\n  const [showAdvancedModal, setShowAdvancedModal] = useState(false);\r\n  const [showValidationHistory, setShowValidationHistory] = useState(false);\r\n  const [isOffline, setIsOffline] = useState(() => {\r\n    if (typeof navigator === 'undefined') {\r\n      return false;\r\n    }\r\n    return !navigator.onLine;\r\n  });\r\n  const { preferences } = useTraumaInformed();\r\n  const { validationHistory, addValidation, clearHistory } = useEmotionalValidation();\r\n\r\n  const sortedEntries = useMemo(\r\n    () =>\r\n      [...entries].sort(\r\n        (a, b) => new Date(a.timestamp).getTime() - new Date(b.timestamp).getTime()\r\n      ),\r\n    [entries]\r\n  );\r\n\r\n  useEffect(() => {\r\n    setShowValidationHistory(preferences.realTimeValidation);\r\n  }, [preferences.realTimeValidation]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') {\r\n      return;\r\n    }\r\n    const updateStatus = () => {\r\n      if (typeof navigator === 'undefined') {\r\n        setIsOffline(false);\r\n        return;\r\n      }\r\n      setIsOffline(!navigator.onLine);\r\n    };\r\n    window.addEventListener('online', updateStatus);\r\n    window.addEventListener('offline', updateStatus);\r\n    return () => {\r\n      window.removeEventListener('online', updateStatus);\r\n      window.removeEventListener('offline', updateStatus);\r\n    };\r\n  }, []);\r\n\r\n  const validationIsActive = useMemo(\r\n    () => ENABLE_VALIDATION_EXPORT && preferences.realTimeValidation,\r\n    [preferences.realTimeValidation]\r\n  );\r\n\r\n  const rangeLabel = useMemo(() => {\r\n    if (sortedEntries.length === 0) {\r\n      return 'No entries yet';\r\n    }\r\n    const start = new Date(sortedEntries[0].timestamp);\r\n    const end = new Date(sortedEntries[sortedEntries.length - 1].timestamp);\r\n    return `${start.toLocaleDateString()}  ${end.toLocaleDateString()}`;\r\n  }, [sortedEntries]);\r\n\r\n  const rangeSlug = useMemo(() => {\r\n    if (sortedEntries.length === 0) {\r\n      return 'no-data';\r\n    }\r\n    const start = new Date(sortedEntries[0].timestamp).toISOString().split('T')[0];\r\n    const end = new Date(sortedEntries[sortedEntries.length - 1].timestamp)\r\n      .toISOString()\r\n      .split('T')[0];\r\n    return `${start}-to-${end}`;\r\n  }, [sortedEntries]);\r\n\r\n  const riskLevel =\r\n    analytics.riskScore > 75 ? 'High' : analytics.riskScore > 50 ? 'Elevated' : 'Managed';\r\n  const topTriggers =\r\n    analytics.topTriggers\r\n      ?.slice?.(0, 2)\r\n      .map(trigger => trigger.trigger)\r\n      .filter(Boolean)\r\n      .join(', ') || 'Not captured';\r\n  const topLocationsSummary =\r\n    analytics.topLocations\r\n      ?.slice?.(0, 2)\r\n      .map(loc => loc.location)\r\n      .filter(Boolean)\r\n      .join(', ') || 'Not captured';\r\n  const recommendation =\r\n    analytics.personalizedRecommendations?.[0]?.detail ??\r\n    'Keep logging detailed entries (triggers, interventions, medications) to unlock personalized recommendations.';\r\n  const forecastLine = analytics.nextWeekForecast\r\n    ? `${analytics.nextWeekForecast.projectedAverage.toFixed(1)}/10 avg (${analytics.nextWeekForecast.change >= 0 ? '+' : ''}${analytics.nextWeekForecast.change.toFixed(1)} change  confidence ${analytics.nextWeekForecast.confidence})`\r\n    : 'Need more entries to forecast next week.';\r\n\r\n  const shareSummary = useMemo(() => {\r\n    if (sortedEntries.length === 0) {\r\n      return 'No entries logged yet. Capture at least one day of pain data to unlock exportable summaries.';\r\n    }\r\n    return [\r\n      `Pain Tracker clinical snapshot (${rangeLabel}, ${sortedEntries.length} entries)`,\r\n      '',\r\n      ` Avg pain ${analytics.avgPain.toFixed(1)}/10  Volatility ${analytics.volatility.toFixed(1)}`,\r\n      ` Good days ${analytics.goodDays}  Risk level ${riskLevel}`,\r\n      ` Top locations: ${topLocationsSummary}`,\r\n      ` Triggers to watch: ${topTriggers}`,\r\n      ` Forecast: ${forecastLine}`,\r\n      ` Recommendation: ${recommendation}`,\r\n    ].join('\\n');\r\n  }, [\r\n    analytics.avgPain,\r\n    analytics.goodDays,\r\n    analytics.volatility,\r\n    forecastLine,\r\n    rangeLabel,\r\n    recommendation,\r\n    riskLevel,\r\n    sortedEntries.length,\r\n    topLocationsSummary,\r\n    topTriggers,\r\n  ]);\r\n\r\n  const logExportAudit = useCallback(\r\n    async ({\r\n      action,\r\n      actionType = 'export',\r\n      outcome = 'success',\r\n      details = {},\r\n    }: {\r\n      action: string;\r\n      actionType?: AuditActionType;\r\n      outcome?: AuditOutcome;\r\n      details?: Record<string, unknown>;\r\n    }) => {\r\n      try {\r\n        await hipaaComplianceService.logAuditEvent({\r\n          actionType,\r\n          userId: 'local-user',\r\n          userRole: 'patient',\r\n          resourceType: 'PremiumAnalyticsExport',\r\n          outcome,\r\n          details: {\r\n            action,\r\n            timeRange: rangeLabel,\r\n            entryCount: entries.length,\r\n            ...details,\r\n          },\r\n        });\r\n      } catch (error) {\r\n        console.error('HIPAA audit logging failed', error);\r\n      }\r\n    },\r\n    [entries.length, rangeLabel]\r\n  );\r\n\r\n  const handleQuickExport = useCallback(\r\n    async (format: 'csv' | 'json') => {\r\n      if (entries.length === 0) {\r\n        setQuickExportError('Log at least one entry before exporting.');\r\n        await logExportAudit({\r\n          action: 'quick-export',\r\n          outcome: 'failure',\r\n          details: { reason: 'no-entries', format },\r\n        });\r\n        return;\r\n      }\r\n\r\n      setIsQuickExporting(format);\r\n      setQuickExportError(null);\r\n\r\n      try {\r\n        const mod = await import('../../utils/pain-tracker/export');\r\n        const timestamp = new Date().toISOString().split('T')[0];\r\n        const filename = `premium-analytics-${rangeSlug}-${timestamp}.${format === 'csv' ? 'csv' : 'json'}`;\r\n\r\n        if (format === 'csv') {\r\n          const csv = mod.exportToCSV(entries);\r\n          mod.downloadData(csv, filename, 'text/csv;charset=utf-8');\r\n        } else {\r\n          const json = mod.exportToJSON(entries);\r\n          mod.downloadData(json, filename, 'application/json;charset=utf-8');\r\n        }\r\n        await logExportAudit({\r\n          action: 'quick-export',\r\n          details: { format, filename },\r\n        });\r\n      } catch (error) {\r\n        console.error('Quick export failed', error);\r\n        setQuickExportError('Quick export failed. Try the advanced export workspace.');\r\n        await logExportAudit({\r\n          action: 'quick-export',\r\n          outcome: 'failure',\r\n          details: { format, error: error instanceof Error ? error.message : 'unknown-error' },\r\n        });\r\n      } finally {\r\n        setIsQuickExporting(null);\r\n      }\r\n    },\r\n    [entries, logExportAudit, rangeSlug]\r\n  );\r\n\r\n  const handleCopySummary = useCallback(async () => {\r\n    try {\r\n      if (typeof navigator !== 'undefined' && navigator?.clipboard?.writeText) {\r\n        await navigator.clipboard.writeText(shareSummary);\r\n      } else if (typeof document !== 'undefined') {\r\n        const textarea = document.createElement('textarea');\r\n        textarea.value = shareSummary;\r\n        textarea.style.position = 'fixed';\r\n        textarea.style.opacity = '0';\r\n        document.body.appendChild(textarea);\r\n        textarea.focus();\r\n        textarea.select();\r\n        document.execCommand('copy');\r\n        document.body.removeChild(textarea);\r\n      } else {\r\n        throw new Error('Clipboard API unavailable');\r\n      }\r\n      setShareStatus('copied');\r\n      setCopyErrorMessage('');\r\n      await logExportAudit({\r\n        action: 'copy-clinical-summary',\r\n        details: { channel: 'clipboard' },\r\n      });\r\n      setTimeout(() => setShareStatus('idle'), 3000);\r\n    } catch (error) {\r\n      console.error('Clipboard copy failed', error);\r\n      setShareStatus('error');\r\n      setCopyErrorMessage(\r\n        error instanceof Error\r\n          ? error.message\r\n          : 'Clipboard is unavailable. You can still highlight the summary above and copy it manually if and when you choose to share it.'\r\n      );\r\n      await logExportAudit({\r\n        action: 'copy-clinical-summary',\r\n        outcome: 'failure',\r\n        details: {\r\n          error: error instanceof Error ? error.message : 'unknown-error',\r\n          channel: 'clipboard',\r\n        },\r\n      });\r\n    }\r\n  }, [logExportAudit, shareSummary]);\r\n\r\n  const handleOpenAdvancedModal = useCallback(() => {\r\n    setShowAdvancedModal(true);\r\n    logExportAudit({\r\n      action: 'open-advanced-export-workspace',\r\n      actionType: 'access',\r\n      details: { isOffline },\r\n    });\r\n  }, [isOffline, logExportAudit]);\r\n\r\n  const handleEmailShare = useCallback(async () => {\r\n    if (isOffline) {\r\n      setEmailError('Email composer unavailable offline. Try again once you reconnect.');\r\n      await logExportAudit({\r\n        action: 'compose-email-share',\r\n        outcome: 'failure',\r\n        details: { reason: 'offline' },\r\n      });\r\n      return;\r\n    }\r\n    if (typeof window === 'undefined') {\r\n      setEmailError('Email composer unavailable in this environment.');\r\n      await logExportAudit({\r\n        action: 'compose-email-share',\r\n        outcome: 'failure',\r\n        details: { reason: 'no-window' },\r\n      });\r\n      return;\r\n    }\r\n    setEmailError(null);\r\n    const subject = encodeURIComponent('Pain Tracker clinical snapshot');\r\n    const body = encodeURIComponent(shareSummary);\r\n    window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');\r\n    await logExportAudit({\r\n      action: 'compose-email-share',\r\n      details: { channel: 'email' },\r\n    });\r\n  }, [isOffline, logExportAudit, shareSummary]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"space-y-6\">\r\n        {isOffline && (\r\n          <Card\r\n            variant=\"outlined\"\r\n            padding=\"sm\"\r\n            className=\"border-warning/30 bg-warning/10\"\r\n            role=\"status\"\r\n            aria-live=\"polite\"\r\n          >\r\n            <p className=\"text-sm font-semibold text-foreground\">Offline mode detected</p>\r\n            <p className=\"text-sm text-muted-foreground\">\r\n              Quick downloads stay fully local. Email sharing is paused until you're back online,\r\n              and the advanced export workspace will reopen with cached data only.\r\n            </p>\r\n          </Card>\r\n        )}\r\n        <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6\">\r\n          <Card>\r\n            <CardHeader className=\"pb-4\">\r\n              <div className=\"flex items-start justify-between gap-4 w-full\">\r\n                <div>\r\n                  <CardDescription className=\"text-xs uppercase tracking-[0.2em]\">\r\n                    Clinical-grade exports\r\n                  </CardDescription>\r\n                  <CardTitle className=\"text-2xl mt-2\">Share securely with care teams</CardTitle>\r\n                  <p className=\"text-sm text-muted-foreground mt-2\">\r\n                    Generate WorkSafe BC-ready PDFs or quickly download data snapshots without\r\n                    leaving the browser.\r\n                  </p>\r\n                </div>\r\n                <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-primary/10 text-primary\">\r\n                  <FileText className=\"w-6 h-6\" aria-hidden />\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n\r\n            <React.Suspense\r\n              fallback={\r\n                <Card variant=\"filled\" padding=\"sm\" className=\"mt-4\">\r\n                  <p className=\"text-sm text-muted-foreground\">Preparing clinical export tools</p>\r\n                </Card>\r\n              }\r\n            >\r\n              <ClinicalPDFExportButtonLazy entries={entries} className=\"mt-6\" />\r\n            </React.Suspense>\r\n\r\n            <Button\r\n              onClick={handleOpenAdvancedModal}\r\n              variant=\"outline\"\r\n              fullWidth\r\n              className=\"mt-4 border-dashed\"\r\n              leftIcon={<Filter className=\"w-4 h-4\" aria-hidden />}\r\n            >\r\n              Open advanced export workspace\r\n            </Button>\r\n\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-6\">\r\n              <Button\r\n                onClick={() => handleQuickExport('csv')}\r\n                disabled={isQuickExporting !== null}\r\n                loading={isQuickExporting === 'csv'}\r\n                leftIcon={<FileSpreadsheet className=\"w-5 h-5\" aria-hidden />}\r\n              >\r\n                Quick CSV\r\n              </Button>\r\n              <Button\r\n                onClick={() => handleQuickExport('json')}\r\n                disabled={isQuickExporting !== null}\r\n                loading={isQuickExporting === 'json'}\r\n                variant=\"secondary\"\r\n                leftIcon={<FileJson className=\"w-5 h-5\" aria-hidden />}\r\n              >\r\n                Quick JSON\r\n              </Button>\r\n            </div>\r\n\r\n            {quickExportError && (\r\n              <p className=\"mt-3 text-sm text-destructive\" role=\"alert\">\r\n                {quickExportError}\r\n              </p>\r\n            )}\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader className=\"pb-4\">\r\n              <div className=\"flex items-start justify-between gap-4 w-full\">\r\n                <div>\r\n                  <CardDescription className=\"text-xs uppercase tracking-[0.3em]\">\r\n                    Provider snapshot\r\n                  </CardDescription>\r\n                  <CardTitle className=\"text-2xl mt-2\">Copy or email a clinical summary</CardTitle>\r\n                </div>\r\n                <Share2 className=\"w-6 h-6 text-primary\" aria-hidden />\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n\r\n            <textarea\r\n              readOnly\r\n              value={shareSummary}\r\n              className=\"mt-4 w-full min-h-[220px] rounded-2xl border border-border bg-muted/50 text-sm text-foreground p-4 font-mono\"\r\n            />\r\n\r\n            {validationIsActive && (\r\n              <div className=\"mt-4 space-y-3\" aria-live=\"polite\">\r\n                <EmotionalValidation\r\n                  text={shareSummary}\r\n                  isActive={validationIsActive}\r\n                  delay={1200}\r\n                  onValidationGenerated={addValidation}\r\n                />\r\n                {validationHistory.length > 0 && (\r\n                  <Card variant=\"filled\" padding=\"sm\">\r\n                    <div className=\"flex items-center justify-between gap-3\">\r\n                      <span className=\"text-sm font-semibold text-foreground\">\r\n                        Recent validation messages\r\n                      </span>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                          type=\"button\"\r\n                          variant=\"link\"\r\n                          size=\"xs\"\r\n                          onClick={() => setShowValidationHistory(prev => !prev)}\r\n                        >\r\n                          {showValidationHistory ? 'Hide history' : 'Show history'}\r\n                        </Button>\r\n                        <Button type=\"button\" variant=\"ghost\" size=\"xs\" onClick={clearHistory}>\r\n                          Clear\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                    {showValidationHistory && (\r\n                      <div className=\"mt-2\">\r\n                        <ValidationHistory validations={validationHistory} onClear={clearHistory} />\r\n                      </div>\r\n                    )}\r\n                  </Card>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"mt-4 flex flex-wrap gap-3\">\r\n              <Button\r\n                onClick={handleCopySummary}\r\n                variant={shareStatus === 'copied' ? 'success' : 'default'}\r\n                leftIcon={<ClipboardCheck className=\"w-4 h-4\" aria-hidden />}\r\n              >\r\n                {shareStatus === 'copied' ? 'Copied summary' : 'Copy summary'}\r\n              </Button>\r\n              <Button\r\n                onClick={handleEmailShare}\r\n                disabled={isOffline}\r\n                variant=\"outline\"\r\n                leftIcon={<Mail className=\"w-4 h-4\" aria-hidden />}\r\n              >\r\n                Compose secure email\r\n              </Button>\r\n            </div>\r\n\r\n            {shareStatus === 'error' && (\r\n              <p className=\"text-sm text-destructive mt-2\" role=\"alert\">\r\n                {copyErrorMessage ||\r\n                  'Clipboard unavailable. Select the text above and copy manually instead.'}\r\n              </p>\r\n            )}\r\n            {emailError && (\r\n              <p className=\"text-sm text-warning mt-2\" role=\"alert\">\r\n                {emailError}\r\n              </p>\r\n            )}\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        <Card variant=\"accented\">\r\n          <CardHeader className=\"pb-4\">\r\n            <div className=\"flex items-start gap-3\">\r\n              <div className=\"h-12 w-12 rounded-lg flex items-center justify-center bg-primary/10 text-primary\">\r\n                <Shield className=\"w-6 h-6\" aria-hidden />\r\n              </div>\r\n              <div>\r\n                <CardTitle className=\"text-xl\">Security-first export guarantees</CardTitle>\r\n                <CardDescription>\r\n                  Exports never leave your device unencrypted. You retain full control over every\r\n                  download and share event.\r\n                </CardDescription>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\r\n              <li className=\"flex items-start gap-2\">\r\n                <Lock className=\"w-4 h-4 mt-0.5 flex-shrink-0\" aria-hidden />\r\n                <span>\r\n                  All exports are generated client-side with the same encryption posture as the\r\n                  rest of the app.\r\n                </span>\r\n              </li>\r\n              <li className=\"flex items-start gap-2\">\r\n                <Download className=\"w-4 h-4 mt-0.5 flex-shrink-0\" aria-hidden />\r\n                <span>\r\n                  Audit trails are available through the HIPAA compliance service for every export\r\n                  action.\r\n                </span>\r\n              </li>\r\n              <li className=\"flex items-start gap-2\">\r\n                <Sparkles className=\"w-4 h-4 mt-0.5 flex-shrink-0\" aria-hidden />\r\n                <span>\r\n                  Use trauma-informed sharing prompts to maintain agency during clinical\r\n                  conversations.\r\n                </span>\r\n              </li>\r\n            </ul>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {showAdvancedModal && (\r\n        <React.Suspense\r\n          fallback={\r\n            <div className=\"fixed inset-0 flex items-center justify-center bg-foreground/40 z-50\">\r\n              <Card padding=\"lg\" className=\"max-w-sm w-full\">\r\n                <p className=\"text-sm text-muted-foreground\">Loading export workspace</p>\r\n              </Card>\r\n            </div>\r\n          }\r\n        >\r\n          <DataExportModalLazy\r\n            isOpen={showAdvancedModal}\r\n            onClose={() => setShowAdvancedModal(false)}\r\n            entries={entries}\r\n            title=\"Clinical export workspace\"\r\n          />\r\n        </React.Suspense>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\n// Metric Card Component\r\ninterface MetricCardProps {\r\n  title: string;\r\n  value: string;\r\n  subtitle: string;\r\n  trend?: number;\r\n  icon: React.ComponentType<{ className?: string }>;\r\n  color: 'blue' | 'purple' | 'green' | 'red' | 'yellow';\r\n}\r\n\r\nconst MetricCard: React.FC<MetricCardProps> = ({\r\n  title,\r\n  value,\r\n  subtitle,\r\n  trend,\r\n  icon: Icon,\r\n  color,\r\n}) => {\r\n  const iconToneClassName =\r\n    color === 'red'\r\n      ? 'bg-destructive/10 text-destructive'\r\n      : color === 'yellow'\r\n        ? 'bg-warning/10 text-warning'\r\n        : color === 'green'\r\n          ? 'bg-success/10 text-success'\r\n          : 'bg-primary/10 text-primary';\r\n\r\n  const hasTrend = typeof trend === 'number' && Number.isFinite(trend);\r\n  const trendValue = hasTrend ? trend : 0;\r\n\r\n  const trendBadgeVariant: BadgeProps['variant'] | null = !hasTrend\r\n    ? null\r\n    : trendValue > 0\r\n      ? 'destructive'\r\n      : trendValue < 0\r\n        ? 'success'\r\n        : 'secondary';\r\n\r\n  return (\r\n    <Card hover=\"scale\">\r\n      <CardContent className=\"flex items-start justify-between gap-4\">\r\n        <div>\r\n          <p className=\"text-sm font-medium text-muted-foreground\">{title}</p>\r\n          <div className=\"text-3xl font-semibold text-foreground mt-1\">{value}</div>\r\n          <p className=\"text-sm text-muted-foreground mt-1\">{subtitle}</p>\r\n        </div>\r\n\r\n        <div className=\"flex flex-col items-end gap-3\">\r\n          <div className={`h-12 w-12 rounded-lg flex items-center justify-center ${iconToneClassName}`}>\r\n            <Icon className=\"w-6 h-6\" aria-hidden />\r\n          </div>\r\n          {trendBadgeVariant ? (\r\n            <Badge\r\n              variant={trendBadgeVariant}\r\n              title=\"Trend compares the later half of the selected range to the earlier half. For pain: lower is better.\"\r\n            >\r\n              <span className=\"inline-flex items-center gap-1\">\r\n                {trendValue > 0 ? (\r\n                  <TrendingUp className=\"w-3 h-3\" aria-hidden />\r\n                ) : trendValue < 0 ? (\r\n                  <TrendingDown className=\"w-3 h-3\" aria-hidden />\r\n                ) : null}\r\n                {Math.abs(trendValue).toFixed(1)}%\r\n              </span>\r\n            </Badge>\r\n          ) : null}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n","/**\n * Hook for using emotional validation\n * Separated for Fast Refresh compatibility\n */\n\nimport { useState, useCallback } from 'react';\nimport type { ValidationResponse } from '../services/EmotionalValidationService';\n\nexport function useEmotionalValidation() {\n  const [validationHistory, setValidationHistory] = useState<ValidationResponse[]>([]);\n\n  const addValidation = useCallback((validation: ValidationResponse) => {\n    setValidationHistory(prev => [...prev, validation].slice(-10)); // Keep last 10\n  }, []);\n\n  const clearHistory = useCallback(() => {\n    setValidationHistory([]);\n  }, []);\n\n  return {\n    validationHistory,\n    addValidation,\n    clearHistory,\n  };\n}\n"],"file":"PremiumAnalyticsDashboard-CCJWy35x.js"}