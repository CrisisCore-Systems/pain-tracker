{"version":3,"mappings":"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","names":["window","dataLayer","gtag","ErrorBoundary","Component","constructor","props","super","this","state","hasError","getDerivedStateFromError","error","componentDidCatch","errorInfo","handleRefresh","location","reload","handleGoHome","href","render","fallback","jsxDEV","className","style","background","role","children","border","boxShadow","AlertCircle","fileName","lineNumber","columnNumber","onClick","RefreshCw","Home","borderTop","Heart","colors","THEME_STORAGE_KEY","ThemeContext","createContext","useTheme","context","useContext","Error","ThemeProvider","defaultMode","mode","setModeState","useState","saved","localStorage","getItem","matchMedia","matches","getInitialMode","isTransitioning","setIsTransitioning","transitionTimeoutRef","useRef","hasReducedMotion","setHasReducedMotion","useMemo","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","success","successForeground","warning","warningForeground","info","infoForeground","input","ring","getThemeColors","isDark","updateCSSVariables","useCallback","newMode","root","document","documentElement","setAttribute","classList","add","remove","setMode","current","clearTimeout","setItem","setTimeout","toggleMode","useEffect","mediaQuery","handler","e","addEventListener","removeEventListener","addListener","removeListener","value","isHighContrast","Provider","falsyToString","cx","clsx","cva","base","config","_config_compoundVariants","variants","class","defaultVariants","getVariantClassNames","Object","keys","map","variant","variantProp","defaultVariantProp","variantKey","propsWithoutUndefined","entries","reduce","acc","param","key","getCompoundVariantClassNames","compoundVariants","cvClass","cvClassName","compoundVariantOptions","every","Array","isArray","includes","createClassGroupUtils","classMap","createClassMap","conflictingClassGroups","conflictingClassGroupModifiers","getClassGroupId","classParts","split","length","shift","getGroupRecursive","getGroupIdForArbitraryProperty","getConflictingClassGroupIds","classGroupId","hasPostfixModifier","conflicts","classPartObject","currentClassPart","nextClassPartObject","nextPart","get","classGroupFromNextClassPart","slice","validators","classRest","join","find","validator","arbitraryPropertyRegex","test","arbitraryPropertyClassName","exec","property","substring","indexOf","theme","classGroups","Map","processClassesRecursively","classGroup","forEach","classDefinition","getPart","isThemeGetter","push","path","currentClassPartObject","pathPart","has","set","func","createLruCache","maxCacheSize","cacheSize","cache","previousCache","update","createParseClassName","prefix","experimentalParseClassName","parseClassName","modifiers","postfixModifierPosition","bracketDepth","parenDepth","modifierStart","index","currentCharacter","MODIFIER_SEPARATOR","baseClassNameWithImportantModifier","baseClassName","stripImportantModifier","hasImportantModifier","maybePostfixModifierPosition","fullPrefix","parseClassNameOriginal","startsWith","isExternal","endsWith","createSortModifiers","orderSensitiveModifiers","fromEntries","modifier","sortedModifiers","unsortedModifiers","sort","SPLIT_CLASSES_REGEX","twJoin","argument","resolvedValue","string","arguments","toValue","mix","k","createTailwindMerge","createConfigFirst","createConfigRest","configUtils","cacheGet","cacheSet","functionToCall","previousConfig","createConfigCurrent","sortModifiers","createConfigUtils","tailwindMerge","cachedResult","result","classGroupsInConflict","classNames","trim","originalClassName","variantModifier","modifierId","classId","conflictGroups","i","group","mergeClassList","apply","fromTheme","themeGetter","arbitraryValueRegex","arbitraryVariableRegex","fractionRegex","tshirtUnitRegex","lengthUnitRegex","colorFunctionRegex","shadowRegex","imageRegex","isFraction","isNumber","Number","isNaN","isInteger","isPercent","isTshirtSize","isAny","isLengthOnly","isNever","isShadow","isImage","isAnyNonArbitrary","isArbitraryValue","isArbitraryVariable","isArbitrarySize","getIsArbitraryValue","isLabelSize","isArbitraryLength","isLabelLength","isArbitraryNumber","isLabelNumber","isArbitraryPosition","isLabelPosition","isArbitraryImage","isLabelImage","isArbitraryShadow","isLabelShadow","isArbitraryVariableLength","getIsArbitraryVariable","isArbitraryVariableFamilyName","isLabelFamilyName","isArbitraryVariablePosition","isArbitraryVariableSize","isArbitraryVariableImage","isArbitraryVariableShadow","testLabel","testValue","shouldMatchNoLabel","label","twMerge","themeColor","themeFont","themeText","themeFontWeight","themeTracking","themeLeading","themeBreakpoint","themeContainer","themeSpacing","themeRadius","themeShadow","themeInsetShadow","themeTextShadow","themeDropShadow","themeBlur","themePerspective","themeAspect","themeEase","themeAnimate","scalePositionWithArbitrary","scaleUnambiguousSpacing","scaleInset","scaleGridTemplateColsRows","scaleGridColRowStartAndEnd","span","scaleGridColRowStartOrEnd","scaleGridAutoColsRows","scaleMargin","scaleSizing","scaleColor","scaleBgPosition","position","scaleBgSize","size","scaleGradientStopPosition","scaleRadius","scaleBorderWidth","scaleMaskImagePosition","scaleBlur","scaleRotate","scaleScale","scaleSkew","scaleTranslate","animate","aspect","blur","breakpoint","color","container","ease","font","leading","perspective","radius","shadow","spacing","text","tracking","columns","box","display","sr","float","clear","isolation","object","overflow","overscroll","inset","start","end","top","right","bottom","left","visibility","z","basis","flex","grow","shrink","order","col","row","gap","justify","content","items","baseline","self","p","px","py","ps","pe","pt","pr","pb","pl","m","mx","my","ms","me","mt","mr","mb","ml","w","screen","h","list","placeholder","decoration","indent","align","whitespace","break","wrap","hyphens","bg","repeat","linear","to","radial","conic","from","via","rounded","divide","outline","opacity","mask","closest","farthest","filter","brightness","contrast","grayscale","invert","saturate","sepia","table","caption","transition","duration","delay","backface","rotate","scale","skew","transform","origin","translate","appearance","caret","scheme","cursor","resize","scroll","snap","touch","select","fill","stroke","cn","inputs","buttonVariants","default","ghost","link","gradient","xs","sm","lg","xl","icon","shape","square","pill","circle","Button","React","forwardRef","type","loading","leftIcon","rightIcon","fullWidth","hapticFeedback","longPress","onLongPress","longPressDelay","ripple","disabled","onTouchStart","onTouchEnd","onMouseDown","onMouseUp","ref","isDisabled","longPressTimerRef","rippleTimersRef","isPressed","setIsPressed","isLongPressing","setIsLongPressing","ripples","setRipples","triggerHapticFeedback","navigator","vibrate","handleTouchStart","handleTouchEnd","handleMouseDown","handleMouseUp","handleClick","rect","currentTarget","getBoundingClientRect","x","clientX","y","clientY","id","Date","now","prev","timerId","r","t","width","height","Loader2","displayName","cardVariants","elevated","outlined","filled","accented","padding","none","hover","lift","glow","Card","severity","backgroundColor","CardHeader","CardTitle","CardDescription","CardContent","Input","helperText","startIcon","endIcon","mobileOptimized","inputMode","autoComplete","autoCapitalize","autoCorrect","spellCheck","required","showPassword","setShowPassword","inputId","Math","random","toString","substr","inputType","setInputType","mobileAttributes","baseAttributes","fontSize","getMobileAttributes","baseInputClasses","htmlFor","tabIndex","EyeOff","Eye","badgeVariants","Badge","removable","onRemove","X","loadingVariants","fullScreen","overlay","lines","_","getAssetUrl","replace","brand","pain","mild","moderate","severe","extreme","status","neutral","typography","fonts","sans","mono","logos","wordmark","iconWhite","appIcon","favicon","visual","borderRadius","md","shadows","motion","fast","normal","slow","easing","cssVariables","colorVar","name","computed","getComputedStyle","getPropertyValue","err","prototype","hasOwnProperty","call","rgbStringToRgba","rgbLike","alpha","hexMatch","match","hex","parseInt","numMatch","resolveColor","varName","fallbackHex","cssVal","val","parts","g","b","readCssRgbVar","chartColors","treatment","medication","therapy","lifestyle","analytics","trend","average","prediction","critical","series","getChartColor","palette","colorArray","values","String","getChartColorAlpha","chartJsWithMarker","ChartJS","mapDataset","ds","chartType","datasetIndex","mapped","getDefaultColors","borderWidth","tension","getFillOption","pointBackgroundColor","resolvePointColor","pointBorderColor","borderColor","applyLineChartStyles","defaultColor","defaultColorAlpha","Chart","data","title","summary","responsive","maintainAspectRatio","showLegend","showTitle","scales","plugins","chartData","labels","datasets","options","devicePixelRatio","interaction","intersect","includeInvisible","legend","innerWidth","usePointStyle","pointStyle","tooltip","enabled","titleColor","bodyColor","titleFont","bodyFont","yAlign","callbacks","dataset","idx","dataIndex","seriesLabel","line","parsed","raw","_meta","meta","count","flags","notes","meds","formatMetadata","formattedValue","generateTooltipLabel","zoom","pan","threshold","wheel","pinch","elements","point","hoverRadius","bar","animation","ticks","maxTicksLimit","grid","min","max","y1","srSummary","Bar","Doughnut","Radar","Line","Toast","message","action","customOnDismiss","onDismiss","isVisible","setIsVisible","isExiting","setIsExiting","isMountedRef","dismissTimeoutRef","handleDismiss","timer","getBackgroundColor","CheckCircle","XCircle","Info","getIcon","removeToastById","_registered","register","registerables","zoomPlugin","ToastContext","ToastErrorBoundary","ToastProvider","toasts","setToasts","bottomLeftToasts","setBottomLeftToasts","removeToast","addToast","toastData","newToast","maxToasts","exists","next","addToastToList","clearToasts","addBottomLeftToast","maxBottomToasts","addBottomLeftToastToList","toast","useToast","useToastContext","bottomLeft","custom","dismiss","defaultPreferences","simplifiedMode","showMemoryAids","autoSave","showProgress","showCognitiveLoadIndicators","adaptiveComplexity","reduceMotion","touchTargetSize","confirmationLevel","voiceInput","gentleLanguage","hideDistressingContent","showComfortPrompts","enableContentWarnings","contentWarningLevel","enableCrisisDetection","crisisDetectionSensitivity","showCrisisResources","enableProgressiveDisclosure","defaultDisclosureLevel","adaptiveDisclosure","realTimeValidation","reminderFrequency","TraumaInformedContext","preferences","updatePreferences","useTraumaInformed","allowedKeyPattern","namespaced","ns","secureStorage","fullKey","namespace","decoded","encrypt","decrypt","decryptFn","globalThis","__secureStorageDecrypt","JSON","parse","bytes","stringify","truncated","Blob","safeStringify","maxValueSizeBytes","out","encryptFn","__secureStorageEncrypt","removeItem","safeJSON","GA4Events","getTimeOfDay","hour","getHours","trackGA4Event","eventName","params","enrichedParams","time_of_day","trackDataExported","format","entryCount","entry_count","trackOnboardingCompleted","trackOnboardingSkipped","STORAGE_KEYS","getStoredData","defaultValue","stored","setStoredData","trackUsageEvent","category","metadata","events","event","timestamp","updatedEvents","featureCounts","featureKey","trackExport","recordCount","exportHistory","activity","updated","TraumaInformedProvider","setPreferences","secure","legacy","setProperty","small","medium","large","getTouchSizeValue","contrastClass","body","updates","newPreferences","settingName","settingValue","setting_name","setting_value","trackAccessibilitySettingChanged","DEFAULT_TONE_PREFERENCES","warmth","coachIntensity","allowLightness","medicalTerms","STATE_THRESHOLDS","toneEngine","measurements","detectState","timeSinceFlare","safeEntries","sorted","a","getTime","mostRecent","currentPain","baselineData","intensity","previous","calculatePainTrend","diff","direction","buildContext","painTrend","sleepQuality","selectCopy","copy","states","stateVariation","warm","medical","withTerms","generateInsight","days","cutoff","setDate","getDate","recent","avg","sum","previousCutoff","toFixed","confidence","prevAvg","change","absChange","abs","factors","trackMeasurement","measurement","persistMeasurement","getAcceptanceRate","intent","relevant","metric","getAverageTimeToCalm","db","openDatabase","store","transaction","objectStore","Promise","resolve","reject","request","indexedDB","open","onerror","onsuccess","onupgradeneeded","target","objectStoreNames","contains","createObjectStore","keyPath","autoIncrement","loadMeasurements","tx","getAll","formatNumber","decimals","Infinity","isDate","toIsoString","toISOString","d","arrayBufferToBase64","buffer","Buffer","binary","Uint8Array","byteLength","fromCharCode","btoa","base64ToBytes","base64","buf","ab","byteOffset","atob","ArrayBuffer","charCodeAt","SecurityService","encryptionConfig","privacyConfig","sessionId","masterCryptoKey","masterHmacKey","algorithm","keySize","enableAnalytics","dataRetentionDays","anonymizationLevel","consentRequired","minimumNoiseLevel","_isTestEnvCached","detectTestEnv","generateSessionId","initializeSecurity","isTestEnv","env","process","define_process_env_default","isTest","VITEST","NODE_ENV","arr","crypto","getRandomValues","padStart","logSecurityEvent","level","encryptionAlgorithm","privacyLevel","initializeMasterKey","password","subtle","iterationOverride","salt","saltBytes","pwUtf8","TextEncoder","encode","baseKey","importKey","deriveKey","iterations","hash","hmacBits","deriveBits","generateKey","encryptData","_customKey","v","payload","iv","enc","cipherB64","hmacB64","sign","cipher","hmac","dataLength","decryptData","encryptedData","obj","verify","cipherBuf","decryptedBuf","decrypted","TextDecoder","decode","createSecureStorage","async","encrypted","serialized","finalData","dataSize","retrieve","delete","performSecurityAudit","issues","recommendations","description","remediation","affectedComponents","recentErrors","sampleKey","storage","criticalIssues","highIssues","mediumIssues","score","totalIssues","passed","lastAudit","wrapKey","exportKey","wrapped","unwrapKey","wrappedJson","usages","wrappedBuf","getSecurityEvents","filters","filtered","since","limit","clearSecurityEvents","olderThan","getSecurityStatus","recent24h","recentEvents","lastAuditEvent","encryptionEnabled","masterKeyInitialized","securityService","localDayStart","NaN","parseISO","getFullYear","getMonth","DifferentialPrivacyEngine","epsilon","budgetUsed","addLaplaceNoise","sensitivity","noise","generateLaplaceNoise","u","log","getRemainingBudget","resetBudget","privacyAnalytics","privacyEngine","userConsent","sessionHash","differentialPrivacyEnabled","noiseLevel","minimumAggregationSize","allowedMetrics","generateSessionHash","initializeService","randomData","userAgent","cleanOldEvents","requestConsent","consentGiven","revokeConsent","hasConsent","trackPainEntry","entry","shouldTrack","anonymizedMetadata","painLevel","anonymizePainLevel","hasLocation","locations","hasDescription","timeOfDay","dayOfWeek","getDay","eventType","isAnonymized","addEvent","hasNotes","locationCount","symptomCount","symptoms","pain_level","has_location","has_notes","location_count","symptom_count","trackValidationUsage","validationType","anonymizeString","validation_type","trackGA4Validation","trackProgressView","viewType","view_type","trackGA4Progress","trackDataExport","exportType","generateInsights","painEvents","validationEvents","totalUsers","getUniqueSessionCount","averagePainLevel","calculateAveragePainLevel","commonLocations","getCommonPainLocations","usagePatterns","averageEntriesPerWeek","calculateWeeklyAverage","peakUsageHours","getPeakUsageHours","validationUsageRate","insights","round","commonPainLocations","privacyMetrics","noiseAdded","dataPointsAggregated","privacyBudgetUsed","generatedAt","totalEvents","uniqueSessions","privacyBudgetRemaining","getPrivacyStatus","analyticsEnabled","eventsCollected","clearAnalyticsData","updatePrivacyConfig","newConfig","cutoffDate","initialCount","removed","str","toLowerCase","Set","sevenDayWindowStart","parseDate","frequency","hourCounts","item","HIPAAComplianceService","auditTrails","accessRequests","breachAssessments","static","validateFHIRResource","resource","errors","warnings","resourceType","isValidId","phiCheck","scanForPHI","identifiers","lastUpdated","isValidTimestamp","complianceScore","calculateComplianceScore","isValid","validateFHIRBundle","bundle","overallErrors","resourceResults","validation","resourceId","totalErrors","dataStr","patterns","ssn","phone","email","ipAddress","creditCard","zipCode","pattern","riskLevel","deidentifyData","method","originalData","deidentifiedData","identifiersRemoved","scanResult","identifier","RegExp","escapeRegExp","assign","processedBy","requestDataAccess","requestId","accessRequest","requestDate","approvalStatus","urgency","approvedBy","approvalDate","expirationDate","logAuditEvent","actionType","userId","requesterId","userRole","requesterRole","patientId","outcome","details","emergency","autoApproved","approveAccessRequest","approverInfo","conditions","auditEvent","eventId","riskScore","calculateRiskScore","MAX_AUDIT_TRAILS","flagSuspiciousActivity","getAuditTrail","startDate","endDate","reportBreach","breach","incidentId","breachAssessment","reportedDate","investigationStatus","phiInvolved","patientCount","notificationRequired","authoritiesNotified","getBreachAssessment","generateComplianceReport","period","periodEvents","eventDate","highRiskEvents","suspiciousActivity","generateComplianceRecommendations","calculateOverallComplianceScore","totalAuditEvents","breachReports","reportDate","dataValidations","riskAnalysis","date","errorPenalty","warningPenalty","export","print","read","create","access","login","logout","uniqueUsers","avgRiskScore","hipaaComplianceService","organizationId","privacyOfficer","securityOfficer","complianceOfficer","businessAssociates","policies","technicalSafeguards","accessControl","uniqueUserIdentification","automaticLogoff","encryptionDecryption","auditControls","hardwareSystemsAccess","softwareSystemsAccess","activityReviews","integrity","protectionFromAlteration","protectionFromDestruction","personOrEntityAuthentication","verifyUserIdentity","transmissionSecurity","guardAgainstUnauthorizedAccess","dataIntegrityControls","encryptionStandards","physicalSafeguards","facilityAccessControls","limitPhysicalAccess","workstationAccess","mediaControls","workstationUse","limitedAccess","physicalAttributes","deviceMediaControls","disposalProcedures","reuseProtocols","accountabilityMeasures","dataBackupStorage","administrativeSafeguards","securityManagement","securityOfficerAssigned","managementResponsibilities","workforceTraining","privacyTraining","securityTraining","trainingFrequency","lastCompleted","accessManagement","accessAuthorizationProcedures","accessEstablishmentModification","accessTerminationProcedures","contingencyPlan","dataBackupPlan","disasterRecoveryPlan","emergencyModeOperationPlan","dataRecoveryPlan","businessAssociateContracts","writtenContracts","safeguardRequirements","usePainTrackerStore","devtools","persist","subscribeWithSelector","immer","moodEntries","fibromyalgiaEntries","emergencyData","activityLogs","ui","showWCBReport","showOnboarding","showWalkthrough","showEmpathyDashboard","currentFormSection","reportPeriod","isLoading","crisisDetectionEnabled","scheduledReports","addEntry","entryData","newEntry","floor","functionalImpact","limitedActivities","assistanceNeeded","mobilityAids","medications","changes","effectiveness","treatments","planned","qualityOfLife","moodImpact","socialImpact","workImpact","missedWork","modifiedDuties","workLimitations","comparison","worseningSince","newLimitations","triggers","quality","reliefMethods","activityLevel","weather","sleep","mood","stress","activities","medicationAdherence","catch","updateEntry","findIndex","deleteEntry","addMoodEntry","newMoodEntry","ts","energy","anxiety","hopefulness","selfEfficacy","emotionalClarity","emotionalRegulation","copingStrategies","socialSupport","makeMoodEntry","moodLevel","mood_level","updateMoodEntry","idOrTimestamp","incoming","deleteMoodEntry","addFibromyalgiaEntry","updateFibromyalgiaEntry","deleteFibromyalgiaEntry","setShowWCBReport","show","setShowOnboarding","setShowWalkthrough","setShowEmpathyDashboard","setCurrentFormSection","section","setReportPeriod","setCrisisDetectionEnabled","updateEmergencyData","addActivityLog","logData","newLog","updateActivityLog","setError","setLoading","clearAllData","loadSampleData","getState","s","__vitePreload","samplePainEntries","import","__VITE_PRELOAD__","then","loadChronicPainTestData","chronicPain12MonthPainEntries","chronicPain12MonthMoodEntries","chronicPainDataStats","addScheduledReport","schedule","recipients","auditErrorCount","deleteScheduledReport","updateScheduledReport","runScheduledReport","generatePDFReport","template","templateId","sections","createdAt","lastModified","dateRange","includeCharts","includeRawData","lastRun","runNow","version","migrate","persistedState","fromVersion","act","nextRun","migratePainTrackerState","partialize","selectEntries","ToneContext","ToneProvider","setContext","newContext","getCopy","trackInteraction","accepted","trackTimeToCalm","seconds","forceState","useTone","useAdaptiveCopy","SUBSCRIPTION_PLANS","free","tier","tagline","features","maxPainEntries","maxMoodEntries","maxActivityLogs","maxStorageMB","basicAnalytics","advancedAnalytics","predictiveInsights","customReports","empathyIntelligence","csvExport","jsonExport","pdfReports","wcbReports","clinicalPDFExport","maxExportsPerMonth","healthcareProviderAPI","fhirIntegration","calendarSync","wearableDevices","multiUser","familySharing","caregiverAccess","maxSharedUsers","encryption","twoFactorAuth","auditLogs","hipaaCompliance","soc2Compliance","customDataRetention","supportLevel","responseTime","onboarding","customTraining","aiInsights","automatedReminders","smartSuggestions","patternRecognition","customThemes","customDashboard","customFields","branding","whiteLabel","offlineMode","mobileApp","apiAccess","webhooks","customIntegrations","pricing","monthly","amount","currency","yearly","savings","trial","limits","softLimits","gracePeriodDays","targeting","userType","basic","popular","pro","lifetime","recommended","enterprise","FEATURE_COMPARISON","collaboration","security","support","UPGRADE_PATHS","USAGE_LIMITS","storageMB","warningAt","unit","exportCount","resetMonthly","apiCalls","subscriptionService","subscriptions","billingEvents","createSubscription","billingInterval","plan","currentPeriodStart","currentPeriodEnd","calculatePeriodEnd","isTrial","subscription","generateSubscriptionId","cancelAtPeriodEnd","trialStart","trialEnd","calculateTrialEnd","usage","painEntries","updatedAt","logBillingEvent","subscriptionId","getSubscription","getUserTier","isSubscriptionExpired","checkFeatureAccess","featureName","feature","hasAccess","reason","getMinimumTierForFeature","upgradeRequired","quota","getFeatureQuota","remaining","getNextTier","percentage","featureValue","resetDate","shouldResetMonthly","trackUsage","usageType","upgradeTier","newTier","immediate","currentTier","changeOption","calculateTierChange","fromTier","toTier","scheduledChange","effectiveDate","downgradeTier","cancelSubscription","reactivateSubscription","fromPlan","toPlan","isUpgrade","featuresGained","featuresLost","fromValue","immediateCharge","nextBillingChange","requiresMigration","effectiveImmediately","confirmationRequired","getAnalytics","oneDayAgo","oneWeekAgo","oneMonthAgo","engagementScore","calculateEngagementScore","churnRisk","calculateChurnRisk","dailyActive","weeklyActive","monthlyActive","mostUsedFeatures","entriesCreated","reportsGenerated","insightsViewed","exportsMade","tiers","upgrades","tierOrder","interval","setMonth","setFullYear","daysSinceUpdate","billingEvent","SubscriptionContext","SubscriptionProvider","setSubscription","setCurrentTier","setIsLoading","initialize","uid","sub","refresh","errorMsg","hasFeature","useSubscription","useTierBadge","StartupPromptsContext","useStartupPrompts","StartupPromptsProvider","activePrompt","setActivePrompt","promptQueue","setPromptQueue","dismissedPrompts","setDismissedPrompts","priority","requestPrompt","some","dismissPrompt","canShowPrompt","announceToScreenReader","timeout","liveRegion","getElementById","createElement","appendChild","getAttribute","textContent","FocusManager","saveFocusAndMoveTo","newElement","currentFocus","activeElement","focusStack","focus","restoreFocus","previousFocus","pop","getFocusableElements","focusableSelectors","querySelectorAll","el","hasAttribute","offsetParent","createFocusTrap","focusableElements","firstElement","lastElement","handleKeyDown","shiftKey","preventDefault","useGlobalAccessibility","enableValidation","enableAutoLabeling","announceRouteChanges","targetElement","scrollIntoView","behavior","block","insertBefore","firstChild","setupSkipLinks","setInterval","button","iconHint","querySelector","addMissingAriaLabels","clearInterval","validateInterval","elementsWithRoles","validRoles","tagName","validateARIA","observer","MutationObserver","mutations","mutation","observe","childList","subtree","disconnect","handleGlobalKeyboard","ctrlKey","metaKey","CustomEvent","dispatchEvent","announceMessage","resources","en","translation","fr","es","i18n","use","LanguageDetector","initReactI18next","init","fallbackLng","debug","interpolation","escapeValue","detection","caches","react","useSuspense","PWAManager","installPromptEvent","isInstalled","swRegistration","isInitialized","capabilities","serviceWorker","pushNotifications","backgroundSync","persistentStorage","installPrompt","fullscreen","readyState","getInstance","instance","checkInstallStatus","setupInstallPromptListener","detectCapabilities","registerServiceWorker","initializeOfflineStorage","setupOnlineOfflineListeners","setupPerformanceMonitoring","dispatchCustomEvent","ServiceWorkerRegistration","getCapabilities","offlineStorage","baseUrl","__vite_import_meta_env__","VITE_BASE","pathname","swPath","scope","updateViaCache","newWorker","installing","controller","notifyUpdate","notifyInstalled","handleServiceWorkerMessage","ev","__pwa_sw_ready","__pwa_sw_version","__SW_VERSION","active","postMessage","setupBackgroundSync","monitorServiceWorkerPerformance","__test_registerSW","url","cacheName","stats","cacheHits","cacheMisses","total","hitRatio","totalRequests","showInstallPrompt","prompt","userChoice","isInstallPromptAvailable","standalone","isAppInstalled","handleOnlineStatus","monitorConnectionQuality","isOnline","svc","forceSync","forcSync","reg","sync","connection","updateConnectionInfo","effectiveType","downlink","rtt","saveData","startConnectionQualityTests","onLine","startTime","performance","manifestUrl","fetch","latency","navigation","getEntriesByType","loadTime","loadEventEnd","fetchStart","domContentLoaded","domContentLoadedEventEnd","firstPaint","getFirstPaint","cacheHitRatio","getCacheHitRatio","PerformanceObserver","slowResources","getEntries","transferSize","buffered","ratio","parseFloat","requestNotificationPermission","Notification","permission","requestPermission","subscribeToPushNotifications","applicationServerKey","VITE_VAPID_PUBLIC_KEY","pushManager","subscribe","userVisibleOnly","urlBase64ToUint8Array","scheduleNotification","badge","tag","requireInteraction","updateApp","registration","waiting","detail","base64String","rawData","outputArray","clearCaches","cacheNames","all","getCacheSize","estimate","exportOfflineData","offlineDataExport","exportData","settings","syncQueue","importOfflineData","queueItem","addToSyncQueue","headers","enableHealthDataSync","scheduleHealthReminder","triggerTime","showNotification","getDiagnostics","storageUsage","getStorageUsage","pendingSyncItems","getPendingItemsCount","lastSync","hasServiceWorker","clearPWAData","resetServiceWorker","registrations","getRegistrations","unregister","forceRefresh","checkForUpdates","pwaManager","PWAInstallPrompt","showPrompt","setShowPrompt","isInstalling","setIsInstalling","handleInstallAvailable","handleInstalled","sessionStorage","Smartphone","Sparkles","Download","Wifi","Zap","Bell","benefit","PWAStatusIndicator","setStatus","pendingSync","isSyncing","updateStatus","getSyncStatus","handleOnline","handleOffline","handleSyncUpdate","STORAGE_KEY","NotificationConsentPrompt","consent","setConsent","hasShownToast","dismissPromptRef","handleGrant","AnalyticsConsentPrompt","bottomLeftRef","sodiumInstance","sodiumPromise","getSodium","crypto_pwhash","sodiumModule","n","l","sodium","ready","ensureReady","isEnvelopeString","c","vaultService","sodiumReady","listeners","initialized","logEvent","loadMetadata","emit","onChange","listener","getStatus","setupPassphrase","passphrase","configuredSaltBytes","crypto_pwhash_SALTBYTES","randombytes_buf","opslimit","crypto_pwhash_OPSLIMIT_MODERATE","memlimit","crypto_pwhash_MEMLIMIT_MODERATE","keyLength","crypto_aead_xchacha20poly1305_ietf_KEYBYTES","crypto_pwhash_ALG_ARGON2ID13","verificationHash","crypto_pwhash_str","derivation","to_base64","verification","nonceLength","crypto_aead_xchacha20poly1305_ietf_NPUBBYTES","migrations","applyGlobalHooks","migrateLegacyStorage","unlock","crypto_pwhash_str_verify","from_base64","actual","lock","memzero","isUnlocked","encryptString","assertSodium","msg","TypeError","isBuffer","isView","view","encoder","toBytes","nonceLen","nonce","finalMsg","crypto_aead_xchacha20poly1305_ietf_encrypt","decryptString","plain","crypto_aead_xchacha20poly1305_ietf_decrypt","to_string","encryptBytes","nonceSize","decryptBytes","clearAll","reencrypted","skipped","legacyCompletedAt","plaintext","ciphertext","DEV","__test_vault","setup","getSnapshot","useVaultStatus","useSyncExternalStore","VaultGate","setPassphrase","confirmPassphrase","setConfirmPassphrase","isProcessing","setIsProcessing","passphraseInputRef","showPassphrase","setShowPassphrase","resetForm","handleSetup","handleUnlock","handleResetVault","confirm","isTestModeWindow","__pt_test_mode","isTestModeLS","onSubmit","minLength","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","objectAssign","test1","getOwnPropertyNames","test2","test3","letter","shouldUseNative","source","symbols","toObject","ReactPropTypesSecret_1","Function","bind","printWarning","ReactPropTypesSecret","require$$0","loggedTypeFailures","require$$1","checkPropTypes","typeSpecs","componentName","getStack","typeSpecName","ex","stack","resetWarningCache","checkPropTypes_1","ReactIs","require$$2","require$$3","require$$4","emptyFunctionThatReturnsNull","factoryWithTypeCheckers","isValidElement","throwOnDirectAccess","ITERATOR_SYMBOL","Symbol","iterator","ANONYMOUS","ReactPropTypes","array","createPrimitiveTypeChecker","bigint","bool","number","symbol","any","createChainableTypeChecker","arrayOf","typeChecker","propName","propFullName","PropTypeError","propValue","getPropType","element","elementType","isValidElementType","instanceOf","expectedClass","expectedClassName","node","isNode","objectOf","propType","oneOf","expectedValues","is","valuesString","getPreciseType","oneOfType","arrayOfTypeCheckers","checker","getPostfixForTypeWarning","expectedTypes","checkerResult","expectedType","shapeTypes","invalidValidatorError","exact","allKeys","validate","manualPropTypeCallCache","manualPropTypeWarningCount","checkType","isRequired","secret","console","cacheKey","chainedCheckType","iteratorFn","maybeIterable","getIteratorFn","step","done","isSymbol","PropTypes","propTypesModule","exports","isElement","candidateSelectors","candidateSelector","NoElement","Element","msMatchesSelector","webkitMatchesSelector","getRootNode","ownerDocument","getCandidates","includeContainer","candidates","unshift","getCandidatesIteratively","elementsToCheck","assigned","assignedElements","nestedCandidates","flatten","shadowRoot","getShadowRoot","validShadowRoot","shadowRootFilter","_nestedCandidates","getTabindex","isScope","isContentEditable","sortOrderedTabbables","documentOrder","isInput","isNonTabbableRadio","isRadio","radioSet","radioScope","form","queryRadios","CSS","escape","checked","nodes","getCheckedRadio","isTabbableRadio","isZeroArea","_node$getBoundingClie","isNodeMatchingSelectorFocusable","isHiddenInput","_ref","displayCheck","nodeUnderDetails","parentElement","nodeRootHost","host","nodeIsAttached","originalNode","rootNode","assignedSlot","getClientRects","isHidden","child","isDetailsWithSummary","parentNode","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","isValidShadowRootTabbable","shadowHostNode","sortByOrder","regularTabbables","orderedTabbables","candidateTabindex","sortable","concat","tabbable","focusable","isTabbable","focusableCandidateSelector","isFocusable","ownKeys","enumerableOnly","sym","getOwnPropertyDescriptor","enumerable","_objectSpread2","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","configurable","writable","activeFocusTraps","trapQueue","activateTrap","trap","activeTrap","pause","trapIndex","splice","deactivateTrap","unpause","fn","valueOrHandler","_len","_key","getActualTarget","composedPath","userOptions","doc","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","containers","containerGroups","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","paused","delayInitialFocusTimer","getOption","configOverrideOptions","optionName","configOptionName","findContainerIndex","tabbableNodes","getNodeForOption","optionValue","_len2","_key2","getInitialFocusNode","firstTabbableGroup","firstTabbableNode","updateTabbableNodes","tabbableOptions","focusableNodes","lastTabbableNode","nextTabbableNode","forward","nodeIdx","reverse","tryFocus","preventScroll","isSelectableInput","getReturnFocusNode","previousActiveElement","checkPointerDown","clickOutsideDeactivates","deactivate","returnFocus","allowOutsideClick","checkFocusIn","targetContained","Document","stopImmediatePropagation","checkKey","keyCode","isEscapeEvent","isTabEvent","destinationNode","containerIndex","containerGroup","startOfGroupIndex","_ref2","destinationGroupIndex","lastOfGroupIndex","_ref3","_destinationGroupIndex","checkTab","checkClick","addListeners","capture","passive","removeListeners","activate","activateOptions","onActivate","onPostActivate","checkCanFocusTrap","finishActivation","deactivateOptions","onDeactivate","onPostDeactivate","checkCanReturnFocus","finishDeactivation","updateContainerElements","containerElements","elementsAsArray","Boolean","_typeof","_createClass","Constructor","protoProps","staticProps","descriptor","_defineProperties","_setPrototypeOf","o","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","valueOf","_isNativeReflectConstruct","Super","_getPrototypeOf","NewTarget","_assertThisInitialized","_possibleConstructorReturn","ReferenceError","getPrototypeOf","FocusTrap","_React$Component","subClass","superClass","_inherits","_super","_this","_classCallCheck","_this$internalOptions","internalOptions","originalOptions","_this$getDocument","getDocument","handleDeactivate","handlePostDeactivate","handleClickOutsideDeactivates","focusTrapOptions","outsideClick","focusTrapElements","updatePreviousElement","previouslyFocusedElement","currentDocument","focusTrap","allowDeactivation","_this2","returnFocusNode","canReturnFocus","_this2$internalOption","_createFocusTrap","setupFocusTrap","prevProps","hasActivated","hasDeactivated","hasPaused","hasUnpaused","_this3","Children","only","Fragment","cloneElement","ElementType","propTypes","initialFocus","fallbackFocus","setReturnFocus","defaultProps","focusTrapReact","saveAlert","rec","curr","loadAlerts","Event","usePatternAlerts","seen","detectors","detectSuddenSpike","windowSize","rollingAverageSpike","mean","std","sqrt","pow","simpleZScoreOutlier","time","OfflineBanner","setIsOnline","CloudOff","BlackBoxSplashScreen","ToneStateTester","toggleVisibility","isInputField","stateIndex","toUpperCase","emoji","isBrowser","detectEnvironment","isDevelopment","vam","inject","_a","va","vaq","beforeSend","src","scriptSrc","basePath","getScriptSrc","head","script","defer","sdkn","framework","sdkv","disableAutoTrack","endpoint","dsn","getBasePath","REACT_APP_VERCEL_OBSERVABILITY_BASEPATH","Analytics","route","pageview","PainTrackerContainer","lazy","LandingPage","PricingPage","ScreenshotShowcase","ClinicPortal","SubscriptionManagementPage","SubmitStoryPage","ErrorFallback","LoadingFallback","App","showSplash","setShowSplash","initializeDeferred","initializeToneEngine","trackSessionStart","requestIdleCallback","initializePWAFeatures","resetPWA","setState","BrowserRouter","Suspense","Routes","Route","Navigate","initialView","URL","searchParams","lsFlag","ReactDOM","createRoot","StrictMode"],"ignoreList":[4,5,57,58,59,60,61,62,63,64,65,71],"sources":["../../src/analytics/analytics-loader.ts","../../src/components/ErrorBoundary.tsx","../../src/design-system/theme.ts","../../src/design-system/ThemeProvider.tsx","../../node_modules/class-variance-authority/dist/index.mjs","../../node_modules/tailwind-merge/dist/bundle-mjs.mjs","../../src/design-system/utils.ts","../../src/design-system/components/Button.tsx","../../src/design-system/components/Card.tsx","../../src/design-system/components/Input.tsx","../../src/design-system/components/Badge.tsx","../../src/design-system/components/Loading.tsx","../../src/design-system/components/Toast.tsx","../../src/design-system/brand.ts","../../src/design-system/utils/theme.ts","../../src/design-system/utils/chart-colors.ts","../../src/design-system/components/Chart.tsx","../../src/components/feedback/Toast.tsx","../../src/components/feedback/toastHelpers.ts","../../src/components/feedback/toastContext.ts","../../src/components/feedback/ToastProvider.tsx","../../src/components/feedback/useToast.tsx","../../src/components/accessibility/TraumaInformedTypes.ts","../../src/components/accessibility/TraumaInformedHooks.ts","../../src/lib/storage/secureStorage.ts","../../src/analytics/ga4-events.ts","../../src/utils/usage-tracking.ts","../../src/components/accessibility/TraumaInformedContext.tsx","../../src/types/tone.ts","../../src/services/ToneEngine.ts","../../src/utils/formatting.ts","../../src/utils/date-utils.ts","../../src/services/SecurityService.ts","../../src/utils/dates.ts","../../src/services/PrivacyAnalyticsService.ts","../../src/services/HIPAACompliance.ts","../../src/stores/pain-tracker-store.ts","../../src/utils/mood-entry-factory.ts","../../src/stores/pain-tracker-migrations.ts","../../src/contexts/ToneContext.tsx","../../src/contexts/useTone.ts","../../src/config/subscription-tiers.ts","../../src/services/SubscriptionService.ts","../../src/contexts/SubscriptionContext.tsx","../../src/contexts/StartupPromptsContext.tsx","../../src/utils/accessibility.ts","../../src/hooks/useGlobalAccessibility.ts","../../src/i18n/config.ts","../../src/utils/pwa-utils.ts","../../src/components/pwa/PWAInstallPrompt.tsx","../../src/components/pwa/PWAStatusIndicator.tsx","../../src/components/NotificationConsentPrompt.tsx","../../src/components/AnalyticsConsentPrompt.tsx","../../src/lib/crypto/sodium.ts","../../src/services/VaultService.ts","../../src/hooks/useVault.ts","../../src/components/security/VaultGate.tsx","../../node_modules/object-assign/index.js","../../node_modules/prop-types/lib/ReactPropTypesSecret.js","../../node_modules/prop-types/lib/has.js","../../node_modules/prop-types/checkPropTypes.js","../../node_modules/prop-types/factoryWithTypeCheckers.js","../../node_modules/prop-types/index.js","../../node_modules/tabbable/dist/index.esm.js","../../node_modules/focus-trap/dist/focus-trap.esm.js","../../node_modules/focus-trap-react/dist/focus-trap-react.js","../../src/components/AlertsActivityLog.tsx","../../src/hooks/usePatternAlerts.tsx","../../src/components/pwa/OfflineIndicator.tsx","../../src/components/branding/BlackBoxSplashScreen.tsx","../../src/components/dev/ToneStateTester.tsx","../../node_modules/@vercel/analytics/dist/react/index.mjs","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["/* src/analytics/analytics-loader.ts */\r\n\r\n// Vite exposes env vars as strings. Only enable real analytics when explicitly allowed.\r\nconst enableAnalytics = import.meta.env.VITE_ENABLE_ANALYTICS === 'true';\r\n\r\nif (enableAnalytics) {\r\n  // Load remote Google Tag Manager script from its host when enabled.\r\n  const s = document.createElement('script');\r\n  s.src = 'https://www.googletagmanager.com/gtag/js?id=G-X25RTEWBYL';\r\n  s.async = true;\r\n  document.head.appendChild(s);\r\n\r\n  window.dataLayer = window.dataLayer || [];\r\n  function gtag(...args: unknown[]) { window.dataLayer!.push(args); }\r\n  window.gtag = gtag;\r\n\r\n  // Initialize gtag\r\n  try {\r\n    window.gtag('js', new Date());\r\n    window.gtag('config', 'G-X25RTEWBYL');\r\n  } catch {\r\n    // swallow any runtime error during initialization\r\n  }\r\n} else {\r\n  // Test / preview: provide a no-op implementation so callers won't throw\r\n  window.dataLayer = window.dataLayer || [];\r\n  window.gtag = () => { /* no-op during tests/preview */ };\r\n\r\n  // Do not append the remote script when analytics disabled.\r\n}\r\n\r\nexport {};\r\n","import { Component, ErrorInfo, ReactNode } from 'react';\nimport { AlertCircle, RefreshCw, Home, Heart } from 'lucide-react';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\n/**\n * Trauma-informed error boundary with gentle, supportive messaging.\n * Designed to reduce anxiety when errors occur.\n */\nexport class ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error('ErrorBoundary:', error, errorInfo);\n  }\n\n  handleRefresh = () => {\n    window.location.reload();\n  };\n\n  handleGoHome = () => {\n    window.location.href = '/';\n  };\n\n  render(): ReactNode {\n    if (this.state.hasError) {\n      return (\n        this.props.fallback || (\n          <div \n            className=\"min-h-screen flex items-center justify-center p-4\"\n            style={{ \n              background: 'linear-gradient(135deg, rgba(15, 23, 42, 0.98) 0%, rgba(30, 41, 59, 0.95) 100%)' \n            }}\n            role=\"alert\"\n            aria-live=\"assertive\"\n          >\n            <div \n              className=\"max-w-md w-full text-center p-8 rounded-2xl\"\n              style={{\n                background: 'rgba(30, 41, 59, 0.8)',\n                border: '1px solid rgba(255, 255, 255, 0.1)',\n                boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5)'\n              }}\n            >\n              {/* Gentle icon */}\n              <div \n                className=\"mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-6\"\n                style={{ \n                  background: 'rgba(245, 158, 11, 0.15)',\n                  border: '1px solid rgba(245, 158, 11, 0.3)'\n                }}\n              >\n                <AlertCircle className=\"h-8 w-8 text-amber-400\" aria-hidden=\"true\" />\n              </div>\n\n              {/* Trauma-informed messaging */}\n              <h2 className=\"text-xl font-semibold text-white mb-3\">\n                We hit a small bump\n              </h2>\n              \n              <p className=\"text-slate-400 mb-2\">\n                Something unexpected happened, but your data is safe.\n              </p>\n              \n              <p className=\"text-slate-500 text-sm mb-6\">\n                This isn't your fault. These things happen sometimes, and we're here to help you get back on track.\n              </p>\n\n              {/* Supportive actions */}\n              <div className=\"flex flex-col sm:flex-row gap-3 justify-center\">\n                <button\n                  onClick={this.handleRefresh}\n                  className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium text-white transition-all duration-200 min-h-[44px]\"\n                  style={{\n                    background: 'linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)',\n                    boxShadow: '0 4px 15px rgba(14, 165, 233, 0.3)'\n                  }}\n                >\n                  <RefreshCw className=\"h-4 w-4\" aria-hidden=\"true\" />\n                  Try Again\n                </button>\n                \n                <button\n                  onClick={this.handleGoHome}\n                  className=\"inline-flex items-center justify-center gap-2 px-5 py-2.5 rounded-xl text-sm font-medium text-slate-300 transition-all duration-200 min-h-[44px]\"\n                  style={{\n                    background: 'rgba(51, 65, 85, 0.5)',\n                    border: '1px solid rgba(255, 255, 255, 0.1)'\n                  }}\n                >\n                  <Home className=\"h-4 w-4\" aria-hidden=\"true\" />\n                  Go Home\n                </button>\n              </div>\n\n              {/* Reassurance footer */}\n              <div \n                className=\"mt-6 pt-6 flex items-center justify-center gap-2 text-xs text-slate-500\"\n                style={{ borderTop: '1px solid rgba(255, 255, 255, 0.05)' }}\n              >\n                <Heart className=\"h-3 w-3 text-rose-400\" aria-hidden=\"true\" />\n                <span>Your wellbeing matters to us</span>\n              </div>\n            </div>\n          </div>\n        )\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","/**\n * Design System Theme Configuration\n * Modern design tokens following Material Design 3.0 principles\n */\n\nexport type ThemeMode = 'light' | 'dark' | 'high-contrast' | 'colorblind';\n\n// Lightweight explicit shape for the small set of theme tokens returned by\n// getThemeColors. Using an explicit interface keeps TypeScript happy when\n// consumers access semantic keys like `warning`, `info`, `success`, etc.\nexport interface ThemeColors {\n  background: string;\n  foreground: string;\n  card: string;\n  cardForeground: string;\n  popover: string;\n  popoverForeground: string;\n  primary: string;\n  primaryForeground: string;\n  secondary: string;\n  secondaryForeground: string;\n  muted: string;\n  mutedForeground: string;\n  accent: string;\n  accentForeground: string;\n  destructive: string;\n  destructiveForeground: string;\n  // Semantic helpers used across the app\n  success: string;\n  successForeground: string;\n  warning: string;\n  warningForeground: string;\n  info: string;\n  infoForeground: string;\n  border: string;\n  input: string;\n  ring: string;\n}\n\nexport interface ColorScale {\n  50: string;\n  100: string;\n  200: string;\n  300: string;\n  400: string;\n  500: string;\n  600: string;\n  700: string;\n  800: string;\n  900: string;\n  950: string;\n}\n\nexport interface Colors {\n  primary: ColorScale;\n  secondary: ColorScale;\n  accent: ColorScale;\n  neutral: ColorScale;\n  success: ColorScale;\n  warning: ColorScale;\n  error: ColorScale;\n  info: ColorScale;\n}\n\nexport interface Typography {\n  fontFamily: {\n    sans: string[];\n    mono: string[];\n  };\n  // Allow additional semantic font size keys (e.g. h1, h2, body, caption)\n  fontSize: Record<string, [string, { lineHeight: string }]>;\n  fontWeight: {\n    light: string;\n    normal: string;\n    medium: string;\n    semibold: string;\n    bold: string;\n  };\n}\n\nexport interface Spacing {\n  // Allow arbitrary spacing tokens (including touch-sm/touch-md etc.)\n  [key: string]: string;\n}\n\nexport interface BorderRadius {\n  none: string;\n  sm: string;\n  DEFAULT: string;\n  md: string;\n  lg: string;\n  xl: string;\n  '2xl': string;\n  '3xl': string;\n  full: string;\n}\n\nexport interface Shadows {\n  sm: string;\n  DEFAULT: string;\n  md: string;\n  lg: string;\n  xl: string;\n  '2xl': string;\n  inner: string;\n  none: string;\n}\n\nexport interface Theme {\n  colors: Colors;\n  typography: Typography;\n  spacing: Spacing;\n  borderRadius: BorderRadius;\n  shadows: Shadows;\n  transitions: {\n    duration: {\n      fast: string;\n      normal: string;\n      slow: string;\n    };\n    easing: {\n      easeInOut: string;\n      easeOut: string;\n      easeIn: string;\n    };\n  };\n}\n\n// Modern color palette with accessibility in mind\nconst colors: Colors = {\n  primary: {\n    50: '#eff6ff',\n    100: '#dbeafe',\n    200: '#bfdbfe',\n    300: '#93c5fd',\n    400: '#60a5fa',\n    500: '#3b82f6',\n    600: '#2563eb',\n    700: '#1d4ed8',\n    800: '#1e40af',\n    900: '#1e3a8a',\n    950: '#172554',\n  },\n  secondary: {\n    50: '#f8fafc',\n    100: '#f1f5f9',\n    200: '#e2e8f0',\n    300: '#cbd5e1',\n    400: '#94a3b8',\n    500: '#64748b',\n    600: '#475569',\n    700: '#334155',\n    800: '#1e293b',\n    900: '#0f172a',\n    950: '#020617',\n  },\n  accent: {\n    50: '#fdf4ff',\n    100: '#fae8ff',\n    200: '#f5d0fe',\n    300: '#f0abfc',\n    400: '#e879f9',\n    500: '#d946ef',\n    600: '#c026d3',\n    700: '#a21caf',\n    800: '#86198f',\n    900: '#701a75',\n    950: '#4a044e',\n  },\n  neutral: {\n    50: '#fafafa',\n    100: '#f5f5f5',\n    200: '#e5e5e5',\n    300: '#d4d4d4',\n    400: '#a3a3a3',\n    500: '#737373',\n    600: '#525252',\n    700: '#404040',\n    800: '#262626',\n    900: '#171717',\n    950: '#0a0a0a',\n  },\n  success: {\n    50: '#f0fdf4',\n    100: '#dcfce7',\n    200: '#bbf7d0',\n    300: '#86efac',\n    400: '#4ade80',\n    500: '#22c55e',\n    600: '#16a34a',\n    700: '#15803d',\n    800: '#166534',\n    900: '#14532d',\n    950: '#052e16',\n  },\n  warning: {\n    50: '#fffbeb',\n    100: '#fef3c7',\n    200: '#fde68a',\n    300: '#fcd34d',\n    400: '#fbbf24',\n    500: '#f59e0b',\n    600: '#d97706',\n    700: '#b45309',\n    800: '#92400e',\n    900: '#78350f',\n    950: '#451a03',\n  },\n  error: {\n    50: '#fef2f2',\n    100: '#fee2e2',\n    200: '#fecaca',\n    300: '#fca5a5',\n    400: '#f87171',\n    500: '#ef4444',\n    600: '#dc2626',\n    700: '#b91c1c',\n    800: '#991b1b',\n    900: '#7f1d1d',\n    950: '#450a0a',\n  },\n  info: {\n    50: '#ecfeff',\n    100: '#cffafe',\n    200: '#a5f3fc',\n    300: '#67e8f9',\n    400: '#22d3ee',\n    500: '#06b6d4',\n    600: '#0891b2',\n    700: '#0e7490',\n    800: '#155e75',\n    900: '#164e63',\n    950: '#083344',\n  },\n};\n\nconst typography: Typography = {\n  fontFamily: {\n    sans: [\n      'Inter',\n      '-apple-system',\n      'BlinkMacSystemFont',\n      'Segoe UI',\n      'Roboto',\n      'Oxygen',\n      'Ubuntu',\n      'Cantarell',\n      'Fira Sans',\n      'Droid Sans',\n      'Helvetica Neue',\n      'sans-serif',\n    ],\n    mono: [\n      'Fira Code',\n      'JetBrains Mono',\n      'Monaco',\n      'Cascadia Code',\n      'Segoe UI Mono',\n      'Roboto Mono',\n      'Oxygen Mono',\n      'Ubuntu Monospace',\n      'Source Code Pro',\n      'Fira Mono',\n      'Droid Sans Mono',\n      'Courier New',\n      'monospace',\n    ],\n  },\n  fontSize: {\n    xs: ['0.75rem', { lineHeight: '1rem' }],\n    sm: ['0.875rem', { lineHeight: '1.25rem' }],\n    base: ['1rem', { lineHeight: '1.5rem' }],\n    lg: ['1.125rem', { lineHeight: '1.75rem' }],\n    xl: ['1.25rem', { lineHeight: '1.75rem' }],\n    '2xl': ['1.5rem', { lineHeight: '2rem' }],\n    '3xl': ['1.875rem', { lineHeight: '2.25rem' }],\n    '4xl': ['2.25rem', { lineHeight: '2.5rem' }],\n    '5xl': ['3rem', { lineHeight: '1' }],\n    '6xl': ['3.75rem', { lineHeight: '1' }],\n  },\n  fontWeight: {\n    light: '300',\n    normal: '400',\n    medium: '500',\n    semibold: '600',\n    bold: '700',\n  },\n};\n\nconst spacing: Spacing = {\n  px: '1px',\n  0: '0px',\n  0.5: '0.125rem',\n  1: '0.25rem',\n  1.5: '0.375rem',\n  2: '0.5rem',\n  2.5: '0.625rem',\n  3: '0.75rem',\n  3.5: '0.875rem',\n  4: '1rem',\n  5: '1.25rem',\n  6: '1.5rem',\n  7: '1.75rem',\n  8: '2rem',\n  9: '2.25rem',\n  10: '2.5rem',\n  11: '2.75rem',\n  12: '3rem',\n  14: '3.5rem',\n  16: '4rem',\n  20: '5rem',\n  24: '6rem',\n  28: '7rem',\n  32: '8rem',\n  36: '9rem',\n  40: '10rem',\n  44: '11rem',\n  48: '12rem',\n  52: '13rem',\n  56: '14rem',\n  60: '15rem',\n  64: '16rem',\n  72: '18rem',\n  80: '20rem',\n  96: '24rem',\n};\n\nconst borderRadius: BorderRadius = {\n  none: '0px',\n  sm: '0.125rem',\n  DEFAULT: '0.25rem',\n  md: '0.375rem',\n  lg: '0.5rem',\n  xl: '0.75rem',\n  '2xl': '1rem',\n  '3xl': '1.5rem',\n  full: '9999px',\n};\n\nconst shadows: Shadows = {\n  sm: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n  DEFAULT: '0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1)',\n  md: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)',\n  lg: '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)',\n  xl: '0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)',\n  '2xl': '0 25px 50px -12px rgb(0 0 0 / 0.25)',\n  inner: 'inset 0 2px 4px 0 rgb(0 0 0 / 0.05)',\n  none: '0 0 #0000',\n};\n\nexport const theme: Theme = {\n  colors,\n  typography,\n  spacing,\n  borderRadius,\n  shadows,\n  transitions: {\n    duration: {\n      fast: '150ms',\n      normal: '300ms',\n      slow: '500ms',\n    },\n    easing: {\n      easeInOut: 'cubic-bezier(0.4, 0, 0.2, 1)',\n      easeOut: 'cubic-bezier(0, 0, 0.2, 1)',\n      easeIn: 'cubic-bezier(0.4, 0, 1, 1)',\n    },\n  },\n};\n\n// CSS Custom Properties for theming\nexport const getCSSCustomProperties = (mode: ThemeMode) => {\n  const themeColors = getThemeColors(mode);\n\n  return {\n    // Base colors\n    '--background': themeColors.background,\n    '--foreground': themeColors.foreground,\n    '--card': themeColors.card,\n    '--card-foreground': themeColors.cardForeground,\n    '--popover': themeColors.popover,\n    '--popover-foreground': themeColors.popoverForeground,\n    '--primary': themeColors.primary,\n    '--primary-foreground': themeColors.primaryForeground,\n    '--secondary': themeColors.secondary,\n    '--secondary-foreground': themeColors.secondaryForeground,\n    '--muted': themeColors.muted,\n    '--muted-foreground': themeColors.mutedForeground,\n    '--accent': themeColors.accent,\n    '--accent-foreground': themeColors.accentForeground,\n    '--destructive': themeColors.destructive,\n    '--destructive-foreground': themeColors.destructiveForeground,\n    '--border': themeColors.border,\n    '--input': themeColors.input,\n    '--ring': themeColors.ring,\n\n    // Extended colors for new variants\n    '--success': colors.success[500],\n    '--success-foreground': colors.success[50],\n    '--warning': colors.warning[500],\n    '--warning-foreground': colors.warning[50],\n    '--info': colors.info[500],\n    '--info-foreground': colors.info[50],\n\n    // Semantic colors\n    '--success-bg': colors.success[50],\n    '--success-border': colors.success[200],\n    '--warning-bg': colors.warning[50],\n    '--warning-border': colors.warning[200],\n    '--error-bg': colors.error[50],\n    '--error-border': colors.error[200],\n    '--info-bg': colors.info[50],\n    '--info-border': colors.info[200],\n  };\n};\n\n// Theme context helpers\nexport const getThemeColors = (mode: ThemeMode): ThemeColors => {\n  if (mode === 'high-contrast') {\n    return {\n      background: '#000000',\n      foreground: '#ffffff',\n      card: '#000000',\n      cardForeground: '#ffffff',\n      popover: '#000000',\n      popoverForeground: '#ffffff',\n      primary: '#ffff00',\n      primaryForeground: '#000000',\n      secondary: '#ffffff',\n      secondaryForeground: '#000000',\n      muted: '#333333',\n      mutedForeground: '#ffffff',\n      accent: '#00ffff',\n      accentForeground: '#000000',\n      destructive: '#ff0000',\n      destructiveForeground: '#ffffff',\n      // success/info/warning\n      success: colors.success[500],\n      successForeground: colors.success[50],\n      warning: colors.warning[500],\n      warningForeground: colors.warning[50],\n      info: colors.info[500],\n      infoForeground: colors.info[50],\n      border: '#ffffff',\n      input: '#ffffff',\n      ring: '#ffff00',\n    };\n  }\n\n  if (mode === 'colorblind') {\n    return {\n      background: colors.neutral[50],\n      foreground: colors.neutral[900],\n      card: colors.neutral[50],\n      cardForeground: colors.neutral[900],\n      popover: colors.neutral[50],\n      popoverForeground: colors.neutral[900],\n      primary: colors.neutral[800],\n      primaryForeground: colors.neutral[50],\n      secondary: colors.neutral[600],\n      secondaryForeground: colors.neutral[50],\n      muted: colors.neutral[100],\n      mutedForeground: colors.neutral[700],\n      accent: colors.neutral[500],\n      accentForeground: colors.neutral[50],\n      destructive: colors.neutral[900],\n      destructiveForeground: colors.neutral[50],\n      // semantic colors\n      success: colors.success[500],\n      successForeground: colors.success[50],\n      warning: colors.warning[500],\n      warningForeground: colors.warning[50],\n      info: colors.info[500],\n      infoForeground: colors.info[50],\n      border: colors.neutral[300],\n      input: colors.neutral[200],\n      ring: colors.neutral[800],\n    };\n  }\n\n  if (mode === 'dark') {\n    return {\n      background: colors.neutral[900],\n      foreground: colors.neutral[50],\n      card: colors.neutral[800],\n      cardForeground: colors.neutral[100],\n      popover: colors.neutral[800],\n      popoverForeground: colors.neutral[100],\n      primary: colors.primary[400],\n      primaryForeground: colors.neutral[900],\n      secondary: colors.neutral[700],\n      secondaryForeground: colors.neutral[100],\n      muted: colors.neutral[700],\n      mutedForeground: colors.neutral[400],\n      accent: colors.accent[400],\n      accentForeground: colors.neutral[900],\n      destructive: colors.error[500],\n      destructiveForeground: '#ffffff',\n      // semantic colors\n      success: colors.success[500],\n      successForeground: colors.success[50],\n      warning: colors.warning[500],\n      warningForeground: colors.warning[50],\n      info: colors.info[500],\n      infoForeground: colors.info[50],\n      border: colors.neutral[700],\n      input: colors.neutral[700],\n      ring: colors.primary[400],\n    };\n  }\n\n  return {\n    background: colors.neutral[50],\n    foreground: colors.neutral[900],\n    card: colors.neutral[50],\n    cardForeground: colors.neutral[900],\n    popover: colors.neutral[50],\n    popoverForeground: colors.neutral[900],\n    primary: colors.primary[600],\n    primaryForeground: colors.neutral[50],\n    secondary: colors.neutral[100],\n    secondaryForeground: colors.neutral[900],\n    muted: colors.neutral[100],\n    // increase muted foreground contrast for accessibility\n    mutedForeground: colors.neutral[700],\n    accent: colors.accent[600],\n    accentForeground: colors.neutral[50],\n    // use darker semantic shades for better contrast on light backgrounds\n    destructive: colors.error[700],\n    // ensure destructive foreground is pure white for contrast against red\n    destructiveForeground: '#ffffff',\n    // semantic colors (darker variants)\n    success: colors.success[700],\n    successForeground: colors.success[50],\n    warning: colors.warning[700],\n    warningForeground: colors.warning[50],\n    info: colors.info[700],\n    infoForeground: colors.info[50],\n    border: colors.neutral[200],\n    input: colors.neutral[200],\n    ring: colors.primary[600],\n  };\n};\n\n// Extend theme with explicit typographic scale and spacing tokens for accessibility\n// Provide a small 4-step typographic scale (h1, h2, body, caption) used across the app\ntheme.typography.fontSize['h1'] = ['1.75rem', { lineHeight: '2.25rem' }]; // ~28px\ntheme.typography.fontSize['h2'] = ['1.25rem', { lineHeight: '1.75rem' }]; // ~20px\ntheme.typography.fontSize['body'] = theme.typography.fontSize.base; // 16px\ntheme.typography.fontSize['caption'] = ['0.75rem', { lineHeight: '1rem' }]; // 12px\n\n// Add a couple of spacing tokens that map to touch-target friendly values\ntheme.spacing['touch-sm'] = '12px';\ntheme.spacing['touch-md'] = '16px';\ntheme.spacing['touch-lg'] = '24px';\n","// @refresh reset\r\n/**\r\n * Theme Provider Component\r\n * Manages dark/light mode and provides theme context throughout the app\r\n *\r\n * DESIGN PHILOSOPHY: Dark mode is the DEFAULT.\r\n * At 3 AM when you're in pain, a white screen is violence.\r\n * We respect system preferences, but default to dark for new users.\r\n *\r\n * Performance optimizations:\r\n * - Memoized context value to prevent unnecessary re-renders\r\n * - Batched CSS variable updates\r\n * - Debounced system preference listeners\r\n * - Selective re-rendering via granular selectors\r\n */\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useEffect,\r\n  useState,\r\n  useCallback,\r\n  useMemo,\r\n  useRef,\r\n} from 'react';\r\nimport { ThemeMode, getThemeColors, ThemeColors } from './theme';\r\n\r\n/** Storage key for persisting theme preference */\r\nconst THEME_STORAGE_KEY = 'pain-tracker:theme-mode';\r\n\r\n/** Transition duration for theme changes (ms) */\r\nconst THEME_TRANSITION_DURATION = 150;\r\n\r\ninterface ThemeContextType {\r\n  /** Current theme mode */\r\n  mode: ThemeMode;\r\n  /** Toggle between light and dark modes */\r\n  toggleMode: () => void;\r\n  /** Current theme color tokens */\r\n  colors: ThemeColors;\r\n  /** Set a specific theme mode */\r\n  setMode: (mode: ThemeMode) => void;\r\n  /** Whether high-contrast mode is active */\r\n  isHighContrast: boolean;\r\n  /** Whether reduced motion is preferred */\r\n  hasReducedMotion: boolean;\r\n  /** Whether dark mode is active (includes high-contrast) */\r\n  isDark: boolean;\r\n  /** Whether the theme is currently transitioning */\r\n  isTransitioning: boolean;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport const useTheme = () => {\r\n  const context = useContext(ThemeContext);\r\n  if (context === undefined) {\r\n    throw new Error('useTheme must be used within a ThemeProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Selector hooks for performance - subscribe only to specific values\r\n * Use these when you only need one value to avoid unnecessary re-renders\r\n */\r\nexport const useThemeMode = () => useTheme().mode;\r\nexport const useIsDark = () => useTheme().isDark;\r\nexport const useIsHighContrast = () => useTheme().isHighContrast;\r\nexport const useThemeColors = () => useTheme().colors;\r\n\r\ninterface ThemeProviderProps {\r\n  children: React.ReactNode;\r\n  defaultMode?: ThemeMode;\r\n}\r\n\r\n/**\r\n * Get the initial theme mode.\r\n * Priority:\r\n * 1. User's saved preference (from localStorage)\r\n * 2. System preference (prefers-color-scheme)\r\n * 3. Default to 'dark' (our trauma-informed default)\r\n */\r\nfunction getInitialMode(defaultMode: ThemeMode): ThemeMode {\r\n  if (typeof window === 'undefined') return defaultMode;\r\n  \r\n  // Check for saved preference first\r\n  try {\r\n    const saved = localStorage.getItem(THEME_STORAGE_KEY);\r\n    if (saved === 'light' || saved === 'dark' || saved === 'high-contrast' || saved === 'colorblind') {\r\n      return saved as ThemeMode;\r\n    }\r\n  } catch {\r\n    // localStorage might be unavailable\r\n  }\r\n  \r\n  // Check system preference\r\n  if (window.matchMedia('(prefers-color-scheme: light)').matches) {\r\n    return 'light';\r\n  }\r\n  \r\n  // Default to dark - our trauma-informed default\r\n  return 'dark';\r\n}\r\n\r\nexport const ThemeProvider: React.FC<ThemeProviderProps> = ({\r\n  children,\r\n  defaultMode = 'dark', // Dark is our default\r\n}) => {\r\n  const [mode, setModeState] = useState<ThemeMode>(() => getInitialMode(defaultMode));\r\n  const [isTransitioning, setIsTransitioning] = useState(false);\r\n  const transitionTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n\r\n  const [hasReducedMotion, setHasReducedMotion] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      return window.matchMedia('(prefers-reduced-motion: reduce)').matches;\r\n    }\r\n    return false;\r\n  });\r\n\r\n  const colors = useMemo(() => getThemeColors(mode), [mode]);\r\n  const isDark = mode === 'dark' || mode === 'high-contrast';\r\n\r\n  // Update CSS custom properties when mode changes\r\n  const updateCSSVariables = useCallback((newMode: ThemeMode) => {\r\n    const root = document.documentElement;\r\n\r\n    // Set data attribute for CSS targeting\r\n    root.setAttribute('data-theme', newMode === 'high-contrast' ? 'dark' : newMode);\r\n\r\n    // Toggle 'dark' class for Tailwind dark mode\r\n    if (newMode === 'dark' || newMode === 'high-contrast') {\r\n      root.classList.add('dark');\r\n    } else {\r\n      root.classList.remove('dark');\r\n    }\r\n  }, []);\r\n\r\n  // Set and persist mode with smooth transition\r\n  const setMode = useCallback(\r\n    (newMode: ThemeMode) => {\r\n      // Start transition\r\n      setIsTransitioning(true);\r\n\r\n      // Clear any existing timeout\r\n      if (transitionTimeoutRef.current) {\r\n        clearTimeout(transitionTimeoutRef.current);\r\n      }\r\n\r\n      setModeState(newMode);\r\n      try {\r\n        localStorage.setItem(THEME_STORAGE_KEY, newMode);\r\n      } catch {\r\n        // localStorage might be unavailable\r\n      }\r\n      updateCSSVariables(newMode);\r\n\r\n      // End transition after animation completes\r\n      transitionTimeoutRef.current = setTimeout(() => {\r\n        setIsTransitioning(false);\r\n      }, THEME_TRANSITION_DURATION);\r\n    },\r\n    [updateCSSVariables]\r\n  );\r\n\r\n  const toggleMode = useCallback(() => {\r\n    const newMode = mode === 'dark' ? 'light' : 'dark';\r\n    setMode(newMode);\r\n  }, [mode, setMode]);\r\n\r\n  // Listen for system accessibility preferences (reduced motion only)\r\n  useEffect(() => {\r\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\r\n    \r\n    const handler = (e: MediaQueryListEvent) => {\r\n      setHasReducedMotion(e.matches);\r\n    };\r\n\r\n    if (mediaQuery.addEventListener) {\r\n      mediaQuery.addEventListener('change', handler);\r\n      return () => mediaQuery.removeEventListener('change', handler);\r\n    } else {\r\n      // Fallback for older browsers\r\n      mediaQuery.addListener(handler);\r\n      return () => mediaQuery.removeListener(handler);\r\n    }\r\n  }, []);\r\n\r\n  // Listen for system color scheme changes (respect user's OS preference)\r\n  useEffect(() => {\r\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\r\n    \r\n    const handler = (e: MediaQueryListEvent) => {\r\n      // Only auto-switch if user hasn't explicitly set a preference\r\n      try {\r\n        const saved = localStorage.getItem(THEME_STORAGE_KEY);\r\n        if (!saved) {\r\n          setMode(e.matches ? 'dark' : 'light');\r\n        }\r\n      } catch {\r\n        setMode(e.matches ? 'dark' : 'light');\r\n      }\r\n    };\r\n\r\n    if (mediaQuery.addEventListener) {\r\n      mediaQuery.addEventListener('change', handler);\r\n      return () => mediaQuery.removeEventListener('change', handler);\r\n    } else {\r\n      mediaQuery.addListener(handler);\r\n      return () => mediaQuery.removeListener(handler);\r\n    }\r\n  }, [setMode]);\r\n\r\n  // Initial CSS variables setup\r\n  useEffect(() => {\r\n    updateCSSVariables(mode);\r\n  }, [mode, updateCSSVariables]);\r\n\r\n  // Cleanup transition timeout on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (transitionTimeoutRef.current) {\r\n        clearTimeout(transitionTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Memoize context value to prevent unnecessary re-renders\r\n  const value: ThemeContextType = useMemo(\r\n    () => ({\r\n      mode,\r\n      toggleMode,\r\n      colors,\r\n      setMode,\r\n      isHighContrast: mode === 'high-contrast',\r\n      hasReducedMotion,\r\n      isDark,\r\n      isTransitioning,\r\n    }),\r\n    [mode, toggleMode, colors, setMode, hasReducedMotion, isDark, isTransitioning]\r\n  );\r\n\r\n  return <ThemeContext.Provider value={value}>{children}</ThemeContext.Provider>;\r\n};\r\n","/**\n * Copyright 2022 Joe Bell. All rights reserved.\n *\n * This file is licensed to you under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with the\n * License. You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR REPRESENTATIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */ import { clsx } from \"clsx\";\nconst falsyToString = (value)=>typeof value === \"boolean\" ? `${value}` : value === 0 ? \"0\" : value;\nexport const cx = clsx;\nexport const cva = (base, config)=>(props)=>{\n        var _config_compoundVariants;\n        if ((config === null || config === void 0 ? void 0 : config.variants) == null) return cx(base, props === null || props === void 0 ? void 0 : props.class, props === null || props === void 0 ? void 0 : props.className);\n        const { variants, defaultVariants } = config;\n        const getVariantClassNames = Object.keys(variants).map((variant)=>{\n            const variantProp = props === null || props === void 0 ? void 0 : props[variant];\n            const defaultVariantProp = defaultVariants === null || defaultVariants === void 0 ? void 0 : defaultVariants[variant];\n            if (variantProp === null) return null;\n            const variantKey = falsyToString(variantProp) || falsyToString(defaultVariantProp);\n            return variants[variant][variantKey];\n        });\n        const propsWithoutUndefined = props && Object.entries(props).reduce((acc, param)=>{\n            let [key, value] = param;\n            if (value === undefined) {\n                return acc;\n            }\n            acc[key] = value;\n            return acc;\n        }, {});\n        const getCompoundVariantClassNames = config === null || config === void 0 ? void 0 : (_config_compoundVariants = config.compoundVariants) === null || _config_compoundVariants === void 0 ? void 0 : _config_compoundVariants.reduce((acc, param)=>{\n            let { class: cvClass, className: cvClassName, ...compoundVariantOptions } = param;\n            return Object.entries(compoundVariantOptions).every((param)=>{\n                let [key, value] = param;\n                return Array.isArray(value) ? value.includes({\n                    ...defaultVariants,\n                    ...propsWithoutUndefined\n                }[key]) : ({\n                    ...defaultVariants,\n                    ...propsWithoutUndefined\n                })[key] === value;\n            }) ? [\n                ...acc,\n                cvClass,\n                cvClassName\n            ] : acc;\n        }, []);\n        return cx(base, getVariantClassNames, getCompoundVariantClassNames, props === null || props === void 0 ? void 0 : props.class, props === null || props === void 0 ? void 0 : props.className);\n    };\n\n","const CLASS_PART_SEPARATOR = '-';\nconst createClassGroupUtils = config => {\n  const classMap = createClassMap(config);\n  const {\n    conflictingClassGroups,\n    conflictingClassGroupModifiers\n  } = config;\n  const getClassGroupId = className => {\n    const classParts = className.split(CLASS_PART_SEPARATOR);\n    // Classes like `-inset-1` produce an empty string as first classPart. We assume that classes for negative values are used correctly and remove it from classParts.\n    if (classParts[0] === '' && classParts.length !== 1) {\n      classParts.shift();\n    }\n    return getGroupRecursive(classParts, classMap) || getGroupIdForArbitraryProperty(className);\n  };\n  const getConflictingClassGroupIds = (classGroupId, hasPostfixModifier) => {\n    const conflicts = conflictingClassGroups[classGroupId] || [];\n    if (hasPostfixModifier && conflictingClassGroupModifiers[classGroupId]) {\n      return [...conflicts, ...conflictingClassGroupModifiers[classGroupId]];\n    }\n    return conflicts;\n  };\n  return {\n    getClassGroupId,\n    getConflictingClassGroupIds\n  };\n};\nconst getGroupRecursive = (classParts, classPartObject) => {\n  if (classParts.length === 0) {\n    return classPartObject.classGroupId;\n  }\n  const currentClassPart = classParts[0];\n  const nextClassPartObject = classPartObject.nextPart.get(currentClassPart);\n  const classGroupFromNextClassPart = nextClassPartObject ? getGroupRecursive(classParts.slice(1), nextClassPartObject) : undefined;\n  if (classGroupFromNextClassPart) {\n    return classGroupFromNextClassPart;\n  }\n  if (classPartObject.validators.length === 0) {\n    return undefined;\n  }\n  const classRest = classParts.join(CLASS_PART_SEPARATOR);\n  return classPartObject.validators.find(({\n    validator\n  }) => validator(classRest))?.classGroupId;\n};\nconst arbitraryPropertyRegex = /^\\[(.+)\\]$/;\nconst getGroupIdForArbitraryProperty = className => {\n  if (arbitraryPropertyRegex.test(className)) {\n    const arbitraryPropertyClassName = arbitraryPropertyRegex.exec(className)[1];\n    const property = arbitraryPropertyClassName?.substring(0, arbitraryPropertyClassName.indexOf(':'));\n    if (property) {\n      // I use two dots here because one dot is used as prefix for class groups in plugins\n      return 'arbitrary..' + property;\n    }\n  }\n};\n/**\n * Exported for testing only\n */\nconst createClassMap = config => {\n  const {\n    theme,\n    classGroups\n  } = config;\n  const classMap = {\n    nextPart: new Map(),\n    validators: []\n  };\n  for (const classGroupId in classGroups) {\n    processClassesRecursively(classGroups[classGroupId], classMap, classGroupId, theme);\n  }\n  return classMap;\n};\nconst processClassesRecursively = (classGroup, classPartObject, classGroupId, theme) => {\n  classGroup.forEach(classDefinition => {\n    if (typeof classDefinition === 'string') {\n      const classPartObjectToEdit = classDefinition === '' ? classPartObject : getPart(classPartObject, classDefinition);\n      classPartObjectToEdit.classGroupId = classGroupId;\n      return;\n    }\n    if (typeof classDefinition === 'function') {\n      if (isThemeGetter(classDefinition)) {\n        processClassesRecursively(classDefinition(theme), classPartObject, classGroupId, theme);\n        return;\n      }\n      classPartObject.validators.push({\n        validator: classDefinition,\n        classGroupId\n      });\n      return;\n    }\n    Object.entries(classDefinition).forEach(([key, classGroup]) => {\n      processClassesRecursively(classGroup, getPart(classPartObject, key), classGroupId, theme);\n    });\n  });\n};\nconst getPart = (classPartObject, path) => {\n  let currentClassPartObject = classPartObject;\n  path.split(CLASS_PART_SEPARATOR).forEach(pathPart => {\n    if (!currentClassPartObject.nextPart.has(pathPart)) {\n      currentClassPartObject.nextPart.set(pathPart, {\n        nextPart: new Map(),\n        validators: []\n      });\n    }\n    currentClassPartObject = currentClassPartObject.nextPart.get(pathPart);\n  });\n  return currentClassPartObject;\n};\nconst isThemeGetter = func => func.isThemeGetter;\n\n// LRU cache inspired from hashlru (https://github.com/dominictarr/hashlru/blob/v1.0.4/index.js) but object replaced with Map to improve performance\nconst createLruCache = maxCacheSize => {\n  if (maxCacheSize < 1) {\n    return {\n      get: () => undefined,\n      set: () => {}\n    };\n  }\n  let cacheSize = 0;\n  let cache = new Map();\n  let previousCache = new Map();\n  const update = (key, value) => {\n    cache.set(key, value);\n    cacheSize++;\n    if (cacheSize > maxCacheSize) {\n      cacheSize = 0;\n      previousCache = cache;\n      cache = new Map();\n    }\n  };\n  return {\n    get(key) {\n      let value = cache.get(key);\n      if (value !== undefined) {\n        return value;\n      }\n      if ((value = previousCache.get(key)) !== undefined) {\n        update(key, value);\n        return value;\n      }\n    },\n    set(key, value) {\n      if (cache.has(key)) {\n        cache.set(key, value);\n      } else {\n        update(key, value);\n      }\n    }\n  };\n};\nconst IMPORTANT_MODIFIER = '!';\nconst MODIFIER_SEPARATOR = ':';\nconst MODIFIER_SEPARATOR_LENGTH = MODIFIER_SEPARATOR.length;\nconst createParseClassName = config => {\n  const {\n    prefix,\n    experimentalParseClassName\n  } = config;\n  /**\n   * Parse class name into parts.\n   *\n   * Inspired by `splitAtTopLevelOnly` used in Tailwind CSS\n   * @see https://github.com/tailwindlabs/tailwindcss/blob/v3.2.2/src/util/splitAtTopLevelOnly.js\n   */\n  let parseClassName = className => {\n    const modifiers = [];\n    let bracketDepth = 0;\n    let parenDepth = 0;\n    let modifierStart = 0;\n    let postfixModifierPosition;\n    for (let index = 0; index < className.length; index++) {\n      let currentCharacter = className[index];\n      if (bracketDepth === 0 && parenDepth === 0) {\n        if (currentCharacter === MODIFIER_SEPARATOR) {\n          modifiers.push(className.slice(modifierStart, index));\n          modifierStart = index + MODIFIER_SEPARATOR_LENGTH;\n          continue;\n        }\n        if (currentCharacter === '/') {\n          postfixModifierPosition = index;\n          continue;\n        }\n      }\n      if (currentCharacter === '[') {\n        bracketDepth++;\n      } else if (currentCharacter === ']') {\n        bracketDepth--;\n      } else if (currentCharacter === '(') {\n        parenDepth++;\n      } else if (currentCharacter === ')') {\n        parenDepth--;\n      }\n    }\n    const baseClassNameWithImportantModifier = modifiers.length === 0 ? className : className.substring(modifierStart);\n    const baseClassName = stripImportantModifier(baseClassNameWithImportantModifier);\n    const hasImportantModifier = baseClassName !== baseClassNameWithImportantModifier;\n    const maybePostfixModifierPosition = postfixModifierPosition && postfixModifierPosition > modifierStart ? postfixModifierPosition - modifierStart : undefined;\n    return {\n      modifiers,\n      hasImportantModifier,\n      baseClassName,\n      maybePostfixModifierPosition\n    };\n  };\n  if (prefix) {\n    const fullPrefix = prefix + MODIFIER_SEPARATOR;\n    const parseClassNameOriginal = parseClassName;\n    parseClassName = className => className.startsWith(fullPrefix) ? parseClassNameOriginal(className.substring(fullPrefix.length)) : {\n      isExternal: true,\n      modifiers: [],\n      hasImportantModifier: false,\n      baseClassName: className,\n      maybePostfixModifierPosition: undefined\n    };\n  }\n  if (experimentalParseClassName) {\n    const parseClassNameOriginal = parseClassName;\n    parseClassName = className => experimentalParseClassName({\n      className,\n      parseClassName: parseClassNameOriginal\n    });\n  }\n  return parseClassName;\n};\nconst stripImportantModifier = baseClassName => {\n  if (baseClassName.endsWith(IMPORTANT_MODIFIER)) {\n    return baseClassName.substring(0, baseClassName.length - 1);\n  }\n  /**\n   * In Tailwind CSS v3 the important modifier was at the start of the base class name. This is still supported for legacy reasons.\n   * @see https://github.com/dcastil/tailwind-merge/issues/513#issuecomment-2614029864\n   */\n  if (baseClassName.startsWith(IMPORTANT_MODIFIER)) {\n    return baseClassName.substring(1);\n  }\n  return baseClassName;\n};\n\n/**\n * Sorts modifiers according to following schema:\n * - Predefined modifiers are sorted alphabetically\n * - When an arbitrary variant appears, it must be preserved which modifiers are before and after it\n */\nconst createSortModifiers = config => {\n  const orderSensitiveModifiers = Object.fromEntries(config.orderSensitiveModifiers.map(modifier => [modifier, true]));\n  const sortModifiers = modifiers => {\n    if (modifiers.length <= 1) {\n      return modifiers;\n    }\n    const sortedModifiers = [];\n    let unsortedModifiers = [];\n    modifiers.forEach(modifier => {\n      const isPositionSensitive = modifier[0] === '[' || orderSensitiveModifiers[modifier];\n      if (isPositionSensitive) {\n        sortedModifiers.push(...unsortedModifiers.sort(), modifier);\n        unsortedModifiers = [];\n      } else {\n        unsortedModifiers.push(modifier);\n      }\n    });\n    sortedModifiers.push(...unsortedModifiers.sort());\n    return sortedModifiers;\n  };\n  return sortModifiers;\n};\nconst createConfigUtils = config => ({\n  cache: createLruCache(config.cacheSize),\n  parseClassName: createParseClassName(config),\n  sortModifiers: createSortModifiers(config),\n  ...createClassGroupUtils(config)\n});\nconst SPLIT_CLASSES_REGEX = /\\s+/;\nconst mergeClassList = (classList, configUtils) => {\n  const {\n    parseClassName,\n    getClassGroupId,\n    getConflictingClassGroupIds,\n    sortModifiers\n  } = configUtils;\n  /**\n   * Set of classGroupIds in following format:\n   * `{importantModifier}{variantModifiers}{classGroupId}`\n   * @example 'float'\n   * @example 'hover:focus:bg-color'\n   * @example 'md:!pr'\n   */\n  const classGroupsInConflict = [];\n  const classNames = classList.trim().split(SPLIT_CLASSES_REGEX);\n  let result = '';\n  for (let index = classNames.length - 1; index >= 0; index -= 1) {\n    const originalClassName = classNames[index];\n    const {\n      isExternal,\n      modifiers,\n      hasImportantModifier,\n      baseClassName,\n      maybePostfixModifierPosition\n    } = parseClassName(originalClassName);\n    if (isExternal) {\n      result = originalClassName + (result.length > 0 ? ' ' + result : result);\n      continue;\n    }\n    let hasPostfixModifier = !!maybePostfixModifierPosition;\n    let classGroupId = getClassGroupId(hasPostfixModifier ? baseClassName.substring(0, maybePostfixModifierPosition) : baseClassName);\n    if (!classGroupId) {\n      if (!hasPostfixModifier) {\n        // Not a Tailwind class\n        result = originalClassName + (result.length > 0 ? ' ' + result : result);\n        continue;\n      }\n      classGroupId = getClassGroupId(baseClassName);\n      if (!classGroupId) {\n        // Not a Tailwind class\n        result = originalClassName + (result.length > 0 ? ' ' + result : result);\n        continue;\n      }\n      hasPostfixModifier = false;\n    }\n    const variantModifier = sortModifiers(modifiers).join(':');\n    const modifierId = hasImportantModifier ? variantModifier + IMPORTANT_MODIFIER : variantModifier;\n    const classId = modifierId + classGroupId;\n    if (classGroupsInConflict.includes(classId)) {\n      // Tailwind class omitted due to conflict\n      continue;\n    }\n    classGroupsInConflict.push(classId);\n    const conflictGroups = getConflictingClassGroupIds(classGroupId, hasPostfixModifier);\n    for (let i = 0; i < conflictGroups.length; ++i) {\n      const group = conflictGroups[i];\n      classGroupsInConflict.push(modifierId + group);\n    }\n    // Tailwind class not in conflict\n    result = originalClassName + (result.length > 0 ? ' ' + result : result);\n  }\n  return result;\n};\n\n/**\n * The code in this file is copied from https://github.com/lukeed/clsx and modified to suit the needs of tailwind-merge better.\n *\n * Specifically:\n * - Runtime code from https://github.com/lukeed/clsx/blob/v1.2.1/src/index.js\n * - TypeScript types from https://github.com/lukeed/clsx/blob/v1.2.1/clsx.d.ts\n *\n * Original code has MIT license: Copyright (c) Luke Edwards <luke.edwards05@gmail.com> (lukeed.com)\n */\nfunction twJoin() {\n  let index = 0;\n  let argument;\n  let resolvedValue;\n  let string = '';\n  while (index < arguments.length) {\n    if (argument = arguments[index++]) {\n      if (resolvedValue = toValue(argument)) {\n        string && (string += ' ');\n        string += resolvedValue;\n      }\n    }\n  }\n  return string;\n}\nconst toValue = mix => {\n  if (typeof mix === 'string') {\n    return mix;\n  }\n  let resolvedValue;\n  let string = '';\n  for (let k = 0; k < mix.length; k++) {\n    if (mix[k]) {\n      if (resolvedValue = toValue(mix[k])) {\n        string && (string += ' ');\n        string += resolvedValue;\n      }\n    }\n  }\n  return string;\n};\nfunction createTailwindMerge(createConfigFirst, ...createConfigRest) {\n  let configUtils;\n  let cacheGet;\n  let cacheSet;\n  let functionToCall = initTailwindMerge;\n  function initTailwindMerge(classList) {\n    const config = createConfigRest.reduce((previousConfig, createConfigCurrent) => createConfigCurrent(previousConfig), createConfigFirst());\n    configUtils = createConfigUtils(config);\n    cacheGet = configUtils.cache.get;\n    cacheSet = configUtils.cache.set;\n    functionToCall = tailwindMerge;\n    return tailwindMerge(classList);\n  }\n  function tailwindMerge(classList) {\n    const cachedResult = cacheGet(classList);\n    if (cachedResult) {\n      return cachedResult;\n    }\n    const result = mergeClassList(classList, configUtils);\n    cacheSet(classList, result);\n    return result;\n  }\n  return function callTailwindMerge() {\n    return functionToCall(twJoin.apply(null, arguments));\n  };\n}\nconst fromTheme = key => {\n  const themeGetter = theme => theme[key] || [];\n  themeGetter.isThemeGetter = true;\n  return themeGetter;\n};\nconst arbitraryValueRegex = /^\\[(?:(\\w[\\w-]*):)?(.+)\\]$/i;\nconst arbitraryVariableRegex = /^\\((?:(\\w[\\w-]*):)?(.+)\\)$/i;\nconst fractionRegex = /^\\d+\\/\\d+$/;\nconst tshirtUnitRegex = /^(\\d+(\\.\\d+)?)?(xs|sm|md|lg|xl)$/;\nconst lengthUnitRegex = /\\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\\b(calc|min|max|clamp)\\(.+\\)|^0$/;\nconst colorFunctionRegex = /^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\\(.+\\)$/;\n// Shadow always begins with x and y offset separated by underscore optionally prepended by inset\nconst shadowRegex = /^(inset_)?-?((\\d+)?\\.?(\\d+)[a-z]+|0)_-?((\\d+)?\\.?(\\d+)[a-z]+|0)/;\nconst imageRegex = /^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\\(.+\\)$/;\nconst isFraction = value => fractionRegex.test(value);\nconst isNumber = value => !!value && !Number.isNaN(Number(value));\nconst isInteger = value => !!value && Number.isInteger(Number(value));\nconst isPercent = value => value.endsWith('%') && isNumber(value.slice(0, -1));\nconst isTshirtSize = value => tshirtUnitRegex.test(value);\nconst isAny = () => true;\nconst isLengthOnly = value =>\n// `colorFunctionRegex` check is necessary because color functions can have percentages in them which which would be incorrectly classified as lengths.\n// For example, `hsl(0 0% 0%)` would be classified as a length without this check.\n// I could also use lookbehind assertion in `lengthUnitRegex` but that isn't supported widely enough.\nlengthUnitRegex.test(value) && !colorFunctionRegex.test(value);\nconst isNever = () => false;\nconst isShadow = value => shadowRegex.test(value);\nconst isImage = value => imageRegex.test(value);\nconst isAnyNonArbitrary = value => !isArbitraryValue(value) && !isArbitraryVariable(value);\nconst isArbitrarySize = value => getIsArbitraryValue(value, isLabelSize, isNever);\nconst isArbitraryValue = value => arbitraryValueRegex.test(value);\nconst isArbitraryLength = value => getIsArbitraryValue(value, isLabelLength, isLengthOnly);\nconst isArbitraryNumber = value => getIsArbitraryValue(value, isLabelNumber, isNumber);\nconst isArbitraryPosition = value => getIsArbitraryValue(value, isLabelPosition, isNever);\nconst isArbitraryImage = value => getIsArbitraryValue(value, isLabelImage, isImage);\nconst isArbitraryShadow = value => getIsArbitraryValue(value, isLabelShadow, isShadow);\nconst isArbitraryVariable = value => arbitraryVariableRegex.test(value);\nconst isArbitraryVariableLength = value => getIsArbitraryVariable(value, isLabelLength);\nconst isArbitraryVariableFamilyName = value => getIsArbitraryVariable(value, isLabelFamilyName);\nconst isArbitraryVariablePosition = value => getIsArbitraryVariable(value, isLabelPosition);\nconst isArbitraryVariableSize = value => getIsArbitraryVariable(value, isLabelSize);\nconst isArbitraryVariableImage = value => getIsArbitraryVariable(value, isLabelImage);\nconst isArbitraryVariableShadow = value => getIsArbitraryVariable(value, isLabelShadow, true);\n// Helpers\nconst getIsArbitraryValue = (value, testLabel, testValue) => {\n  const result = arbitraryValueRegex.exec(value);\n  if (result) {\n    if (result[1]) {\n      return testLabel(result[1]);\n    }\n    return testValue(result[2]);\n  }\n  return false;\n};\nconst getIsArbitraryVariable = (value, testLabel, shouldMatchNoLabel = false) => {\n  const result = arbitraryVariableRegex.exec(value);\n  if (result) {\n    if (result[1]) {\n      return testLabel(result[1]);\n    }\n    return shouldMatchNoLabel;\n  }\n  return false;\n};\n// Labels\nconst isLabelPosition = label => label === 'position' || label === 'percentage';\nconst isLabelImage = label => label === 'image' || label === 'url';\nconst isLabelSize = label => label === 'length' || label === 'size' || label === 'bg-size';\nconst isLabelLength = label => label === 'length';\nconst isLabelNumber = label => label === 'number';\nconst isLabelFamilyName = label => label === 'family-name';\nconst isLabelShadow = label => label === 'shadow';\nconst validators = /*#__PURE__*/Object.defineProperty({\n  __proto__: null,\n  isAny,\n  isAnyNonArbitrary,\n  isArbitraryImage,\n  isArbitraryLength,\n  isArbitraryNumber,\n  isArbitraryPosition,\n  isArbitraryShadow,\n  isArbitrarySize,\n  isArbitraryValue,\n  isArbitraryVariable,\n  isArbitraryVariableFamilyName,\n  isArbitraryVariableImage,\n  isArbitraryVariableLength,\n  isArbitraryVariablePosition,\n  isArbitraryVariableShadow,\n  isArbitraryVariableSize,\n  isFraction,\n  isInteger,\n  isNumber,\n  isPercent,\n  isTshirtSize\n}, Symbol.toStringTag, {\n  value: 'Module'\n});\nconst getDefaultConfig = () => {\n  /**\n   * Theme getters for theme variable namespaces\n   * @see https://tailwindcss.com/docs/theme#theme-variable-namespaces\n   */\n  /***/\n  const themeColor = fromTheme('color');\n  const themeFont = fromTheme('font');\n  const themeText = fromTheme('text');\n  const themeFontWeight = fromTheme('font-weight');\n  const themeTracking = fromTheme('tracking');\n  const themeLeading = fromTheme('leading');\n  const themeBreakpoint = fromTheme('breakpoint');\n  const themeContainer = fromTheme('container');\n  const themeSpacing = fromTheme('spacing');\n  const themeRadius = fromTheme('radius');\n  const themeShadow = fromTheme('shadow');\n  const themeInsetShadow = fromTheme('inset-shadow');\n  const themeTextShadow = fromTheme('text-shadow');\n  const themeDropShadow = fromTheme('drop-shadow');\n  const themeBlur = fromTheme('blur');\n  const themePerspective = fromTheme('perspective');\n  const themeAspect = fromTheme('aspect');\n  const themeEase = fromTheme('ease');\n  const themeAnimate = fromTheme('animate');\n  /**\n   * Helpers to avoid repeating the same scales\n   *\n   * We use functions that create a new array every time they're called instead of static arrays.\n   * This ensures that users who modify any scale by mutating the array (e.g. with `array.push(element)`) don't accidentally mutate arrays in other parts of the config.\n   */\n  /***/\n  const scaleBreak = () => ['auto', 'avoid', 'all', 'avoid-page', 'page', 'left', 'right', 'column'];\n  const scalePosition = () => ['center', 'top', 'bottom', 'left', 'right', 'top-left',\n  // Deprecated since Tailwind CSS v4.1.0, see https://github.com/tailwindlabs/tailwindcss/pull/17378\n  'left-top', 'top-right',\n  // Deprecated since Tailwind CSS v4.1.0, see https://github.com/tailwindlabs/tailwindcss/pull/17378\n  'right-top', 'bottom-right',\n  // Deprecated since Tailwind CSS v4.1.0, see https://github.com/tailwindlabs/tailwindcss/pull/17378\n  'right-bottom', 'bottom-left',\n  // Deprecated since Tailwind CSS v4.1.0, see https://github.com/tailwindlabs/tailwindcss/pull/17378\n  'left-bottom'];\n  const scalePositionWithArbitrary = () => [...scalePosition(), isArbitraryVariable, isArbitraryValue];\n  const scaleOverflow = () => ['auto', 'hidden', 'clip', 'visible', 'scroll'];\n  const scaleOverscroll = () => ['auto', 'contain', 'none'];\n  const scaleUnambiguousSpacing = () => [isArbitraryVariable, isArbitraryValue, themeSpacing];\n  const scaleInset = () => [isFraction, 'full', 'auto', ...scaleUnambiguousSpacing()];\n  const scaleGridTemplateColsRows = () => [isInteger, 'none', 'subgrid', isArbitraryVariable, isArbitraryValue];\n  const scaleGridColRowStartAndEnd = () => ['auto', {\n    span: ['full', isInteger, isArbitraryVariable, isArbitraryValue]\n  }, isInteger, isArbitraryVariable, isArbitraryValue];\n  const scaleGridColRowStartOrEnd = () => [isInteger, 'auto', isArbitraryVariable, isArbitraryValue];\n  const scaleGridAutoColsRows = () => ['auto', 'min', 'max', 'fr', isArbitraryVariable, isArbitraryValue];\n  const scaleAlignPrimaryAxis = () => ['start', 'end', 'center', 'between', 'around', 'evenly', 'stretch', 'baseline', 'center-safe', 'end-safe'];\n  const scaleAlignSecondaryAxis = () => ['start', 'end', 'center', 'stretch', 'center-safe', 'end-safe'];\n  const scaleMargin = () => ['auto', ...scaleUnambiguousSpacing()];\n  const scaleSizing = () => [isFraction, 'auto', 'full', 'dvw', 'dvh', 'lvw', 'lvh', 'svw', 'svh', 'min', 'max', 'fit', ...scaleUnambiguousSpacing()];\n  const scaleColor = () => [themeColor, isArbitraryVariable, isArbitraryValue];\n  const scaleBgPosition = () => [...scalePosition(), isArbitraryVariablePosition, isArbitraryPosition, {\n    position: [isArbitraryVariable, isArbitraryValue]\n  }];\n  const scaleBgRepeat = () => ['no-repeat', {\n    repeat: ['', 'x', 'y', 'space', 'round']\n  }];\n  const scaleBgSize = () => ['auto', 'cover', 'contain', isArbitraryVariableSize, isArbitrarySize, {\n    size: [isArbitraryVariable, isArbitraryValue]\n  }];\n  const scaleGradientStopPosition = () => [isPercent, isArbitraryVariableLength, isArbitraryLength];\n  const scaleRadius = () => [\n  // Deprecated since Tailwind CSS v4.0.0\n  '', 'none', 'full', themeRadius, isArbitraryVariable, isArbitraryValue];\n  const scaleBorderWidth = () => ['', isNumber, isArbitraryVariableLength, isArbitraryLength];\n  const scaleLineStyle = () => ['solid', 'dashed', 'dotted', 'double'];\n  const scaleBlendMode = () => ['normal', 'multiply', 'screen', 'overlay', 'darken', 'lighten', 'color-dodge', 'color-burn', 'hard-light', 'soft-light', 'difference', 'exclusion', 'hue', 'saturation', 'color', 'luminosity'];\n  const scaleMaskImagePosition = () => [isNumber, isPercent, isArbitraryVariablePosition, isArbitraryPosition];\n  const scaleBlur = () => [\n  // Deprecated since Tailwind CSS v4.0.0\n  '', 'none', themeBlur, isArbitraryVariable, isArbitraryValue];\n  const scaleRotate = () => ['none', isNumber, isArbitraryVariable, isArbitraryValue];\n  const scaleScale = () => ['none', isNumber, isArbitraryVariable, isArbitraryValue];\n  const scaleSkew = () => [isNumber, isArbitraryVariable, isArbitraryValue];\n  const scaleTranslate = () => [isFraction, 'full', ...scaleUnambiguousSpacing()];\n  return {\n    cacheSize: 500,\n    theme: {\n      animate: ['spin', 'ping', 'pulse', 'bounce'],\n      aspect: ['video'],\n      blur: [isTshirtSize],\n      breakpoint: [isTshirtSize],\n      color: [isAny],\n      container: [isTshirtSize],\n      'drop-shadow': [isTshirtSize],\n      ease: ['in', 'out', 'in-out'],\n      font: [isAnyNonArbitrary],\n      'font-weight': ['thin', 'extralight', 'light', 'normal', 'medium', 'semibold', 'bold', 'extrabold', 'black'],\n      'inset-shadow': [isTshirtSize],\n      leading: ['none', 'tight', 'snug', 'normal', 'relaxed', 'loose'],\n      perspective: ['dramatic', 'near', 'normal', 'midrange', 'distant', 'none'],\n      radius: [isTshirtSize],\n      shadow: [isTshirtSize],\n      spacing: ['px', isNumber],\n      text: [isTshirtSize],\n      'text-shadow': [isTshirtSize],\n      tracking: ['tighter', 'tight', 'normal', 'wide', 'wider', 'widest']\n    },\n    classGroups: {\n      // --------------\n      // --- Layout ---\n      // --------------\n      /**\n       * Aspect Ratio\n       * @see https://tailwindcss.com/docs/aspect-ratio\n       */\n      aspect: [{\n        aspect: ['auto', 'square', isFraction, isArbitraryValue, isArbitraryVariable, themeAspect]\n      }],\n      /**\n       * Container\n       * @see https://tailwindcss.com/docs/container\n       * @deprecated since Tailwind CSS v4.0.0\n       */\n      container: ['container'],\n      /**\n       * Columns\n       * @see https://tailwindcss.com/docs/columns\n       */\n      columns: [{\n        columns: [isNumber, isArbitraryValue, isArbitraryVariable, themeContainer]\n      }],\n      /**\n       * Break After\n       * @see https://tailwindcss.com/docs/break-after\n       */\n      'break-after': [{\n        'break-after': scaleBreak()\n      }],\n      /**\n       * Break Before\n       * @see https://tailwindcss.com/docs/break-before\n       */\n      'break-before': [{\n        'break-before': scaleBreak()\n      }],\n      /**\n       * Break Inside\n       * @see https://tailwindcss.com/docs/break-inside\n       */\n      'break-inside': [{\n        'break-inside': ['auto', 'avoid', 'avoid-page', 'avoid-column']\n      }],\n      /**\n       * Box Decoration Break\n       * @see https://tailwindcss.com/docs/box-decoration-break\n       */\n      'box-decoration': [{\n        'box-decoration': ['slice', 'clone']\n      }],\n      /**\n       * Box Sizing\n       * @see https://tailwindcss.com/docs/box-sizing\n       */\n      box: [{\n        box: ['border', 'content']\n      }],\n      /**\n       * Display\n       * @see https://tailwindcss.com/docs/display\n       */\n      display: ['block', 'inline-block', 'inline', 'flex', 'inline-flex', 'table', 'inline-table', 'table-caption', 'table-cell', 'table-column', 'table-column-group', 'table-footer-group', 'table-header-group', 'table-row-group', 'table-row', 'flow-root', 'grid', 'inline-grid', 'contents', 'list-item', 'hidden'],\n      /**\n       * Screen Reader Only\n       * @see https://tailwindcss.com/docs/display#screen-reader-only\n       */\n      sr: ['sr-only', 'not-sr-only'],\n      /**\n       * Floats\n       * @see https://tailwindcss.com/docs/float\n       */\n      float: [{\n        float: ['right', 'left', 'none', 'start', 'end']\n      }],\n      /**\n       * Clear\n       * @see https://tailwindcss.com/docs/clear\n       */\n      clear: [{\n        clear: ['left', 'right', 'both', 'none', 'start', 'end']\n      }],\n      /**\n       * Isolation\n       * @see https://tailwindcss.com/docs/isolation\n       */\n      isolation: ['isolate', 'isolation-auto'],\n      /**\n       * Object Fit\n       * @see https://tailwindcss.com/docs/object-fit\n       */\n      'object-fit': [{\n        object: ['contain', 'cover', 'fill', 'none', 'scale-down']\n      }],\n      /**\n       * Object Position\n       * @see https://tailwindcss.com/docs/object-position\n       */\n      'object-position': [{\n        object: scalePositionWithArbitrary()\n      }],\n      /**\n       * Overflow\n       * @see https://tailwindcss.com/docs/overflow\n       */\n      overflow: [{\n        overflow: scaleOverflow()\n      }],\n      /**\n       * Overflow X\n       * @see https://tailwindcss.com/docs/overflow\n       */\n      'overflow-x': [{\n        'overflow-x': scaleOverflow()\n      }],\n      /**\n       * Overflow Y\n       * @see https://tailwindcss.com/docs/overflow\n       */\n      'overflow-y': [{\n        'overflow-y': scaleOverflow()\n      }],\n      /**\n       * Overscroll Behavior\n       * @see https://tailwindcss.com/docs/overscroll-behavior\n       */\n      overscroll: [{\n        overscroll: scaleOverscroll()\n      }],\n      /**\n       * Overscroll Behavior X\n       * @see https://tailwindcss.com/docs/overscroll-behavior\n       */\n      'overscroll-x': [{\n        'overscroll-x': scaleOverscroll()\n      }],\n      /**\n       * Overscroll Behavior Y\n       * @see https://tailwindcss.com/docs/overscroll-behavior\n       */\n      'overscroll-y': [{\n        'overscroll-y': scaleOverscroll()\n      }],\n      /**\n       * Position\n       * @see https://tailwindcss.com/docs/position\n       */\n      position: ['static', 'fixed', 'absolute', 'relative', 'sticky'],\n      /**\n       * Top / Right / Bottom / Left\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      inset: [{\n        inset: scaleInset()\n      }],\n      /**\n       * Right / Left\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      'inset-x': [{\n        'inset-x': scaleInset()\n      }],\n      /**\n       * Top / Bottom\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      'inset-y': [{\n        'inset-y': scaleInset()\n      }],\n      /**\n       * Start\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      start: [{\n        start: scaleInset()\n      }],\n      /**\n       * End\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      end: [{\n        end: scaleInset()\n      }],\n      /**\n       * Top\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      top: [{\n        top: scaleInset()\n      }],\n      /**\n       * Right\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      right: [{\n        right: scaleInset()\n      }],\n      /**\n       * Bottom\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      bottom: [{\n        bottom: scaleInset()\n      }],\n      /**\n       * Left\n       * @see https://tailwindcss.com/docs/top-right-bottom-left\n       */\n      left: [{\n        left: scaleInset()\n      }],\n      /**\n       * Visibility\n       * @see https://tailwindcss.com/docs/visibility\n       */\n      visibility: ['visible', 'invisible', 'collapse'],\n      /**\n       * Z-Index\n       * @see https://tailwindcss.com/docs/z-index\n       */\n      z: [{\n        z: [isInteger, 'auto', isArbitraryVariable, isArbitraryValue]\n      }],\n      // ------------------------\n      // --- Flexbox and Grid ---\n      // ------------------------\n      /**\n       * Flex Basis\n       * @see https://tailwindcss.com/docs/flex-basis\n       */\n      basis: [{\n        basis: [isFraction, 'full', 'auto', themeContainer, ...scaleUnambiguousSpacing()]\n      }],\n      /**\n       * Flex Direction\n       * @see https://tailwindcss.com/docs/flex-direction\n       */\n      'flex-direction': [{\n        flex: ['row', 'row-reverse', 'col', 'col-reverse']\n      }],\n      /**\n       * Flex Wrap\n       * @see https://tailwindcss.com/docs/flex-wrap\n       */\n      'flex-wrap': [{\n        flex: ['nowrap', 'wrap', 'wrap-reverse']\n      }],\n      /**\n       * Flex\n       * @see https://tailwindcss.com/docs/flex\n       */\n      flex: [{\n        flex: [isNumber, isFraction, 'auto', 'initial', 'none', isArbitraryValue]\n      }],\n      /**\n       * Flex Grow\n       * @see https://tailwindcss.com/docs/flex-grow\n       */\n      grow: [{\n        grow: ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Flex Shrink\n       * @see https://tailwindcss.com/docs/flex-shrink\n       */\n      shrink: [{\n        shrink: ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Order\n       * @see https://tailwindcss.com/docs/order\n       */\n      order: [{\n        order: [isInteger, 'first', 'last', 'none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Grid Template Columns\n       * @see https://tailwindcss.com/docs/grid-template-columns\n       */\n      'grid-cols': [{\n        'grid-cols': scaleGridTemplateColsRows()\n      }],\n      /**\n       * Grid Column Start / End\n       * @see https://tailwindcss.com/docs/grid-column\n       */\n      'col-start-end': [{\n        col: scaleGridColRowStartAndEnd()\n      }],\n      /**\n       * Grid Column Start\n       * @see https://tailwindcss.com/docs/grid-column\n       */\n      'col-start': [{\n        'col-start': scaleGridColRowStartOrEnd()\n      }],\n      /**\n       * Grid Column End\n       * @see https://tailwindcss.com/docs/grid-column\n       */\n      'col-end': [{\n        'col-end': scaleGridColRowStartOrEnd()\n      }],\n      /**\n       * Grid Template Rows\n       * @see https://tailwindcss.com/docs/grid-template-rows\n       */\n      'grid-rows': [{\n        'grid-rows': scaleGridTemplateColsRows()\n      }],\n      /**\n       * Grid Row Start / End\n       * @see https://tailwindcss.com/docs/grid-row\n       */\n      'row-start-end': [{\n        row: scaleGridColRowStartAndEnd()\n      }],\n      /**\n       * Grid Row Start\n       * @see https://tailwindcss.com/docs/grid-row\n       */\n      'row-start': [{\n        'row-start': scaleGridColRowStartOrEnd()\n      }],\n      /**\n       * Grid Row End\n       * @see https://tailwindcss.com/docs/grid-row\n       */\n      'row-end': [{\n        'row-end': scaleGridColRowStartOrEnd()\n      }],\n      /**\n       * Grid Auto Flow\n       * @see https://tailwindcss.com/docs/grid-auto-flow\n       */\n      'grid-flow': [{\n        'grid-flow': ['row', 'col', 'dense', 'row-dense', 'col-dense']\n      }],\n      /**\n       * Grid Auto Columns\n       * @see https://tailwindcss.com/docs/grid-auto-columns\n       */\n      'auto-cols': [{\n        'auto-cols': scaleGridAutoColsRows()\n      }],\n      /**\n       * Grid Auto Rows\n       * @see https://tailwindcss.com/docs/grid-auto-rows\n       */\n      'auto-rows': [{\n        'auto-rows': scaleGridAutoColsRows()\n      }],\n      /**\n       * Gap\n       * @see https://tailwindcss.com/docs/gap\n       */\n      gap: [{\n        gap: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Gap X\n       * @see https://tailwindcss.com/docs/gap\n       */\n      'gap-x': [{\n        'gap-x': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Gap Y\n       * @see https://tailwindcss.com/docs/gap\n       */\n      'gap-y': [{\n        'gap-y': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Justify Content\n       * @see https://tailwindcss.com/docs/justify-content\n       */\n      'justify-content': [{\n        justify: [...scaleAlignPrimaryAxis(), 'normal']\n      }],\n      /**\n       * Justify Items\n       * @see https://tailwindcss.com/docs/justify-items\n       */\n      'justify-items': [{\n        'justify-items': [...scaleAlignSecondaryAxis(), 'normal']\n      }],\n      /**\n       * Justify Self\n       * @see https://tailwindcss.com/docs/justify-self\n       */\n      'justify-self': [{\n        'justify-self': ['auto', ...scaleAlignSecondaryAxis()]\n      }],\n      /**\n       * Align Content\n       * @see https://tailwindcss.com/docs/align-content\n       */\n      'align-content': [{\n        content: ['normal', ...scaleAlignPrimaryAxis()]\n      }],\n      /**\n       * Align Items\n       * @see https://tailwindcss.com/docs/align-items\n       */\n      'align-items': [{\n        items: [...scaleAlignSecondaryAxis(), {\n          baseline: ['', 'last']\n        }]\n      }],\n      /**\n       * Align Self\n       * @see https://tailwindcss.com/docs/align-self\n       */\n      'align-self': [{\n        self: ['auto', ...scaleAlignSecondaryAxis(), {\n          baseline: ['', 'last']\n        }]\n      }],\n      /**\n       * Place Content\n       * @see https://tailwindcss.com/docs/place-content\n       */\n      'place-content': [{\n        'place-content': scaleAlignPrimaryAxis()\n      }],\n      /**\n       * Place Items\n       * @see https://tailwindcss.com/docs/place-items\n       */\n      'place-items': [{\n        'place-items': [...scaleAlignSecondaryAxis(), 'baseline']\n      }],\n      /**\n       * Place Self\n       * @see https://tailwindcss.com/docs/place-self\n       */\n      'place-self': [{\n        'place-self': ['auto', ...scaleAlignSecondaryAxis()]\n      }],\n      // Spacing\n      /**\n       * Padding\n       * @see https://tailwindcss.com/docs/padding\n       */\n      p: [{\n        p: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding X\n       * @see https://tailwindcss.com/docs/padding\n       */\n      px: [{\n        px: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Y\n       * @see https://tailwindcss.com/docs/padding\n       */\n      py: [{\n        py: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Start\n       * @see https://tailwindcss.com/docs/padding\n       */\n      ps: [{\n        ps: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding End\n       * @see https://tailwindcss.com/docs/padding\n       */\n      pe: [{\n        pe: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Top\n       * @see https://tailwindcss.com/docs/padding\n       */\n      pt: [{\n        pt: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Right\n       * @see https://tailwindcss.com/docs/padding\n       */\n      pr: [{\n        pr: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Bottom\n       * @see https://tailwindcss.com/docs/padding\n       */\n      pb: [{\n        pb: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Padding Left\n       * @see https://tailwindcss.com/docs/padding\n       */\n      pl: [{\n        pl: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Margin\n       * @see https://tailwindcss.com/docs/margin\n       */\n      m: [{\n        m: scaleMargin()\n      }],\n      /**\n       * Margin X\n       * @see https://tailwindcss.com/docs/margin\n       */\n      mx: [{\n        mx: scaleMargin()\n      }],\n      /**\n       * Margin Y\n       * @see https://tailwindcss.com/docs/margin\n       */\n      my: [{\n        my: scaleMargin()\n      }],\n      /**\n       * Margin Start\n       * @see https://tailwindcss.com/docs/margin\n       */\n      ms: [{\n        ms: scaleMargin()\n      }],\n      /**\n       * Margin End\n       * @see https://tailwindcss.com/docs/margin\n       */\n      me: [{\n        me: scaleMargin()\n      }],\n      /**\n       * Margin Top\n       * @see https://tailwindcss.com/docs/margin\n       */\n      mt: [{\n        mt: scaleMargin()\n      }],\n      /**\n       * Margin Right\n       * @see https://tailwindcss.com/docs/margin\n       */\n      mr: [{\n        mr: scaleMargin()\n      }],\n      /**\n       * Margin Bottom\n       * @see https://tailwindcss.com/docs/margin\n       */\n      mb: [{\n        mb: scaleMargin()\n      }],\n      /**\n       * Margin Left\n       * @see https://tailwindcss.com/docs/margin\n       */\n      ml: [{\n        ml: scaleMargin()\n      }],\n      /**\n       * Space Between X\n       * @see https://tailwindcss.com/docs/margin#adding-space-between-children\n       */\n      'space-x': [{\n        'space-x': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Space Between X Reverse\n       * @see https://tailwindcss.com/docs/margin#adding-space-between-children\n       */\n      'space-x-reverse': ['space-x-reverse'],\n      /**\n       * Space Between Y\n       * @see https://tailwindcss.com/docs/margin#adding-space-between-children\n       */\n      'space-y': [{\n        'space-y': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Space Between Y Reverse\n       * @see https://tailwindcss.com/docs/margin#adding-space-between-children\n       */\n      'space-y-reverse': ['space-y-reverse'],\n      // --------------\n      // --- Sizing ---\n      // --------------\n      /**\n       * Size\n       * @see https://tailwindcss.com/docs/width#setting-both-width-and-height\n       */\n      size: [{\n        size: scaleSizing()\n      }],\n      /**\n       * Width\n       * @see https://tailwindcss.com/docs/width\n       */\n      w: [{\n        w: [themeContainer, 'screen', ...scaleSizing()]\n      }],\n      /**\n       * Min-Width\n       * @see https://tailwindcss.com/docs/min-width\n       */\n      'min-w': [{\n        'min-w': [themeContainer, 'screen', /** Deprecated. @see https://github.com/tailwindlabs/tailwindcss.com/issues/2027#issuecomment-2620152757 */\n        'none', ...scaleSizing()]\n      }],\n      /**\n       * Max-Width\n       * @see https://tailwindcss.com/docs/max-width\n       */\n      'max-w': [{\n        'max-w': [themeContainer, 'screen', 'none', /** Deprecated since Tailwind CSS v4.0.0. @see https://github.com/tailwindlabs/tailwindcss.com/issues/2027#issuecomment-2620152757 */\n        'prose', /** Deprecated since Tailwind CSS v4.0.0. @see https://github.com/tailwindlabs/tailwindcss.com/issues/2027#issuecomment-2620152757 */\n        {\n          screen: [themeBreakpoint]\n        }, ...scaleSizing()]\n      }],\n      /**\n       * Height\n       * @see https://tailwindcss.com/docs/height\n       */\n      h: [{\n        h: ['screen', 'lh', ...scaleSizing()]\n      }],\n      /**\n       * Min-Height\n       * @see https://tailwindcss.com/docs/min-height\n       */\n      'min-h': [{\n        'min-h': ['screen', 'lh', 'none', ...scaleSizing()]\n      }],\n      /**\n       * Max-Height\n       * @see https://tailwindcss.com/docs/max-height\n       */\n      'max-h': [{\n        'max-h': ['screen', 'lh', ...scaleSizing()]\n      }],\n      // ------------------\n      // --- Typography ---\n      // ------------------\n      /**\n       * Font Size\n       * @see https://tailwindcss.com/docs/font-size\n       */\n      'font-size': [{\n        text: ['base', themeText, isArbitraryVariableLength, isArbitraryLength]\n      }],\n      /**\n       * Font Smoothing\n       * @see https://tailwindcss.com/docs/font-smoothing\n       */\n      'font-smoothing': ['antialiased', 'subpixel-antialiased'],\n      /**\n       * Font Style\n       * @see https://tailwindcss.com/docs/font-style\n       */\n      'font-style': ['italic', 'not-italic'],\n      /**\n       * Font Weight\n       * @see https://tailwindcss.com/docs/font-weight\n       */\n      'font-weight': [{\n        font: [themeFontWeight, isArbitraryVariable, isArbitraryNumber]\n      }],\n      /**\n       * Font Stretch\n       * @see https://tailwindcss.com/docs/font-stretch\n       */\n      'font-stretch': [{\n        'font-stretch': ['ultra-condensed', 'extra-condensed', 'condensed', 'semi-condensed', 'normal', 'semi-expanded', 'expanded', 'extra-expanded', 'ultra-expanded', isPercent, isArbitraryValue]\n      }],\n      /**\n       * Font Family\n       * @see https://tailwindcss.com/docs/font-family\n       */\n      'font-family': [{\n        font: [isArbitraryVariableFamilyName, isArbitraryValue, themeFont]\n      }],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-normal': ['normal-nums'],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-ordinal': ['ordinal'],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-slashed-zero': ['slashed-zero'],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-figure': ['lining-nums', 'oldstyle-nums'],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-spacing': ['proportional-nums', 'tabular-nums'],\n      /**\n       * Font Variant Numeric\n       * @see https://tailwindcss.com/docs/font-variant-numeric\n       */\n      'fvn-fraction': ['diagonal-fractions', 'stacked-fractions'],\n      /**\n       * Letter Spacing\n       * @see https://tailwindcss.com/docs/letter-spacing\n       */\n      tracking: [{\n        tracking: [themeTracking, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Line Clamp\n       * @see https://tailwindcss.com/docs/line-clamp\n       */\n      'line-clamp': [{\n        'line-clamp': [isNumber, 'none', isArbitraryVariable, isArbitraryNumber]\n      }],\n      /**\n       * Line Height\n       * @see https://tailwindcss.com/docs/line-height\n       */\n      leading: [{\n        leading: [/** Deprecated since Tailwind CSS v4.0.0. @see https://github.com/tailwindlabs/tailwindcss.com/issues/2027#issuecomment-2620152757 */\n        themeLeading, ...scaleUnambiguousSpacing()]\n      }],\n      /**\n       * List Style Image\n       * @see https://tailwindcss.com/docs/list-style-image\n       */\n      'list-image': [{\n        'list-image': ['none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * List Style Position\n       * @see https://tailwindcss.com/docs/list-style-position\n       */\n      'list-style-position': [{\n        list: ['inside', 'outside']\n      }],\n      /**\n       * List Style Type\n       * @see https://tailwindcss.com/docs/list-style-type\n       */\n      'list-style-type': [{\n        list: ['disc', 'decimal', 'none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Text Alignment\n       * @see https://tailwindcss.com/docs/text-align\n       */\n      'text-alignment': [{\n        text: ['left', 'center', 'right', 'justify', 'start', 'end']\n      }],\n      /**\n       * Placeholder Color\n       * @deprecated since Tailwind CSS v3.0.0\n       * @see https://v3.tailwindcss.com/docs/placeholder-color\n       */\n      'placeholder-color': [{\n        placeholder: scaleColor()\n      }],\n      /**\n       * Text Color\n       * @see https://tailwindcss.com/docs/text-color\n       */\n      'text-color': [{\n        text: scaleColor()\n      }],\n      /**\n       * Text Decoration\n       * @see https://tailwindcss.com/docs/text-decoration\n       */\n      'text-decoration': ['underline', 'overline', 'line-through', 'no-underline'],\n      /**\n       * Text Decoration Style\n       * @see https://tailwindcss.com/docs/text-decoration-style\n       */\n      'text-decoration-style': [{\n        decoration: [...scaleLineStyle(), 'wavy']\n      }],\n      /**\n       * Text Decoration Thickness\n       * @see https://tailwindcss.com/docs/text-decoration-thickness\n       */\n      'text-decoration-thickness': [{\n        decoration: [isNumber, 'from-font', 'auto', isArbitraryVariable, isArbitraryLength]\n      }],\n      /**\n       * Text Decoration Color\n       * @see https://tailwindcss.com/docs/text-decoration-color\n       */\n      'text-decoration-color': [{\n        decoration: scaleColor()\n      }],\n      /**\n       * Text Underline Offset\n       * @see https://tailwindcss.com/docs/text-underline-offset\n       */\n      'underline-offset': [{\n        'underline-offset': [isNumber, 'auto', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Text Transform\n       * @see https://tailwindcss.com/docs/text-transform\n       */\n      'text-transform': ['uppercase', 'lowercase', 'capitalize', 'normal-case'],\n      /**\n       * Text Overflow\n       * @see https://tailwindcss.com/docs/text-overflow\n       */\n      'text-overflow': ['truncate', 'text-ellipsis', 'text-clip'],\n      /**\n       * Text Wrap\n       * @see https://tailwindcss.com/docs/text-wrap\n       */\n      'text-wrap': [{\n        text: ['wrap', 'nowrap', 'balance', 'pretty']\n      }],\n      /**\n       * Text Indent\n       * @see https://tailwindcss.com/docs/text-indent\n       */\n      indent: [{\n        indent: scaleUnambiguousSpacing()\n      }],\n      /**\n       * Vertical Alignment\n       * @see https://tailwindcss.com/docs/vertical-align\n       */\n      'vertical-align': [{\n        align: ['baseline', 'top', 'middle', 'bottom', 'text-top', 'text-bottom', 'sub', 'super', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Whitespace\n       * @see https://tailwindcss.com/docs/whitespace\n       */\n      whitespace: [{\n        whitespace: ['normal', 'nowrap', 'pre', 'pre-line', 'pre-wrap', 'break-spaces']\n      }],\n      /**\n       * Word Break\n       * @see https://tailwindcss.com/docs/word-break\n       */\n      break: [{\n        break: ['normal', 'words', 'all', 'keep']\n      }],\n      /**\n       * Overflow Wrap\n       * @see https://tailwindcss.com/docs/overflow-wrap\n       */\n      wrap: [{\n        wrap: ['break-word', 'anywhere', 'normal']\n      }],\n      /**\n       * Hyphens\n       * @see https://tailwindcss.com/docs/hyphens\n       */\n      hyphens: [{\n        hyphens: ['none', 'manual', 'auto']\n      }],\n      /**\n       * Content\n       * @see https://tailwindcss.com/docs/content\n       */\n      content: [{\n        content: ['none', isArbitraryVariable, isArbitraryValue]\n      }],\n      // -------------------\n      // --- Backgrounds ---\n      // -------------------\n      /**\n       * Background Attachment\n       * @see https://tailwindcss.com/docs/background-attachment\n       */\n      'bg-attachment': [{\n        bg: ['fixed', 'local', 'scroll']\n      }],\n      /**\n       * Background Clip\n       * @see https://tailwindcss.com/docs/background-clip\n       */\n      'bg-clip': [{\n        'bg-clip': ['border', 'padding', 'content', 'text']\n      }],\n      /**\n       * Background Origin\n       * @see https://tailwindcss.com/docs/background-origin\n       */\n      'bg-origin': [{\n        'bg-origin': ['border', 'padding', 'content']\n      }],\n      /**\n       * Background Position\n       * @see https://tailwindcss.com/docs/background-position\n       */\n      'bg-position': [{\n        bg: scaleBgPosition()\n      }],\n      /**\n       * Background Repeat\n       * @see https://tailwindcss.com/docs/background-repeat\n       */\n      'bg-repeat': [{\n        bg: scaleBgRepeat()\n      }],\n      /**\n       * Background Size\n       * @see https://tailwindcss.com/docs/background-size\n       */\n      'bg-size': [{\n        bg: scaleBgSize()\n      }],\n      /**\n       * Background Image\n       * @see https://tailwindcss.com/docs/background-image\n       */\n      'bg-image': [{\n        bg: ['none', {\n          linear: [{\n            to: ['t', 'tr', 'r', 'br', 'b', 'bl', 'l', 'tl']\n          }, isInteger, isArbitraryVariable, isArbitraryValue],\n          radial: ['', isArbitraryVariable, isArbitraryValue],\n          conic: [isInteger, isArbitraryVariable, isArbitraryValue]\n        }, isArbitraryVariableImage, isArbitraryImage]\n      }],\n      /**\n       * Background Color\n       * @see https://tailwindcss.com/docs/background-color\n       */\n      'bg-color': [{\n        bg: scaleColor()\n      }],\n      /**\n       * Gradient Color Stops From Position\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-from-pos': [{\n        from: scaleGradientStopPosition()\n      }],\n      /**\n       * Gradient Color Stops Via Position\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-via-pos': [{\n        via: scaleGradientStopPosition()\n      }],\n      /**\n       * Gradient Color Stops To Position\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-to-pos': [{\n        to: scaleGradientStopPosition()\n      }],\n      /**\n       * Gradient Color Stops From\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-from': [{\n        from: scaleColor()\n      }],\n      /**\n       * Gradient Color Stops Via\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-via': [{\n        via: scaleColor()\n      }],\n      /**\n       * Gradient Color Stops To\n       * @see https://tailwindcss.com/docs/gradient-color-stops\n       */\n      'gradient-to': [{\n        to: scaleColor()\n      }],\n      // ---------------\n      // --- Borders ---\n      // ---------------\n      /**\n       * Border Radius\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      rounded: [{\n        rounded: scaleRadius()\n      }],\n      /**\n       * Border Radius Start\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-s': [{\n        'rounded-s': scaleRadius()\n      }],\n      /**\n       * Border Radius End\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-e': [{\n        'rounded-e': scaleRadius()\n      }],\n      /**\n       * Border Radius Top\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-t': [{\n        'rounded-t': scaleRadius()\n      }],\n      /**\n       * Border Radius Right\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-r': [{\n        'rounded-r': scaleRadius()\n      }],\n      /**\n       * Border Radius Bottom\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-b': [{\n        'rounded-b': scaleRadius()\n      }],\n      /**\n       * Border Radius Left\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-l': [{\n        'rounded-l': scaleRadius()\n      }],\n      /**\n       * Border Radius Start Start\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-ss': [{\n        'rounded-ss': scaleRadius()\n      }],\n      /**\n       * Border Radius Start End\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-se': [{\n        'rounded-se': scaleRadius()\n      }],\n      /**\n       * Border Radius End End\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-ee': [{\n        'rounded-ee': scaleRadius()\n      }],\n      /**\n       * Border Radius End Start\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-es': [{\n        'rounded-es': scaleRadius()\n      }],\n      /**\n       * Border Radius Top Left\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-tl': [{\n        'rounded-tl': scaleRadius()\n      }],\n      /**\n       * Border Radius Top Right\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-tr': [{\n        'rounded-tr': scaleRadius()\n      }],\n      /**\n       * Border Radius Bottom Right\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-br': [{\n        'rounded-br': scaleRadius()\n      }],\n      /**\n       * Border Radius Bottom Left\n       * @see https://tailwindcss.com/docs/border-radius\n       */\n      'rounded-bl': [{\n        'rounded-bl': scaleRadius()\n      }],\n      /**\n       * Border Width\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w': [{\n        border: scaleBorderWidth()\n      }],\n      /**\n       * Border Width X\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-x': [{\n        'border-x': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Y\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-y': [{\n        'border-y': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Start\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-s': [{\n        'border-s': scaleBorderWidth()\n      }],\n      /**\n       * Border Width End\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-e': [{\n        'border-e': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Top\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-t': [{\n        'border-t': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Right\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-r': [{\n        'border-r': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Bottom\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-b': [{\n        'border-b': scaleBorderWidth()\n      }],\n      /**\n       * Border Width Left\n       * @see https://tailwindcss.com/docs/border-width\n       */\n      'border-w-l': [{\n        'border-l': scaleBorderWidth()\n      }],\n      /**\n       * Divide Width X\n       * @see https://tailwindcss.com/docs/border-width#between-children\n       */\n      'divide-x': [{\n        'divide-x': scaleBorderWidth()\n      }],\n      /**\n       * Divide Width X Reverse\n       * @see https://tailwindcss.com/docs/border-width#between-children\n       */\n      'divide-x-reverse': ['divide-x-reverse'],\n      /**\n       * Divide Width Y\n       * @see https://tailwindcss.com/docs/border-width#between-children\n       */\n      'divide-y': [{\n        'divide-y': scaleBorderWidth()\n      }],\n      /**\n       * Divide Width Y Reverse\n       * @see https://tailwindcss.com/docs/border-width#between-children\n       */\n      'divide-y-reverse': ['divide-y-reverse'],\n      /**\n       * Border Style\n       * @see https://tailwindcss.com/docs/border-style\n       */\n      'border-style': [{\n        border: [...scaleLineStyle(), 'hidden', 'none']\n      }],\n      /**\n       * Divide Style\n       * @see https://tailwindcss.com/docs/border-style#setting-the-divider-style\n       */\n      'divide-style': [{\n        divide: [...scaleLineStyle(), 'hidden', 'none']\n      }],\n      /**\n       * Border Color\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color': [{\n        border: scaleColor()\n      }],\n      /**\n       * Border Color X\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-x': [{\n        'border-x': scaleColor()\n      }],\n      /**\n       * Border Color Y\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-y': [{\n        'border-y': scaleColor()\n      }],\n      /**\n       * Border Color S\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-s': [{\n        'border-s': scaleColor()\n      }],\n      /**\n       * Border Color E\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-e': [{\n        'border-e': scaleColor()\n      }],\n      /**\n       * Border Color Top\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-t': [{\n        'border-t': scaleColor()\n      }],\n      /**\n       * Border Color Right\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-r': [{\n        'border-r': scaleColor()\n      }],\n      /**\n       * Border Color Bottom\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-b': [{\n        'border-b': scaleColor()\n      }],\n      /**\n       * Border Color Left\n       * @see https://tailwindcss.com/docs/border-color\n       */\n      'border-color-l': [{\n        'border-l': scaleColor()\n      }],\n      /**\n       * Divide Color\n       * @see https://tailwindcss.com/docs/divide-color\n       */\n      'divide-color': [{\n        divide: scaleColor()\n      }],\n      /**\n       * Outline Style\n       * @see https://tailwindcss.com/docs/outline-style\n       */\n      'outline-style': [{\n        outline: [...scaleLineStyle(), 'none', 'hidden']\n      }],\n      /**\n       * Outline Offset\n       * @see https://tailwindcss.com/docs/outline-offset\n       */\n      'outline-offset': [{\n        'outline-offset': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Outline Width\n       * @see https://tailwindcss.com/docs/outline-width\n       */\n      'outline-w': [{\n        outline: ['', isNumber, isArbitraryVariableLength, isArbitraryLength]\n      }],\n      /**\n       * Outline Color\n       * @see https://tailwindcss.com/docs/outline-color\n       */\n      'outline-color': [{\n        outline: scaleColor()\n      }],\n      // ---------------\n      // --- Effects ---\n      // ---------------\n      /**\n       * Box Shadow\n       * @see https://tailwindcss.com/docs/box-shadow\n       */\n      shadow: [{\n        shadow: [\n        // Deprecated since Tailwind CSS v4.0.0\n        '', 'none', themeShadow, isArbitraryVariableShadow, isArbitraryShadow]\n      }],\n      /**\n       * Box Shadow Color\n       * @see https://tailwindcss.com/docs/box-shadow#setting-the-shadow-color\n       */\n      'shadow-color': [{\n        shadow: scaleColor()\n      }],\n      /**\n       * Inset Box Shadow\n       * @see https://tailwindcss.com/docs/box-shadow#adding-an-inset-shadow\n       */\n      'inset-shadow': [{\n        'inset-shadow': ['none', themeInsetShadow, isArbitraryVariableShadow, isArbitraryShadow]\n      }],\n      /**\n       * Inset Box Shadow Color\n       * @see https://tailwindcss.com/docs/box-shadow#setting-the-inset-shadow-color\n       */\n      'inset-shadow-color': [{\n        'inset-shadow': scaleColor()\n      }],\n      /**\n       * Ring Width\n       * @see https://tailwindcss.com/docs/box-shadow#adding-a-ring\n       */\n      'ring-w': [{\n        ring: scaleBorderWidth()\n      }],\n      /**\n       * Ring Width Inset\n       * @see https://v3.tailwindcss.com/docs/ring-width#inset-rings\n       * @deprecated since Tailwind CSS v4.0.0\n       * @see https://github.com/tailwindlabs/tailwindcss/blob/v4.0.0/packages/tailwindcss/src/utilities.ts#L4158\n       */\n      'ring-w-inset': ['ring-inset'],\n      /**\n       * Ring Color\n       * @see https://tailwindcss.com/docs/box-shadow#setting-the-ring-color\n       */\n      'ring-color': [{\n        ring: scaleColor()\n      }],\n      /**\n       * Ring Offset Width\n       * @see https://v3.tailwindcss.com/docs/ring-offset-width\n       * @deprecated since Tailwind CSS v4.0.0\n       * @see https://github.com/tailwindlabs/tailwindcss/blob/v4.0.0/packages/tailwindcss/src/utilities.ts#L4158\n       */\n      'ring-offset-w': [{\n        'ring-offset': [isNumber, isArbitraryLength]\n      }],\n      /**\n       * Ring Offset Color\n       * @see https://v3.tailwindcss.com/docs/ring-offset-color\n       * @deprecated since Tailwind CSS v4.0.0\n       * @see https://github.com/tailwindlabs/tailwindcss/blob/v4.0.0/packages/tailwindcss/src/utilities.ts#L4158\n       */\n      'ring-offset-color': [{\n        'ring-offset': scaleColor()\n      }],\n      /**\n       * Inset Ring Width\n       * @see https://tailwindcss.com/docs/box-shadow#adding-an-inset-ring\n       */\n      'inset-ring-w': [{\n        'inset-ring': scaleBorderWidth()\n      }],\n      /**\n       * Inset Ring Color\n       * @see https://tailwindcss.com/docs/box-shadow#setting-the-inset-ring-color\n       */\n      'inset-ring-color': [{\n        'inset-ring': scaleColor()\n      }],\n      /**\n       * Text Shadow\n       * @see https://tailwindcss.com/docs/text-shadow\n       */\n      'text-shadow': [{\n        'text-shadow': ['none', themeTextShadow, isArbitraryVariableShadow, isArbitraryShadow]\n      }],\n      /**\n       * Text Shadow Color\n       * @see https://tailwindcss.com/docs/text-shadow#setting-the-shadow-color\n       */\n      'text-shadow-color': [{\n        'text-shadow': scaleColor()\n      }],\n      /**\n       * Opacity\n       * @see https://tailwindcss.com/docs/opacity\n       */\n      opacity: [{\n        opacity: [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Mix Blend Mode\n       * @see https://tailwindcss.com/docs/mix-blend-mode\n       */\n      'mix-blend': [{\n        'mix-blend': [...scaleBlendMode(), 'plus-darker', 'plus-lighter']\n      }],\n      /**\n       * Background Blend Mode\n       * @see https://tailwindcss.com/docs/background-blend-mode\n       */\n      'bg-blend': [{\n        'bg-blend': scaleBlendMode()\n      }],\n      /**\n       * Mask Clip\n       * @see https://tailwindcss.com/docs/mask-clip\n       */\n      'mask-clip': [{\n        'mask-clip': ['border', 'padding', 'content', 'fill', 'stroke', 'view']\n      }, 'mask-no-clip'],\n      /**\n       * Mask Composite\n       * @see https://tailwindcss.com/docs/mask-composite\n       */\n      'mask-composite': [{\n        mask: ['add', 'subtract', 'intersect', 'exclude']\n      }],\n      /**\n       * Mask Image\n       * @see https://tailwindcss.com/docs/mask-image\n       */\n      'mask-image-linear-pos': [{\n        'mask-linear': [isNumber]\n      }],\n      'mask-image-linear-from-pos': [{\n        'mask-linear-from': scaleMaskImagePosition()\n      }],\n      'mask-image-linear-to-pos': [{\n        'mask-linear-to': scaleMaskImagePosition()\n      }],\n      'mask-image-linear-from-color': [{\n        'mask-linear-from': scaleColor()\n      }],\n      'mask-image-linear-to-color': [{\n        'mask-linear-to': scaleColor()\n      }],\n      'mask-image-t-from-pos': [{\n        'mask-t-from': scaleMaskImagePosition()\n      }],\n      'mask-image-t-to-pos': [{\n        'mask-t-to': scaleMaskImagePosition()\n      }],\n      'mask-image-t-from-color': [{\n        'mask-t-from': scaleColor()\n      }],\n      'mask-image-t-to-color': [{\n        'mask-t-to': scaleColor()\n      }],\n      'mask-image-r-from-pos': [{\n        'mask-r-from': scaleMaskImagePosition()\n      }],\n      'mask-image-r-to-pos': [{\n        'mask-r-to': scaleMaskImagePosition()\n      }],\n      'mask-image-r-from-color': [{\n        'mask-r-from': scaleColor()\n      }],\n      'mask-image-r-to-color': [{\n        'mask-r-to': scaleColor()\n      }],\n      'mask-image-b-from-pos': [{\n        'mask-b-from': scaleMaskImagePosition()\n      }],\n      'mask-image-b-to-pos': [{\n        'mask-b-to': scaleMaskImagePosition()\n      }],\n      'mask-image-b-from-color': [{\n        'mask-b-from': scaleColor()\n      }],\n      'mask-image-b-to-color': [{\n        'mask-b-to': scaleColor()\n      }],\n      'mask-image-l-from-pos': [{\n        'mask-l-from': scaleMaskImagePosition()\n      }],\n      'mask-image-l-to-pos': [{\n        'mask-l-to': scaleMaskImagePosition()\n      }],\n      'mask-image-l-from-color': [{\n        'mask-l-from': scaleColor()\n      }],\n      'mask-image-l-to-color': [{\n        'mask-l-to': scaleColor()\n      }],\n      'mask-image-x-from-pos': [{\n        'mask-x-from': scaleMaskImagePosition()\n      }],\n      'mask-image-x-to-pos': [{\n        'mask-x-to': scaleMaskImagePosition()\n      }],\n      'mask-image-x-from-color': [{\n        'mask-x-from': scaleColor()\n      }],\n      'mask-image-x-to-color': [{\n        'mask-x-to': scaleColor()\n      }],\n      'mask-image-y-from-pos': [{\n        'mask-y-from': scaleMaskImagePosition()\n      }],\n      'mask-image-y-to-pos': [{\n        'mask-y-to': scaleMaskImagePosition()\n      }],\n      'mask-image-y-from-color': [{\n        'mask-y-from': scaleColor()\n      }],\n      'mask-image-y-to-color': [{\n        'mask-y-to': scaleColor()\n      }],\n      'mask-image-radial': [{\n        'mask-radial': [isArbitraryVariable, isArbitraryValue]\n      }],\n      'mask-image-radial-from-pos': [{\n        'mask-radial-from': scaleMaskImagePosition()\n      }],\n      'mask-image-radial-to-pos': [{\n        'mask-radial-to': scaleMaskImagePosition()\n      }],\n      'mask-image-radial-from-color': [{\n        'mask-radial-from': scaleColor()\n      }],\n      'mask-image-radial-to-color': [{\n        'mask-radial-to': scaleColor()\n      }],\n      'mask-image-radial-shape': [{\n        'mask-radial': ['circle', 'ellipse']\n      }],\n      'mask-image-radial-size': [{\n        'mask-radial': [{\n          closest: ['side', 'corner'],\n          farthest: ['side', 'corner']\n        }]\n      }],\n      'mask-image-radial-pos': [{\n        'mask-radial-at': scalePosition()\n      }],\n      'mask-image-conic-pos': [{\n        'mask-conic': [isNumber]\n      }],\n      'mask-image-conic-from-pos': [{\n        'mask-conic-from': scaleMaskImagePosition()\n      }],\n      'mask-image-conic-to-pos': [{\n        'mask-conic-to': scaleMaskImagePosition()\n      }],\n      'mask-image-conic-from-color': [{\n        'mask-conic-from': scaleColor()\n      }],\n      'mask-image-conic-to-color': [{\n        'mask-conic-to': scaleColor()\n      }],\n      /**\n       * Mask Mode\n       * @see https://tailwindcss.com/docs/mask-mode\n       */\n      'mask-mode': [{\n        mask: ['alpha', 'luminance', 'match']\n      }],\n      /**\n       * Mask Origin\n       * @see https://tailwindcss.com/docs/mask-origin\n       */\n      'mask-origin': [{\n        'mask-origin': ['border', 'padding', 'content', 'fill', 'stroke', 'view']\n      }],\n      /**\n       * Mask Position\n       * @see https://tailwindcss.com/docs/mask-position\n       */\n      'mask-position': [{\n        mask: scaleBgPosition()\n      }],\n      /**\n       * Mask Repeat\n       * @see https://tailwindcss.com/docs/mask-repeat\n       */\n      'mask-repeat': [{\n        mask: scaleBgRepeat()\n      }],\n      /**\n       * Mask Size\n       * @see https://tailwindcss.com/docs/mask-size\n       */\n      'mask-size': [{\n        mask: scaleBgSize()\n      }],\n      /**\n       * Mask Type\n       * @see https://tailwindcss.com/docs/mask-type\n       */\n      'mask-type': [{\n        'mask-type': ['alpha', 'luminance']\n      }],\n      /**\n       * Mask Image\n       * @see https://tailwindcss.com/docs/mask-image\n       */\n      'mask-image': [{\n        mask: ['none', isArbitraryVariable, isArbitraryValue]\n      }],\n      // ---------------\n      // --- Filters ---\n      // ---------------\n      /**\n       * Filter\n       * @see https://tailwindcss.com/docs/filter\n       */\n      filter: [{\n        filter: [\n        // Deprecated since Tailwind CSS v3.0.0\n        '', 'none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Blur\n       * @see https://tailwindcss.com/docs/blur\n       */\n      blur: [{\n        blur: scaleBlur()\n      }],\n      /**\n       * Brightness\n       * @see https://tailwindcss.com/docs/brightness\n       */\n      brightness: [{\n        brightness: [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Contrast\n       * @see https://tailwindcss.com/docs/contrast\n       */\n      contrast: [{\n        contrast: [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Drop Shadow\n       * @see https://tailwindcss.com/docs/drop-shadow\n       */\n      'drop-shadow': [{\n        'drop-shadow': [\n        // Deprecated since Tailwind CSS v4.0.0\n        '', 'none', themeDropShadow, isArbitraryVariableShadow, isArbitraryShadow]\n      }],\n      /**\n       * Drop Shadow Color\n       * @see https://tailwindcss.com/docs/filter-drop-shadow#setting-the-shadow-color\n       */\n      'drop-shadow-color': [{\n        'drop-shadow': scaleColor()\n      }],\n      /**\n       * Grayscale\n       * @see https://tailwindcss.com/docs/grayscale\n       */\n      grayscale: [{\n        grayscale: ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Hue Rotate\n       * @see https://tailwindcss.com/docs/hue-rotate\n       */\n      'hue-rotate': [{\n        'hue-rotate': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Invert\n       * @see https://tailwindcss.com/docs/invert\n       */\n      invert: [{\n        invert: ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Saturate\n       * @see https://tailwindcss.com/docs/saturate\n       */\n      saturate: [{\n        saturate: [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Sepia\n       * @see https://tailwindcss.com/docs/sepia\n       */\n      sepia: [{\n        sepia: ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Filter\n       * @see https://tailwindcss.com/docs/backdrop-filter\n       */\n      'backdrop-filter': [{\n        'backdrop-filter': [\n        // Deprecated since Tailwind CSS v3.0.0\n        '', 'none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Blur\n       * @see https://tailwindcss.com/docs/backdrop-blur\n       */\n      'backdrop-blur': [{\n        'backdrop-blur': scaleBlur()\n      }],\n      /**\n       * Backdrop Brightness\n       * @see https://tailwindcss.com/docs/backdrop-brightness\n       */\n      'backdrop-brightness': [{\n        'backdrop-brightness': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Contrast\n       * @see https://tailwindcss.com/docs/backdrop-contrast\n       */\n      'backdrop-contrast': [{\n        'backdrop-contrast': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Grayscale\n       * @see https://tailwindcss.com/docs/backdrop-grayscale\n       */\n      'backdrop-grayscale': [{\n        'backdrop-grayscale': ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Hue Rotate\n       * @see https://tailwindcss.com/docs/backdrop-hue-rotate\n       */\n      'backdrop-hue-rotate': [{\n        'backdrop-hue-rotate': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Invert\n       * @see https://tailwindcss.com/docs/backdrop-invert\n       */\n      'backdrop-invert': [{\n        'backdrop-invert': ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Opacity\n       * @see https://tailwindcss.com/docs/backdrop-opacity\n       */\n      'backdrop-opacity': [{\n        'backdrop-opacity': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Saturate\n       * @see https://tailwindcss.com/docs/backdrop-saturate\n       */\n      'backdrop-saturate': [{\n        'backdrop-saturate': [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Backdrop Sepia\n       * @see https://tailwindcss.com/docs/backdrop-sepia\n       */\n      'backdrop-sepia': [{\n        'backdrop-sepia': ['', isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      // --------------\n      // --- Tables ---\n      // --------------\n      /**\n       * Border Collapse\n       * @see https://tailwindcss.com/docs/border-collapse\n       */\n      'border-collapse': [{\n        border: ['collapse', 'separate']\n      }],\n      /**\n       * Border Spacing\n       * @see https://tailwindcss.com/docs/border-spacing\n       */\n      'border-spacing': [{\n        'border-spacing': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Border Spacing X\n       * @see https://tailwindcss.com/docs/border-spacing\n       */\n      'border-spacing-x': [{\n        'border-spacing-x': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Border Spacing Y\n       * @see https://tailwindcss.com/docs/border-spacing\n       */\n      'border-spacing-y': [{\n        'border-spacing-y': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Table Layout\n       * @see https://tailwindcss.com/docs/table-layout\n       */\n      'table-layout': [{\n        table: ['auto', 'fixed']\n      }],\n      /**\n       * Caption Side\n       * @see https://tailwindcss.com/docs/caption-side\n       */\n      caption: [{\n        caption: ['top', 'bottom']\n      }],\n      // ---------------------------------\n      // --- Transitions and Animation ---\n      // ---------------------------------\n      /**\n       * Transition Property\n       * @see https://tailwindcss.com/docs/transition-property\n       */\n      transition: [{\n        transition: ['', 'all', 'colors', 'opacity', 'shadow', 'transform', 'none', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Transition Behavior\n       * @see https://tailwindcss.com/docs/transition-behavior\n       */\n      'transition-behavior': [{\n        transition: ['normal', 'discrete']\n      }],\n      /**\n       * Transition Duration\n       * @see https://tailwindcss.com/docs/transition-duration\n       */\n      duration: [{\n        duration: [isNumber, 'initial', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Transition Timing Function\n       * @see https://tailwindcss.com/docs/transition-timing-function\n       */\n      ease: [{\n        ease: ['linear', 'initial', themeEase, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Transition Delay\n       * @see https://tailwindcss.com/docs/transition-delay\n       */\n      delay: [{\n        delay: [isNumber, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Animation\n       * @see https://tailwindcss.com/docs/animation\n       */\n      animate: [{\n        animate: ['none', themeAnimate, isArbitraryVariable, isArbitraryValue]\n      }],\n      // ------------------\n      // --- Transforms ---\n      // ------------------\n      /**\n       * Backface Visibility\n       * @see https://tailwindcss.com/docs/backface-visibility\n       */\n      backface: [{\n        backface: ['hidden', 'visible']\n      }],\n      /**\n       * Perspective\n       * @see https://tailwindcss.com/docs/perspective\n       */\n      perspective: [{\n        perspective: [themePerspective, isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Perspective Origin\n       * @see https://tailwindcss.com/docs/perspective-origin\n       */\n      'perspective-origin': [{\n        'perspective-origin': scalePositionWithArbitrary()\n      }],\n      /**\n       * Rotate\n       * @see https://tailwindcss.com/docs/rotate\n       */\n      rotate: [{\n        rotate: scaleRotate()\n      }],\n      /**\n       * Rotate X\n       * @see https://tailwindcss.com/docs/rotate\n       */\n      'rotate-x': [{\n        'rotate-x': scaleRotate()\n      }],\n      /**\n       * Rotate Y\n       * @see https://tailwindcss.com/docs/rotate\n       */\n      'rotate-y': [{\n        'rotate-y': scaleRotate()\n      }],\n      /**\n       * Rotate Z\n       * @see https://tailwindcss.com/docs/rotate\n       */\n      'rotate-z': [{\n        'rotate-z': scaleRotate()\n      }],\n      /**\n       * Scale\n       * @see https://tailwindcss.com/docs/scale\n       */\n      scale: [{\n        scale: scaleScale()\n      }],\n      /**\n       * Scale X\n       * @see https://tailwindcss.com/docs/scale\n       */\n      'scale-x': [{\n        'scale-x': scaleScale()\n      }],\n      /**\n       * Scale Y\n       * @see https://tailwindcss.com/docs/scale\n       */\n      'scale-y': [{\n        'scale-y': scaleScale()\n      }],\n      /**\n       * Scale Z\n       * @see https://tailwindcss.com/docs/scale\n       */\n      'scale-z': [{\n        'scale-z': scaleScale()\n      }],\n      /**\n       * Scale 3D\n       * @see https://tailwindcss.com/docs/scale\n       */\n      'scale-3d': ['scale-3d'],\n      /**\n       * Skew\n       * @see https://tailwindcss.com/docs/skew\n       */\n      skew: [{\n        skew: scaleSkew()\n      }],\n      /**\n       * Skew X\n       * @see https://tailwindcss.com/docs/skew\n       */\n      'skew-x': [{\n        'skew-x': scaleSkew()\n      }],\n      /**\n       * Skew Y\n       * @see https://tailwindcss.com/docs/skew\n       */\n      'skew-y': [{\n        'skew-y': scaleSkew()\n      }],\n      /**\n       * Transform\n       * @see https://tailwindcss.com/docs/transform\n       */\n      transform: [{\n        transform: [isArbitraryVariable, isArbitraryValue, '', 'none', 'gpu', 'cpu']\n      }],\n      /**\n       * Transform Origin\n       * @see https://tailwindcss.com/docs/transform-origin\n       */\n      'transform-origin': [{\n        origin: scalePositionWithArbitrary()\n      }],\n      /**\n       * Transform Style\n       * @see https://tailwindcss.com/docs/transform-style\n       */\n      'transform-style': [{\n        transform: ['3d', 'flat']\n      }],\n      /**\n       * Translate\n       * @see https://tailwindcss.com/docs/translate\n       */\n      translate: [{\n        translate: scaleTranslate()\n      }],\n      /**\n       * Translate X\n       * @see https://tailwindcss.com/docs/translate\n       */\n      'translate-x': [{\n        'translate-x': scaleTranslate()\n      }],\n      /**\n       * Translate Y\n       * @see https://tailwindcss.com/docs/translate\n       */\n      'translate-y': [{\n        'translate-y': scaleTranslate()\n      }],\n      /**\n       * Translate Z\n       * @see https://tailwindcss.com/docs/translate\n       */\n      'translate-z': [{\n        'translate-z': scaleTranslate()\n      }],\n      /**\n       * Translate None\n       * @see https://tailwindcss.com/docs/translate\n       */\n      'translate-none': ['translate-none'],\n      // ---------------------\n      // --- Interactivity ---\n      // ---------------------\n      /**\n       * Accent Color\n       * @see https://tailwindcss.com/docs/accent-color\n       */\n      accent: [{\n        accent: scaleColor()\n      }],\n      /**\n       * Appearance\n       * @see https://tailwindcss.com/docs/appearance\n       */\n      appearance: [{\n        appearance: ['none', 'auto']\n      }],\n      /**\n       * Caret Color\n       * @see https://tailwindcss.com/docs/just-in-time-mode#caret-color-utilities\n       */\n      'caret-color': [{\n        caret: scaleColor()\n      }],\n      /**\n       * Color Scheme\n       * @see https://tailwindcss.com/docs/color-scheme\n       */\n      'color-scheme': [{\n        scheme: ['normal', 'dark', 'light', 'light-dark', 'only-dark', 'only-light']\n      }],\n      /**\n       * Cursor\n       * @see https://tailwindcss.com/docs/cursor\n       */\n      cursor: [{\n        cursor: ['auto', 'default', 'pointer', 'wait', 'text', 'move', 'help', 'not-allowed', 'none', 'context-menu', 'progress', 'cell', 'crosshair', 'vertical-text', 'alias', 'copy', 'no-drop', 'grab', 'grabbing', 'all-scroll', 'col-resize', 'row-resize', 'n-resize', 'e-resize', 's-resize', 'w-resize', 'ne-resize', 'nw-resize', 'se-resize', 'sw-resize', 'ew-resize', 'ns-resize', 'nesw-resize', 'nwse-resize', 'zoom-in', 'zoom-out', isArbitraryVariable, isArbitraryValue]\n      }],\n      /**\n       * Field Sizing\n       * @see https://tailwindcss.com/docs/field-sizing\n       */\n      'field-sizing': [{\n        'field-sizing': ['fixed', 'content']\n      }],\n      /**\n       * Pointer Events\n       * @see https://tailwindcss.com/docs/pointer-events\n       */\n      'pointer-events': [{\n        'pointer-events': ['auto', 'none']\n      }],\n      /**\n       * Resize\n       * @see https://tailwindcss.com/docs/resize\n       */\n      resize: [{\n        resize: ['none', '', 'y', 'x']\n      }],\n      /**\n       * Scroll Behavior\n       * @see https://tailwindcss.com/docs/scroll-behavior\n       */\n      'scroll-behavior': [{\n        scroll: ['auto', 'smooth']\n      }],\n      /**\n       * Scroll Margin\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-m': [{\n        'scroll-m': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin X\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-mx': [{\n        'scroll-mx': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Y\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-my': [{\n        'scroll-my': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Start\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-ms': [{\n        'scroll-ms': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin End\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-me': [{\n        'scroll-me': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Top\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-mt': [{\n        'scroll-mt': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Right\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-mr': [{\n        'scroll-mr': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Bottom\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-mb': [{\n        'scroll-mb': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Margin Left\n       * @see https://tailwindcss.com/docs/scroll-margin\n       */\n      'scroll-ml': [{\n        'scroll-ml': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-p': [{\n        'scroll-p': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding X\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-px': [{\n        'scroll-px': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Y\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-py': [{\n        'scroll-py': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Start\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-ps': [{\n        'scroll-ps': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding End\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-pe': [{\n        'scroll-pe': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Top\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-pt': [{\n        'scroll-pt': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Right\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-pr': [{\n        'scroll-pr': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Bottom\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-pb': [{\n        'scroll-pb': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Padding Left\n       * @see https://tailwindcss.com/docs/scroll-padding\n       */\n      'scroll-pl': [{\n        'scroll-pl': scaleUnambiguousSpacing()\n      }],\n      /**\n       * Scroll Snap Align\n       * @see https://tailwindcss.com/docs/scroll-snap-align\n       */\n      'snap-align': [{\n        snap: ['start', 'end', 'center', 'align-none']\n      }],\n      /**\n       * Scroll Snap Stop\n       * @see https://tailwindcss.com/docs/scroll-snap-stop\n       */\n      'snap-stop': [{\n        snap: ['normal', 'always']\n      }],\n      /**\n       * Scroll Snap Type\n       * @see https://tailwindcss.com/docs/scroll-snap-type\n       */\n      'snap-type': [{\n        snap: ['none', 'x', 'y', 'both']\n      }],\n      /**\n       * Scroll Snap Type Strictness\n       * @see https://tailwindcss.com/docs/scroll-snap-type\n       */\n      'snap-strictness': [{\n        snap: ['mandatory', 'proximity']\n      }],\n      /**\n       * Touch Action\n       * @see https://tailwindcss.com/docs/touch-action\n       */\n      touch: [{\n        touch: ['auto', 'none', 'manipulation']\n      }],\n      /**\n       * Touch Action X\n       * @see https://tailwindcss.com/docs/touch-action\n       */\n      'touch-x': [{\n        'touch-pan': ['x', 'left', 'right']\n      }],\n      /**\n       * Touch Action Y\n       * @see https://tailwindcss.com/docs/touch-action\n       */\n      'touch-y': [{\n        'touch-pan': ['y', 'up', 'down']\n      }],\n      /**\n       * Touch Action Pinch Zoom\n       * @see https://tailwindcss.com/docs/touch-action\n       */\n      'touch-pz': ['touch-pinch-zoom'],\n      /**\n       * User Select\n       * @see https://tailwindcss.com/docs/user-select\n       */\n      select: [{\n        select: ['none', 'text', 'all', 'auto']\n      }],\n      /**\n       * Will Change\n       * @see https://tailwindcss.com/docs/will-change\n       */\n      'will-change': [{\n        'will-change': ['auto', 'scroll', 'contents', 'transform', isArbitraryVariable, isArbitraryValue]\n      }],\n      // -----------\n      // --- SVG ---\n      // -----------\n      /**\n       * Fill\n       * @see https://tailwindcss.com/docs/fill\n       */\n      fill: [{\n        fill: ['none', ...scaleColor()]\n      }],\n      /**\n       * Stroke Width\n       * @see https://tailwindcss.com/docs/stroke-width\n       */\n      'stroke-w': [{\n        stroke: [isNumber, isArbitraryVariableLength, isArbitraryLength, isArbitraryNumber]\n      }],\n      /**\n       * Stroke\n       * @see https://tailwindcss.com/docs/stroke\n       */\n      stroke: [{\n        stroke: ['none', ...scaleColor()]\n      }],\n      // ---------------------\n      // --- Accessibility ---\n      // ---------------------\n      /**\n       * Forced Color Adjust\n       * @see https://tailwindcss.com/docs/forced-color-adjust\n       */\n      'forced-color-adjust': [{\n        'forced-color-adjust': ['auto', 'none']\n      }]\n    },\n    conflictingClassGroups: {\n      overflow: ['overflow-x', 'overflow-y'],\n      overscroll: ['overscroll-x', 'overscroll-y'],\n      inset: ['inset-x', 'inset-y', 'start', 'end', 'top', 'right', 'bottom', 'left'],\n      'inset-x': ['right', 'left'],\n      'inset-y': ['top', 'bottom'],\n      flex: ['basis', 'grow', 'shrink'],\n      gap: ['gap-x', 'gap-y'],\n      p: ['px', 'py', 'ps', 'pe', 'pt', 'pr', 'pb', 'pl'],\n      px: ['pr', 'pl'],\n      py: ['pt', 'pb'],\n      m: ['mx', 'my', 'ms', 'me', 'mt', 'mr', 'mb', 'ml'],\n      mx: ['mr', 'ml'],\n      my: ['mt', 'mb'],\n      size: ['w', 'h'],\n      'font-size': ['leading'],\n      'fvn-normal': ['fvn-ordinal', 'fvn-slashed-zero', 'fvn-figure', 'fvn-spacing', 'fvn-fraction'],\n      'fvn-ordinal': ['fvn-normal'],\n      'fvn-slashed-zero': ['fvn-normal'],\n      'fvn-figure': ['fvn-normal'],\n      'fvn-spacing': ['fvn-normal'],\n      'fvn-fraction': ['fvn-normal'],\n      'line-clamp': ['display', 'overflow'],\n      rounded: ['rounded-s', 'rounded-e', 'rounded-t', 'rounded-r', 'rounded-b', 'rounded-l', 'rounded-ss', 'rounded-se', 'rounded-ee', 'rounded-es', 'rounded-tl', 'rounded-tr', 'rounded-br', 'rounded-bl'],\n      'rounded-s': ['rounded-ss', 'rounded-es'],\n      'rounded-e': ['rounded-se', 'rounded-ee'],\n      'rounded-t': ['rounded-tl', 'rounded-tr'],\n      'rounded-r': ['rounded-tr', 'rounded-br'],\n      'rounded-b': ['rounded-br', 'rounded-bl'],\n      'rounded-l': ['rounded-tl', 'rounded-bl'],\n      'border-spacing': ['border-spacing-x', 'border-spacing-y'],\n      'border-w': ['border-w-x', 'border-w-y', 'border-w-s', 'border-w-e', 'border-w-t', 'border-w-r', 'border-w-b', 'border-w-l'],\n      'border-w-x': ['border-w-r', 'border-w-l'],\n      'border-w-y': ['border-w-t', 'border-w-b'],\n      'border-color': ['border-color-x', 'border-color-y', 'border-color-s', 'border-color-e', 'border-color-t', 'border-color-r', 'border-color-b', 'border-color-l'],\n      'border-color-x': ['border-color-r', 'border-color-l'],\n      'border-color-y': ['border-color-t', 'border-color-b'],\n      translate: ['translate-x', 'translate-y', 'translate-none'],\n      'translate-none': ['translate', 'translate-x', 'translate-y', 'translate-z'],\n      'scroll-m': ['scroll-mx', 'scroll-my', 'scroll-ms', 'scroll-me', 'scroll-mt', 'scroll-mr', 'scroll-mb', 'scroll-ml'],\n      'scroll-mx': ['scroll-mr', 'scroll-ml'],\n      'scroll-my': ['scroll-mt', 'scroll-mb'],\n      'scroll-p': ['scroll-px', 'scroll-py', 'scroll-ps', 'scroll-pe', 'scroll-pt', 'scroll-pr', 'scroll-pb', 'scroll-pl'],\n      'scroll-px': ['scroll-pr', 'scroll-pl'],\n      'scroll-py': ['scroll-pt', 'scroll-pb'],\n      touch: ['touch-x', 'touch-y', 'touch-pz'],\n      'touch-x': ['touch'],\n      'touch-y': ['touch'],\n      'touch-pz': ['touch']\n    },\n    conflictingClassGroupModifiers: {\n      'font-size': ['leading']\n    },\n    orderSensitiveModifiers: ['*', '**', 'after', 'backdrop', 'before', 'details-content', 'file', 'first-letter', 'first-line', 'marker', 'placeholder', 'selection']\n  };\n};\n\n/**\n * @param baseConfig Config where other config will be merged into. This object will be mutated.\n * @param configExtension Partial config to merge into the `baseConfig`.\n */\nconst mergeConfigs = (baseConfig, {\n  cacheSize,\n  prefix,\n  experimentalParseClassName,\n  extend = {},\n  override = {}\n}) => {\n  overrideProperty(baseConfig, 'cacheSize', cacheSize);\n  overrideProperty(baseConfig, 'prefix', prefix);\n  overrideProperty(baseConfig, 'experimentalParseClassName', experimentalParseClassName);\n  overrideConfigProperties(baseConfig.theme, override.theme);\n  overrideConfigProperties(baseConfig.classGroups, override.classGroups);\n  overrideConfigProperties(baseConfig.conflictingClassGroups, override.conflictingClassGroups);\n  overrideConfigProperties(baseConfig.conflictingClassGroupModifiers, override.conflictingClassGroupModifiers);\n  overrideProperty(baseConfig, 'orderSensitiveModifiers', override.orderSensitiveModifiers);\n  mergeConfigProperties(baseConfig.theme, extend.theme);\n  mergeConfigProperties(baseConfig.classGroups, extend.classGroups);\n  mergeConfigProperties(baseConfig.conflictingClassGroups, extend.conflictingClassGroups);\n  mergeConfigProperties(baseConfig.conflictingClassGroupModifiers, extend.conflictingClassGroupModifiers);\n  mergeArrayProperties(baseConfig, extend, 'orderSensitiveModifiers');\n  return baseConfig;\n};\nconst overrideProperty = (baseObject, overrideKey, overrideValue) => {\n  if (overrideValue !== undefined) {\n    baseObject[overrideKey] = overrideValue;\n  }\n};\nconst overrideConfigProperties = (baseObject, overrideObject) => {\n  if (overrideObject) {\n    for (const key in overrideObject) {\n      overrideProperty(baseObject, key, overrideObject[key]);\n    }\n  }\n};\nconst mergeConfigProperties = (baseObject, mergeObject) => {\n  if (mergeObject) {\n    for (const key in mergeObject) {\n      mergeArrayProperties(baseObject, mergeObject, key);\n    }\n  }\n};\nconst mergeArrayProperties = (baseObject, mergeObject, key) => {\n  const mergeValue = mergeObject[key];\n  if (mergeValue !== undefined) {\n    baseObject[key] = baseObject[key] ? baseObject[key].concat(mergeValue) : mergeValue;\n  }\n};\nconst extendTailwindMerge = (configExtension, ...createConfig) => typeof configExtension === 'function' ? createTailwindMerge(getDefaultConfig, configExtension, ...createConfig) : createTailwindMerge(() => mergeConfigs(getDefaultConfig(), configExtension), ...createConfig);\nconst twMerge = /*#__PURE__*/createTailwindMerge(getDefaultConfig);\nexport { createTailwindMerge, extendTailwindMerge, fromTheme, getDefaultConfig, mergeConfigs, twJoin, twMerge, validators };\n//# sourceMappingURL=bundle-mjs.mjs.map\n","/**\n * Utility functions for the design system\n */\n\nimport { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n/**\n * Conditionally join class names and merge Tailwind classes\n */\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\n// Export accessibility utilities\nexport * from './utils/accessibility';\n","/**\r\n * Enhanced Button Component\r\n * Modern button component with multiple variants, sizes, and improved accessibility\r\n */\r\n\r\nimport React from 'react';\r\nimport { cva, type VariantProps } from 'class-variance-authority';\r\nimport { cn } from '../utils';\r\nimport { Loader2 } from 'lucide-react';\r\n\r\nconst buttonVariants = cva(\r\n  'inline-flex items-center justify-center rounded-lg text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background active:scale-[0.98] select-none touch-manipulation',\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          'bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md active:bg-primary/80',\r\n        destructive:\r\n          'bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm hover:shadow-md active:bg-destructive/80',\r\n        outline:\r\n          'border border-input hover:bg-accent hover:text-accent-foreground shadow-sm hover:shadow-md active:bg-accent/80',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md active:bg-secondary/70',\r\n        ghost: 'hover:bg-accent hover:text-accent-foreground active:bg-accent/50',\r\n        link: 'underline-offset-4 hover:underline text-primary shadow-none hover:shadow-none active:text-primary/80',\r\n        success:\r\n          'bg-success text-success-foreground hover:bg-success/90 shadow-sm hover:shadow-md active:bg-success/80',\r\n        warning:\r\n          'bg-warning text-warning-foreground hover:bg-warning/90 shadow-sm hover:shadow-md active:bg-warning/80',\r\n        gradient:\r\n          'bg-gradient-to-r from-primary to-accent text-primary-foreground hover:from-primary/90 hover:to-accent/90 shadow-lg hover:shadow-xl active:from-primary/80 active:to-accent/80',\r\n      },\r\n      size: {\r\n        xs: 'h-8 px-2 text-xs rounded-md min-h-[32px] min-w-[32px]',\r\n        sm: 'h-9 px-3 text-xs rounded-md min-h-[36px] min-w-[36px]',\r\n        default: 'h-12 py-2 px-4 min-h-[44px] min-w-[44px]',\r\n        lg: 'h-12 px-6 text-base rounded-lg min-h-[48px] min-w-[48px]',\r\n        xl: 'h-16 px-8 text-lg rounded-xl min-h-[56px] min-w-[56px]',\r\n        icon: 'h-12 w-12 min-h-[44px] min-w-[44px]',\r\n        'icon-sm': 'h-9 w-9 min-h-[36px] min-w-[36px]',\r\n        'icon-lg': 'h-14 w-14 min-h-[48px] min-w-[48px]',\r\n      },\r\n      shape: {\r\n        default: '',\r\n        square: 'rounded-none',\r\n        pill: 'rounded-full',\r\n        circle: 'rounded-full',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n      shape: 'default',\r\n    },\r\n  }\r\n);\r\n\r\nexport interface ButtonProps\r\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\r\n    VariantProps<typeof buttonVariants> {\r\n  loading?: boolean;\r\n  leftIcon?: React.ReactNode;\r\n  rightIcon?: React.ReactNode;\r\n  fullWidth?: boolean;\r\n  hapticFeedback?: boolean;\r\n  longPress?: boolean;\r\n  onLongPress?: () => void;\r\n  longPressDelay?: number;\r\n  ripple?: boolean;\r\n}\r\n\r\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\r\n  (\r\n    {\r\n      className,\r\n      variant,\r\n      size,\r\n      shape,\r\n      type = 'button',\r\n      loading = false,\r\n      leftIcon,\r\n      rightIcon,\r\n      fullWidth = false,\r\n      hapticFeedback = true,\r\n      longPress = false,\r\n      onLongPress,\r\n      longPressDelay = 500,\r\n      ripple = true,\r\n      disabled,\r\n      onClick,\r\n      onTouchStart,\r\n      onTouchEnd,\r\n      onMouseDown,\r\n      onMouseUp,\r\n      children,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const isDisabled = disabled || loading;\r\n    const longPressTimerRef = React.useRef<ReturnType<typeof setTimeout> | undefined>();\r\n    const rippleTimersRef = React.useRef<Array<ReturnType<typeof setTimeout>>>([]);\r\n    const [isPressed, setIsPressed] = React.useState(false);\r\n    const [isLongPressing, setIsLongPressing] = React.useState(false);\r\n    const [ripples, setRipples] = React.useState<Array<{ x: number; y: number; id: number }>>([]);\r\n\r\n    // Haptic feedback function\r\n    const triggerHapticFeedback = React.useCallback(() => {\r\n      if (hapticFeedback && 'vibrate' in navigator) {\r\n        navigator.vibrate(50);\r\n      }\r\n    }, [hapticFeedback]);\r\n\r\n    // Touch event handlers\r\n    const handleTouchStart = React.useCallback(\r\n      (e: React.TouchEvent<HTMLButtonElement>) => {\r\n        if (isDisabled) return;\r\n\r\n        setIsPressed(true);\r\n        onTouchStart?.(e);\r\n\r\n        if (longPress && onLongPress) {\r\n          longPressTimerRef.current = setTimeout(() => {\r\n            setIsLongPressing(true);\r\n            triggerHapticFeedback();\r\n            onLongPress();\r\n          }, longPressDelay);\r\n        }\r\n      },\r\n      [isDisabled, longPress, onLongPress, longPressDelay, onTouchStart, triggerHapticFeedback]\r\n    );\r\n\r\n    const handleTouchEnd = React.useCallback(\r\n      (e: React.TouchEvent<HTMLButtonElement>) => {\r\n        setIsPressed(false);\r\n        setIsLongPressing(false);\r\n        onTouchEnd?.(e);\r\n\r\n        if (longPressTimerRef.current) {\r\n          clearTimeout(longPressTimerRef.current);\r\n        }\r\n      },\r\n      [onTouchEnd]\r\n    );\r\n\r\n    // Mouse event handlers (for desktop testing)\r\n    const handleMouseDown = React.useCallback(\r\n      (e: React.MouseEvent<HTMLButtonElement>) => {\r\n        if (isDisabled) return;\r\n\r\n        setIsPressed(true);\r\n        onMouseDown?.(e);\r\n\r\n        if (longPress && onLongPress) {\r\n          longPressTimerRef.current = setTimeout(() => {\r\n            setIsLongPressing(true);\r\n            onLongPress();\r\n          }, longPressDelay);\r\n        }\r\n      },\r\n      [isDisabled, longPress, onLongPress, longPressDelay, onMouseDown]\r\n    );\r\n\r\n    const handleMouseUp = React.useCallback(\r\n      (e: React.MouseEvent<HTMLButtonElement>) => {\r\n        setIsPressed(false);\r\n        setIsLongPressing(false);\r\n        onMouseUp?.(e);\r\n\r\n        if (longPressTimerRef.current) {\r\n          clearTimeout(longPressTimerRef.current);\r\n        }\r\n      },\r\n      [onMouseUp]\r\n    );\r\n\r\n    // Click handler with haptic feedback\r\n    const handleClick = React.useCallback(\r\n      (e: React.MouseEvent<HTMLButtonElement>) => {\r\n        if (isDisabled || isLongPressing) return;\r\n\r\n        // Add ripple effect\r\n        if (ripple) {\r\n          const rect = e.currentTarget.getBoundingClientRect();\r\n          const x = e.clientX - rect.left;\r\n          const y = e.clientY - rect.top;\r\n          const id = Date.now();\r\n\r\n          setRipples(prev => [...prev, { x, y, id }]);\r\n\r\n          // Remove ripple after animation\r\n          const timerId = setTimeout(() => {\r\n            setRipples(prev => prev.filter(r => r.id !== id));\r\n            rippleTimersRef.current = rippleTimersRef.current.filter(t => t !== timerId);\r\n          }, 600);\r\n          rippleTimersRef.current.push(timerId);\r\n        }\r\n\r\n        triggerHapticFeedback();\r\n        onClick?.(e);\r\n      },\r\n      [isDisabled, isLongPressing, ripple, triggerHapticFeedback, onClick]\r\n    );\r\n\r\n    // Cleanup timer on unmount\r\n    React.useEffect(() => {\r\n      return () => {\r\n        if (longPressTimerRef.current) {\r\n          clearTimeout(longPressTimerRef.current);\r\n        }\r\n        for (const timerId of rippleTimersRef.current) {\r\n          clearTimeout(timerId);\r\n        }\r\n        rippleTimersRef.current = [];\r\n      };\r\n    }, []);\r\n\r\n    return (\r\n      <button\r\n        className={cn(\r\n          buttonVariants({ variant, size, shape, className }),\r\n          fullWidth && 'w-full',\r\n          loading && 'cursor-wait',\r\n          isPressed && 'scale-95',\r\n          isLongPressing && 'ring-2 ring-primary ring-opacity-50',\r\n          ripple && 'relative overflow-hidden',\r\n          'touch-manipulation select-none'\r\n        )}\r\n        ref={ref}\r\n        type={type}\r\n        disabled={isDisabled}\r\n        aria-disabled={isDisabled}\r\n        aria-pressed={isPressed}\r\n        onClick={handleClick}\r\n        onTouchStart={handleTouchStart}\r\n        onTouchEnd={handleTouchEnd}\r\n        onMouseDown={handleMouseDown}\r\n        onMouseUp={handleMouseUp}\r\n        {...props}\r\n      >\r\n        {/* Ripple effects */}\r\n        {ripple &&\r\n          ripples.map(ripple => (\r\n            <span\r\n              key={ripple.id}\r\n              className=\"absolute bg-white/30 rounded-full pointer-events-none animate-ripple\"\r\n              style={{\r\n                left: ripple.x,\r\n                top: ripple.y,\r\n                width: '20px',\r\n                height: '20px',\r\n                transform: 'translate(-50%, -50%)',\r\n              }}\r\n            />\r\n          ))}\r\n\r\n        {loading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" aria-hidden=\"true\" />}\r\n        {!loading && leftIcon && (\r\n          <span className=\"mr-2 flex-shrink-0\" aria-hidden=\"true\">\r\n            {leftIcon}\r\n          </span>\r\n        )}\r\n        <span className={cn('flex items-center justify-center', loading && 'opacity-70')}>\r\n          {children}\r\n        </span>\r\n        {!loading && rightIcon && (\r\n          <span className=\"ml-2 flex-shrink-0\" aria-hidden=\"true\">\r\n            {rightIcon}\r\n          </span>\r\n        )}\r\n      </button>\r\n    );\r\n  }\r\n);\r\nButton.displayName = 'Button';\r\n\r\nexport { Button, buttonVariants };\r\n","/**\n * Enhanced Card Component\n * Modern card component with consistent styling and multiple variants\n */\n\nimport React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../utils';\n\nconst cardVariants = cva(\n  'rounded-lg border bg-card text-card-foreground shadow-md transition-all duration-200',\n  {\n    variants: {\n      variant: {\n        // default now includes a subtle border for clearer separation\n        default: 'border-border',\n        elevated: 'shadow-2xl hover:shadow-2xl/80',\n        outlined: 'border-2 shadow-none',\n        filled: 'bg-muted/50 border-muted',\n        ghost: 'border-transparent shadow-none bg-transparent',\n        gradient: 'bg-gradient-to-br from-card to-muted/50 border-muted/50',\n        // accented provides a stronger border and depth for emphasis\n        accented: 'border-2 border-primary/40 shadow-2xl hover:shadow-2xl/80',\n      },\n      padding: {\n        none: 'p-0',\n        sm: 'p-3',\n        default: 'p-6',\n        lg: 'p-8',\n        xl: 'p-10',\n      },\n      hover: {\n        none: '',\n        lift: 'hover:-translate-y-1.5 hover:shadow-2xl/70',\n        glow: 'hover:shadow-2xl hover:shadow-primary/15',\n        scale: 'hover:scale-[1.02] hover:shadow-lg',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      padding: 'default',\n      hover: 'none',\n    },\n  }\n);\n\nexport interface CardProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof cardVariants> {\n  /** Optional severity indicator for color-coding cards */\n  severity?: 'low' | 'medium' | 'high' | 'critical' | null;\n}\n\nconst Card = React.forwardRef<HTMLDivElement, CardProps>(\n  ({ className, variant, padding, hover, ...props }, ref) => (\n    <div ref={ref} className={cn(cardVariants({ variant, padding, hover, className }))} {...props}>\n      {/* severity indicator: small colored bar at the top-left */}\n      {'severity' in props && props.severity ? (\n        <div\n          aria-hidden\n          className={cn('absolute -top-2 -left-2 h-2 w-12 rounded-b-md')}\n          style={{\n            backgroundColor:\n              props.severity === 'low'\n                ? 'rgb(var(--color-pain-none))'\n                : props.severity === 'medium'\n                  ? 'rgb(var(--color-pain-mild))'\n                  : props.severity === 'high'\n                    ? 'rgb(var(--color-pain-severe))'\n                    : 'rgb(var(--color-pain-extreme))',\n          }}\n        />\n      ) : null}\n      {props.children}\n    </div>\n  )\n);\nCard.displayName = 'Card';\n\nconst CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      className={cn('flex items-center justify-between space-x-3 pb-4', className)}\n      {...props}\n    />\n  )\n);\nCardHeader.displayName = 'CardHeader';\n\nconst CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(\n  ({ className, ...props }, ref) => (\n    <h2\n      ref={ref}\n      className={cn('text-2xl font-semibold leading-none tracking-tight', className)}\n      {...props}\n    />\n  )\n);\nCardTitle.displayName = 'CardTitle';\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p ref={ref} className={cn('text-sm text-muted-foreground', className)} {...props} />\n));\nCardDescription.displayName = 'CardDescription';\n\nconst CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => <div ref={ref} className={cn('pt-0', className)} {...props} />\n);\nCardContent.displayName = 'CardContent';\n\nconst CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div ref={ref} className={cn('flex items-center pt-4', className)} {...props} />\n  )\n);\nCardFooter.displayName = 'CardFooter';\n\n// New Card variants for specific use cases\nconst CardAction = React.forwardRef<HTMLDivElement, CardProps>(({ className, ...props }, ref) => (\n  <Card\n    ref={ref}\n    className={cn('cursor-pointer hover:shadow-md transition-shadow', className)}\n    {...props}\n  />\n));\nCardAction.displayName = 'CardAction';\n\nconst CardStats = React.forwardRef<HTMLDivElement, CardProps>(\n  ({ className, children, ...props }, ref) => (\n    <Card ref={ref} variant=\"elevated\" className={cn('text-center', className)} {...props}>\n      {children}\n    </Card>\n  )\n);\nCardStats.displayName = 'CardStats';\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n  CardAction,\n  CardStats,\n  cardVariants,\n};\n","/**\r\n * Enhanced Input Component\r\n * Modern input component with consistent styling and improved accessibility\r\n */\r\n\r\nimport React from 'react';\r\nimport { cn } from '../utils';\r\nimport { Eye, EyeOff } from 'lucide-react';\r\n\r\nexport type InputProps = React.InputHTMLAttributes<HTMLInputElement> & {\r\n  label?: string;\r\n  error?: string;\r\n  helperText?: string;\r\n  startIcon?: React.ReactNode;\r\n  endIcon?: React.ReactNode;\r\n  fullWidth?: boolean;\r\n  variant?: 'default' | 'filled' | 'outlined';\r\n  mobileOptimized?: boolean;\r\n  inputMode?: 'text' | 'decimal' | 'numeric' | 'tel' | 'search' | 'email' | 'url';\r\n  autoComplete?: string;\r\n  autoCapitalize?: 'off' | 'none' | 'on' | 'sentences' | 'words' | 'characters';\r\n  autoCorrect?: 'off' | 'on';\r\n  spellCheck?: boolean;\r\n};\r\n\r\nconst Input = React.forwardRef<HTMLInputElement, InputProps>(\r\n  (\r\n    {\r\n      className,\r\n      type,\r\n      label,\r\n      error,\r\n      helperText,\r\n      startIcon,\r\n      endIcon,\r\n      fullWidth = false,\r\n      variant = 'default',\r\n      mobileOptimized = true,\r\n      inputMode,\r\n      autoComplete,\r\n      autoCapitalize,\r\n      autoCorrect,\r\n      spellCheck,\r\n      id,\r\n      required,\r\n      disabled,\r\n      ...props\r\n    },\r\n    ref\r\n  ) => {\r\n    const [showPassword, setShowPassword] = React.useState(false);\r\n    const [inputId] = React.useState(id || `input-${Math.random().toString(36).substr(2, 9)}`);\r\n    const [inputType, setInputType] = React.useState(type);\r\n\r\n    React.useEffect(() => {\r\n      if (type === 'password' && showPassword) {\r\n        setInputType('text');\r\n      } else {\r\n        setInputType(type);\r\n      }\r\n    }, [type, showPassword]);\r\n\r\n    const handleTogglePassword = () => {\r\n      setShowPassword(!showPassword);\r\n    };\r\n\r\n    // Mobile-specific input attributes\r\n    const getMobileAttributes = () => {\r\n      if (!mobileOptimized) return {};\r\n\r\n      const baseAttributes: Partial<React.InputHTMLAttributes<HTMLInputElement>> & {\r\n        style: React.CSSProperties;\r\n        'data-mobile-optimized': 'true';\r\n      } = {\r\n        // Prevent zoom on iOS\r\n        style: { fontSize: '16px' },\r\n        // Better touch targets\r\n        'data-mobile-optimized': 'true',\r\n      };\r\n\r\n      // Input mode for better keyboard\r\n      if (inputMode) {\r\n        baseAttributes.inputMode = inputMode;\r\n      } else if (type === 'number') {\r\n        baseAttributes.inputMode = 'decimal';\r\n      } else if (type === 'email') {\r\n        baseAttributes.inputMode = 'email';\r\n      } else if (type === 'tel') {\r\n        baseAttributes.inputMode = 'tel';\r\n      } else if (type === 'url') {\r\n        baseAttributes.inputMode = 'url';\r\n      }\r\n\r\n      // Autocomplete attributes\r\n      if (autoComplete) {\r\n        baseAttributes.autoComplete = autoComplete;\r\n      }\r\n\r\n      // Text input attributes\r\n      if (autoCapitalize) {\r\n        baseAttributes.autoCapitalize = autoCapitalize;\r\n      }\r\n      if (autoCorrect !== undefined) {\r\n        baseAttributes.autoCorrect = autoCorrect;\r\n      }\r\n      if (spellCheck !== undefined) {\r\n        baseAttributes.spellCheck = spellCheck;\r\n      }\r\n\r\n      return baseAttributes;\r\n    };\r\n\r\n    const mobileAttributes = getMobileAttributes();\r\n\r\n    const baseInputClasses = cn(\r\n      'flex h-12 w-full rounded-md border border-gray-300 bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-offset-1 focus-visible:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-200',\r\n      variant === 'filled' && 'bg-muted/50 border-muted',\r\n      variant === 'outlined' && 'border-2',\r\n      error && 'border-red-500 focus:ring-red-500 focus-visible:ring-red-500',\r\n      startIcon && 'pl-12',\r\n      (endIcon || type === 'password') && 'pr-12',\r\n      fullWidth && 'w-full',\r\n      mobileOptimized && 'mobile-keyboard-optimized touch-manipulation'\r\n    );\r\n\r\n    return (\r\n      <div\r\n        className={cn('space-y-2', fullWidth && 'w-full', mobileOptimized && 'mobile-form-spacing')}\r\n      >\r\n        {label && (\r\n          <label\r\n            htmlFor={inputId}\r\n            className={cn(\r\n              'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70',\r\n              error && 'text-destructive'\r\n            )}\r\n          >\r\n            {label}\r\n            {required && (\r\n              <span className=\"text-destructive ml-1\" aria-label=\"required\">\r\n                *\r\n              </span>\r\n            )}\r\n          </label>\r\n        )}\r\n\r\n        <div className=\"relative\">\r\n          {startIcon && (\r\n            <div className=\"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground z-10\">\r\n              {startIcon}\r\n            </div>\r\n          )}\r\n\r\n          <input\r\n            id={inputId}\r\n            type={inputType}\r\n            className={cn(baseInputClasses, className)}\r\n            ref={ref}\r\n            disabled={disabled}\r\n            aria-invalid={error ? 'true' : 'false'}\r\n            aria-describedby={\r\n              error ? `${inputId}-error` : helperText ? `${inputId}-helper` : undefined\r\n            }\r\n            {...mobileAttributes}\r\n            {...props}\r\n          />\r\n\r\n          {type === 'password' && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleTogglePassword}\r\n              className=\"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors z-10 min-h-[44px] min-w-[44px] flex items-center justify-center\"\r\n              aria-label={showPassword ? 'Hide password' : 'Show password'}\r\n              tabIndex={-1}\r\n            >\r\n              {showPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\r\n            </button>\r\n          )}\r\n\r\n          {endIcon && type !== 'password' && (\r\n            <div className=\"absolute right-4 top-1/2 -translate-y-1/2 text-muted-foreground z-10\">\r\n              {endIcon}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {error && (\r\n          <p\r\n            id={`${inputId}-error`}\r\n            className=\"text-sm text-destructive\"\r\n            role=\"alert\"\r\n            aria-live=\"polite\"\r\n          >\r\n            {error}\r\n          </p>\r\n        )}\r\n\r\n        {helperText && !error && (\r\n          <p id={`${inputId}-helper`} className=\"text-sm text-muted-foreground\">\r\n            {helperText}\r\n          </p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\nInput.displayName = 'Input';\r\n\r\nexport { Input };\r\n","/**\n * Badge Component\n * Modern badge component with multiple variants and sizes\n */\n\nimport React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../utils';\nimport { X } from 'lucide-react';\n\nconst badgeVariants = cva(\n  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',\n  {\n    variants: {\n      variant: {\n        default: 'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        destructive:\n          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',\n        outline: 'text-foreground',\n        success: 'border-transparent bg-success text-success-foreground hover:bg-success/80',\n        warning: 'border-transparent bg-warning text-warning-foreground hover:bg-warning/80',\n        info: 'border-transparent bg-info text-info-foreground hover:bg-info/80',\n      },\n      size: {\n        sm: 'px-2 py-0.5 text-xs',\n        default: 'px-2.5 py-0.5 text-xs',\n        lg: 'px-3 py-1 text-sm',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  }\n);\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {\n  removable?: boolean;\n  onRemove?: () => void;\n}\n\nconst Badge = React.forwardRef<HTMLDivElement, BadgeProps>(\n  ({ className, variant, size, removable = false, onRemove, children, ...props }, ref) => {\n    return (\n      <div ref={ref} className={cn(badgeVariants({ variant, size }), className)} {...props}>\n        <span className=\"flex items-center\">\n          {children}\n          {removable && onRemove && (\n            <button\n              onClick={onRemove}\n              className=\"ml-1 rounded-full hover:bg-black/10 p-0.5 -mr-1\"\n              aria-label=\"Remove\"\n            >\n              <X className=\"h-3 w-3\" />\n            </button>\n          )}\n        </span>\n      </div>\n    );\n  }\n);\nBadge.displayName = 'Badge';\n\nexport { Badge, badgeVariants };\n","/**\n * Loading Component\n * Modern loading component with multiple variants and sizes\n */\n\nimport React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../utils';\nimport { Loader2 } from 'lucide-react';\n\nconst loadingVariants = cva('animate-spin', {\n  variants: {\n    size: {\n      xs: 'h-3 w-3',\n      sm: 'h-4 w-4',\n      default: 'h-6 w-6',\n      lg: 'h-8 w-8',\n      xl: 'h-12 w-12',\n    },\n    variant: {\n      default: 'text-muted-foreground',\n      primary: 'text-primary',\n      secondary: 'text-secondary',\n      destructive: 'text-destructive',\n      success: 'text-success',\n      warning: 'text-warning',\n    },\n  },\n  defaultVariants: {\n    size: 'default',\n    variant: 'default',\n  },\n});\n\nexport interface LoadingProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof loadingVariants> {\n  text?: string;\n  fullScreen?: boolean;\n  overlay?: boolean;\n}\n\nconst Loading = React.forwardRef<HTMLDivElement, LoadingProps>(\n  ({ className, size, variant, text, fullScreen = false, overlay = false, ...props }, ref) => {\n    const content = (\n      <div\n        ref={ref}\n        className={cn(\n          'flex flex-col items-center justify-center gap-2',\n          fullScreen && 'fixed inset-0 z-50 bg-background/80 backdrop-blur-sm',\n          overlay && 'absolute inset-0 z-10 bg-background/50 backdrop-blur-sm rounded-lg',\n          className\n        )}\n        {...props}\n      >\n        <Loader2 className={cn(loadingVariants({ size, variant }))} />\n        {text && <p className=\"text-sm text-muted-foreground animate-pulse\">{text}</p>}\n      </div>\n    );\n\n    if (fullScreen || overlay) {\n      return content;\n    }\n\n    return <div className=\"flex items-center justify-center p-4\">{content}</div>;\n  }\n);\nLoading.displayName = 'Loading';\n\nconst LoadingDots = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(\n  ({ className, ...props }, ref) => (\n    <div ref={ref} className={cn('flex space-x-1', className)} {...props}>\n      <div className=\"w-2 h-2 bg-current rounded-full animate-bounce [animation-delay:-0.3s]\" />\n      <div className=\"w-2 h-2 bg-current rounded-full animate-bounce [animation-delay:-0.15s]\" />\n      <div className=\"w-2 h-2 bg-current rounded-full animate-bounce\" />\n    </div>\n  )\n);\nLoadingDots.displayName = 'LoadingDots';\n\nconst LoadingSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & {\n    lines?: number;\n    height?: string;\n  }\n>(({ className, lines = 1, height = 'h-4', ...props }, ref) => (\n  <div ref={ref} className={cn('space-y-2', className)} {...props}>\n    {Array.from({ length: lines }).map((_, i) => (\n      <div\n        key={i}\n        className={cn(\n          'bg-muted animate-pulse rounded',\n          height,\n          i === lines - 1 && lines > 1 ? 'w-3/4' : 'w-full'\n        )}\n      />\n    ))}\n  </div>\n));\nLoadingSkeleton.displayName = 'LoadingSkeleton';\n\nexport { Loading, LoadingDots, LoadingSkeleton, loadingVariants };\n","/**\r\n * Toast Notification System\r\n * Animated toast notifications with auto-dismiss and accessibility support\r\n */\r\n\r\nimport React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\r\nimport { X, CheckCircle, AlertTriangle, AlertCircle, Info } from 'lucide-react';\r\nimport { cn } from '../utils';\r\nimport { Slide } from './PageTransition';\r\n\r\nexport type ToastType = 'success' | 'error' | 'warning' | 'info';\r\nexport type ToastPosition =\r\n  | 'top-left'\r\n  | 'top-center'\r\n  | 'top-right'\r\n  | 'bottom-left'\r\n  | 'bottom-center'\r\n  | 'bottom-right';\r\n\r\nexport interface Toast {\r\n  id: string;\r\n  type: ToastType;\r\n  title: string;\r\n  message?: string;\r\n  duration?: number;\r\n  action?: {\r\n    label: string;\r\n    onClick: () => void;\r\n  };\r\n}\r\n\r\ninterface ToastContextValue {\r\n  toasts: Toast[];\r\n  addToast: (toast: Omit<Toast, 'id'>) => string;\r\n  removeToast: (id: string) => void;\r\n  clearAllToasts: () => void;\r\n}\r\n\r\nconst ToastContext = createContext<ToastContextValue | undefined>(undefined);\r\n\r\nexport function useToast() {\r\n  const context = useContext(ToastContext);\r\n  if (!context) {\r\n    throw new Error('useToast must be used within ToastProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\ninterface ToastProviderProps {\r\n  children: React.ReactNode;\r\n  position?: ToastPosition;\r\n  maxToasts?: number;\r\n}\r\n\r\nexport function ToastProvider({\r\n  children,\r\n  position = 'top-right',\r\n  maxToasts = 5,\r\n}: ToastProviderProps) {\r\n  const [toasts, setToasts] = useState<Toast[]>([]);\r\n\r\n  const removeToast = useCallback((id: string) => {\r\n    setToasts(prev => prev.filter(toast => toast.id !== id));\r\n  }, []);\r\n\r\n  const clearAllToasts = useCallback(() => {\r\n    setToasts([]);\r\n  }, []);\r\n\r\n  const addToast = useCallback(\r\n    (toast: Omit<Toast, 'id'>) => {\r\n      const id = `toast-${Date.now()}-${Math.random()}`;\r\n      const newToast: Toast = {\r\n        ...toast,\r\n        id,\r\n        duration: toast.duration ?? 5000,\r\n      };\r\n\r\n      setToasts(prev => {\r\n        const updated = [...prev, newToast];\r\n        // Limit number of toasts\r\n        return updated.slice(-maxToasts);\r\n      });\r\n\r\n      // Auto-dismiss if duration is set\r\n      if (newToast.duration && newToast.duration > 0) {\r\n        setTimeout(() => {\r\n          removeToast(id);\r\n        }, newToast.duration);\r\n      }\r\n\r\n      return id;\r\n    },\r\n    [maxToasts, removeToast]\r\n  );\r\n\r\n  return (\r\n    <ToastContext.Provider value={{ toasts, addToast, removeToast, clearAllToasts }}>\r\n      {children}\r\n      <ToastContainer toasts={toasts} position={position} onRemove={removeToast} />\r\n    </ToastContext.Provider>\r\n  );\r\n}\r\n\r\ninterface ToastContainerProps {\r\n  toasts: Toast[];\r\n  position: ToastPosition;\r\n  onRemove: (id: string) => void;\r\n}\r\n\r\nfunction ToastContainer({ toasts, position, onRemove }: ToastContainerProps) {\r\n  const positionClasses = {\r\n    'top-left': 'top-4 left-4',\r\n    'top-center': 'top-4 left-1/2 -translate-x-1/2',\r\n    'top-right': 'top-4 right-4',\r\n    'bottom-left': 'bottom-4 left-4',\r\n    'bottom-center': 'bottom-4 left-1/2 -translate-x-1/2',\r\n    'bottom-right': 'bottom-4 right-4',\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'fixed z-50 flex flex-col gap-2 pointer-events-none',\r\n        positionClasses[position]\r\n      )}\r\n      aria-live=\"polite\"\r\n      aria-atomic=\"true\"\r\n      role=\"region\"\r\n      aria-label=\"Notifications\"\r\n    >\r\n      {toasts.map(toast => (\r\n        <ToastItem key={toast.id} toast={toast} onRemove={onRemove} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\ninterface ToastItemProps {\r\n  toast: Toast;\r\n  onRemove: (id: string) => void;\r\n}\r\n\r\nfunction ToastItem({ toast, onRemove }: ToastItemProps) {\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [progress, setProgress] = useState(100);\r\n\r\n  useEffect(() => {\r\n    if (toast.duration && toast.duration > 0) {\r\n      const interval = 50;\r\n      const decrement = (interval / toast.duration) * 100;\r\n\r\n      const timer = setInterval(() => {\r\n        setProgress(prev => {\r\n          const newProgress = prev - decrement;\r\n          return newProgress > 0 ? newProgress : 0;\r\n        });\r\n      }, interval);\r\n\r\n      return () => clearInterval(timer);\r\n    }\r\n  }, [toast.duration]);\r\n\r\n  const handleClose = () => {\r\n    setIsVisible(false);\r\n    setTimeout(() => {\r\n      onRemove(toast.id);\r\n    }, 300); // Match animation duration\r\n  };\r\n\r\n  const icons = {\r\n    success: <CheckCircle className=\"h-5 w-5\" />,\r\n    error: <AlertCircle className=\"h-5 w-5\" />,\r\n    warning: <AlertTriangle className=\"h-5 w-5\" />,\r\n    info: <Info className=\"h-5 w-5\" />,\r\n  };\r\n\r\n  const colorClasses = {\r\n    success: {\r\n      bg: 'bg-emerald-50 dark:bg-emerald-900/20',\r\n      border: 'border-emerald-200 dark:border-emerald-800',\r\n      icon: 'text-emerald-600 dark:text-emerald-400',\r\n      text: 'text-emerald-900 dark:text-emerald-100',\r\n      progress: 'bg-emerald-500',\r\n    },\r\n    error: {\r\n      bg: 'bg-red-50 dark:bg-red-900/20',\r\n      border: 'border-red-200 dark:border-red-800',\r\n      icon: 'text-red-600 dark:text-red-400',\r\n      text: 'text-red-900 dark:text-red-100',\r\n      progress: 'bg-red-500',\r\n    },\r\n    warning: {\r\n      bg: 'bg-amber-50 dark:bg-amber-900/20',\r\n      border: 'border-amber-200 dark:border-amber-800',\r\n      icon: 'text-amber-600 dark:text-amber-400',\r\n      text: 'text-amber-900 dark:text-amber-100',\r\n      progress: 'bg-amber-500',\r\n    },\r\n    info: {\r\n      bg: 'bg-blue-50 dark:bg-blue-900/20',\r\n      border: 'border-blue-200 dark:border-blue-800',\r\n      icon: 'text-blue-600 dark:text-blue-400',\r\n      text: 'text-blue-900 dark:text-blue-100',\r\n      progress: 'bg-blue-500',\r\n    },\r\n  };\r\n\r\n  const colors = colorClasses[toast.type];\r\n\r\n  return (\r\n    <Slide show={isVisible} direction=\"down\" duration={300} className=\"pointer-events-auto\">\r\n      <div\r\n        className={cn(\r\n          'min-w-[320px] max-w-md rounded-lg border-2 shadow-lg backdrop-blur-sm',\r\n          'animate-[slideInRight_0.3s_ease-out]',\r\n          colors.bg,\r\n          colors.border\r\n        )}\r\n        role=\"alert\"\r\n        aria-live=\"assertive\"\r\n        aria-atomic=\"true\"\r\n      >\r\n        <div className=\"p-4\">\r\n          <div className=\"flex items-start space-x-3\">\r\n            <div className={cn('flex-shrink-0', colors.icon)}>{icons[toast.type]}</div>\r\n\r\n            <div className=\"flex-1 min-w-0\">\r\n              <p className={cn('text-sm font-semibold', colors.text)}>{toast.title}</p>\r\n              {toast.message && (\r\n                <p className={cn('text-sm mt-1 opacity-90', colors.text)}>{toast.message}</p>\r\n              )}\r\n\r\n              {toast.action && (\r\n                <button\r\n                  onClick={() => {\r\n                    toast.action!.onClick();\r\n                    handleClose();\r\n                  }}\r\n                  className={cn(\r\n                    'text-sm font-medium mt-2 hover:underline focus:outline-none focus:underline',\r\n                    colors.icon\r\n                  )}\r\n                >\r\n                  {toast.action.label}\r\n                </button>\r\n              )}\r\n            </div>\r\n\r\n            <button\r\n              onClick={handleClose}\r\n              className={cn(\r\n                'flex-shrink-0 p-1 rounded-md hover:bg-black/5 dark:hover:bg-white/5',\r\n                'focus:outline-none focus:ring-2 focus:ring-offset-2',\r\n                'transition-colors',\r\n                colors.icon\r\n              )}\r\n              aria-label=\"Close notification\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Progress bar */}\r\n        {toast.duration && toast.duration > 0 && (\r\n          <div className=\"h-1 bg-black/10 dark:bg-white/10 overflow-hidden rounded-b-lg\">\r\n            <div\r\n              className={cn('h-full transition-all ease-linear', colors.progress)}\r\n              style={{ width: `${progress}%` }}\r\n            />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Slide>\r\n  );\r\n}\r\n\r\n// Convenience hooks for common toast types\r\nexport function useSuccessToast() {\r\n  const { addToast } = useToast();\r\n  return useCallback(\r\n    (title: string, message?: string, options?: Partial<Toast>) => {\r\n      return addToast({ type: 'success', title, message, ...options });\r\n    },\r\n    [addToast]\r\n  );\r\n}\r\n\r\nexport function useErrorToast() {\r\n  const { addToast } = useToast();\r\n  return useCallback(\r\n    (title: string, message?: string, options?: Partial<Toast>) => {\r\n      return addToast({ type: 'error', title, message, ...options });\r\n    },\r\n    [addToast]\r\n  );\r\n}\r\n\r\nexport function useWarningToast() {\r\n  const { addToast } = useToast();\r\n  return useCallback(\r\n    (title: string, message?: string, options?: Partial<Toast>) => {\r\n      return addToast({ type: 'warning', title, message, ...options });\r\n    },\r\n    [addToast]\r\n  );\r\n}\r\n\r\nexport function useInfoToast() {\r\n  const { addToast } = useToast();\r\n  return useCallback(\r\n    (title: string, message?: string, options?: Partial<Toast>) => {\r\n      return addToast({ type: 'info', title, message, ...options });\r\n    },\r\n    [addToast]\r\n  );\r\n}\r\n","// Pain Tracker Brand Identity System\n\n// Helper function to get correct asset URLs with base path\nconst getAssetUrl = (path: string): string => {\n  if (typeof window !== 'undefined') {\n    // Client-side: use import.meta.env if available\n    const baseUrl = import.meta.env?.BASE_URL || '/';\n    return `${baseUrl}${path}`.replace(/\\/+/g, '/');\n  }\n  // Fallback for SSR or other contexts\n  return path.startsWith('/') ? path : `/${path}`;\n};\n\nexport const brand = {\n  // Brand Identity\n  name: 'Pain Tracker Pro',\n  tagline: 'Privacy-First Pain Tracking',\n  description: 'Local-first pain tracking with insights and shareable exports',\n\n  // Brand Colors - Medical/Healthcare Palette\n  colors: {\n    // Primary Brand Colors\n    primary: {\n      50: '#f0f9ff',\n      100: '#e0f2fe',\n      200: '#bae6fd',\n      300: '#7dd3fc',\n      400: '#38bdf8',\n      500: '#0ea5e9', // Primary brand color\n      600: '#0284c7',\n      700: '#0369a1',\n      800: '#075985',\n      900: '#0c4a6e',\n    },\n\n    // Secondary - Healing Green\n    secondary: {\n      50: '#f0fdf4',\n      100: '#dcfce7',\n      200: '#bbf7d0',\n      300: '#86efac',\n      400: '#4ade80',\n      500: '#22c55e', // Secondary brand color\n      600: '#16a34a',\n      700: '#15803d',\n      800: '#166534',\n      900: '#14532d',\n    },\n\n    // Accent - Professional Purple\n    accent: {\n      50: '#faf5ff',\n      100: '#f3e8ff',\n      200: '#e9d5ff',\n      300: '#d8b4fe',\n      400: '#c084fc',\n      500: '#a855f7', // Accent color\n      600: '#9333ea',\n      700: '#7c3aed',\n      800: '#6b21a8',\n      900: '#581c87',\n    },\n\n    // Pain Level Colors\n    pain: {\n      none: '#10b981', // Green - No pain\n      mild: '#84cc16', // Light green - Mild pain\n      moderate: '#eab308', // Yellow - Moderate pain\n      severe: '#f59e0b', // Orange - Severe pain\n      extreme: '#ef4444', // Red - Extreme pain\n    },\n\n    // Status Colors\n    status: {\n      success: '#22c55e',\n      warning: '#f59e0b',\n      error: '#ef4444',\n      info: '#3b82f6',\n    },\n\n    // Neutral Colors\n    neutral: {\n      0: '#ffffff',\n      50: '#f8fafc',\n      100: '#f1f5f9',\n      200: '#e2e8f0',\n      300: '#cbd5e1',\n      400: '#94a3b8',\n      500: '#64748b',\n      600: '#475569',\n      700: '#334155',\n      800: '#1e293b',\n      900: '#0f172a',\n    },\n  },\n\n  // Typography System\n  typography: {\n    fonts: {\n      sans: ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],\n      mono: ['Fira Code', 'Monaco', 'Consolas', 'Liberation Mono', 'Courier New', 'monospace'],\n      display: ['Cal Sans', 'Inter', 'system-ui', 'sans-serif'],\n    },\n\n    scale: {\n      xs: '0.75rem', // 12px\n      sm: '0.875rem', // 14px\n      base: '1rem', // 16px\n      lg: '1.125rem', // 18px\n      xl: '1.25rem', // 20px\n      '2xl': '1.5rem', // 24px\n      '3xl': '1.875rem', // 30px\n      '4xl': '2.25rem', // 36px\n      '5xl': '3rem', // 48px\n      '6xl': '3.75rem', // 60px\n    },\n\n    weights: {\n      light: 300,\n      normal: 400,\n      medium: 500,\n      semibold: 600,\n      bold: 700,\n      extrabold: 800,\n    },\n  },\n\n  // Logo Variations\n  logos: {\n    primary: getAssetUrl('logos/pain-tracker-logo.svg'),\n    wordmark: getAssetUrl('logos/pain-tracker-wordmark.svg'),\n    icon: getAssetUrl('logos/pain-tracker-icon.svg'),\n    iconWhite: getAssetUrl('logos/pain-tracker-icon-white.svg'),\n\n    // App Icons\n    appIcon: getAssetUrl('icons/app-icon-512.png'),\n    favicon: getAssetUrl('icons/favicon.ico'),\n  },\n\n  // Brand Voice\n  voice: {\n    tone: 'Professional, Empathetic, Innovative',\n    personality: [\n      'Trustworthy and medical-grade reliable',\n      'Empathetic to pain experiences',\n      'Innovative with cutting-edge technology',\n      'Accessible and user-friendly',\n      'Evidence-based and scientific',\n    ],\n  },\n\n  // Visual Elements\n  visual: {\n    borderRadius: {\n      sm: '0.375rem', // 6px\n      md: '0.5rem', // 8px\n      lg: '0.75rem', // 12px\n      xl: '1rem', // 16px\n      '2xl': '1.5rem', // 24px\n    },\n\n    shadows: {\n      sm: '0 1px 2px 0 rgba(0, 0, 0, 0.05)',\n      md: '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',\n      lg: '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',\n      xl: '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',\n    },\n\n    gradients: {\n      primary: 'linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%)',\n      secondary: 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)',\n      accent: 'linear-gradient(135deg, #a855f7 0%, #9333ea 100%)',\n      healing: 'linear-gradient(135deg, #0ea5e9 0%, #22c55e 100%)',\n    },\n  },\n\n  // Iconography\n  icons: {\n    style: 'Lucide React - consistent, medical-friendly',\n    weight: 'medium',\n    size: {\n      xs: 12,\n      sm: 16,\n      md: 20,\n      lg: 24,\n      xl: 32,\n    },\n  },\n\n  // Animation & Motion\n  motion: {\n    duration: {\n      fast: '150ms',\n      normal: '300ms',\n      slow: '500ms',\n    },\n\n    easing: {\n      ease: 'cubic-bezier(0.4, 0, 0.2, 1)',\n      easeIn: 'cubic-bezier(0.4, 0, 1, 1)',\n      easeOut: 'cubic-bezier(0, 0, 0.2, 1)',\n    },\n  },\n};\n\n// Brand Guidelines\nexport const brandGuidelines = {\n  logo: {\n    clearSpace: 'Minimum clear space should be 1/2 the height of the logo',\n    minSize: {\n      digital: '24px height',\n      print: '0.5 inch height',\n    },\n    usage: [\n      'Always maintain aspect ratio',\n      'Use high contrast backgrounds',\n      'Prefer primary logo on light backgrounds',\n      'Use white version on dark backgrounds',\n    ],\n  },\n\n  colors: {\n    accessibility: 'All color combinations meet WCAG 2.1 AA standards',\n    usage: [\n      'Primary blue for main actions and navigation',\n      'Secondary green for positive states and healing',\n      'Accent purple for premium features',\n      'Pain colors for medical visualizations',\n      'Neutral grays for text and backgrounds',\n    ],\n  },\n\n  typography: {\n    hierarchy: [\n      'Use display font for marketing headlines',\n      'Use Inter for all UI text and body copy',\n      'Maintain consistent line heights',\n      'Ensure 16px minimum for body text',\n    ],\n  },\n};\n\n// CSS Custom Properties Export\nexport const cssVariables = {\n  ':root': {\n    // Colors\n    '--color-primary': brand.colors.primary[500],\n    '--color-primary-foreground': brand.colors.neutral[0],\n    '--color-secondary': brand.colors.secondary[500],\n    '--color-secondary-foreground': brand.colors.neutral[0],\n    '--color-accent': brand.colors.accent[500],\n    '--color-accent-foreground': brand.colors.neutral[0],\n\n    // Pain Colors\n    '--color-pain-none': brand.colors.pain.none,\n    '--color-pain-mild': brand.colors.pain.mild,\n    '--color-pain-moderate': brand.colors.pain.moderate,\n    '--color-pain-severe': brand.colors.pain.severe,\n    '--color-pain-extreme': brand.colors.pain.extreme,\n\n    // Typography\n    '--font-sans': brand.typography.fonts.sans.join(', '),\n    '--font-mono': brand.typography.fonts.mono.join(', '),\n    '--font-display': brand.typography.fonts.display.join(', '),\n\n    // Visual\n    '--radius': brand.visual.borderRadius.md,\n    '--shadow-sm': brand.visual.shadows.sm,\n    '--shadow-md': brand.visual.shadows.md,\n    '--shadow-lg': brand.visual.shadows.lg,\n\n    // Motion\n    '--duration-fast': brand.motion.duration.fast,\n    '--duration-normal': brand.motion.duration.normal,\n    '--duration-slow': brand.motion.duration.slow,\n    '--easing': brand.motion.easing.ease,\n  },\n};\n","// Theme helper utilities for design tokens\r\nimport { cssVariables, brand } from '../brand';\r\n\r\nexport const colorVar = (name: string) => {\r\n  // Prefer runtime computed style in browser\r\n  if (typeof window !== 'undefined' && typeof document !== 'undefined') {\r\n    try {\r\n      const computed = getComputedStyle(document.documentElement)\r\n        .getPropertyValue(`--${name}`)\r\n        .trim();\r\n      if (computed) return computed;\r\n    } catch (err) {\r\n      console.warn('colorVar computedStyle failed', err);\r\n    }\r\n  }\r\n\r\n  // Fallback to brand-defined cssVariables (concrete hex values)\r\n  try {\r\n    if (\r\n      cssVariables &&\r\n      cssVariables[':root'] &&\r\n      Object.prototype.hasOwnProperty.call(cssVariables[':root'], `--${name}`)\r\n    ) {\r\n      return (cssVariables[':root'] as Record<string, string>)[`--${name}`];\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  // Final fallback to a neutral brand color\r\n  return brand.colors.neutral?.[500] ?? '#64748b';\r\n};\r\n\r\n// Convert hex color (#rrggbb or #rgb) to rgba string with provided alpha\r\nfunction hexToRgba(hex: string, alpha: number) {\r\n  if (!hex) return '';\r\n  const h = hex.trim().replace('#', '');\r\n  if (h.length === 3) {\r\n    const r = parseInt(h[0] + h[0], 16);\r\n    const g = parseInt(h[1] + h[1], 16);\r\n    const b = parseInt(h[2] + h[2], 16);\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n  if (h.length === 6) {\r\n    const r = parseInt(h.slice(0, 2), 16);\r\n    const g = parseInt(h.slice(2, 4), 16);\r\n    const b = parseInt(h.slice(4, 6), 16);\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n  return '';\r\n}\r\n\r\nexport const colorVarAlpha = (name: string, alpha: number | string) => {\r\n  const alphaNum = typeof alpha === 'string' ? parseFloat(alpha) : alpha;\r\n\r\n  // Try computed style first (browser)\r\n  if (typeof window !== 'undefined' && typeof document !== 'undefined') {\r\n    try {\r\n      const computed = getComputedStyle(document.documentElement)\r\n        .getPropertyValue(`--${name}`)\r\n        .trim();\r\n      if (computed) {\r\n        if (computed.startsWith('#')) {\r\n          const rgba = hexToRgba(computed, Number.isFinite(alphaNum) ? alphaNum : 1);\r\n          if (rgba) return rgba;\r\n        }\r\n\r\n        const rgbMatch = computed.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i);\r\n        if (rgbMatch) {\r\n          const r = rgbMatch[1],\r\n            g = rgbMatch[2],\r\n            b = rgbMatch[3];\r\n          return `rgba(${r}, ${g}, ${b}, ${Number.isFinite(alphaNum) ? alphaNum : 1})`;\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.warn('colorVarAlpha computedStyle failed', err);\r\n    }\r\n  }\r\n\r\n  // Fallback to brand css variables\r\n  try {\r\n    if (\r\n      cssVariables &&\r\n      cssVariables[':root'] &&\r\n      Object.prototype.hasOwnProperty.call(cssVariables[':root'], `--${name}`)\r\n    ) {\r\n      const val = (cssVariables[':root'] as Record<string, string>)[`--${name}`];\r\n      if (val && val.startsWith('#')) {\r\n        const rgba = hexToRgba(val, Number.isFinite(alphaNum) ? alphaNum : 1);\r\n        if (rgba) return rgba;\r\n      }\r\n      const rgbMatch = (val || '').match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i);\r\n      if (rgbMatch) {\r\n        const r = rgbMatch[1],\r\n          g = rgbMatch[2],\r\n          b = rgbMatch[3];\r\n        return `rgba(${r}, ${g}, ${b}, ${Number.isFinite(alphaNum) ? alphaNum : 1})`;\r\n      }\r\n    }\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  // Final fallback: neutral brand color with alpha\r\n  const fallback = brand.colors.neutral?.[500] ?? '#64748b';\r\n  if (fallback.startsWith('#')) {\r\n    const rgba = hexToRgba(fallback, Number.isFinite(alphaNum) ? alphaNum : 1);\r\n    if (rgba) return rgba;\r\n  }\r\n\r\n  return fallback;\r\n};\r\n\r\nexport const shadowVar = (size: 'sm' | 'md' | 'lg' | 'xl' = 'md') => `var(--shadow-${size})`;\r\n\r\nexport const radiusVar = () => `var(--radius)`;\r\n\r\nexport default {\r\n  colorVar,\r\n  colorVarAlpha,\r\n  shadowVar,\r\n  radiusVar,\r\n};\r\n","// Chart color utilities for consistent, accessible chart styling\r\nimport { brand } from '../brand';\r\n\r\n// Utility to read an RGB CSS variable (like \"14 165 233\") and return hex or rgba\r\nconst root = (typeof window !== 'undefined' && window?.document?.documentElement) || null;\r\n\r\nfunction readCssRgbVar(varName: string): string | null {\r\n  try {\r\n    if (!root) return null;\r\n    const val = getComputedStyle(root).getPropertyValue(varName).trim();\r\n    if (!val) return null;\r\n    // Expecting `r g b` or `r, g, b` or `#hex`\r\n    if (val.startsWith('#')) return val;\r\n    // normalize commas\r\n    const cleaned = val.replace(/,/g, ' ').replace(/\\s+/g, ' ').trim();\r\n    const parts = cleaned.split(' ');\r\n    if (parts.length === 3 && parts.every(p => /^\\d+$/.test(p))) {\r\n      const [r, g, b] = parts.map(Number);\r\n      return `rgb(${r} ${g} ${b})`;\r\n    }\r\n    return val || null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction rgbStringToRgba(rgbLike: string, alpha = 1): string {\r\n  if (!rgbLike) return `rgba(0,0,0,${alpha})`;\r\n  // handle formats like 'rgb(r g b)' or 'r g b' or '#rrggbb'\r\n  const hexMatch = rgbLike.match(/^#([0-9a-fA-F]{6})$/);\r\n  if (hexMatch) {\r\n    const hex = hexMatch[1];\r\n    const r = parseInt(hex.substr(0, 2), 16);\r\n    const g = parseInt(hex.substr(2, 2), 16);\r\n    const b = parseInt(hex.substr(4, 2), 16);\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n  const numMatch =\r\n    rgbLike.match(/(\\d+)\\s*(?:[, ])\\s*(\\d+)\\s*(?:[, ])\\s*(\\d+)/) ||\r\n    rgbLike.match(/(\\d+)\\s+(\\d+)\\s+(\\d+)/);\r\n  if (numMatch) {\r\n    const r = Number(numMatch[1]);\r\n    const g = Number(numMatch[2]);\r\n    const b = Number(numMatch[3]);\r\n    return `rgba(${r}, ${g}, ${b}, ${alpha})`;\r\n  }\r\n  // fallback: return provided string with alpha using css color-function if possible\r\n  return `rgba(0,0,0,${alpha})`;\r\n}\r\n\r\n// Resolve a CSS variable name to an rgba string, falling back to a brand value\r\nfunction resolveColor(varName: string, fallbackHex?: string, alpha = 1): string {\r\n  const cssVal = readCssRgbVar(varName);\r\n  if (cssVal) return rgbStringToRgba(cssVal, alpha);\r\n  if (fallbackHex) return rgbStringToRgba(fallbackHex, alpha);\r\n  return `rgba(0,0,0,${alpha})`;\r\n}\r\n\r\n// Chart color palettes derived from CSS variables (ensures theme adaptability)\r\nexport const chartColors = {\r\n  pain: {\r\n    none: resolveColor('--color-pain-none', brand.colors.pain.none),\r\n    mild: resolveColor('--color-pain-mild', brand.colors.pain.mild),\r\n    moderate: resolveColor('--color-pain-moderate', brand.colors.pain.moderate),\r\n    severe: resolveColor('--color-pain-severe', brand.colors.pain.severe),\r\n    extreme: resolveColor('--color-pain-extreme', brand.colors.pain.extreme),\r\n  },\r\n\r\n  treatment: {\r\n    primary: resolveColor('--chart-series-2', brand.colors.secondary[500]),\r\n    medication: resolveColor('--chart-series-3', brand.colors.accent[500]),\r\n    therapy: resolveColor('--chart-series-1', brand.colors.primary[600]),\r\n    lifestyle: resolveColor('--chart-series-6', brand.colors.neutral[600]),\r\n  },\r\n\r\n  analytics: {\r\n    trend: resolveColor('--chart-series-1', brand.colors.primary[500]),\r\n    average: resolveColor('--chart-series-2', brand.colors.secondary[500]),\r\n    prediction: resolveColor('--chart-series-3', brand.colors.accent[400]),\r\n    baseline: resolveColor('--chart-series-6', brand.colors.neutral[500]),\r\n  },\r\n\r\n  status: {\r\n    normal: resolveColor('--chart-series-1', brand.colors.status.info),\r\n    warning: resolveColor('--chart-series-4', brand.colors.status.warning),\r\n    critical: resolveColor('--chart-series-6', brand.colors.status.error),\r\n    success: resolveColor('--chart-series-2', brand.colors.status.success),\r\n  },\r\n\r\n  series: [\r\n    resolveColor('--chart-series-1', brand.colors.primary[500]),\r\n    resolveColor('--chart-series-2', brand.colors.secondary[500]),\r\n    resolveColor('--chart-series-3', brand.colors.accent[500]),\r\n    resolveColor('--chart-series-4', brand.colors.pain.severe),\r\n    resolveColor('--chart-series-5', brand.colors.pain.moderate),\r\n    resolveColor('--chart-series-6', brand.colors.neutral[600]),\r\n    resolveColor('--chart-series-1', brand.colors.primary[700]),\r\n    resolveColor('--chart-series-2', brand.colors.secondary[700]),\r\n    resolveColor('--chart-series-3', brand.colors.accent[700]),\r\n    resolveColor('--chart-series-6', brand.colors.pain.extreme),\r\n  ],\r\n};\r\n\r\n// Helper functions for chart colors\r\nexport const getChartColor = (\r\n  index: number,\r\n  palette: keyof typeof chartColors = 'series'\r\n): string => {\r\n  const colorArray = chartColors[palette] as unknown;\r\n  if (Array.isArray(colorArray)) return colorArray[index % colorArray.length];\r\n  // if palette is an object, return a stable value\r\n  if (typeof colorArray === 'object' && colorArray !== null) {\r\n    const values = Object.values(colorArray as Record<string, unknown>);\r\n    return String(values[index % values.length]);\r\n  }\r\n  return chartColors.series[index % chartColors.series.length];\r\n};\r\n\r\nexport const getChartColorAlpha = (\r\n  index: number,\r\n  alpha: number = 0.2,\r\n  palette: keyof typeof chartColors = 'series'\r\n): string => {\r\n  const color = getChartColor(index, palette);\r\n  // color is already an rgba string from resolveColor\r\n  if (color.startsWith('rgba')) {\r\n    // replace alpha\r\n    return color.replace(\r\n      /rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*([0-9.]+)\\)/,\r\n      `rgba($1, $2, $3, ${alpha})`\r\n    );\r\n  }\r\n  // fallback: try to parse numeric rgb\r\n  return rgbStringToRgba(color, alpha);\r\n};\r\n\r\n// Pain level color mapping\r\nexport const getPainLevelColor = (painLevel: number): string => {\r\n  if (painLevel === 0) return chartColors.pain.none;\r\n  if (painLevel <= 2) return chartColors.pain.mild;\r\n  if (painLevel <= 5) return chartColors.pain.moderate;\r\n  if (painLevel <= 7) return chartColors.pain.severe;\r\n  return chartColors.pain.extreme;\r\n};\r\n\r\n// Treatment type color mapping\r\nexport const getTreatmentColor = (treatmentType: string): string => {\r\n  switch (treatmentType.toLowerCase()) {\r\n    case 'medication':\r\n    case 'meds':\r\n      return chartColors.treatment.medication;\r\n    case 'therapy':\r\n    case 'physical therapy':\r\n    case 'pt':\r\n      return chartColors.treatment.therapy;\r\n    case 'lifestyle':\r\n    case 'exercise':\r\n    case 'diet':\r\n      return chartColors.treatment.lifestyle;\r\n    default:\r\n      return chartColors.treatment.primary;\r\n  }\r\n};\r\n\r\n// Default chart configuration colors\r\nexport const defaultChartColors = {\r\n  line: {\r\n    stroke: chartColors.analytics.trend,\r\n    fill: getChartColorAlpha(0, 0.1, 'analytics'),\r\n  },\r\n  bar: {\r\n    background: chartColors.analytics.trend,\r\n    border: chartColors.analytics.trend,\r\n  },\r\n  treatment: {\r\n    line: chartColors.treatment.primary,\r\n    medication: chartColors.treatment.medication,\r\n    therapy: chartColors.treatment.therapy,\r\n  },\r\n};\r\n","import React from 'react';\r\nimport {\r\n  Chart as ChartJS,\r\n  registerables,\r\n  ChartOptions,\r\n  ChartData as ChartJSData,\r\n  ChartType,\r\n} from 'chart.js';\r\n\r\nimport zoomPlugin from 'chartjs-plugin-zoom';\r\nimport { Line, Bar, Doughnut, Radar } from 'react-chartjs-2';\r\n\r\nimport { Card, CardContent } from './Card';\r\nimport { cn } from '../utils';\r\nimport { colorVar } from '../utils/theme';\r\nimport { getChartColor, getChartColorAlpha } from '../utils/chart-colors';\r\nimport type { ChartPointMeta, ChartPointMetaArray } from '../types/chart';\r\nimport type { TooltipItem } from 'chart.js';\r\n\r\n// Local typed dataset matching project usage\r\nexport type ChartDataset = {\r\n  label?: string;\r\n  // allow undefined as callers sometimes map undefined -> null at render time\r\n  data: (number | null | undefined)[];\r\n  yAxisID?: string;\r\n  hidden?: boolean;\r\n  backgroundColor?: string | string[];\r\n  borderColor?: string | string[];\r\n  borderWidth?: number;\r\n  borderRadius?: number | number[];\r\n  borderSkipped?: boolean | string;\r\n  fill?: boolean;\r\n  tension?: number;\r\n  // Per-point chart.js props that may be injected by mapDataset\r\n  pointBackgroundColor?: string | string[];\r\n  pointBorderColor?: string | string[];\r\n  pointRadius?: number | number[];\r\n  pointHoverRadius?: number | number[];\r\n  // allow specifying dataset-level chart type for mixed charts\r\n  type?: ChartType;\r\n  borderDash?: number[];\r\n  _meta?: ChartPointMetaArray;\r\n};\r\n\r\nexport type ChartData = {\r\n  labels: string[];\r\n  datasets: ChartDataset[];\r\n};\r\n\r\nexport type ChartConfig = {\r\n  responsive?: boolean;\r\n  maintainAspectRatio?: boolean;\r\n  showLegend?: boolean;\r\n  showTitle?: boolean;\r\n  scales?: Record<string, unknown> | undefined;\r\n  plugins?: Record<string, unknown> | undefined;\r\n};\r\n\r\nexport type ChartProps = {\r\n  data: ChartData;\r\n  type?: ChartType;\r\n  title?: string;\r\n  summary?: string;\r\n  height?: number;\r\n  className?: string;\r\n  config?: ChartConfig;\r\n};\r\n\r\n// Register Chart.js components only in browser/runtime to avoid SSR/test issues\r\nconst chartJsWithMarker = ChartJS as typeof ChartJS & { _registered?: boolean };\r\nif (typeof window !== 'undefined' && chartJsWithMarker._registered !== true) {\r\n  ChartJS.register(...registerables, zoomPlugin);\r\n  // small marker to avoid double registration\r\n  chartJsWithMarker._registered = true;\r\n}\r\n\r\nfunction mapDataset(ds: ChartDataset, chartType?: ChartType, datasetIndex: number = 0) {\r\n  const mapped: ChartDataset = {\r\n    ...ds,\r\n    ...getDefaultColors(ds, datasetIndex),\r\n    borderWidth: ds.borderWidth ?? 2,\r\n    tension: ds.tension ?? 0.4,\r\n    fill: getFillOption(ds, chartType),\r\n  };\r\n\r\n  if (chartType === 'line') {\r\n    applyLineChartStyles(mapped, ds);\r\n  }\r\n\r\n  return mapped;\r\n}\r\n\r\nfunction applyLineChartStyles(mapped: ChartDataset, ds: ChartDataset) {\r\n  mapped.pointBackgroundColor = resolvePointColor(ds.backgroundColor, mapped.backgroundColor);\r\n  mapped.pointBorderColor = resolvePointColor(ds.borderColor, mapped.borderColor);\r\n}\r\n\r\nfunction getDefaultColors(ds: ChartDataset, datasetIndex: number) {\r\n  const defaultColor = getChartColor(datasetIndex);\r\n  const defaultColorAlpha = getChartColorAlpha(datasetIndex, 0.1);\r\n\r\n  return {\r\n    borderColor: ds.borderColor ?? defaultColor,\r\n    backgroundColor: ds.backgroundColor ?? defaultColorAlpha,\r\n  };\r\n}\r\n\r\nfunction getFillOption(ds: ChartDataset, chartType?: ChartType) {\r\n  if (typeof ds.fill === 'boolean') return ds.fill;\r\n  return chartType === 'line';\r\n}\r\n\r\nfunction resolvePointColor(\r\n  color: string | string[] | undefined,\r\n  fallback: string | string[] | undefined\r\n) {\r\n  if (Array.isArray(color)) return color;\r\n  return fallback;\r\n}\r\n\r\nexport function Chart({\r\n  data,\r\n  type = 'line',\r\n  title,\r\n  summary,\r\n  height = 300,\r\n  className,\r\n  config = {},\r\n}: ChartProps & { config?: ChartConfig }) {\r\n  const {\r\n    responsive = true,\r\n    maintainAspectRatio = false,\r\n    showLegend = true,\r\n    showTitle = true,\r\n    scales,\r\n    plugins,\r\n  } = config;\r\n\r\n  const chartData = React.useMemo(\r\n    () =>\r\n      ({\r\n        labels: data.labels,\r\n        datasets: data.datasets.map((ds, index) => mapDataset(ds, type, index)),\r\n      }) as ChartJSData<ChartType>,\r\n    [data, type]\r\n  );\r\n\r\n  const options: ChartOptions<ChartType> = React.useMemo(\r\n    () => ({\r\n      responsive,\r\n      maintainAspectRatio,\r\n      devicePixelRatio: typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1,\r\n      interaction: {\r\n        mode: 'index' as const,\r\n        intersect: false,\r\n        includeInvisible: false,\r\n      },\r\n      plugins: {\r\n        legend: {\r\n          display: showLegend,\r\n          labels: {\r\n            color: colorVar('color-foreground'),\r\n            padding: typeof window !== 'undefined' && window.innerWidth < 768 ? 20 : 10,\r\n            usePointStyle: true,\r\n            pointStyle: 'circle',\r\n          },\r\n          position:\r\n            typeof window !== 'undefined' && window.innerWidth < 768\r\n              ? ('bottom' as const)\r\n              : ('top' as const),\r\n        },\r\n        title: { display: showTitle && !!title, text: title, color: colorVar('color-foreground') },\r\n        tooltip: {\r\n          enabled: true,\r\n          mode: 'nearest' as const,\r\n          intersect: false,\r\n          backgroundColor: colorVar('color-card'),\r\n          titleColor: colorVar('color-foreground'),\r\n          bodyColor: colorVar('color-foreground'),\r\n          borderColor: colorVar('color-border'),\r\n          borderWidth: 1,\r\n          padding: 12,\r\n          titleFont: {\r\n            size: typeof window !== 'undefined' && window.innerWidth < 768 ? 14 : 12,\r\n          },\r\n          bodyFont: {\r\n            size: typeof window !== 'undefined' && window.innerWidth < 768 ? 13 : 11,\r\n          },\r\n          position: 'nearest' as const,\r\n          yAlign: 'bottom' as const,\r\n          callbacks: {\r\n            label: function (context: TooltipItem<ChartType>) {\r\n              return generateTooltipLabel(context);\r\n            },\r\n          },\r\n        },\r\n        zoom: {\r\n          pan: {\r\n            enabled: true,\r\n            mode: 'xy' as const,\r\n            threshold: 10,\r\n          },\r\n          zoom: {\r\n            wheel: {\r\n              enabled: false,\r\n            },\r\n            pinch: {\r\n              enabled: true,\r\n            },\r\n            mode: 'xy' as const,\r\n          },\r\n        },\r\n        ...plugins,\r\n      },\r\n      elements: {\r\n        point: {\r\n          radius: typeof window !== 'undefined' && window.innerWidth < 768 ? 4 : 3,\r\n          hoverRadius: typeof window !== 'undefined' && window.innerWidth < 768 ? 8 : 6,\r\n          borderWidth: 2,\r\n        },\r\n        line: {\r\n          tension: 0.35,\r\n        },\r\n        bar: {\r\n          borderRadius: typeof window !== 'undefined' && window.innerWidth < 768 ? 2 : 0,\r\n        },\r\n      },\r\n      animation: {\r\n        duration: typeof window !== 'undefined' && window.innerWidth < 768 ? 200 : 400,\r\n        easing: 'easeOutQuart' as const,\r\n      },\r\n      scales:\r\n        type !== 'doughnut' && type !== 'radar'\r\n          ? {\r\n              x: {\r\n                ticks: {\r\n                  color: colorVar('color-foreground'),\r\n                  maxTicksLimit: typeof window !== 'undefined' && window.innerWidth < 768 ? 5 : 10,\r\n                  font: {\r\n                    size: typeof window !== 'undefined' && window.innerWidth < 768 ? 11 : 12,\r\n                  },\r\n                },\r\n                grid: { color: colorVar('color-border') },\r\n                pan: { enabled: true },\r\n                zoom: {\r\n                  wheel: { enabled: false },\r\n                  pinch: { enabled: true },\r\n                },\r\n              },\r\n              y: {\r\n                min: 0,\r\n                max: 10,\r\n                ticks: {\r\n                  color: colorVar('color-foreground'),\r\n                  font: {\r\n                    size: typeof window !== 'undefined' && window.innerWidth < 768 ? 11 : 12,\r\n                  },\r\n                },\r\n                grid: { color: colorVar('color-border') },\r\n                title: { display: true, text: 'Pain Level' },\r\n                pan: { enabled: true },\r\n                zoom: {\r\n                  wheel: { enabled: false },\r\n                  pinch: { enabled: true },\r\n                },\r\n              },\r\n              y1: {\r\n                position: 'right' as const,\r\n                ticks: {\r\n                  color: colorVar('color-foreground'),\r\n                  font: {\r\n                    size: typeof window !== 'undefined' && window.innerWidth < 768 ? 11 : 12,\r\n                  },\r\n                },\r\n                grid: { display: false },\r\n                title: { display: true, text: 'Entries' },\r\n                pan: { enabled: true },\r\n                zoom: {\r\n                  wheel: { enabled: false },\r\n                  pinch: { enabled: true },\r\n                },\r\n              },\r\n              ...scales,\r\n            }\r\n          : undefined,\r\n    }),\r\n    [responsive, maintainAspectRatio, showLegend, showTitle, title, type, scales, plugins]\r\n  );\r\n\r\n  const srSummary =\r\n    summary ?? (title ? `${title} chart with ${data.datasets.length} dataset(s)` : 'Chart data');\r\n\r\n  return (\r\n    <Card className={cn('w-full mobile-chart', className)}>\r\n      <CardContent className=\"p-4 md:p-6\">\r\n        <figure aria-labelledby={title ? 'chart-title' : undefined}>\r\n          {title && (\r\n            <figcaption id=\"chart-title\" className=\"sr-only\">\r\n              {title}\r\n            </figcaption>\r\n          )}\r\n          <p className=\"sr-only\" id=\"chart-summary\">\r\n            {srSummary}\r\n          </p>\r\n          <div aria-describedby=\"chart-summary\">\r\n            {type === 'bar' && (\r\n              <Bar\r\n                data={chartData as unknown as ChartJSData<'bar'>}\r\n                options={options as unknown as ChartOptions<'bar'>}\r\n                height={height}\r\n              />\r\n            )}\r\n            {type === 'doughnut' && (\r\n              <Doughnut\r\n                data={chartData as unknown as ChartJSData<'doughnut'>}\r\n                options={options as unknown as ChartOptions<'doughnut'>}\r\n                height={height}\r\n              />\r\n            )}\r\n            {type === 'radar' && (\r\n              <Radar\r\n                data={chartData as unknown as ChartJSData<'radar'>}\r\n                options={options as unknown as ChartOptions<'radar'>}\r\n                height={height}\r\n              />\r\n            )}\r\n            {type === 'line' && (\r\n              <Line\r\n                data={chartData as unknown as ChartJSData<'line'>}\r\n                options={options as unknown as ChartOptions<'line'>}\r\n                height={height}\r\n              />\r\n            )}\r\n          </div>\r\n        </figure>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nfunction generateTooltipLabel(context: TooltipItem<ChartType>) {\r\n  try {\r\n    const ds = context.dataset as unknown as ChartDataset & { _meta?: ChartPointMetaArray };\r\n    const idx = context.dataIndex;\r\n    const seriesLabel = context.dataset.label ?? '';\r\n    const value =\r\n      (context.parsed as unknown as { y?: unknown } | undefined)?.y ??\r\n      (context.parsed as unknown) ??\r\n      (context.raw as unknown) ??\r\n      '';\r\n    let line = `${seriesLabel}: ${value}`;\r\n\r\n    if (ds._meta && ds._meta[idx]) {\r\n      line += formatMetadata(ds._meta[idx]);\r\n    }\r\n\r\n    return line;\r\n  } catch {\r\n    const label = context.dataset.label;\r\n    return label ? `${label}: ${context.formattedValue}` : `${context.formattedValue}`;\r\n  }\r\n}\r\n\r\nfunction formatMetadata(meta: ChartPointMeta) {\r\n  let line = '';\r\n\r\n  if (typeof meta.count === 'number') {\r\n    line += `  ${meta.count} entr${meta.count === 1 ? 'y' : 'ies'}`;\r\n  }\r\n\r\n  const flags: string[] = [];\r\n  if (meta.notes) flags.push(`${meta.notes} notes`);\r\n  if (meta.meds) flags.push(`${meta.meds} meds`);\r\n  if (flags.length) {\r\n    line += ` (${flags.join(', ')})`;\r\n  }\r\n\r\n  return line;\r\n}\r\n\r\nexport function PainTrendChart(props: Omit<ChartProps, 'type'> & { data: ChartData }) {\r\n  return <Chart type=\"line\" {...props} />;\r\n}\r\n\r\nexport function SymptomFrequencyChart(props: Omit<ChartProps, 'type'> & { data: ChartData }) {\r\n  return <Chart type=\"bar\" {...props} />;\r\n}\r\n\r\nexport function PainDistributionChart(props: Omit<ChartProps, 'type'> & { data: ChartData }) {\r\n  return <Chart type=\"doughnut\" {...props} />;\r\n}\r\n\r\nexport function MultiDimensionalChart(props: Omit<ChartProps, 'type'> & { data: ChartData }) {\r\n  return <Chart type=\"radar\" {...props} />;\r\n}\r\n\r\nexport default Chart;\r\n","/**\r\n * Toast - Individual toast notification component\r\n */\r\n\r\nimport { useEffect, useState, useCallback, useRef } from 'react';\r\nimport { CheckCircle, XCircle, AlertCircle, Info, X } from 'lucide-react';\r\n\r\nexport interface ToastData {\r\n  id: string;\r\n  type: 'success' | 'error' | 'warning' | 'info';\r\n  title: string;\r\n  message?: string;\r\n  duration?: number;\r\n  action?: {\r\n    label: string;\r\n    onClick: () => void;\r\n  };\r\n  onDismiss?: () => void;\r\n}\r\n\r\ninterface ToastProps extends Omit<ToastData, 'onDismiss'> {\r\n  onDismiss: (id: string) => void;\r\n  customOnDismiss?: () => void;\r\n}\r\n\r\nexport function Toast({\r\n  id,\r\n  type,\r\n  title,\r\n  message,\r\n  duration = 5000,\r\n  action,\r\n  customOnDismiss,\r\n  onDismiss,\r\n}: ToastProps) {\r\n  const [isVisible, setIsVisible] = useState(true);\r\n  const [isExiting, setIsExiting] = useState(false);\r\n  const isMountedRef = useRef(true);\r\n  const dismissTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n\r\n  // Track mounted state to prevent state updates after unmount\r\n  useEffect(() => {\r\n    isMountedRef.current = true;\r\n    return () => {\r\n      isMountedRef.current = false;\r\n      // Clear any pending timeouts on unmount\r\n      if (dismissTimeoutRef.current) {\r\n        clearTimeout(dismissTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleDismiss = useCallback(() => {\r\n    if (!isMountedRef.current) return;\r\n    \r\n    setIsExiting(true);\r\n    \r\n    // Clear any existing timeout\r\n    if (dismissTimeoutRef.current) {\r\n      clearTimeout(dismissTimeoutRef.current);\r\n    }\r\n    \r\n    dismissTimeoutRef.current = setTimeout(() => {\r\n      // Check if still mounted before updating state\r\n      if (!isMountedRef.current) return;\r\n      \r\n      setIsVisible(false);\r\n      try {\r\n        onDismiss(id);\r\n        customOnDismiss?.();\r\n      } catch (error) {\r\n        // Silently handle errors during dismiss - component may be unmounting\r\n        console.debug('Toast dismiss error (safe to ignore):', error);\r\n      }\r\n    }, 150); // Animation duration\r\n  }, [id, onDismiss, customOnDismiss]);\r\n\r\n  useEffect(() => {\r\n    if (duration > 0) {\r\n      const timer = setTimeout(() => {\r\n        handleDismiss();\r\n      }, duration);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [duration, handleDismiss]);\r\n\r\n  const getIcon = () => {\r\n    switch (type) {\r\n      case 'success':\r\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />;\r\n      case 'error':\r\n        return <XCircle className=\"h-5 w-5 text-red-600\" />;\r\n      case 'warning':\r\n        return <AlertCircle className=\"h-5 w-5 text-yellow-600\" />;\r\n      case 'info':\r\n        return <Info className=\"h-5 w-5 text-blue-600\" />;\r\n      default:\r\n        return <Info className=\"h-5 w-5 text-blue-600\" />;\r\n    }\r\n  };\r\n\r\n  const getBackgroundColor = () => {\r\n    switch (type) {\r\n      case 'success':\r\n        return 'bg-green-50 border-green-200 dark:bg-green-950/30 dark:border-green-800';\r\n      case 'error':\r\n        return 'bg-red-50 border-red-200 dark:bg-red-950/30 dark:border-red-800';\r\n      case 'warning':\r\n        return 'bg-yellow-50 border-yellow-200 dark:bg-yellow-950/30 dark:border-yellow-800';\r\n      case 'info':\r\n        return 'bg-blue-50 border-blue-200 dark:bg-blue-950/30 dark:border-blue-800';\r\n      default:\r\n        return 'bg-card border-border';\r\n    }\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  return (\r\n    <div\r\n      className={`\r\n        w-full max-w-sm rounded-lg border p-4 shadow-lg\r\n        transition-all duration-150 ease-in-out\r\n        ${getBackgroundColor()}\r\n        ${isExiting ? 'opacity-0 transform translate-x-full' : 'opacity-100 transform translate-x-0'}\r\n      `}\r\n      role=\"alert\"\r\n      aria-live=\"polite\"\r\n    >\r\n      <div className=\"flex items-start space-x-3\">\r\n        <div className=\"flex-shrink-0\">{getIcon()}</div>\r\n\r\n        <div className=\"flex-1 min-w-0\">\r\n          <h4 className=\"text-sm font-semibold text-foreground\">{title}</h4>\r\n          {message && <p className=\"text-sm text-muted-foreground mt-1\">{message}</p>}\r\n\r\n          {action && (\r\n            <button\r\n              onClick={action.onClick}\r\n              className=\"pointer-events-auto text-sm font-medium text-primary hover:text-primary/80 mt-2 block\"\r\n            >\r\n              {action.label}\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleDismiss}\r\n          className=\"pointer-events-auto flex-shrink-0 text-muted-foreground hover:text-foreground transition-colors\"\r\n          aria-label=\"Dismiss notification\"\r\n        >\r\n          <X className=\"h-4 w-4\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { ToastData } from './Toast';\r\n\r\nexport function addToastToList(prev: ToastData[], newToast: ToastData, maxToasts = 6): ToastData[] {\r\n  // Deduplicate by type + title + message to avoid repeating identical toasts\r\n  const exists = prev.find(t => t.type === newToast.type && t.title === newToast.title && t.message === newToast.message);\r\n  if (exists) {\r\n    // Refresh existing toast by moving it to the end and preserving its id\r\n    const filtered = prev.filter(t => t.id !== exists.id);\r\n    return [...filtered, { ...exists, id: exists.id }];\r\n  }\r\n\r\n  const next = [...prev, newToast];\r\n  if (next.length > maxToasts) return next.slice(next.length - maxToasts);\r\n  return next;\r\n}\r\n\r\nexport function addBottomLeftToastToList(prev: ToastData[], newToast: ToastData, maxBottomToasts = 3): ToastData[] {\r\n  // Bottom-left toasts are deduplicated strongly and have a smaller cap.\r\n  const exists = prev.find(t => t.type === newToast.type && t.title === newToast.title && t.message === newToast.message);\r\n  if (exists) {\r\n    const filtered = prev.filter(t => t.id !== exists.id);\r\n    return [...filtered, { ...exists, id: exists.id }];\r\n  }\r\n\r\n  const next = [...prev, newToast];\r\n  if (next.length > maxBottomToasts) return next.slice(next.length - maxBottomToasts);\r\n  return next;\r\n}\r\n\r\nexport function removeToastById(prev: ToastData[], id: string): ToastData[] {\r\n  return prev.filter(t => t.id !== id);\r\n}\r\n","import { createContext, useContext } from 'react';\r\nimport { ToastData } from './Toast';\r\n\r\nexport interface ToastContextType {\r\n  addToast: (toast: Omit<ToastData, 'id'>) => void;\r\n  removeToast: (id: string) => void;\r\n  clearToasts: () => void;\r\n  addBottomLeftToast: (toast: Omit<ToastData, 'id'>) => void;\r\n}\r\n\r\nexport const ToastContext = createContext<ToastContextType | undefined>(undefined);\r\n\r\nexport function useToastContext() {\r\n  const context = useContext(ToastContext);\r\n  if (!context) {\r\n    throw new Error('useToastContext must be used within a ToastProvider');\r\n  }\r\n  return context;\r\n}\r\n","/**\r\n * ToastProvider - Context provider for toast notifications\r\n */\r\n\r\nimport { useState, ReactNode, Component, ErrorInfo } from 'react';\r\nimport { Toast, ToastData } from './Toast';\r\nimport { addToastToList, addBottomLeftToastToList, removeToastById } from './toastHelpers';\r\nimport { ToastContext } from './toastContext';\r\n\r\n// Simple error boundary for toast rendering - prevents toast errors from crashing the app\r\n// IMPORTANT: Does NOT try to recover/recreate toasts - just renders nothing on error\r\nclass ToastErrorBoundary extends Component<{ children: ReactNode }, { hasError: boolean }> {\r\n  constructor(props: { children: ReactNode }) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(): { hasError: boolean } {\r\n    // Mark as errored - will render nothing\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\r\n    // Log but don't crash - toast errors are non-critical\r\n    // DO NOT try to reset state or recreate - this causes infinite loops\r\n    console.debug('Toast error caught (safe to ignore):', error.message, errorInfo.componentStack);\r\n  }\r\n\r\n  render(): ReactNode {\r\n    if (this.state.hasError) {\r\n      // Render empty div - DO NOT try to recover, it causes infinite loops\r\n      return <div style={{ display: 'none' }} aria-hidden=\"true\" />;\r\n    }\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\n// ToastContext and hook live in `toastContext.ts` to keep this file focused on the provider component.\r\n\r\ninterface ToastProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function ToastProvider({ children }: ToastProviderProps) {\r\n  const [toasts, setToasts] = useState<ToastData[]>([]);\r\n  const [bottomLeftToasts, setBottomLeftToasts] = useState<ToastData[]>([]);\r\n\r\n  const addToast = (toastData: Omit<ToastData, 'id'>) => {\r\n    const id = Math.random().toString(36).substring(2, 9);\r\n    const newToast: ToastData = {\r\n      ...toastData,\r\n      id,\r\n    };\r\n\r\n    setToasts(prev => addToastToList(prev, newToast));\r\n  };\r\n\r\n  const addBottomLeftToast = (toastData: Omit<ToastData, 'id'>) => {\r\n    const id = Math.random().toString(36).substring(2, 9);\r\n    const newToast: ToastData = {\r\n      ...toastData,\r\n      id,\r\n    };\r\n\r\n    setBottomLeftToasts(prev => addBottomLeftToastToList(prev, newToast));\r\n  };\r\n\r\n  const removeToast = (id: string) => {\r\n    setToasts(prev => removeToastById(prev, id));\r\n    setBottomLeftToasts(prev => removeToastById(prev, id));\r\n  };\r\n\r\n  const clearToasts = () => {\r\n    setToasts([]);\r\n    setBottomLeftToasts([]);\r\n  };\r\n\r\n  return (\r\n    <ToastContext.Provider value={{ addToast, removeToast, clearToasts, addBottomLeftToast }}>\r\n      {children}\r\n\r\n      {/* Top-right toast container - wrapped in error boundary to prevent crashes */}\r\n      {/* Increased z-index to ensure toast appears above PWA install prompt (which uses z-index ~1001)\r\n      and other floating UI. Using a very high explicit z-index to avoid stacking conflicts. */}\r\n      <ToastErrorBoundary>\r\n        <div className=\"fixed top-4 right-4 z-[10002] flex flex-col space-y-2 pointer-events-none\">\r\n          {toasts.map(toast => (\r\n            <Toast\r\n              key={toast.id}\r\n              {...toast}\r\n              customOnDismiss={toast.onDismiss}\r\n              onDismiss={(id?: string) => removeToast(id ?? toast.id)}\r\n            />\r\n          ))}\r\n        </div>\r\n      </ToastErrorBoundary>\r\n\r\n      {/* Bottom-left toast container - wrapped in error boundary to prevent crashes */}\r\n      {/* Keep bottom-left toasts slightly lower than top-right but still very high to avoid being overlapped */}\r\n      <ToastErrorBoundary>\r\n        <div className=\"fixed bottom-4 left-4 z-[10000] flex flex-col space-y-2 pointer-events-none max-w-[90%]\">\r\n          {bottomLeftToasts.map(toast => (\r\n            <Toast\r\n              key={toast.id}\r\n              {...toast}\r\n              customOnDismiss={toast.onDismiss}\r\n              onDismiss={(id?: string) => removeToast(id ?? toast.id)}\r\n            />\r\n          ))}\r\n        </div>\r\n      </ToastErrorBoundary>\r\n    </ToastContext.Provider>\r\n  );\r\n}\r\n","/**\n * useToast - Hook for using toast notifications\n */\n\nimport { useToastContext } from './toastContext';\n\nexport function useToast() {\n  const { addToast, removeToast, clearToasts, addBottomLeftToast } = useToastContext();\n\n  const toast = {\n    success: (title: string, message?: string, action?: { label: string; onClick: () => void }) => {\n      addToast({\n        type: 'success',\n        title,\n        message,\n        action,\n      });\n    },\n\n    error: (title: string, message?: string, action?: { label: string; onClick: () => void }) => {\n      addToast({\n        type: 'error',\n        title,\n        message,\n        action,\n        duration: 7000, // Longer duration for errors\n      });\n    },\n\n    warning: (title: string, message?: string, action?: { label: string; onClick: () => void }) => {\n      addToast({\n        type: 'warning',\n        title,\n        message,\n        action,\n        duration: 6000,\n      });\n    },\n\n    info: (title: string, message?: string, action?: { label: string; onClick: () => void }) => {\n      addToast({\n        type: 'info',\n        title,\n        message,\n        action,\n      });\n    },\n\n    bottomLeft: {\n      success: (\n        title: string,\n        message?: string,\n        action?: { label: string; onClick: () => void },\n        options?: { onDismiss?: () => void }\n      ) => {\n        addBottomLeftToast({\n          type: 'success',\n          title,\n          message,\n          action,\n          onDismiss: options?.onDismiss,\n        });\n      },\n\n      error: (\n        title: string,\n        message?: string,\n        action?: { label: string; onClick: () => void },\n        options?: { onDismiss?: () => void }\n      ) => {\n        addBottomLeftToast({\n          type: 'error',\n          title,\n          message,\n          action,\n          duration: 7000,\n          onDismiss: options?.onDismiss,\n        });\n      },\n\n      warning: (\n        title: string,\n        message?: string,\n        action?: { label: string; onClick: () => void },\n        options?: { onDismiss?: () => void }\n      ) => {\n        addBottomLeftToast({\n          type: 'warning',\n          title,\n          message,\n          action,\n          duration: 6000,\n          onDismiss: options?.onDismiss,\n        });\n      },\n\n      info: (\n        title: string,\n        message?: string,\n        action?: { label: string; onClick: () => void },\n        options?: { onDismiss?: () => void }\n      ) => {\n        addBottomLeftToast({\n          type: 'info',\n          title,\n          message,\n          action,\n          onDismiss: options?.onDismiss,\n        });\n      },\n    },\n\n    custom: (toastData: Parameters<typeof addToast>[0]) => {\n      addToast(toastData);\n    },\n\n    dismiss: removeToast,\n    clear: clearToasts,\n  };\n\n  return toast;\n}\n","/**\n * Trauma-Informed UX Types and Constants\n */\n\n// User Preferences Interface\nexport interface TraumaInformedPreferences {\n  // Cognitive Support\n  simplifiedMode: boolean;\n  showMemoryAids: boolean;\n  autoSave: boolean;\n  showProgress: boolean;\n  showCognitiveLoadIndicators: boolean;\n  adaptiveComplexity: boolean;\n\n  // Visual Preferences\n  fontSize: 'small' | 'medium' | 'large' | 'xl';\n  contrast: 'normal' | 'high' | 'extra-high';\n  reduceMotion: boolean;\n\n  // Interaction Preferences\n  touchTargetSize: 'normal' | 'large' | 'extra-large';\n  confirmationLevel: 'minimal' | 'standard' | 'high';\n  voiceInput: boolean;\n\n  // Emotional Safety\n  gentleLanguage: boolean;\n  hideDistressingContent: boolean;\n  showComfortPrompts: boolean;\n  enableContentWarnings: boolean;\n  contentWarningLevel: 'minimal' | 'standard' | 'comprehensive';\n\n  // Crisis Support\n  enableCrisisDetection: boolean;\n  crisisDetectionSensitivity: 'low' | 'medium' | 'high';\n  showCrisisResources: boolean;\n\n  // Progressive Disclosure\n  enableProgressiveDisclosure: boolean;\n  defaultDisclosureLevel: 'essential' | 'helpful' | 'advanced' | 'expert';\n  adaptiveDisclosure: boolean;\n\n  // Validation Technology Features\n  realTimeValidation: boolean;\n  theme: 'light' | 'dark' | 'high-contrast' | 'auto';\n  reminderFrequency: 'none' | 'daily' | 'twice-daily' | 'weekly';\n}\n\n// Default preferences optimized for trauma-informed care\nexport const defaultPreferences: TraumaInformedPreferences = {\n  simplifiedMode: true,\n  showMemoryAids: true,\n  autoSave: true,\n  showProgress: true,\n  showCognitiveLoadIndicators: true,\n  adaptiveComplexity: true,\n  fontSize: 'medium',\n  contrast: 'normal',\n  reduceMotion: false,\n  touchTargetSize: 'large',\n  confirmationLevel: 'standard',\n  voiceInput: false,\n  gentleLanguage: true,\n  hideDistressingContent: false,\n  showComfortPrompts: true,\n  enableContentWarnings: true,\n  contentWarningLevel: 'standard',\n  enableCrisisDetection: true,\n  crisisDetectionSensitivity: 'medium',\n  showCrisisResources: true,\n  enableProgressiveDisclosure: true,\n  defaultDisclosureLevel: 'helpful',\n  adaptiveDisclosure: true,\n  realTimeValidation: true,\n  theme: 'auto',\n  reminderFrequency: 'daily',\n};\n\n// Context interface\nexport interface TraumaInformedContextType {\n  preferences: TraumaInformedPreferences;\n  updatePreferences: (updates: Partial<TraumaInformedPreferences>) => void;\n}\n\n// Helper functions\nexport const getFontSizeValue = (size: TraumaInformedPreferences['fontSize']): string => {\n  const fontSizeMap = {\n    small: '14px',\n    medium: '16px',\n    large: '18px',\n    xl: '20px',\n  };\n  return fontSizeMap[size];\n};\n\nexport const getTouchSizeValue = (size: TraumaInformedPreferences['touchTargetSize']): string => {\n  const touchSizeMap = {\n    normal: '44px',\n    large: '56px',\n    'extra-large': '72px',\n  };\n  return touchSizeMap[size];\n};\n","/**\r\n * Trauma-Informed UX Hooks\r\n *\r\n * Provides comprehensive accessibility and trauma-informed preferences management.\r\n * These hooks enable components to adapt their behavior and presentation\r\n * based on user needs and preferences.\r\n */\r\n\r\nimport { useContext, createContext, useCallback, useMemo } from 'react';\r\nimport {\r\n  TraumaInformedContextType,\r\n  TraumaInformedPreferences,\r\n  defaultPreferences,\r\n  getFontSizeValue,\r\n  getTouchSizeValue,\r\n} from './TraumaInformedTypes';\r\n\r\n// Context for trauma-informed preferences\r\nexport const TraumaInformedContext = createContext<TraumaInformedContextType>({\r\n  preferences: defaultPreferences,\r\n  updatePreferences: () => {},\r\n});\r\n\r\n/**\r\n * Main hook for accessing trauma-informed preferences\r\n * @returns Current preferences and update function\r\n */\r\nexport const useTraumaInformed = () => useContext(TraumaInformedContext);\r\n\r\n/**\r\n * Hook for cognitive load management\r\n * Returns computed values for managing cognitive complexity\r\n */\r\nexport function useCognitiveSupport() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Whether to show simplified UI */\r\n      isSimplified: preferences.simplifiedMode,\r\n      /** Whether to show memory aids and hints */\r\n      showMemoryAids: preferences.showMemoryAids,\r\n      /** Whether to auto-save user input */\r\n      autoSave: preferences.autoSave,\r\n      /** Whether to show progress indicators */\r\n      showProgress: preferences.showProgress,\r\n      /** Current cognitive load indicator preference */\r\n      showLoadIndicators: preferences.showCognitiveLoadIndicators,\r\n      /** Whether complexity should adapt to user behavior */\r\n      adaptiveComplexity: preferences.adaptiveComplexity,\r\n      /** Current disclosure level for progressive disclosure */\r\n      disclosureLevel: preferences.defaultDisclosureLevel,\r\n    }),\r\n    [preferences]\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for visual accessibility preferences\r\n * Returns CSS values and computed flags for visual adaptations\r\n */\r\nexport function useVisualPreferences() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Current font size CSS value */\r\n      fontSize: getFontSizeValue(preferences.fontSize),\r\n      /** Current font size setting */\r\n      fontSizeSetting: preferences.fontSize,\r\n      /** Current contrast level */\r\n      contrast: preferences.contrast,\r\n      /** Whether high contrast is enabled */\r\n      isHighContrast: preferences.contrast !== 'normal',\r\n      /** Whether motion should be reduced */\r\n      reduceMotion: preferences.reduceMotion,\r\n      /** CSS animation duration based on motion preference */\r\n      animationDuration: preferences.reduceMotion ? '0ms' : undefined,\r\n    }),\r\n    [preferences]\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for interaction preferences\r\n * Returns values for touch targets and confirmation behaviors\r\n */\r\nexport function useInteractionPreferences() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Current touch target size CSS value */\r\n      touchTargetSize: getTouchSizeValue(preferences.touchTargetSize),\r\n      /** Current touch target setting */\r\n      touchTargetSetting: preferences.touchTargetSize,\r\n      /** Current confirmation level */\r\n      confirmationLevel: preferences.confirmationLevel,\r\n      /** Whether to require confirmation for important actions */\r\n      requireConfirmation: preferences.confirmationLevel !== 'minimal',\r\n      /** Whether to show extra confirmation for destructive actions */\r\n      strictConfirmation: preferences.confirmationLevel === 'high',\r\n      /** Whether voice input is enabled */\r\n      voiceInputEnabled: preferences.voiceInput,\r\n    }),\r\n    [preferences]\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for emotional safety preferences\r\n * Returns flags for gentle language and content warnings\r\n */\r\nexport function useEmotionalSafety() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Whether to use gentle, empathetic language */\r\n      useGentleLanguage: preferences.gentleLanguage,\r\n      /** Whether to hide potentially distressing content */\r\n      hideDistressing: preferences.hideDistressingContent,\r\n      /** Whether to show comfort prompts during difficult moments */\r\n      showComfortPrompts: preferences.showComfortPrompts,\r\n      /** Whether to show content warnings */\r\n      enableContentWarnings: preferences.enableContentWarnings,\r\n      /** Current content warning level */\r\n      warningLevel: preferences.contentWarningLevel,\r\n      /** Helper to get appropriate message based on gentle language setting */\r\n      getMessage: (gentle: string, standard: string) =>\r\n        preferences.gentleLanguage ? gentle : standard,\r\n    }),\r\n    [preferences]\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for crisis detection and support\r\n * Returns flags and helpers for crisis management\r\n */\r\nexport function useCrisisSupport() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Whether crisis detection is enabled */\r\n      crisisDetectionEnabled: preferences.enableCrisisDetection,\r\n      /** Current detection sensitivity */\r\n      sensitivity: preferences.crisisDetectionSensitivity,\r\n      /** Whether to show crisis resources */\r\n      showResources: preferences.showCrisisResources,\r\n      /** Crisis detection thresholds based on sensitivity */\r\n      thresholds: {\r\n        painLevel:\r\n          preferences.crisisDetectionSensitivity === 'high'\r\n            ? 7\r\n            : preferences.crisisDetectionSensitivity === 'medium'\r\n              ? 8\r\n              : 9,\r\n        distressKeywords:\r\n          preferences.crisisDetectionSensitivity === 'high'\r\n            ? 1\r\n            : preferences.crisisDetectionSensitivity === 'medium'\r\n              ? 2\r\n              : 3,\r\n      },\r\n    }),\r\n    [preferences]\r\n  );\r\n}\r\n\r\n/**\r\n * Hook for progressive disclosure preferences\r\n */\r\nexport function useProgressiveDisclosure() {\r\n  const { preferences } = useTraumaInformed();\r\n\r\n  const getVisibilityForLevel = useCallback(\r\n    (requiredLevel: TraumaInformedPreferences['defaultDisclosureLevel']) => {\r\n      if (!preferences.enableProgressiveDisclosure) return true;\r\n\r\n      const levels = ['essential', 'helpful', 'advanced', 'expert'] as const;\r\n      const currentIndex = levels.indexOf(preferences.defaultDisclosureLevel);\r\n      const requiredIndex = levels.indexOf(requiredLevel);\r\n\r\n      return currentIndex >= requiredIndex;\r\n    },\r\n    [preferences.enableProgressiveDisclosure, preferences.defaultDisclosureLevel]\r\n  );\r\n\r\n  return useMemo(\r\n    () => ({\r\n      /** Whether progressive disclosure is enabled */\r\n      enabled: preferences.enableProgressiveDisclosure,\r\n      /** Current disclosure level */\r\n      level: preferences.defaultDisclosureLevel,\r\n      /** Whether disclosure adapts based on user behavior */\r\n      adaptive: preferences.adaptiveDisclosure,\r\n      /** Check if content at a given level should be visible */\r\n      isVisible: getVisibilityForLevel,\r\n      /** Convenience flags for common levels */\r\n      showEssential: true,\r\n      showHelpful: getVisibilityForLevel('helpful'),\r\n      showAdvanced: getVisibilityForLevel('advanced'),\r\n      showExpert: getVisibilityForLevel('expert'),\r\n    }),\r\n    [preferences, getVisibilityForLevel]\r\n  );\r\n}\r\n\r\n/**\r\n * Combined hook that returns all preference categories\r\n * Use this when you need access to multiple preference types\r\n */\r\nexport function useAllTraumaInformedPreferences() {\r\n  const { preferences, updatePreferences } = useTraumaInformed();\r\n  const cognitive = useCognitiveSupport();\r\n  const visual = useVisualPreferences();\r\n  const interaction = useInteractionPreferences();\r\n  const emotional = useEmotionalSafety();\r\n  const crisis = useCrisisSupport();\r\n  const disclosure = useProgressiveDisclosure();\r\n\r\n  return useMemo(\r\n    () => ({\r\n      raw: preferences,\r\n      update: updatePreferences,\r\n      cognitive,\r\n      visual,\r\n      interaction,\r\n      emotional,\r\n      crisis,\r\n      disclosure,\r\n    }),\r\n    [preferences, updatePreferences, cognitive, visual, interaction, emotional, crisis, disclosure]\r\n  );\r\n}\r\n","/**\n * secureStorage - wrapper around localStorage with:\n *  - try/catch safety\n *  - size / quota guard\n *  - optional JSON + (future) encryption hook\n *  - namespacing & allowed key whitelist pattern\n */\n\nexport interface SecureStorageOptions {\n  encrypt?: boolean; // reserved for future encryption integration\n  namespace?: string; // prefix keys\n  maxValueSizeBytes?: number; // guard large blobs\n  // Optional custom crypto hooks (return string <-> string)\n  encryptFn?: (plaintext: string) => string;\n  decryptFn?: (ciphertext: string) => string;\n}\n\ninterface SetResult {\n  success: boolean;\n  error?: string;\n  bytes?: number;\n  truncated?: boolean;\n}\n\nconst DEFAULT_NAMESPACE = 'pt';\nconst DEFAULT_MAX_VALUE = 50 * 1024; // 50KB per item heuristic\n\nconst allowedKeyPattern = /^[a-z0-9:_-]+$/i;\n\nfunction namespaced(key: string, ns?: string) {\n  return `${ns || DEFAULT_NAMESPACE}:${key}`;\n}\n\nfunction safeStringify(value: unknown): { data: string; truncated: boolean; bytes: number } {\n  try {\n    const data = typeof value === 'string' ? value : JSON.stringify(value);\n    const bytes = new Blob([data]).size;\n    return { data, truncated: false, bytes };\n  } catch {\n    return { data: '\"__SERIALIZATION_ERROR__\"', truncated: false, bytes: 28 };\n  }\n}\n\nexport const secureStorage = {\n  get<T = unknown>(key: string, options?: SecureStorageOptions): T | null {\n    try {\n      if (!allowedKeyPattern.test(key)) return null;\n      const fullKey = namespaced(key, options?.namespace);\n      const raw = localStorage.getItem(fullKey);\n      if (raw == null) return null;\n      if (raw === '\"__SERIALIZATION_ERROR__\"') return null;\n      try {\n        let decoded = raw;\n        if (options?.encrypt) {\n          const decrypt =\n            options.decryptFn ||\n            (globalThis as unknown as { __secureStorageDecrypt?: (c: string) => string })\n              .__secureStorageDecrypt;\n          if (!decrypt) {\n            return null;\n          }\n          try {\n            decoded = decrypt(raw);\n          } catch {\n            return null; // decryption failure treated as missing\n          }\n        }\n        return JSON.parse(decoded) as T;\n      } catch {\n        // return raw string if not JSON\n        return raw as unknown as T;\n      }\n    } catch {\n      return null;\n    }\n  },\n\n  set(key: string, value: unknown, options?: SecureStorageOptions): SetResult {\n    if (!allowedKeyPattern.test(key)) {\n      return { success: false, error: 'INVALID_KEY' };\n    }\n    const fullKey = namespaced(key, options?.namespace);\n    try {\n      const { data, bytes } = safeStringify(value);\n      const limit = options?.maxValueSizeBytes ?? DEFAULT_MAX_VALUE;\n      if (bytes > limit) {\n        return { success: false, error: 'VALUE_TOO_LARGE', bytes };\n      }\n      let out = data;\n      if (options?.encrypt) {\n        const encrypt =\n          options.encryptFn ||\n          (globalThis as unknown as { __secureStorageEncrypt?: (p: string) => string })\n            .__secureStorageEncrypt;\n        if (!encrypt) {\n          return { success: false, error: 'ENCRYPTION_UNAVAILABLE' };\n        }\n        try {\n          out = encrypt(data);\n        } catch {\n          return { success: false, error: 'ENCRYPT_FAILED' };\n        }\n      }\n      localStorage.setItem(fullKey, out);\n      return { success: true, bytes };\n    } catch (e) {\n      return { success: false, error: (e as Error).message };\n    }\n  },\n\n  remove(key: string, options?: SecureStorageOptions): boolean {\n    try {\n      const fullKey = namespaced(key, options?.namespace);\n      localStorage.removeItem(fullKey);\n      return true;\n    } catch {\n      return false;\n    }\n  },\n\n  safeJSON<T = unknown>(key: string, fallback: T, options?: SecureStorageOptions): T {\n    const val = this.get<T>(key, options);\n    return val == null ? fallback : val;\n  },\n\n  keys(namespace?: string): string[] {\n    const prefix = `${namespace || DEFAULT_NAMESPACE}:`;\n    const out: string[] = [];\n    for (let i = 0; i < localStorage.length; i++) {\n      const k = localStorage.key(i);\n      if (k && k.startsWith(prefix)) out.push(k.slice(prefix.length));\n    }\n    return out;\n  },\n};\n","/**\r\n * GA4 Custom Events Service\r\n * Sends custom events to Google Analytics 4 for tracking user interactions\r\n * \r\n * This service works alongside the PrivacyAnalyticsService, sending events\r\n * to GA4 only when analytics is enabled and gtag is available.\r\n */\r\n\r\n// Window.gtag is declared in analytics-loader.ts - use that type\r\n\r\n/**\r\n * GA4 Event Names - following GA4 recommended event naming conventions\r\n * https://support.google.com/analytics/answer/9267735\r\n */\r\nexport const GA4Events = {\r\n  // Pain Tracking Events\r\n  LOG_PAIN_ENTRY: 'log_pain_entry',\r\n  UPDATE_PAIN_ENTRY: 'update_pain_entry',\r\n  DELETE_PAIN_ENTRY: 'delete_pain_entry',\r\n  \r\n  // Validation Events  \r\n  USE_VALIDATION: 'use_validation',\r\n  \r\n  // Progress/Analytics Events\r\n  VIEW_PROGRESS: 'view_progress',\r\n  VIEW_ANALYTICS_TAB: 'view_analytics_tab',\r\n  \r\n  // Export Events\r\n  EXPORT_DATA: 'export_data',\r\n  EXPORT_WCB_REPORT: 'export_wcb_report',\r\n  GENERATE_CLINICAL_REPORT: 'generate_clinical_report',\r\n  \r\n  // Body Map Events\r\n  SELECT_BODY_LOCATION: 'select_body_location',\r\n  \r\n  // Empathy Features\r\n  VIEW_EMPATHY_INSIGHT: 'view_empathy_insight',\r\n  \r\n  // Template Events\r\n  APPLY_TEMPLATE: 'apply_template',\r\n  CREATE_TEMPLATE: 'create_template',\r\n  \r\n  // Backup/Restore Events\r\n  CREATE_BACKUP: 'create_backup',\r\n  RESTORE_DATA: 'restore_data',\r\n  \r\n  // Accessibility Events\r\n  CHANGE_ACCESSIBILITY_SETTING: 'change_accessibility_setting',\r\n  \r\n  // Milestone Events\r\n  REACH_MILESTONE: 'reach_milestone',\r\n  \r\n  // Crisis Events\r\n  TRIGGER_CRISIS_RESOURCE: 'trigger_crisis_resource',\r\n  \r\n  // Mood Tracking Events\r\n  LOG_MOOD_ENTRY: 'log_mood_entry',\r\n  \r\n  // Onboarding Events\r\n  COMPLETE_ONBOARDING: 'complete_onboarding',\r\n  SKIP_ONBOARDING: 'skip_onboarding',\r\n} as const;\r\n\r\nexport type GA4EventName = typeof GA4Events[keyof typeof GA4Events];\r\n\r\n/**\r\n * Event parameter types for type safety\r\n */\r\nexport interface GA4EventParams {\r\n  // Pain entry parameters\r\n  pain_level?: number;\r\n  has_location?: boolean;\r\n  has_notes?: boolean;\r\n  location_count?: number;\r\n  symptom_count?: number;\r\n  time_of_day?: string;\r\n  \r\n  // Export parameters\r\n  format?: string;\r\n  report_type?: string;\r\n  entry_count?: number;\r\n  \r\n  // View parameters\r\n  tab_name?: string;\r\n  view_type?: string;\r\n  \r\n  // Validation parameters\r\n  validation_type?: string;\r\n  \r\n  // Body map parameters\r\n  body_region?: string;\r\n  \r\n  // Template parameters\r\n  template_id?: string;\r\n  template_name?: string;\r\n  \r\n  // Empathy parameters\r\n  insight_type?: string;\r\n  confidence?: number;\r\n  \r\n  // Accessibility parameters\r\n  setting_name?: string;\r\n  setting_value?: string | boolean;\r\n  \r\n  // Milestone parameters\r\n  milestone_type?: string;\r\n  milestone_value?: number;\r\n  \r\n  // Mood parameters\r\n  mood_level?: number;\r\n  \r\n  // Generic parameters\r\n  [key: string]: unknown;\r\n}\r\n\r\n/**\r\n * Check if GA4 is available and enabled\r\n */\r\nfunction isGA4Available(): boolean {\r\n  return typeof window !== 'undefined' && typeof window.gtag === 'function';\r\n}\r\n\r\n/**\r\n * Get time of day category for analytics\r\n */\r\nfunction getTimeOfDay(): string {\r\n  const hour = new Date().getHours();\r\n  if (hour >= 5 && hour < 12) return 'morning';\r\n  if (hour >= 12 && hour < 17) return 'afternoon';\r\n  if (hour >= 17 && hour < 21) return 'evening';\r\n  return 'night';\r\n}\r\n\r\n/**\r\n * Send a custom event to GA4\r\n * \r\n * @param eventName - The GA4 event name\r\n * @param params - Optional event parameters\r\n */\r\nexport function trackGA4Event(eventName: GA4EventName, params?: GA4EventParams): void {\r\n  if (!isGA4Available()) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // Add common parameters\r\n    const enrichedParams: GA4EventParams = {\r\n      ...params,\r\n      time_of_day: params?.time_of_day || getTimeOfDay(),\r\n    };\r\n\r\n    window.gtag?.('event', eventName, enrichedParams);\r\n  } catch {\r\n    // Silently fail - analytics should never affect user experience\r\n  }\r\n}\r\n\r\n/**\r\n * Track pain entry logged\r\n */\r\nexport function trackPainEntryLogged(params: {\r\n  painLevel: number;\r\n  hasLocation: boolean;\r\n  hasNotes: boolean;\r\n  locationCount?: number;\r\n  symptomCount?: number;\r\n}): void {\r\n  trackGA4Event(GA4Events.LOG_PAIN_ENTRY, {\r\n    pain_level: params.painLevel,\r\n    has_location: params.hasLocation,\r\n    has_notes: params.hasNotes,\r\n    location_count: params.locationCount,\r\n    symptom_count: params.symptomCount,\r\n  });\r\n}\r\n\r\n/**\r\n * Track validation system usage\r\n */\r\nexport function trackValidationUsed(validationType: string): void {\r\n  trackGA4Event(GA4Events.USE_VALIDATION, {\r\n    validation_type: validationType,\r\n  });\r\n}\r\n\r\n/**\r\n * Track progress view\r\n */\r\nexport function trackProgressViewed(viewType: string): void {\r\n  trackGA4Event(GA4Events.VIEW_PROGRESS, {\r\n    view_type: viewType,\r\n  });\r\n}\r\n\r\n/**\r\n * Track analytics tab view\r\n */\r\nexport function trackAnalyticsTabViewed(tabName: string): void {\r\n  trackGA4Event(GA4Events.VIEW_ANALYTICS_TAB, {\r\n    tab_name: tabName,\r\n  });\r\n}\r\n\r\n/**\r\n * Track data export\r\n */\r\nexport function trackDataExported(format: 'csv' | 'json' | 'pdf', entryCount?: number): void {\r\n  trackGA4Event(GA4Events.EXPORT_DATA, {\r\n    format,\r\n    entry_count: entryCount,\r\n  });\r\n}\r\n\r\n/**\r\n * Track WCB report export\r\n */\r\nexport function trackWCBReportExported(reportType: string): void {\r\n  trackGA4Event(GA4Events.EXPORT_WCB_REPORT, {\r\n    report_type: reportType,\r\n  });\r\n}\r\n\r\n/**\r\n * Track clinical report generation\r\n */\r\nexport function trackClinicalReportGenerated(format: string): void {\r\n  trackGA4Event(GA4Events.GENERATE_CLINICAL_REPORT, {\r\n    format,\r\n  });\r\n}\r\n\r\n/**\r\n * Track body location selection\r\n */\r\nexport function trackBodyLocationSelected(bodyRegion: string): void {\r\n  trackGA4Event(GA4Events.SELECT_BODY_LOCATION, {\r\n    body_region: bodyRegion,\r\n  });\r\n}\r\n\r\n/**\r\n * Track empathy insight view\r\n */\r\nexport function trackEmpathyInsightViewed(insightType: string, confidence?: number): void {\r\n  trackGA4Event(GA4Events.VIEW_EMPATHY_INSIGHT, {\r\n    insight_type: insightType,\r\n    confidence,\r\n  });\r\n}\r\n\r\n/**\r\n * Track template application\r\n */\r\nexport function trackTemplateApplied(templateId: string, templateName?: string): void {\r\n  trackGA4Event(GA4Events.APPLY_TEMPLATE, {\r\n    template_id: templateId,\r\n    template_name: templateName,\r\n  });\r\n}\r\n\r\n/**\r\n * Track template creation\r\n */\r\nexport function trackTemplateCreated(templateId: string, templateName?: string): void {\r\n  trackGA4Event(GA4Events.CREATE_TEMPLATE, {\r\n    template_id: templateId,\r\n    template_name: templateName,\r\n  });\r\n}\r\n\r\n/**\r\n * Track backup creation\r\n */\r\nexport function trackBackupCreated(): void {\r\n  trackGA4Event(GA4Events.CREATE_BACKUP);\r\n}\r\n\r\n/**\r\n * Track data restore\r\n */\r\nexport function trackDataRestored(): void {\r\n  trackGA4Event(GA4Events.RESTORE_DATA);\r\n}\r\n\r\n/**\r\n * Track accessibility setting change\r\n */\r\nexport function trackAccessibilitySettingChanged(\r\n  settingName: string,\r\n  settingValue: string | boolean\r\n): void {\r\n  trackGA4Event(GA4Events.CHANGE_ACCESSIBILITY_SETTING, {\r\n    setting_name: settingName,\r\n    setting_value: settingValue,\r\n  });\r\n}\r\n\r\n/**\r\n * Track milestone reached\r\n */\r\nexport function trackMilestoneReached(milestoneType: string, milestoneValue?: number): void {\r\n  trackGA4Event(GA4Events.REACH_MILESTONE, {\r\n    milestone_type: milestoneType,\r\n    milestone_value: milestoneValue,\r\n  });\r\n}\r\n\r\n/**\r\n * Track crisis resource triggered\r\n */\r\nexport function trackCrisisResourceTriggered(): void {\r\n  trackGA4Event(GA4Events.TRIGGER_CRISIS_RESOURCE);\r\n}\r\n\r\n/**\r\n * Track mood entry logged\r\n */\r\nexport function trackMoodEntryLogged(moodLevel: number): void {\r\n  trackGA4Event(GA4Events.LOG_MOOD_ENTRY, {\r\n    mood_level: moodLevel,\r\n  });\r\n}\r\n\r\n/**\r\n * Track onboarding completion\r\n */\r\nexport function trackOnboardingCompleted(): void {\r\n  trackGA4Event(GA4Events.COMPLETE_ONBOARDING);\r\n}\r\n\r\n/**\r\n * Track onboarding skipped\r\n */\r\nexport function trackOnboardingSkipped(): void {\r\n  trackGA4Event(GA4Events.SKIP_ONBOARDING);\r\n}\r\n\r\n// Export a default object with all tracking functions for convenience\r\nexport const ga4Analytics = {\r\n  trackEvent: trackGA4Event,\r\n  trackPainEntryLogged,\r\n  trackValidationUsed,\r\n  trackProgressViewed,\r\n  trackAnalyticsTabViewed,\r\n  trackDataExported,\r\n  trackWCBReportExported,\r\n  trackClinicalReportGenerated,\r\n  trackBodyLocationSelected,\r\n  trackEmpathyInsightViewed,\r\n  trackTemplateApplied,\r\n  trackTemplateCreated,\r\n  trackBackupCreated,\r\n  trackDataRestored,\r\n  trackAccessibilitySettingChanged,\r\n  trackMilestoneReached,\r\n  trackCrisisResourceTriggered,\r\n  trackMoodEntryLogged,\r\n  trackOnboardingCompleted,\r\n  trackOnboardingSkipped,\r\n  isAvailable: isGA4Available,\r\n};\r\n\r\nexport default ga4Analytics;\r\n","/**\r\n * Usage Tracking Utilities\r\n *\r\n * Centralized utilities for tracking user engagement and feature usage.\r\n * All data is stored locally and only anonymized metrics go to GA4.\r\n */\r\n\r\n// ============================================\r\n// TYPES\r\n// ============================================\r\n\r\nexport interface UsageEvent {\r\n  type: string;\r\n  category: string;\r\n  timestamp: number;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface ExportActivity {\r\n  type: 'csv' | 'pdf' | 'json' | 'wcb';\r\n  timestamp: number;\r\n  recordCount: number;\r\n}\r\n\r\n// ============================================\r\n// LOCAL STORAGE KEYS\r\n// ============================================\r\n\r\nexport const STORAGE_KEYS = {\r\n  USAGE_EVENTS: 'pain-tracker:usage-events',\r\n  SESSION_DATA: 'pain-tracker:session-data',\r\n  FEATURE_COUNTS: 'pain-tracker:feature-counts',\r\n  NAV_PATTERNS: 'pain-tracker:nav-patterns',\r\n  EXPORT_HISTORY: 'pain-tracker:export-history',\r\n} as const;\r\n\r\n// ============================================\r\n// STORAGE UTILITIES\r\n// ============================================\r\n\r\nexport function getStoredData<T>(key: string, defaultValue: T): T {\r\n  try {\r\n    const stored = localStorage.getItem(key);\r\n    return stored ? JSON.parse(stored) : defaultValue;\r\n  } catch {\r\n    return defaultValue;\r\n  }\r\n}\r\n\r\nexport function setStoredData<T>(key: string, data: T): void {\r\n  try {\r\n    localStorage.setItem(key, JSON.stringify(data));\r\n  } catch {\r\n    console.debug('[UsageTracking] Failed to store data:', key);\r\n  }\r\n}\r\n\r\n// ============================================\r\n// USAGE TRACKING FUNCTIONS\r\n// ============================================\r\n\r\nexport function trackUsageEvent(\r\n  type: string,\r\n  category: string,\r\n  metadata?: Record<string, unknown>\r\n): void {\r\n  const events = getStoredData<UsageEvent[]>(STORAGE_KEYS.USAGE_EVENTS, []);\r\n  const event: UsageEvent = {\r\n    type,\r\n    category,\r\n    timestamp: Date.now(),\r\n    metadata,\r\n  };\r\n\r\n  // Keep last 500 events to avoid storage bloat\r\n  const updatedEvents = [...events.slice(-499), event];\r\n  setStoredData(STORAGE_KEYS.USAGE_EVENTS, updatedEvents);\r\n\r\n  // Update feature counts\r\n  const featureCounts = getStoredData<Record<string, number>>(STORAGE_KEYS.FEATURE_COUNTS, {});\r\n  const featureKey = `${category}:${type}`;\r\n  featureCounts[featureKey] = (featureCounts[featureKey] || 0) + 1;\r\n  setStoredData(STORAGE_KEYS.FEATURE_COUNTS, featureCounts);\r\n}\r\n\r\nexport function trackNavigation(from: string, to: string): void {\r\n  const navPatterns = getStoredData<Record<string, number>>(STORAGE_KEYS.NAV_PATTERNS, {});\r\n  const pattern = `${from}  ${to}`;\r\n  navPatterns[pattern] = (navPatterns[pattern] || 0) + 1;\r\n  setStoredData(STORAGE_KEYS.NAV_PATTERNS, navPatterns);\r\n  trackUsageEvent('navigation', 'navigation', { from, to });\r\n}\r\n\r\nexport function trackExport(\r\n  type: 'csv' | 'pdf' | 'json' | 'wcb',\r\n  recordCount: number\r\n): void {\r\n  const exportHistory = getStoredData<ExportActivity[]>(STORAGE_KEYS.EXPORT_HISTORY, []);\r\n  const activity: ExportActivity = {\r\n    type,\r\n    timestamp: Date.now(),\r\n    recordCount,\r\n  };\r\n  // Keep last 100 exports\r\n  const updated = [...exportHistory.slice(-99), activity];\r\n  setStoredData(STORAGE_KEYS.EXPORT_HISTORY, updated);\r\n  trackUsageEvent(`export_${type}`, 'export', { recordCount });\r\n}\r\n\r\n// ============================================\r\n// SESSION TRACKING\r\n// ============================================\r\n\r\nlet sessionStartTime = Date.now();\r\nlet sessionActions = 0;\r\n\r\nexport function trackSessionStart(): void {\r\n  sessionStartTime = Date.now();\r\n  sessionActions = 0;\r\n  trackUsageEvent('session_start', 'session');\r\n}\r\n\r\nexport function incrementSessionAction(): void {\r\n  sessionActions++;\r\n}\r\n\r\nexport function getSessionStats(): { duration: number; actions: number } {\r\n  return {\r\n    duration: Math.floor((Date.now() - sessionStartTime) / 1000),\r\n    actions: sessionActions,\r\n  };\r\n}\r\n\r\nexport function getSessionStartTime(): number {\r\n  return sessionStartTime;\r\n}\r\n","/**\r\n * Trauma-Informed UX Provider\r\n */\r\n\r\nimport { ReactNode, useState, useEffect } from 'react';\r\nimport {\r\n  TraumaInformedPreferences,\r\n  defaultPreferences,\r\n  getFontSizeValue,\r\n  getTouchSizeValue,\r\n} from './TraumaInformedTypes';\r\nimport { secureStorage } from '../../lib/storage/secureStorage';\r\nimport { TraumaInformedContext } from './TraumaInformedHooks';\r\nimport { trackAccessibilitySettingChanged } from '../../analytics/ga4-events';\r\nimport { trackUsageEvent, incrementSessionAction } from '../../utils/usage-tracking';\r\n\r\n// Provider component\r\ninterface TraumaInformedProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function TraumaInformedProvider({ children }: TraumaInformedProviderProps) {\r\n  const [preferences, setPreferences] = useState<TraumaInformedPreferences>(() => {\r\n    // Attempt secure retrieval first\r\n    const secure = secureStorage.get<TraumaInformedPreferences>('trauma-informed-preferences', {\r\n      encrypt: true,\r\n    });\r\n    if (secure) return { ...defaultPreferences, ...secure };\r\n    // Legacy fallback from raw localStorage (one-time migration path)\r\n    try {\r\n      const legacy = localStorage.getItem('trauma-informed-preferences');\r\n      if (legacy) {\r\n        const parsed = JSON.parse(legacy);\r\n        // Persist into secure storage for future loads\r\n        secureStorage.set('trauma-informed-preferences', parsed, { encrypt: true });\r\n        return { ...defaultPreferences, ...parsed };\r\n      }\r\n    } catch {\r\n      /* ignore parse errors */\r\n    }\r\n    return defaultPreferences;\r\n  });\r\n\r\n  const updatePreferences = (updates: Partial<TraumaInformedPreferences>) => {\r\n    const newPreferences = { ...preferences, ...updates };\r\n    setPreferences(newPreferences);\r\n    secureStorage.set('trauma-informed-preferences', newPreferences, { encrypt: true });\r\n\r\n    // Track accessibility setting changes\r\n    Object.keys(updates).forEach(key => {\r\n      const settingName = key as keyof TraumaInformedPreferences;\r\n      const value = updates[settingName];\r\n      trackAccessibilitySettingChanged(settingName, String(value));\r\n      trackUsageEvent(`accessibility_${settingName}`, 'accessibility', { value });\r\n    });\r\n    incrementSessionAction();\r\n  };\r\n\r\n  // Apply CSS custom properties when preferences change\r\n  useEffect(() => {\r\n    const root = document.documentElement;\r\n\r\n    // Font size\r\n    root.style.setProperty('--ti-font-size', getFontSizeValue(preferences.fontSize));\r\n\r\n    // Touch target size\r\n    root.style.setProperty('--ti-touch-size', getTouchSizeValue(preferences.touchTargetSize));\r\n\r\n    // Contrast\r\n    const contrastClass = `ti-contrast-${preferences.contrast}`;\r\n    document.body.className = document.body.className.replace(/ti-contrast-\\w+/g, '');\r\n    document.body.classList.add(contrastClass);\r\n\r\n    // Motion\r\n    if (preferences.reduceMotion) {\r\n      document.body.classList.add('ti-reduce-motion');\r\n    } else {\r\n      document.body.classList.remove('ti-reduce-motion');\r\n    }\r\n\r\n    // Simplified mode\r\n    if (preferences.simplifiedMode) {\r\n      document.body.classList.add('ti-simplified');\r\n    } else {\r\n      document.body.classList.remove('ti-simplified');\r\n    }\r\n  }, [preferences]);\r\n\r\n  return (\r\n    <TraumaInformedContext.Provider value={{ preferences, updatePreferences }}>\r\n      {children}\r\n    </TraumaInformedContext.Provider>\r\n  );\r\n}\r\n","/**\n * @fileoverview Unified Tone System Types\n *\n * Voice Pillars:\n * 1. Calm, competent, human (never cutesy; never sterile)\n * 2. Actionable empathy (\"what to do next\" > platitudes)\n * 3. Empowering evidence (show progress and why it matters)\n * 4. Plain language, precise edges (5th8th grade; medical terms glossed inline)\n */\n\n/**\n * Patient state drives adaptive tone\n */\nexport type PatientState =\n  | 'stable' // Maintenance: brief, upbeat, professional-warm\n  | 'rising' // Yellow: steady, specific, encouraging\n  | 'flare' // Red: short lines, imperative, slow cadence\n  | 'recovery'; // Post-flare: warm, factual, no cheerleading\n\n/**\n * Intent determines copy pattern\n */\nexport type CopyIntent =\n  | 'log' // Fast, neutral, choice-light\n  | 'coach' // One specific next step\n  | 'insight' // Evidence + confidence\n  | 'motivate' // Agency + progress (no shame/gamification)\n  | 'notify' // Value-first (not alarmist)\n  | 'educate'; // Plain lead + action\n\n/**\n * Personalization settings (opt-in)\n */\nexport interface TonePreferences {\n  /** Warmth level: 0 = neutral, 1 = warm */\n  warmth: 0 | 1;\n\n  /** Coach intensity: 0 = minimal prompts, 1 = guided nudges */\n  coachIntensity: 0 | 1;\n\n  /** Lightness: allow pop-culture GIFs in non-flare contexts */\n  allowLightness: boolean;\n\n  /** Use medical terminology (glossed inline) vs plain only */\n  medicalTerms: boolean;\n}\n\n/**\n * Tone context for adaptive copy\n */\nexport interface ToneContext {\n  /** Current patient state */\n  state: PatientState;\n\n  /** User's tone preferences */\n  preferences: TonePreferences;\n\n  /** Recent pain trend (for context-aware messaging) */\n  painTrend?: {\n    current: number;\n    previous: number;\n    direction: 'up' | 'down' | 'stable';\n  };\n\n  /** Time since last flare (for recovery messaging) */\n  timeSinceFlare?: number; // hours\n\n  /** Sleep quality (affects coaching) */\n  sleepQuality?: 'poor' | 'fair' | 'good';\n}\n\n/**\n * Copy variation for A/B testing\n */\nexport interface CopyVariation {\n  id: string;\n  intent: CopyIntent;\n  variants: {\n    control: string;\n    variant: string;\n  };\n  metrics?: {\n    acceptanceRate?: number;\n    completionRate?: number;\n    timeToAction?: number; // seconds\n  };\n}\n\n/**\n * Microcopy with adaptive variations\n */\nexport interface AdaptiveCopy {\n  /** Base copy (stable state, neutral tone) */\n  base: string;\n\n  /** State-specific variations */\n  states?: {\n    stable?: string;\n    rising?: string;\n    flare?: string;\n    recovery?: string;\n  };\n\n  /** Warmth variations */\n  warmth?: {\n    neutral: string;\n    warm: string;\n  };\n\n  /** Medical terminology variation */\n  medical?: {\n    plain: string;\n    withTerms: string;\n  };\n\n  /** Screen reader alternative (if different) */\n  srText?: string;\n\n  /** Character limit for mobile (if constrained) */\n  mobile?: string;\n}\n\n/**\n * Empty state copy pattern\n */\nexport interface EmptyStateCopy {\n  /** Headline (empathetic, not pushy) */\n  headline: string;\n\n  /** Subtext (actionable, not demanding) */\n  subtext: string;\n\n  /** Primary CTA */\n  cta: string;\n\n  /** Secondary action (optional) */\n  secondaryCta?: string;\n}\n\n/**\n * Progress insight copy\n */\nexport interface ProgressInsight {\n  /** Evidence-based summary */\n  summary: string;\n\n  /** Likely factors (not causal claims) */\n  factors?: string[];\n\n  /** Confidence level */\n  confidence: 'low' | 'medium' | 'high';\n\n  /** Suggested action (one small step) */\n  suggestedAction?: string;\n}\n\n/**\n * Reflection prompt (MMP-style)\n */\nexport interface ReflectionPrompt {\n  /** Main question */\n  question: string;\n\n  /** Quick chip suggestions */\n  suggestions: string[];\n\n  /** Post-save acknowledgment */\n  acknowledgment: string;\n\n  /** Optional follow-up */\n  followUp?: string;\n}\n\n/**\n * Clinician summary format\n */\nexport interface ClinicianSummary {\n  /** Concise clinical format */\n  summary: string;\n\n  /** Plain-text safe note insert */\n  smartInsert: string;\n\n  /** Key metrics */\n  metrics: {\n    painAvg: number;\n    painChange: number;\n    variability: 'low' | 'medium' | 'high';\n    flareCount: number;\n    adherence: number; // percentage\n  };\n\n  /** Notable changes */\n  changes: string[];\n}\n\n/**\n * Tone measurement data\n */\nexport interface ToneMeasurement {\n  /** Metric type */\n  metric:\n    | 'prompt_acceptance'\n    | 'reflection_completion'\n    | 'time_to_calm'\n    | 'note_edit_delta'\n    | 'perceived_burden';\n\n  /** Value */\n  value: number;\n\n  /** Context */\n  context: {\n    state: PatientState;\n    intent: CopyIntent;\n    variation?: string;\n  };\n\n  /** Timestamp */\n  timestamp: string;\n}\n\n/**\n * Default tone preferences\n */\nexport const DEFAULT_TONE_PREFERENCES: TonePreferences = {\n  warmth: 0, // Neutral by default\n  coachIntensity: 0, // Minimal prompts\n  allowLightness: false, // No GIFs by default\n  medicalTerms: false, // Plain language only\n};\n\n/**\n * State detection thresholds\n */\nexport const STATE_THRESHOLDS = {\n  /** Pain increase to trigger 'rising' state */\n  risingPainIncrease: 1.5,\n\n  /** Pain level to trigger 'flare' state */\n  flarePainLevel: 7,\n\n  /** Hours since flare to return to 'stable' */\n  recoveryHours: 24,\n\n  /** Pain variability (std dev) for 'stable' */\n  stableVariability: 1.2,\n} as const;\n\n/**\n * Readability targets\n */\nexport const READABILITY = {\n  /** Target grade level (5th-8th) */\n  gradeLevel: { min: 5, max: 8 },\n\n  /** Max sentence length (words) */\n  maxSentenceLength: 20,\n\n  /** Flare state max sentence length */\n  flareMaxSentenceLength: 10,\n\n  /** Max syllables per word (avg) */\n  maxSyllablesPerWord: 2.5,\n} as const;\n","/**\n * @fileoverview Adaptive Tone Engine\n *\n * Determines patient state, selects appropriate copy variations,\n * and tracks tone effectiveness metrics.\n */\n\nimport type {\n  PatientState,\n  CopyIntent,\n  ToneContext,\n  TonePreferences,\n  AdaptiveCopy,\n  ProgressInsight,\n  ToneMeasurement,\n} from '../types/tone';\nimport { STATE_THRESHOLDS } from '../types/tone';\nimport type { PainEntry } from '../types/pain-tracker';\n\n/**\n * Adaptive Tone Engine\n *\n * Core responsibilities:\n * 1. Detect patient state from pain data\n * 2. Select appropriate copy variation\n * 3. Track tone effectiveness\n */\nexport class ToneEngine {\n  private measurements: ToneMeasurement[] = [];\n\n  /**\n   * Detect patient state from recent pain entries\n   */\n  detectState(entries?: PainEntry[] | null, timeSinceFlare?: number): PatientState {\n    const safeEntries = Array.isArray(entries) ? entries : [];\n    if (safeEntries.length === 0) {\n      return 'stable';\n    }\n\n    // Sort by timestamp (most recent first)\n    const sorted = [...safeEntries].sort(\n      (a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n    );\n\n    const mostRecent = sorted[0];\n    const currentPain = mostRecent.baselineData?.pain ?? mostRecent.intensity ?? 0;\n\n    // FLARE: High pain level\n    if (currentPain >= STATE_THRESHOLDS.flarePainLevel) {\n      return 'flare';\n    }\n\n    // RECOVERY: Within 24h of flare\n    if (timeSinceFlare !== undefined && timeSinceFlare < STATE_THRESHOLDS.recoveryHours) {\n      return 'recovery';\n    }\n\n    // Compare to previous entry\n    if (sorted.length >= 2) {\n      const previous = sorted[1];\n      const previousPain = previous.baselineData?.pain ?? previous.intensity ?? 0;\n      const painChange = currentPain - previousPain;\n\n      // RISING: Significant increase\n      if (painChange >= STATE_THRESHOLDS.risingPainIncrease) {\n        return 'rising';\n      }\n    }\n\n    // STABLE: Default\n    return 'stable';\n  }\n\n  /**\n   * Calculate pain trend from entries\n   */\n  calculatePainTrend(entries?: PainEntry[] | null) {\n    const safeEntries = Array.isArray(entries) ? entries : [];\n    if (safeEntries.length < 2) {\n      return undefined;\n    }\n\n    const sorted = [...safeEntries].sort(\n      (a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\n    );\n\n    const current = sorted[0].baselineData?.pain ?? sorted[0].intensity ?? 0;\n    const previous = sorted[1].baselineData?.pain ?? sorted[1].intensity ?? 0;\n    const diff = current - previous;\n\n    return {\n      current,\n      previous,\n      direction:\n        diff > 0.5 ? ('up' as const) : diff < -0.5 ? ('down' as const) : ('stable' as const),\n    };\n  }\n\n  /**\n   * Build tone context from patient data\n   */\n  buildContext(\n    entries: PainEntry[] | null | undefined,\n    preferences: TonePreferences,\n    options?: {\n      timeSinceFlare?: number;\n      sleepQuality?: 'poor' | 'fair' | 'good';\n    }\n  ): ToneContext {\n    return {\n      state: this.detectState(entries, options?.timeSinceFlare),\n      preferences,\n      painTrend: this.calculatePainTrend(entries),\n      timeSinceFlare: options?.timeSinceFlare,\n      sleepQuality: options?.sleepQuality,\n    };\n  }\n\n  /**\n   * Select copy variation based on context\n   */\n  selectCopy(copy: AdaptiveCopy, context: ToneContext): string {\n    // 1. State-specific variation (highest priority)\n    if (copy.states) {\n      const stateVariation = copy.states[context.state];\n      if (stateVariation) {\n        return stateVariation;\n      }\n    }\n\n    // 2. Warmth variation\n    if (copy.warmth && context.preferences.warmth === 1) {\n      return copy.warmth.warm;\n    }\n\n    // 3. Medical terminology\n    if (copy.medical && context.preferences.medicalTerms) {\n      return copy.medical.withTerms;\n    }\n\n    // 4. Base copy\n    return copy.base;\n  }\n\n  /**\n   * Generate progress insight with confidence\n   */\n  generateInsight(entries?: PainEntry[] | null, days: number = 14): ProgressInsight | null {\n    const safeEntries = Array.isArray(entries) ? entries : [];\n    if (safeEntries.length < 2) {\n      return null;\n    }\n\n    // Filter to date range\n    const cutoff = new Date();\n    cutoff.setDate(cutoff.getDate() - days);\n    const recent = safeEntries.filter(e => new Date(e.timestamp) >= cutoff);\n\n    if (recent.length < 2) {\n      return null;\n    }\n\n    // Calculate average pain\n    const avg =\n      recent.reduce((sum, e) => sum + (e.baselineData?.pain ?? e.intensity ?? 0), 0) /\n      recent.length;\n\n    // Compare to previous period\n    const previousCutoff = new Date(cutoff);\n    previousCutoff.setDate(previousCutoff.getDate() - days);\n    const previous = safeEntries.filter(\n      e => new Date(e.timestamp) >= previousCutoff && new Date(e.timestamp) < cutoff\n    );\n\n    if (previous.length < 2) {\n      return {\n        summary: `Last ${days} days: average pain ${avg.toFixed(1)}.`,\n        confidence: 'low',\n      };\n    }\n\n    const prevAvg =\n      previous.reduce((sum, e) => sum + (e.baselineData?.pain ?? e.intensity ?? 0), 0) /\n      previous.length;\n    const change = avg - prevAvg;\n    const direction = change > 0 ? '' : '';\n    const absChange = Math.abs(change);\n\n    // Determine confidence based on data points and consistency\n    const confidence: 'low' | 'medium' | 'high' =\n      recent.length >= 10 ? 'high' : recent.length >= 5 ? 'medium' : 'low';\n\n    // Build summary\n    const summary = `Last ${days} days: average pain ${prevAvg.toFixed(1)}  ${avg.toFixed(1)} (${direction}${absChange.toFixed(1)}).`;\n\n    // Identify likely factors (simplified - would use more sophisticated analysis)\n    const factors: string[] = [];\n\n    // Check for sleep correlation (if we had sleep data)\n    // Check for activity correlation\n    // Check for time-of-day patterns\n\n    return {\n      summary,\n      factors: factors.length > 0 ? factors : undefined,\n      confidence,\n    };\n  }\n\n  /**\n   * Track tone effectiveness measurement\n   */\n  trackMeasurement(measurement: ToneMeasurement): void {\n    this.measurements.push(measurement);\n\n    // Persist to storage (IndexedDB)\n    this.persistMeasurement(measurement);\n  }\n\n  /**\n   * Get acceptance rate for a specific intent/state combination\n   */\n  getAcceptanceRate(intent: CopyIntent, state?: PatientState): number | undefined {\n    const relevant = this.measurements.filter(\n      m =>\n        m.metric === 'prompt_acceptance' &&\n        m.context.intent === intent &&\n        (!state || m.context.state === state)\n    );\n\n    if (relevant.length === 0) {\n      return undefined;\n    }\n\n    const sum = relevant.reduce((acc, m) => acc + m.value, 0);\n    return sum / relevant.length;\n  }\n\n  /**\n   * Get average time to calm in panic mode\n   */\n  getAverageTimeToCalm(): number | undefined {\n    const relevant = this.measurements.filter(m => m.metric === 'time_to_calm');\n\n    if (relevant.length === 0) {\n      return undefined;\n    }\n\n    const sum = relevant.reduce((acc, m) => acc + m.value, 0);\n    return sum / relevant.length;\n  }\n\n  /**\n   * Persist measurement to storage\n   */\n  private async persistMeasurement(measurement: ToneMeasurement): Promise<void> {\n    try {\n      // Store in IndexedDB under 'tone-measurements' store\n      const db = await this.openDatabase();\n      const tx = db.transaction('tone-measurements', 'readwrite');\n      const store = tx.objectStore('tone-measurements');\n      await store.add(measurement);\n    } catch (error) {\n      console.error('Failed to persist tone measurement:', error);\n    }\n  }\n\n  /**\n   * Open IndexedDB for measurements\n   */\n  private async openDatabase(): Promise<IDBDatabase> {\n    return new Promise((resolve, reject) => {\n      const request = indexedDB.open('pain-tracker-tone', 1);\n\n      request.onerror = () => reject(request.error);\n      request.onsuccess = () => resolve(request.result);\n\n      request.onupgradeneeded = event => {\n        const db = (event.target as IDBOpenDBRequest).result;\n\n        if (!db.objectStoreNames.contains('tone-measurements')) {\n          db.createObjectStore('tone-measurements', {\n            keyPath: 'timestamp',\n            autoIncrement: true,\n          });\n        }\n      };\n    });\n  }\n\n  /**\n   * Load measurements from storage\n   */\n  async loadMeasurements(): Promise<void> {\n    try {\n      const db = await this.openDatabase();\n      const tx = db.transaction('tone-measurements', 'readonly');\n      const store = tx.objectStore('tone-measurements');\n      const request = store.getAll();\n\n      request.onsuccess = () => {\n        this.measurements = request.result;\n      };\n    } catch (error) {\n      console.error('Failed to load tone measurements:', error);\n    }\n  }\n}\n\n/**\n * Singleton instance\n */\nexport const toneEngine = new ToneEngine();\n\n/**\n * Initialize tone engine (call on app start)\n */\nexport async function initializeToneEngine(): Promise<void> {\n  await toneEngine.loadMeasurements();\n}\n","export function formatNumber(value: number, decimals = 1) {\n  if (Number.isNaN(value) || value === Infinity || value === -Infinity)\n    return (0).toFixed(decimals);\n  return value.toFixed(decimals);\n}\n\nexport function formatPercent(value: number, decimals = 1) {\n  if (Number.isNaN(value) || value === Infinity || value === -Infinity)\n    return (0).toFixed(decimals) + '%';\n  return `${value.toFixed(decimals)}%`;\n}\n\nexport default { formatNumber, formatPercent };\n","export function isDate(value: unknown): value is Date {\r\n  return Object.prototype.toString.call(value) === '[object Date]';\r\n}\r\n\r\nexport function toIsoString(value?: string | Date | number): string | undefined {\r\n  if (value === undefined || value === null) return undefined;\r\n  if (isDate(value)) return value.toISOString();\r\n  if (typeof value === 'number') return new Date(value).toISOString();\r\n  if (typeof value === 'string') {\r\n    // if it's already an ISO string, keep it; otherwise try convertable\r\n    const d = new Date(value);\r\n    return isNaN(d.getTime()) ? undefined : d.toISOString();\r\n  }\r\n  return undefined;\r\n}\r\n\r\nexport function parseDate(value?: string | Date | number): Date | undefined {\r\n  if (value === undefined || value === null) return undefined;\r\n  if (isDate(value)) return value;\r\n  if (typeof value === 'number') return new Date(value);\r\n  if (typeof value === 'string') {\r\n    const d = new Date(value);\r\n    return isNaN(d.getTime()) ? undefined : d;\r\n  }\r\n  return undefined;\r\n}\r\n","/**\r\n * Security-First Architecture Service\r\n * Comprehensive security management for the Pain Tracker application\r\n */\r\n\r\nimport { formatNumber } from '../utils/formatting';\r\nimport type { WrappedKeyPayload } from '../types/security';\r\n\r\n// --- small crypto helpers (kept local to avoid circular deps) ---\r\nfunction arrayBufferToBase64(buffer: ArrayBuffer): string {\r\n  if (typeof Buffer !== 'undefined') return Buffer.from(buffer).toString('base64');\r\n  let binary = '';\r\n  const bytes = new Uint8Array(buffer);\r\n  for (let i = 0; i < bytes.byteLength; i++) binary += String.fromCharCode(bytes[i]);\r\n  return btoa(binary);\r\n}\r\n\r\nfunction base64ToBytes(base64: string): Uint8Array<ArrayBuffer> {\r\n  if (typeof Buffer !== 'undefined') {\r\n    const buf = Buffer.from(base64, 'base64');\r\n    const ab = buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength) as ArrayBuffer;\r\n    return new Uint8Array(ab);\r\n  }\r\n  const binary = atob(base64);\r\n  const ab = new ArrayBuffer(binary.length);\r\n  const bytes = new Uint8Array(ab);\r\n  for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);\r\n  return bytes;\r\n}\r\n\r\n// Security Event Types\r\nexport interface SecurityEvent {\r\n  type: 'authentication' | 'encryption' | 'data_access' | 'error' | 'audit' | 'analytics' | 'vault';\r\n  level: 'info' | 'warning' | 'error' | 'critical';\r\n  message: string;\r\n  metadata?: Record<string, unknown>;\r\n  timestamp: Date;\r\n  userId?: string;\r\n  sessionId?: string;\r\n}\r\n\r\n// Encryption Configuration\r\nexport interface EncryptionConfig {\r\n  algorithm: 'AES' | 'RSA';\r\n  keySize: 128 | 192 | 256;\r\n  mode: 'CBC' | 'GCM' | 'CTR';\r\n  padding: 'PKCS7' | 'ISO97971' | 'NoPadding';\r\n}\r\n\r\n// Security Audit Result\r\nexport interface SecurityAuditResult {\r\n  passed: boolean;\r\n  score: number; // 0-1\r\n  issues: SecurityIssue[];\r\n  recommendations: string[];\r\n  lastAudit: Date;\r\n}\r\n\r\nexport interface SecurityIssue {\r\n  id: string;\r\n  severity: 'low' | 'medium' | 'high' | 'critical';\r\n  category: 'encryption' | 'authentication' | 'data' | 'network' | 'configuration';\r\n  title: string;\r\n  description: string;\r\n  remediation: string;\r\n  affectedComponents: string[];\r\n}\r\n\r\n// Privacy-Preserving Analytics Configuration\r\nexport interface PrivacyConfig {\r\n  enableAnalytics: boolean;\r\n  dataRetentionDays: number;\r\n  anonymizationLevel: 'none' | 'basic' | 'advanced' | 'differential';\r\n  consentRequired: boolean;\r\n  minimumNoiseLevel: number; // For differential privacy\r\n}\r\n\r\n// Secure Storage Interface\r\nexport interface SecureStorage {\r\n  encrypt(data: string, key?: string): Promise<string>;\r\n  decrypt(encryptedData: string, key?: string): Promise<string>;\r\n  store(key: string, data: unknown, encrypted?: boolean): Promise<void>;\r\n  retrieve(key: string, encrypted?: boolean): Promise<unknown>;\r\n  delete(key: string): Promise<void>;\r\n  clear(): Promise<void>;\r\n}\r\n\r\n/**\r\n * Main Security Service\r\n * Handles all security-related operations including encryption, auditing, and monitoring\r\n */\r\nexport class SecurityService {\r\n  private events: SecurityEvent[] = [];\r\n  private encryptionConfig: EncryptionConfig;\r\n  private privacyConfig: PrivacyConfig;\r\n  private sessionId: string;\r\n  // In-memory non-extractable master keys\r\n  private masterCryptoKey: CryptoKey | null = null;\r\n  private masterHmacKey: CryptoKey | null = null;\r\n\r\n  constructor(\r\n    encryptionConfig?: Partial<EncryptionConfig>,\r\n    privacyConfig?: Partial<PrivacyConfig>\r\n  ) {\r\n    this.encryptionConfig = {\r\n      algorithm: 'AES',\r\n      keySize: 256,\r\n      mode: 'CBC',\r\n      padding: 'PKCS7',\r\n      ...encryptionConfig,\r\n    };\r\n\r\n    this.privacyConfig = {\r\n      enableAnalytics: true,\r\n      dataRetentionDays: 90,\r\n      anonymizationLevel: 'advanced',\r\n      consentRequired: true,\r\n      minimumNoiseLevel: 0.1,\r\n      ...privacyConfig,\r\n    };\r\n\r\n    // Cache test environment detection at construction time to prevent manipulation\r\n    this._isTestEnvCached = SecurityService.detectTestEnv();\r\n    this.sessionId = this.generateSessionId();\r\n    this.initializeSecurity();\r\n  }\r\n\r\n  // Test environment flag - cached at construction time to prevent runtime manipulation\r\n  private readonly _isTestEnvCached: boolean;\r\n  \r\n  private isTestEnv(): boolean {\r\n    return this._isTestEnvCached;\r\n  }\r\n  \r\n  private static detectTestEnv(): boolean {\r\n    try {\r\n      // Only check environment variables at module load time for security\r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      const env = (typeof process !== 'undefined' ? (process as any).env : undefined) || {};\r\n      const isTest = !!(env && (env.VITEST || env.NODE_ENV === 'test'));\r\n      if (isTest) {\r\n        // Log warning if test mode is detected in a suspicious context\r\n        if (typeof window !== 'undefined' && window.location?.hostname !== 'localhost') {\r\n          console.warn('[SECURITY] Test environment detected in non-localhost context');\r\n        }\r\n      }\r\n      return isTest;\r\n    } catch {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    const arr = new Uint8Array(16);\r\n    crypto.getRandomValues(arr);\r\n    return Array.from(arr)\r\n      .map(b => b.toString(16).padStart(2, '0'))\r\n      .join('');\r\n  }\r\n\r\n  private initializeSecurity(): void {\r\n    this.logSecurityEvent({\r\n      type: 'audit',\r\n      level: 'info',\r\n      message: 'Security service initialized',\r\n      metadata: {\r\n        encryptionAlgorithm: this.encryptionConfig.algorithm,\r\n        keySize: this.encryptionConfig.keySize,\r\n        privacyLevel: this.privacyConfig.anonymizationLevel,\r\n      },\r\n      timestamp: new Date(),\r\n      sessionId: this.sessionId,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initialize or derive a master key for encryption\r\n   */\r\n  async initializeMasterKey(password?: string): Promise<void> {\r\n    try {\r\n      // Use SubtleCrypto to derive or generate a non-extractable AES-GCM key and an HMAC key.\r\n      const subtle = crypto.subtle;\r\n      const iterationOverride =\r\n        typeof process !== 'undefined' &&\r\n        process.env &&\r\n        (process.env.VITEST || process.env.NODE_ENV === 'test')\r\n          ? 500\r\n          : 150000; // Increased PBKDF2 iterations for production\r\n\r\n      if (password) {\r\n        // Derive a base key from password\r\n        const salt = crypto.getRandomValues(new Uint8Array(16));\r\n        const saltBytes: Uint8Array<ArrayBuffer> = new Uint8Array(salt);\r\n        const pwUtf8 = new TextEncoder().encode(password);\r\n        const baseKey = await subtle.importKey('raw', pwUtf8, 'PBKDF2', false, [\r\n          'deriveBits',\r\n          'deriveKey',\r\n        ]);\r\n\r\n        // Derive AES-GCM key\r\n        this.masterCryptoKey = await subtle.deriveKey(\r\n          { name: 'PBKDF2', salt: saltBytes, iterations: iterationOverride, hash: 'SHA-256' },\r\n          baseKey,\r\n          { name: 'AES-GCM', length: 256 },\r\n          false,\r\n          ['encrypt', 'decrypt']\r\n        );\r\n\r\n        // Derive HMAC key separately (deriveBits -> import)\r\n        const hmacBits = await subtle.deriveBits(\r\n          { name: 'PBKDF2', salt: saltBytes, iterations: iterationOverride, hash: 'SHA-256' },\r\n          baseKey,\r\n          256\r\n        );\r\n        this.masterHmacKey = await subtle.importKey(\r\n          'raw',\r\n          hmacBits,\r\n          { name: 'HMAC', hash: 'SHA-256' },\r\n          false,\r\n          ['sign', 'verify']\r\n        );\r\n      } else {\r\n        // Generate ephemeral non-extractable keys for the session\r\n        this.masterCryptoKey = await crypto.subtle.generateKey(\r\n          { name: 'AES-GCM', length: 256 },\r\n          false,\r\n          ['encrypt', 'decrypt']\r\n        );\r\n        this.masterHmacKey = await crypto.subtle.generateKey(\r\n          { name: 'HMAC', hash: 'SHA-256' },\r\n          false,\r\n          ['sign', 'verify']\r\n        );\r\n      }\r\n\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'info',\r\n        message: 'Master key initialized',\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n    } catch (error) {\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'error',\r\n        message: 'Failed to initialize master key',\r\n        metadata: { error: error instanceof Error ? error.message : 'Unknown error' },\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n      throw new Error('Failed to initialize encryption key');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Encrypt data using AES encryption\r\n   */\r\n  async encryptData(data: string, _customKey?: string): Promise<string> {\r\n    try {\r\n      // Use in-memory masterCryptoKey for encryption. customKey path is deprecated.\r\n      if (!this.masterCryptoKey || !this.masterHmacKey) {\r\n        if (this.isTestEnv()) {\r\n          // In tests allow a plaintext passthrough to avoid flaky setup, but never in production\r\n          return JSON.stringify({ v: 'clear', payload: data });\r\n        }\r\n        throw new Error('Encryption key not available');\r\n      }\r\n\r\n      const iv = new Uint8Array(12) as Uint8Array<ArrayBuffer>;\r\n      crypto.getRandomValues(iv);\r\n      const enc = new TextEncoder().encode(data);\r\n      const cipherBuffer = await crypto.subtle.encrypt(\r\n        { name: 'AES-GCM', iv },\r\n        this.masterCryptoKey,\r\n        enc\r\n      );\r\n      const cipherB64 = arrayBufferToBase64(cipherBuffer);\r\n\r\n      // Compute HMAC over ciphertext for integrity (do not include raw key)\r\n      const hmacSig = await crypto.subtle.sign(\r\n        'HMAC',\r\n        this.masterHmacKey,\r\n        base64ToBytes(cipherB64)\r\n      );\r\n      const hmacB64 = arrayBufferToBase64(hmacSig);\r\n\r\n      const payload = JSON.stringify({\r\n        v: '1',\r\n        cipher: cipherB64,\r\n        iv: arrayBufferToBase64(iv.buffer),\r\n        hmac: hmacB64,\r\n      });\r\n\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'info',\r\n        message: 'Data encrypted successfully',\r\n        metadata: { dataLength: data.length },\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n\r\n      return payload;\r\n    } catch (error) {\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'error',\r\n        message: 'Data encryption failed',\r\n        metadata: { error: error instanceof Error ? error.message : 'Unknown error' },\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Decrypt data using AES decryption\r\n   */\r\n  async decryptData(encryptedData: string, _customKey?: string): Promise<string> {\r\n    try {\r\n      if (!this.masterCryptoKey || !this.masterHmacKey) {\r\n        if (this.isTestEnv()) {\r\n          // Check if this is a clear passthrough produced by tests\r\n          try {\r\n            const obj = JSON.parse(encryptedData);\r\n            if (obj && obj.v === 'clear' && typeof obj.payload === 'string') return obj.payload;\r\n          } catch {\r\n            // ignore parse failure in test passthrough path; will error below if keys unavailable\r\n          }\r\n        }\r\n        throw new Error('Decryption key not available');\r\n      }\r\n\r\n      // Expect a JSON blob with cipher, iv, hmac\r\n      let parsed: { v?: string; cipher?: string; iv?: string; hmac?: string; payload?: string };\r\n      try {\r\n        parsed = JSON.parse(encryptedData);\r\n      } catch {\r\n        throw new Error('Malformed encrypted payload');\r\n      }\r\n\r\n      if (parsed.v === 'clear' && typeof parsed.payload === 'string') {\r\n        return parsed.payload as unknown as string;\r\n      }\r\n\r\n      if (!parsed.cipher || !parsed.iv || !parsed.hmac)\r\n        throw new Error('Encrypted payload missing fields');\r\n\r\n      // Verify HMAC\r\n      const expected = await crypto.subtle.verify(\r\n        'HMAC',\r\n        this.masterHmacKey,\r\n        base64ToBytes(parsed.hmac),\r\n        base64ToBytes(parsed.cipher)\r\n      );\r\n      if (!expected) throw new Error('Integrity check failed - HMAC mismatch');\r\n\r\n      const iv = base64ToBytes(parsed.iv);\r\n      const cipherBuf = base64ToBytes(parsed.cipher);\r\n      let decryptedBuf: ArrayBuffer;\r\n      try {\r\n        decryptedBuf = await crypto.subtle.decrypt(\r\n          { name: 'AES-GCM', iv },\r\n          this.masterCryptoKey,\r\n          cipherBuf\r\n        );\r\n      } catch {\r\n        throw new Error('Decryption failed - invalid key or corrupted data');\r\n      }\r\n\r\n      const decrypted = new TextDecoder().decode(new Uint8Array(decryptedBuf));\r\n\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'info',\r\n        message: 'Data decrypted successfully',\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n\r\n      return decrypted;\r\n    } catch (error) {\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'error',\r\n        message: 'Data decryption failed',\r\n        metadata: { error: error instanceof Error ? error.message : 'Unknown error' },\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Secure storage implementation\r\n   */\r\n  createSecureStorage(): SecureStorage {\r\n    return {\r\n      encrypt: async (data: string, key?: string) => {\r\n        return this.encryptData(data, key);\r\n      },\r\n\r\n      decrypt: async (encryptedData: string, key?: string) => {\r\n        return this.decryptData(encryptedData, key);\r\n      },\r\n\r\n      store: async (key: string, data: unknown, encrypted = true) => {\r\n        const serialized = JSON.stringify(data);\r\n        if (encrypted) {\r\n          if (!this.masterCryptoKey) {\r\n            if (!this.isTestEnv())\r\n              throw new Error('Secure storage requires initialized master key');\r\n            // In tests allow passthrough to avoid setup complexity\r\n            localStorage.setItem(key, serialized);\r\n          } else {\r\n            const finalData = await this.encryptData(serialized);\r\n            localStorage.setItem(key, finalData);\r\n          }\r\n        } else {\r\n          // Disallow storing plaintext in production\r\n          if (!this.isTestEnv())\r\n            throw new Error('Storing plaintext sensitive data in localStorage is forbidden');\r\n          localStorage.setItem(key, serialized);\r\n        }\r\n\r\n        this.logSecurityEvent({\r\n          type: 'data_access',\r\n          level: 'info',\r\n          message: `Data stored: ${key}`,\r\n          metadata: { encrypted, dataSize: serialized.length },\r\n          timestamp: new Date(),\r\n          sessionId: this.sessionId,\r\n        });\r\n      },\r\n\r\n      retrieve: async (key: string, encrypted = true) => {\r\n        const stored = localStorage.getItem(key);\r\n        if (!stored) return null;\r\n\r\n        try {\r\n          const data = encrypted ? await this.decryptData(stored) : stored;\r\n          return JSON.parse(data as string);\r\n        } catch (error) {\r\n          this.logSecurityEvent({\r\n            type: 'data_access',\r\n            level: 'error',\r\n            message: `Failed to retrieve data: ${key}`,\r\n            metadata: { error: error instanceof Error ? error.message : 'Unknown error' },\r\n            timestamp: new Date(),\r\n            sessionId: this.sessionId,\r\n          });\r\n          return null;\r\n        }\r\n      },\r\n\r\n      delete: async (key: string) => {\r\n        localStorage.removeItem(key);\r\n        this.logSecurityEvent({\r\n          type: 'data_access',\r\n          level: 'info',\r\n          message: `Data deleted: ${key}`,\r\n          timestamp: new Date(),\r\n          sessionId: this.sessionId,\r\n        });\r\n      },\r\n\r\n      clear: async () => {\r\n        localStorage.clear();\r\n        this.logSecurityEvent({\r\n          type: 'data_access',\r\n          level: 'warning',\r\n          message: 'All local storage cleared',\r\n          timestamp: new Date(),\r\n          sessionId: this.sessionId,\r\n        });\r\n      },\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Log security events for monitoring and auditing\r\n   */\r\n  logSecurityEvent(event: SecurityEvent): void {\r\n    this.events.push({\r\n      ...event,\r\n      sessionId: event.sessionId || this.sessionId,\r\n    });\r\n\r\n    // Keep only recent events to prevent memory issues (more aggressive trimming)\r\n    if (this.events.length > 500) {\r\n      this.events = this.events.slice(-250);\r\n    }\r\n\r\n    // Log critical events to console unless running tests (tests inspect events in-memory)\r\n    if (!this.isTestEnv() && (event.level === 'critical' || event.level === 'error')) {\r\n      console.error(`[SECURITY ${event.level.toUpperCase()}]`, event.message, event.metadata);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Perform security audit\r\n   */\r\n  async performSecurityAudit(): Promise<SecurityAuditResult> {\r\n    const issues: SecurityIssue[] = [];\r\n    const recommendations: string[] = [];\r\n\r\n    // Check if master key is initialized\r\n    if (!this.masterCryptoKey) {\r\n      issues.push({\r\n        id: 'no-master-key',\r\n        severity: 'high',\r\n        category: 'encryption',\r\n        title: 'No Master Key Initialized',\r\n        description: 'Encryption is not properly configured',\r\n        remediation: 'Initialize master key using initializeMasterKey()',\r\n        affectedComponents: ['SecureStorage', 'DataEncryption'],\r\n      });\r\n      recommendations.push('Initialize encryption system with a strong master key');\r\n    }\r\n\r\n    // Check for recent security errors\r\n    const recentErrors = this.events\r\n      .filter(e => e.level === 'error' || e.level === 'critical')\r\n      .filter(e => Date.now() - e.timestamp.getTime() < 24 * 60 * 60 * 1000); // Last 24 hours\r\n\r\n    if (recentErrors.length > 0) {\r\n      issues.push({\r\n        id: 'recent-security-errors',\r\n        severity: 'medium',\r\n        category: 'configuration',\r\n        title: 'Recent Security Errors Detected',\r\n        description: `${recentErrors.length} security errors in the last 24 hours`,\r\n        remediation: 'Review security event logs and address recurring issues',\r\n        affectedComponents: ['SecurityMonitoring'],\r\n      });\r\n      recommendations.push('Review and address recent security errors');\r\n    }\r\n\r\n    // Check storage encryption\r\n    const sampleKey = 'security-audit-test';\r\n    const storage = this.createSecureStorage();\r\n    try {\r\n      await storage.store(sampleKey, { test: true }, true);\r\n      await storage.retrieve(sampleKey, true);\r\n      await storage.delete(sampleKey);\r\n    } catch (error) {\r\n      issues.push({\r\n        id: 'storage-encryption-failure',\r\n        severity: 'high',\r\n        category: 'encryption',\r\n        title: 'Storage Encryption Test Failed',\r\n        description: 'Secure storage operations are not working correctly',\r\n        remediation: 'Debug encryption/decryption process and ensure proper key management',\r\n        affectedComponents: ['SecureStorage'],\r\n      });\r\n      console.error('Storage encryption test failed:', error);\r\n    }\r\n\r\n    // Calculate security score\r\n    const criticalIssues = issues.filter(i => i.severity === 'critical').length;\r\n    const highIssues = issues.filter(i => i.severity === 'high').length;\r\n    const mediumIssues = issues.filter(i => i.severity === 'medium').length;\r\n\r\n    const score = Math.max(0, 1 - (criticalIssues * 0.4 + highIssues * 0.3 + mediumIssues * 0.1));\r\n\r\n    this.logSecurityEvent({\r\n      type: 'audit',\r\n      level: issues.length === 0 ? 'info' : 'warning',\r\n      message: `Security audit completed. Score: ${formatNumber(score * 100, 1)}%`,\r\n      metadata: {\r\n        totalIssues: issues.length,\r\n        criticalIssues,\r\n        highIssues,\r\n        mediumIssues,\r\n        score,\r\n      },\r\n      timestamp: new Date(),\r\n      sessionId: this.sessionId,\r\n    });\r\n\r\n    return {\r\n      passed: score >= 0.8 && criticalIssues === 0,\r\n      score,\r\n      issues,\r\n      recommendations,\r\n      lastAudit: new Date(),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Wrap a CryptoKey with the masterCryptoKey for persistent storage.\r\n   * Returns a JSON string containing the wrapped key material and IV.\r\n   */\r\n  async wrapKey(key: CryptoKey): Promise<string> {\r\n    if (!this.masterCryptoKey) {\r\n      if (this.isTestEnv()) {\r\n        // In test env, allow exporting raw key for simplicity\r\n        try {\r\n          const raw = await crypto.subtle.exportKey('raw', key);\r\n          return JSON.stringify({ wrapped: arrayBufferToBase64(raw), iv: null, format: 'raw' });\r\n        } catch {\r\n          return JSON.stringify({ wrapped: null, iv: null, format: 'none' });\r\n        }\r\n      }\r\n      throw new Error('Master crypto key not initialized - cannot wrap key');\r\n    }\r\n\r\n    // Use AES-GCM wrapping with a random IV\r\n    const iv = new Uint8Array(12) as Uint8Array<ArrayBuffer>;\r\n    crypto.getRandomValues(iv);\r\n    const wrapped = await crypto.subtle.wrapKey('raw', key, this.masterCryptoKey, {\r\n      name: 'AES-GCM',\r\n      iv,\r\n    });\r\n    return JSON.stringify({\r\n      wrapped: arrayBufferToBase64(wrapped),\r\n      iv: arrayBufferToBase64(iv.buffer),\r\n      format: 'raw',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Unwrap a previously wrapped key JSON (as produced by wrapKey) into a CryptoKey.\r\n   */\r\n  // Narrow algorithm/usages types inline (avoid DOM lib global types that triggered lint no-undef)\r\n  async unwrapKey(\r\n    wrappedJson: string,\r\n    algorithm: { name: string } = { name: 'AES-GCM' },\r\n    usages: Array<'encrypt' | 'decrypt' | 'sign' | 'verify'> = ['encrypt', 'decrypt']\r\n  ): Promise<CryptoKey | null> {\r\n    try {\r\n      const obj = JSON.parse(wrappedJson) as\r\n        | WrappedKeyPayload\r\n        | { wrapped?: string | null; iv?: string | null; format?: string };\r\n      if (!obj || !obj.wrapped) return null;\r\n      if (obj.format === 'raw' && (!obj.iv || !this.masterCryptoKey)) {\r\n        if (this.isTestEnv()) {\r\n          // In tests the wrapped field may actually be raw key material\r\n          const raw = base64ToBytes(obj.wrapped);\r\n          return await crypto.subtle.importKey('raw', raw, algorithm, false, usages);\r\n        }\r\n        // Cannot unwrap without master key\r\n        throw new Error('Cannot unwrap key - master key missing');\r\n      }\r\n\r\n      const iv: Uint8Array<ArrayBuffer> | null = obj.iv ? base64ToBytes(obj.iv) : null;\r\n      const wrappedBuf = base64ToBytes(obj.wrapped);\r\n      if (!this.masterCryptoKey) throw new Error('Master crypto key not initialized');\r\n      // Unwrap key\r\n      const key = await crypto.subtle.unwrapKey(\r\n        'raw',\r\n        wrappedBuf,\r\n        this.masterCryptoKey,\r\n        { name: 'AES-GCM', iv: iv ?? (new Uint8Array(12) as Uint8Array<ArrayBuffer>) },\r\n        algorithm,\r\n        false,\r\n        usages\r\n      );\r\n      return key;\r\n    } catch (e) {\r\n      this.logSecurityEvent({\r\n        type: 'encryption',\r\n        level: 'error',\r\n        message: 'Failed to unwrap key',\r\n        metadata: { error: e instanceof Error ? e.message : String(e) },\r\n        timestamp: new Date(),\r\n        sessionId: this.sessionId,\r\n      });\r\n      if (this.isTestEnv()) return null;\r\n      throw e;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get security events for monitoring\r\n   */\r\n  getSecurityEvents(filters?: {\r\n    type?: SecurityEvent['type'];\r\n    level?: SecurityEvent['level'];\r\n    since?: Date;\r\n    limit?: number;\r\n  }): SecurityEvent[] {\r\n    let filtered = [...this.events];\r\n\r\n    if (filters) {\r\n      if (filters.type) {\r\n        filtered = filtered.filter(e => e.type === filters.type);\r\n      }\r\n      if (filters.level) {\r\n        filtered = filtered.filter(e => e.level === filters.level);\r\n      }\r\n      if (filters.since) {\r\n        filtered = filtered.filter(e => e.timestamp >= filters.since!);\r\n      }\r\n      if (filters.limit) {\r\n        filtered = filtered.slice(-filters.limit);\r\n      }\r\n    }\r\n\r\n    return filtered.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\r\n  }\r\n\r\n  /**\r\n   * Clear security events (for privacy compliance)\r\n   */\r\n  clearSecurityEvents(olderThan?: Date): void {\r\n    if (olderThan) {\r\n      this.events = this.events.filter(e => e.timestamp >= olderThan);\r\n    } else {\r\n      this.events = [];\r\n    }\r\n\r\n    this.logSecurityEvent({\r\n      type: 'audit',\r\n      level: 'info',\r\n      message: 'Security events cleared',\r\n      metadata: { olderThan: olderThan?.toISOString() },\r\n      timestamp: new Date(),\r\n      sessionId: this.sessionId,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get current security status summary\r\n   */\r\n  getSecurityStatus(): {\r\n    encryptionEnabled: boolean;\r\n    masterKeyInitialized: boolean;\r\n    recentEvents: number;\r\n    recentErrors: number;\r\n    lastAudit: Date | null;\r\n  } {\r\n    const recent24h = new Date(Date.now() - 24 * 60 * 60 * 1000);\r\n    const recentEvents = this.events.filter(e => e.timestamp >= recent24h);\r\n    const recentErrors = recentEvents.filter(e => e.level === 'error' || e.level === 'critical');\r\n\r\n    const lastAuditEvent = this.events\r\n      .filter(e => e.type === 'audit' && e.message.includes('audit completed'))\r\n      .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())[0];\r\n\r\n    return {\r\n      encryptionEnabled: !!this.masterCryptoKey,\r\n      masterKeyInitialized: !!this.masterCryptoKey,\r\n      recentEvents: recentEvents.length,\r\n      recentErrors: recentErrors.length,\r\n      lastAudit: lastAuditEvent?.timestamp || null,\r\n    };\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const securityService = new SecurityService();\r\n","import { parseISO } from 'date-fns';\n\n/**\n * Return a Date at local midnight for the given ISO string or Date.\n * This normalizes a timestamp to the local-day start so comparisons are consistent.\n */\nexport function localDayStart(input: string | Date): Date {\n  // Defensive: Only allow ISO date strings or Date objects\n  let d: Date;\n  if (typeof input === 'string') {\n    if (!/^\\d{4}-\\d{2}-\\d{2}T?/.test(input)) return new Date(NaN);\n    d = parseISO(input);\n  } else {\n    d = input;\n  }\n  if (!(d instanceof Date) || Number.isNaN(d.getTime())) return new Date(NaN);\n  return new Date(d.getFullYear(), d.getMonth(), d.getDate());\n}\n\nexport function isSameLocalDay(a: string | Date, b: string | Date): boolean {\n  const da = localDayStart(a);\n  const db = localDayStart(b);\n  return da.getTime() === db.getTime();\n}\n\nexport default { localDayStart, isSameLocalDay };\n","/**\r\n * Privacy-Preserving Analytics Service\r\n * Collects insights while maintaining user privacy through differential privacy\r\n * and data minimization techniques\r\n */\r\n\r\nimport { securityService } from './SecurityService';\r\nimport { formatNumber } from '../utils/formatting';\r\nimport { localDayStart } from '../utils/dates';\r\nimport type { PainEntry } from '../types';\r\nimport { parseDate } from '../utils/date-utils';\r\nimport {\r\n  trackPainEntryLogged,\r\n  trackValidationUsed as trackGA4Validation,\r\n  trackProgressViewed as trackGA4Progress,\r\n} from '../analytics/ga4-events';\r\n\r\n// Privacy configuration\r\nexport interface PrivacyPreservingConfig {\r\n  enableAnalytics: boolean;\r\n  differentialPrivacyEnabled: boolean;\r\n  noiseLevel: number; // Epsilon value for differential privacy\r\n  dataRetentionDays: number;\r\n  minimumAggregationSize: number; // Minimum data points before reporting\r\n  allowedMetrics: string[];\r\n  consentRequired: boolean;\r\n}\r\n\r\n// Anonymized analytics event\r\nexport interface AnonymizedEvent {\r\n  eventType: 'pain_logged' | 'progress_viewed' | 'validation_used' | 'export_performed';\r\n  timestamp: Date;\r\n  metadata: Record<string, unknown>;\r\n  sessionHash: string; // One-way hash of session\r\n  isAnonymized: true;\r\n}\r\n\r\n// Aggregated insights (no individual data)\r\nexport interface AggregatedInsights {\r\n  totalUsers: number; // Approximate\r\n  averagePainLevel: number; // With noise added\r\n  commonPainLocations: Array<{ location: string; frequency: number }>;\r\n  usagePatterns: {\r\n    averageEntriesPerWeek: number;\r\n    peakUsageHours: number[];\r\n    validationUsageRate: number;\r\n  };\r\n  privacyMetrics: {\r\n    noiseAdded: number;\r\n    dataPointsAggregated: number;\r\n    privacyBudgetUsed: number;\r\n  };\r\n  generatedAt: Date;\r\n}\r\n\r\n// Differential privacy noise generator\r\nclass DifferentialPrivacyEngine {\r\n  private epsilon: number; // Privacy budget\r\n  private budgetUsed: number = 0;\r\n\r\n  constructor(epsilon: number = 1.0) {\r\n    this.epsilon = epsilon;\r\n  }\r\n\r\n  // Add Laplace noise for differential privacy\r\n  addLaplaceNoise(value: number, sensitivity: number = 1): number {\r\n    if (this.budgetUsed >= this.epsilon) {\r\n      throw new Error('Privacy budget exhausted');\r\n    }\r\n\r\n    const scale = sensitivity / this.epsilon;\r\n    const noise = this.generateLaplaceNoise(scale);\r\n    this.budgetUsed += this.epsilon * 0.1; // Use 10% of budget per query\r\n\r\n    return Math.max(0, value + noise); // Ensure non-negative results\r\n  }\r\n\r\n  // Generate noise from Laplace distribution\r\n  private generateLaplaceNoise(scale: number): number {\r\n    const u = Math.random() - 0.5;\r\n    return -scale * Math.sign(u) * Math.log(1 - 2 * Math.abs(u));\r\n  }\r\n\r\n  getRemainingBudget(): number {\r\n    return Math.max(0, this.epsilon - this.budgetUsed);\r\n  }\r\n\r\n  resetBudget(): void {\r\n    this.budgetUsed = 0;\r\n  }\r\n}\r\n\r\n/**\r\n * Privacy-Preserving Analytics Service\r\n * Provides insights while protecting individual privacy\r\n */\r\nexport class PrivacyPreservingAnalyticsService {\r\n  private config: PrivacyPreservingConfig;\r\n  private events: AnonymizedEvent[] = [];\r\n  private privacyEngine: DifferentialPrivacyEngine;\r\n  private userConsent: boolean = false;\r\n  private sessionHash: string;\r\n\r\n  constructor(config?: Partial<PrivacyPreservingConfig>) {\r\n    this.config = {\r\n      enableAnalytics: true,\r\n      differentialPrivacyEnabled: true,\r\n      noiseLevel: 1.0,\r\n      dataRetentionDays: 30,\r\n      minimumAggregationSize: 5,\r\n      allowedMetrics: ['pain_level', 'location', 'usage_time', 'validation_usage'],\r\n      consentRequired: true,\r\n      ...config,\r\n    };\r\n\r\n    this.privacyEngine = new DifferentialPrivacyEngine(this.config.noiseLevel);\r\n    this.sessionHash = this.generateSessionHash();\r\n    this.initializeService();\r\n  }\r\n\r\n  private generateSessionHash(): string {\r\n    // Generate a one-way hash for session tracking without identification\r\n    const randomData = `${Date.now()}-${Math.random()}-${navigator.userAgent}`;\r\n    let hash = 0;\r\n    for (let i = 0; i < randomData.length; i++) {\r\n      const char = randomData.charCodeAt(i);\r\n      hash = (hash << 5) - hash + char;\r\n      hash = hash & hash; // Convert to 32-bit integer\r\n    }\r\n    return Math.abs(hash).toString(36);\r\n  }\r\n\r\n  private initializeService(): void {\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'Privacy-preserving analytics service initialized',\r\n      metadata: {\r\n        differentialPrivacyEnabled: this.config.differentialPrivacyEnabled,\r\n        noiseLevel: this.config.noiseLevel,\r\n        consentRequired: this.config.consentRequired,\r\n      },\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    // Clean old events on initialization\r\n    this.cleanOldEvents();\r\n  }\r\n\r\n  /**\r\n   * Request user consent for analytics\r\n   */\r\n  async requestConsent(): Promise<boolean> {\r\n    if (!this.config.consentRequired) {\r\n      this.userConsent = true;\r\n      return true;\r\n    }\r\n\r\n    // Grant consent when called\r\n    this.userConsent = true;\r\n\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'User consent for analytics granted',\r\n      metadata: { consentGiven: this.userConsent },\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    return this.userConsent;\r\n  }\r\n\r\n  /**\r\n   * Revoke user consent for analytics\r\n   */\r\n  revokeConsent(): void {\r\n    this.userConsent = false;\r\n\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'User consent for analytics revoked',\r\n      metadata: { consentGiven: this.userConsent },\r\n      timestamp: new Date(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if user has given consent\r\n   */\r\n  hasConsent(): boolean {\r\n    return this.userConsent || !this.config.consentRequired;\r\n  }\r\n\r\n  /**\r\n   * Track a pain entry in an anonymized way\r\n   */\r\n  async trackPainEntry(entry: PainEntry): Promise<void> {\r\n    if (!this.shouldTrack()) return;\r\n\r\n    // Extract only non-identifying metrics\r\n    const anonymizedMetadata = {\r\n      painLevel: this.anonymizePainLevel(entry.baselineData.pain),\r\n      hasLocation: !!entry.baselineData.locations && entry.baselineData.locations.length > 0,\r\n      hasDescription: !!entry.notes && entry.notes.length > 0,\r\n      timeOfDay: new Date(entry.timestamp).getHours(),\r\n      dayOfWeek: new Date(entry.timestamp).getDay(),\r\n    };\r\n\r\n    const event: AnonymizedEvent = {\r\n      eventType: 'pain_logged',\r\n      timestamp: new Date(),\r\n      metadata: anonymizedMetadata,\r\n      sessionHash: this.sessionHash,\r\n      isAnonymized: true,\r\n    };\r\n\r\n    this.addEvent(event);\r\n\r\n    // Also send to GA4 for external analytics\r\n    trackPainEntryLogged({\r\n      painLevel: entry.baselineData.pain,\r\n      hasLocation: anonymizedMetadata.hasLocation,\r\n      hasNotes: anonymizedMetadata.hasDescription,\r\n      locationCount: entry.baselineData.locations?.length ?? 0,\r\n      symptomCount: entry.baselineData.symptoms?.length ?? 0,\r\n    });\r\n\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'Pain entry tracked (anonymized)',\r\n      metadata: { sessionHash: this.sessionHash },\r\n      timestamp: new Date(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Track validation system usage\r\n   */\r\n  async trackValidationUsage(validationType: string): Promise<void> {\r\n    if (!this.shouldTrack()) return;\r\n\r\n    const event: AnonymizedEvent = {\r\n      eventType: 'validation_used',\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        validationType: this.anonymizeString(validationType),\r\n        timeOfDay: new Date().getHours(),\r\n      },\r\n      sessionHash: this.sessionHash,\r\n      isAnonymized: true,\r\n    };\r\n\r\n    this.addEvent(event);\r\n\r\n    // Also send to GA4 for external analytics\r\n    trackGA4Validation(validationType);\r\n  }\r\n\r\n  /**\r\n   * Track progress view usage\r\n   */\r\n  async trackProgressView(viewType: string): Promise<void> {\r\n    if (!this.shouldTrack()) return;\r\n\r\n    const event: AnonymizedEvent = {\r\n      eventType: 'progress_viewed',\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        viewType: this.anonymizeString(viewType),\r\n        timeOfDay: new Date().getHours(),\r\n      },\r\n      sessionHash: this.sessionHash,\r\n      isAnonymized: true,\r\n    };\r\n\r\n    this.addEvent(event);\r\n\r\n    // Also send to GA4 for external analytics\r\n    trackGA4Progress(viewType);\r\n  }\r\n\r\n  /**\r\n   * Track data export usage\r\n   * Note: GA4 tracking with entry_count is handled by export utilities directly\r\n   */\r\n  async trackDataExport(exportType: 'csv' | 'json' | 'pdf'): Promise<void> {\r\n    if (!this.shouldTrack()) return;\r\n\r\n    const event: AnonymizedEvent = {\r\n      eventType: 'export_performed',\r\n      timestamp: new Date(),\r\n      metadata: {\r\n        exportType,\r\n        timeOfDay: new Date().getHours(),\r\n      },\r\n      sessionHash: this.sessionHash,\r\n      isAnonymized: true,\r\n    };\r\n\r\n    this.addEvent(event);\r\n    // GA4 tracking is done by callers (export utilities) with entry_count\r\n  }\r\n\r\n  /**\r\n   * Generate aggregated insights with differential privacy\r\n   */\r\n  async generateInsights(): Promise<AggregatedInsights | null> {\r\n    if (!this.shouldTrack() || this.events.length < this.config.minimumAggregationSize) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      const painEvents = this.events.filter(e => e.eventType === 'pain_logged');\r\n      const validationEvents = this.events.filter(e => e.eventType === 'validation_used');\r\n\r\n      // Calculate metrics with noise\r\n      const totalUsers = this.config.differentialPrivacyEnabled\r\n        ? this.privacyEngine.addLaplaceNoise(this.getUniqueSessionCount())\r\n        : this.getUniqueSessionCount();\r\n\r\n      const averagePainLevel = this.config.differentialPrivacyEnabled\r\n        ? this.privacyEngine.addLaplaceNoise(this.calculateAveragePainLevel(painEvents))\r\n        : this.calculateAveragePainLevel(painEvents);\r\n\r\n      const commonLocations = this.getCommonPainLocations();\r\n\r\n      const usagePatterns = {\r\n        averageEntriesPerWeek: this.config.differentialPrivacyEnabled\r\n          ? this.privacyEngine.addLaplaceNoise(this.calculateWeeklyAverage(painEvents))\r\n          : this.calculateWeeklyAverage(painEvents),\r\n        peakUsageHours: this.getPeakUsageHours(this.events),\r\n        validationUsageRate: this.config.differentialPrivacyEnabled\r\n          ? this.privacyEngine.addLaplaceNoise(\r\n              validationEvents.length / Math.max(1, painEvents.length)\r\n            )\r\n          : validationEvents.length / Math.max(1, painEvents.length),\r\n      };\r\n\r\n      const insights: AggregatedInsights = {\r\n        totalUsers: Math.round(totalUsers),\r\n        averagePainLevel: Number(formatNumber(averagePainLevel, 1)),\r\n        commonPainLocations: commonLocations,\r\n        usagePatterns,\r\n        privacyMetrics: {\r\n          noiseAdded: this.config.differentialPrivacyEnabled ? this.config.noiseLevel : 0,\r\n          dataPointsAggregated: this.events.length,\r\n          privacyBudgetUsed: this.config.differentialPrivacyEnabled\r\n            ? this.privacyEngine.getRemainingBudget()\r\n            : 0,\r\n        },\r\n        generatedAt: new Date(),\r\n      };\r\n\r\n      securityService.logSecurityEvent({\r\n        type: 'analytics',\r\n        level: 'info',\r\n        message: 'Privacy-preserving insights generated',\r\n        metadata: {\r\n          totalEvents: this.events.length,\r\n          uniqueSessions: this.getUniqueSessionCount(),\r\n          privacyBudgetRemaining: this.privacyEngine.getRemainingBudget(),\r\n        },\r\n        timestamp: new Date(),\r\n      });\r\n\r\n      return insights;\r\n    } catch (error) {\r\n      securityService.logSecurityEvent({\r\n        type: 'analytics',\r\n        level: 'error',\r\n        message: 'Failed to generate insights',\r\n        metadata: { error: error instanceof Error ? error.message : 'Unknown error' },\r\n        timestamp: new Date(),\r\n      });\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get privacy status and configuration\r\n   */\r\n  getPrivacyStatus(): {\r\n    analyticsEnabled: boolean;\r\n    consentGiven: boolean;\r\n    differentialPrivacyEnabled: boolean;\r\n    eventsCollected: number;\r\n    privacyBudgetRemaining: number;\r\n    dataRetentionDays: number;\r\n  } {\r\n    return {\r\n      analyticsEnabled: this.config.enableAnalytics,\r\n      consentGiven: this.userConsent,\r\n      differentialPrivacyEnabled: this.config.differentialPrivacyEnabled,\r\n      eventsCollected: this.events.length,\r\n      privacyBudgetRemaining: this.privacyEngine.getRemainingBudget(),\r\n      dataRetentionDays: this.config.dataRetentionDays,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear all analytics data\r\n   */\r\n  async clearAnalyticsData(): Promise<void> {\r\n    this.events = [];\r\n    this.privacyEngine.resetBudget();\r\n\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'Analytics data cleared',\r\n      timestamp: new Date(),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update privacy configuration\r\n   */\r\n  updatePrivacyConfig(newConfig: Partial<PrivacyPreservingConfig>): void {\r\n    this.config = { ...this.config, ...newConfig };\r\n\r\n    if (newConfig.noiseLevel) {\r\n      this.privacyEngine = new DifferentialPrivacyEngine(newConfig.noiseLevel);\r\n    }\r\n\r\n    securityService.logSecurityEvent({\r\n      type: 'analytics',\r\n      level: 'info',\r\n      message: 'Privacy configuration updated',\r\n      metadata: newConfig,\r\n      timestamp: new Date(),\r\n    });\r\n  }\r\n\r\n  // Private helper methods\r\n\r\n  private shouldTrack(): boolean {\r\n    return this.config.enableAnalytics && (!this.config.consentRequired || this.userConsent);\r\n  }\r\n\r\n  private addEvent(event: AnonymizedEvent): void {\r\n    this.events.push(event);\r\n    this.cleanOldEvents();\r\n  }\r\n\r\n  private cleanOldEvents(): void {\r\n    const cutoffDate = new Date();\r\n    cutoffDate.setDate(cutoffDate.getDate() - this.config.dataRetentionDays);\r\n\r\n    const initialCount = this.events.length;\r\n    this.events = this.events.filter(event => event.timestamp >= cutoffDate);\r\n\r\n    if (this.events.length < initialCount) {\r\n      securityService.logSecurityEvent({\r\n        type: 'analytics',\r\n        level: 'info',\r\n        message: 'Old analytics events cleaned',\r\n        metadata: { removed: initialCount - this.events.length },\r\n        timestamp: new Date(),\r\n      });\r\n    }\r\n  }\r\n\r\n  private anonymizePainLevel(level: number): number {\r\n    // Round to reduce precision\r\n    return Math.round(level / 2) * 2;\r\n  }\r\n\r\n  private anonymizeString(str: string): string {\r\n    // Return category rather than exact string\r\n    if (str.toLowerCase().includes('validation')) return 'validation';\r\n    if (str.toLowerCase().includes('progress')) return 'progress';\r\n    if (str.toLowerCase().includes('export')) return 'export';\r\n    return 'other';\r\n  }\r\n\r\n  private getUniqueSessionCount(): number {\r\n    const uniqueSessions = new Set(this.events.map(e => e.sessionHash));\r\n    return uniqueSessions.size;\r\n  }\r\n\r\n  private calculateAveragePainLevel(painEvents: AnonymizedEvent[]): number {\r\n    if (painEvents.length === 0) return 0;\r\n\r\n    const total = painEvents.reduce((sum, event) => {\r\n      const painLevel = event.metadata.painLevel as number;\r\n      return sum + (painLevel || 0);\r\n    }, 0);\r\n\r\n    return total / painEvents.length;\r\n  }\r\n\r\n  private calculateWeeklyAverage(painEvents: AnonymizedEvent[]): number {\r\n    if (painEvents.length === 0) return 0;\r\n\r\n    // Compute average pain over the last 7 calendar days (today + previous 6 days)\r\n    const now = new Date();\r\n    const sevenDayWindowStart = new Date(localDayStart(now).getTime());\r\n    sevenDayWindowStart.setDate(sevenDayWindowStart.getDate() - 6); // inclusive of today\r\n\r\n    const recent = painEvents.filter(e => {\r\n      // Accept Date or string timestamps\r\n  // Normalize timestamp to Date using parseDate helper\r\n  const t = parseDate(e.timestamp) ?? new Date(String(e.timestamp));\r\n      return t >= sevenDayWindowStart;\r\n    });\r\n\r\n    if (recent.length === 0) return 0;\r\n\r\n    const total = recent.reduce((sum, event) => {\r\n      const painLevel = (event.metadata && (event.metadata.painLevel as number)) || 0;\r\n      return sum + painLevel;\r\n    }, 0);\r\n\r\n    const avg = total / recent.length;\r\n    // Clamp to expected pain scale (0-10)\r\n    return Math.max(0, Math.min(10, avg));\r\n  }\r\n\r\n  private getCommonPainLocations(): Array<{ location: string; frequency: number }> {\r\n    // Return anonymized location categories\r\n    return [\r\n      { location: 'upper_body', frequency: Math.random() * 50 },\r\n      { location: 'lower_body', frequency: Math.random() * 50 },\r\n      { location: 'extremities', frequency: Math.random() * 30 },\r\n    ];\r\n  }\r\n\r\n  private getPeakUsageHours(events: AnonymizedEvent[]): number[] {\r\n    const hourCounts = new Array(24).fill(0);\r\n\r\n    events.forEach(event => {\r\n      const hour = event.metadata.timeOfDay as number;\r\n      if (hour >= 0 && hour < 24) {\r\n        hourCounts[hour]++;\r\n      }\r\n    });\r\n\r\n    // Return top 3 hours\r\n    return hourCounts\r\n      .map((count, hour) => ({ hour, count }))\r\n      .sort((a, b) => b.count - a.count)\r\n      .slice(0, 3)\r\n      .map(item => item.hour);\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const privacyAnalytics = new PrivacyPreservingAnalyticsService();\r\n","export interface PHIDetectionResult {\n  found: boolean;\n  matches: string[];\n}\n\nexport class HIPAACompliance {\n  // Very small PHI detectors for common PHI patterns. Security must review/expand.\n  private phiPatterns: RegExp[] = [\n    /\\b\\d{3}-\\d{2}-\\d{4}\\b/g, // SSN-like (literal)\n    /\\b\\d{3}-\\d{3}-\\d{4}\\b/g, // phone (literal)\n    /[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}/gi, // email (literal)\n    // All patterns above are statically defined and do not use user input\n  ];\n\n  detectPHI(text: string): PHIDetectionResult {\n    const matches: string[] = [];\n    for (const p of this.phiPatterns) {\n      const found = text.match(p);\n      if (found) matches.push(...found);\n    }\n    return { found: matches.length > 0, matches };\n  }\n\n  // Hook to log PHI detection events; real implementation must forward to secure audit sink.\n  async logPHIDetection(userId: string, textSample: string, matches: string[]) {\n    // Minimal local logging (console usage acceptable here for visibility; remove directive to satisfy lint)\n    console.warn(\n      `[HIPAA] PHI detected for user=${userId}, matches=${JSON.stringify(matches.slice(0, 5))}`\n    );\n  }\n}\n\nexport function createHIPAACompliance() {\n  return new HIPAACompliance();\n}\n// HIPAA Compliance and Data Validation Service\n// Ensures healthcare data handling meets HIPAA requirements and validates data integrity\n\nimport { FHIRResource, FHIRBundle } from './FHIRService';\n\nexport interface HIPAAComplianceConfig {\n  organizationId: string;\n  privacyOfficer: ContactInfo;\n  securityOfficer: ContactInfo;\n  complianceOfficer: ContactInfo;\n  businessAssociates: BusinessAssociate[];\n  policies: CompliancePolicy[];\n  technicalSafeguards: TechnicalSafeguards;\n  physicalSafeguards: PhysicalSafeguards;\n  administrativeSafeguards: AdministrativeSafeguards;\n}\n\nexport interface ContactInfo {\n  name: string;\n  title: string;\n  email: string;\n  phone: string;\n  address?: string;\n}\n\nexport interface BusinessAssociate {\n  id: string;\n  name: string;\n  serviceType: string;\n  contractDate: string;\n  expirationDate: string;\n  contactInfo: ContactInfo;\n  dataTypes: string[];\n  safeguardRequirements: string[];\n  status: 'active' | 'suspended' | 'terminated';\n}\n\nexport interface CompliancePolicy {\n  id: string;\n  name: string;\n  category: 'privacy' | 'security' | 'breach' | 'access' | 'training';\n  description: string;\n  requirements: string[];\n  procedures: string[];\n  lastReview: string;\n  nextReview: string;\n  approvedBy: string;\n  version: string;\n}\n\nexport interface TechnicalSafeguards {\n  accessControl: {\n    uniqueUserIdentification: boolean;\n    automaticLogoff: boolean;\n    encryptionDecryption: boolean;\n  };\n  auditControls: {\n    hardwareSystemsAccess: boolean;\n    softwareSystemsAccess: boolean;\n    activityReviews: boolean;\n  };\n  integrity: {\n    protectionFromAlteration: boolean;\n    protectionFromDestruction: boolean;\n  };\n  personOrEntityAuthentication: {\n    verifyUserIdentity: boolean;\n  };\n  transmissionSecurity: {\n    guardAgainstUnauthorizedAccess: boolean;\n    dataIntegrityControls: boolean;\n    encryptionStandards: string[];\n  };\n}\n\nexport interface PhysicalSafeguards {\n  facilityAccessControls: {\n    limitPhysicalAccess: boolean;\n    workstationAccess: boolean;\n    mediaControls: boolean;\n  };\n  workstationUse: {\n    limitedAccess: boolean;\n    physicalAttributes: string[];\n  };\n  deviceMediaControls: {\n    disposalProcedures: boolean;\n    reuseProtocols: boolean;\n    accountabilityMeasures: boolean;\n    dataBackupStorage: boolean;\n  };\n}\n\nexport interface AdministrativeSafeguards {\n  securityManagement: {\n    securityOfficerAssigned: boolean;\n    managementResponsibilities: string[];\n  };\n  workforceTraining: {\n    privacyTraining: boolean;\n    securityTraining: boolean;\n    trainingFrequency: string;\n    lastCompleted: string;\n  };\n  accessManagement: {\n    accessAuthorizationProcedures: boolean;\n    accessEstablishmentModification: boolean;\n    accessTerminationProcedures: boolean;\n  };\n  contingencyPlan: {\n    dataBackupPlan: boolean;\n    disasterRecoveryPlan: boolean;\n    emergencyModeOperationPlan: boolean;\n    dataRecoveryPlan: boolean;\n  };\n  businessAssociateContracts: {\n    writtenContracts: boolean;\n    safeguardRequirements: boolean;\n  };\n}\n\nexport interface PHIIdentifier {\n  type:\n    | 'name'\n    | 'address'\n    | 'date'\n    | 'phone'\n    | 'fax'\n    | 'email'\n    | 'ssn'\n    | 'mrn'\n    | 'account'\n    | 'certificate'\n    | 'vehicle'\n    | 'device'\n    | 'url'\n    | 'ip'\n    | 'biometric'\n    | 'photo'\n    | 'other';\n  value: string;\n  location: string;\n  confidence: number;\n}\n\nexport interface DeidentificationResult {\n  originalData: unknown;\n  deidentifiedData: unknown;\n  identifiersRemoved: PHIIdentifier[];\n  method: 'safe-harbor' | 'expert-determination' | 'limited-dataset';\n  timestamp: string;\n  processedBy: string;\n}\n\nexport interface BreachAssessment {\n  incidentId: string;\n  reportedDate: string;\n  discoveredDate: string;\n  description: string;\n  phiInvolved: {\n    recordCount: number;\n    patientCount: number;\n    dataTypes: string[];\n  };\n  riskLevel: 'low' | 'medium' | 'high' | 'critical';\n  containmentMeasures: string[];\n  notificationRequired: boolean;\n  authoritiesNotified: boolean;\n  patientsNotified: boolean;\n  investigationStatus: 'open' | 'pending' | 'closed';\n  remedialActions: string[];\n}\n\nexport interface AccessRequest {\n  requestId: string;\n  requesterId: string;\n  requesterRole: string;\n  patientId: string;\n  dataTypes: string[];\n  purpose: string;\n  urgency: 'routine' | 'urgent' | 'emergency';\n  requestDate: string;\n  approvalStatus: 'pending' | 'approved' | 'denied' | 'conditionally-approved';\n  approvedBy?: string;\n  approvalDate?: string;\n  conditions?: string[];\n  expirationDate?: string;\n}\n\nexport interface AuditTrail {\n  eventId: string;\n  timestamp: string;\n  userId: string;\n  userRole: string;\n  actionType:\n    | 'create'\n    | 'read'\n    | 'update'\n    | 'delete'\n    | 'export'\n    | 'print'\n    | 'access'\n    | 'login'\n    | 'logout';\n  resourceType: string;\n  resourceId?: string;\n  patientId?: string;\n  ipAddress: string;\n  userAgent: string;\n  outcome: 'success' | 'failure' | 'warning';\n  details?: Record<string, unknown>;\n  riskScore: number;\n}\n\nexport class HIPAAComplianceService {\n  private config: HIPAAComplianceConfig;\n  private auditTrails: AuditTrail[] = [];\n  private accessRequests: Map<string, AccessRequest> = new Map();\n  private breachAssessments: Map<string, BreachAssessment> = new Map();\n  \n  /** Maximum audit trail entries to retain (prevents unbounded memory growth) */\n  private static readonly MAX_AUDIT_TRAILS = 10000;\n  /** Number of entries to evict when limit is reached */\n  private static readonly AUDIT_EVICTION_COUNT = 2000;\n\n  constructor(config: HIPAAComplianceConfig) {\n    this.config = config;\n  }\n\n  // Data Validation and Sanitization\n  async validateFHIRResource(resource: FHIRResource): Promise<{\n    isValid: boolean;\n    errors: string[];\n    warnings: string[];\n    complianceScore: number;\n  }> {\n    const errors: string[] = [];\n    const warnings: string[] = [];\n\n    // Validate required FHIR fields\n    if (!resource.resourceType) {\n      errors.push('Missing required field: resourceType');\n    }\n\n    // Validate data integrity\n    if (resource.id && !this.isValidId(resource.id)) {\n      errors.push('Invalid resource ID format');\n    }\n\n    // Check for potential PHI in inappropriate fields\n    const phiCheck = await this.scanForPHI(resource);\n    if (phiCheck.identifiers.length > 0) {\n      warnings.push(`Potential PHI detected in ${phiCheck.identifiers.length} fields`);\n    }\n\n    // Validate timestamps\n    if (resource.meta?.lastUpdated && !this.isValidTimestamp(resource.meta.lastUpdated)) {\n      errors.push('Invalid lastUpdated timestamp');\n    }\n\n    const complianceScore = this.calculateComplianceScore(errors, warnings);\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n      warnings,\n      complianceScore,\n    };\n  }\n\n  async validateFHIRBundle(bundle: FHIRBundle): Promise<{\n    isValid: boolean;\n    resourceResults: Array<{\n      resourceId?: string;\n      isValid: boolean;\n      errors: string[];\n      warnings: string[];\n    }>;\n    overallErrors: string[];\n    complianceScore: number;\n  }> {\n    const overallErrors: string[] = [];\n    const resourceResults = [];\n\n    // Validate bundle structure\n    if (!bundle.type) {\n      overallErrors.push('Bundle missing required type field');\n    }\n\n    if (bundle.entry) {\n      for (let i = 0; i < bundle.entry.length; i++) {\n        const entry = bundle.entry[i];\n        if (entry.resource) {\n          const validation = await this.validateFHIRResource(entry.resource);\n          resourceResults.push({\n            resourceId: entry.resource.id,\n            isValid: validation.isValid,\n            errors: validation.errors,\n            warnings: validation.warnings,\n          });\n        }\n      }\n    }\n\n    const totalErrors =\n      overallErrors.length + resourceResults.reduce((sum, r) => sum + r.errors.length, 0);\n    const complianceScore = Math.max(0, 100 - totalErrors * 10);\n\n    return {\n      isValid: overallErrors.length === 0 && resourceResults.every(r => r.isValid),\n      resourceResults,\n      overallErrors,\n      complianceScore,\n    };\n  }\n\n  // PHI Detection and De-identification\n  async scanForPHI(\n    data: unknown\n  ): Promise<{ identifiers: PHIIdentifier[]; riskLevel: 'low' | 'medium' | 'high' }> {\n    const identifiers: PHIIdentifier[] = [];\n    const dataStr = JSON.stringify(data);\n\n    // Regular expressions for common PHI patterns\n    const patterns = {\n      ssn: /\\b\\d{3}-?\\d{2}-?\\d{4}\\b/g,\n      phone: /\\b\\d{3}[-.]?\\d{3}[-.]?\\d{4}\\b/g,\n      email: /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g,\n      ipAddress: /\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b/g,\n      creditCard: /\\b\\d{4}[-\\s]?\\d{4}[-\\s]?\\d{4}[-\\s]?\\d{4}\\b/g,\n      zipCode: /\\b\\d{5}(?:-\\d{4})?\\b/g,\n    };\n\n    // Scan for patterns\n    for (const [type, pattern] of Object.entries(patterns)) {\n      const matches = dataStr.match(pattern);\n      if (matches) {\n        matches.forEach(match => {\n          identifiers.push({\n            type: type as PHIIdentifier['type'],\n            value: match,\n            location: 'data',\n            confidence: 0.8,\n          });\n        });\n      }\n    }\n\n    // Determine risk level\n    let riskLevel: 'low' | 'medium' | 'high' = 'low';\n    if (identifiers.length > 10) {\n      riskLevel = 'high';\n    } else if (identifiers.length > 3) {\n      riskLevel = 'medium';\n    }\n\n    return { identifiers, riskLevel };\n  }\n\n  async deidentifyData(\n    data: unknown,\n    method: 'safe-harbor' | 'expert-determination' | 'limited-dataset' = 'safe-harbor'\n  ): Promise<DeidentificationResult> {\n    const originalData = JSON.parse(JSON.stringify(data));\n    const deidentifiedData = JSON.parse(JSON.stringify(data));\n    const identifiersRemoved: PHIIdentifier[] = [];\n\n    // Apply de-identification based on method\n    if (method === 'safe-harbor') {\n      const scanResult = await this.scanForPHI(deidentifiedData);\n      identifiersRemoved.push(...scanResult.identifiers);\n\n      // Remove or mask identified PHI\n      let dataStr = JSON.stringify(deidentifiedData);\n      // Only use literal values for RegExp construction; never use user input directly\n      scanResult.identifiers.forEach(identifier => {\n        // Defensive: identifier.value is always from a known pattern match, not user input\n        // If identifier.value ever comes from user input, this must be reviewed\n        dataStr = dataStr.replace(\n          new RegExp(this.escapeRegExp(identifier.value), 'g'),\n          '[REDACTED]'\n        );\n      });\n\n      try {\n        Object.assign(deidentifiedData, JSON.parse(dataStr));\n      } catch {\n        // Handle JSON parsing errors\n      }\n    }\n\n    return {\n      originalData,\n      deidentifiedData,\n      identifiersRemoved,\n      method,\n      timestamp: new Date().toISOString(),\n      processedBy: 'hipaa-compliance-service',\n    };\n  }\n\n  // Access Control and Authorization\n  async requestDataAccess(\n    request: Omit<AccessRequest, 'requestId' | 'requestDate' | 'approvalStatus'>\n  ): Promise<string> {\n    const requestId = `ar-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n    const accessRequest: AccessRequest = {\n      ...request,\n      requestId,\n      requestDate: new Date().toISOString(),\n      approvalStatus: 'pending',\n    };\n\n    // Auto-approve emergency requests with appropriate logging\n    if (request.urgency === 'emergency') {\n      accessRequest.approvalStatus = 'approved';\n      accessRequest.approvedBy = 'emergency-protocol';\n      accessRequest.approvalDate = new Date().toISOString();\n      accessRequest.expirationDate = new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(); // 24 hours\n\n      await this.logAuditEvent({\n        actionType: 'access',\n        userId: request.requesterId,\n        userRole: request.requesterRole,\n        resourceType: 'patient-data',\n        patientId: request.patientId,\n        outcome: 'success',\n        details: { emergency: true, autoApproved: true },\n      });\n    }\n\n    this.accessRequests.set(requestId, accessRequest);\n    return requestId;\n  }\n\n  async approveAccessRequest(\n    requestId: string,\n    approverInfo: { userId: string; conditions?: string[] }\n  ): Promise<void> {\n    const request = this.accessRequests.get(requestId);\n    if (!request) {\n      throw new Error('Access request not found');\n    }\n\n    request.approvalStatus = 'approved';\n    request.approvedBy = approverInfo.userId;\n    request.approvalDate = new Date().toISOString();\n    request.conditions = approverInfo.conditions;\n    request.expirationDate = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(); // 30 days\n\n    this.accessRequests.set(requestId, request);\n\n    await this.logAuditEvent({\n      actionType: 'access',\n      userId: approverInfo.userId,\n      userRole: 'supervisor',\n      resourceType: 'access-request',\n      resourceId: requestId,\n      outcome: 'success',\n      details: { action: 'approved', conditions: approverInfo.conditions },\n    });\n  }\n\n  // Audit Logging\n  async logAuditEvent(\n    event: Omit<AuditTrail, 'eventId' | 'timestamp' | 'ipAddress' | 'userAgent' | 'riskScore'>\n  ): Promise<void> {\n    const auditEvent: AuditTrail = {\n      ...event,\n      eventId: `ae-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n      timestamp: new Date().toISOString(),\n      ipAddress: '0.0.0.0', // Would be populated from request context\n      userAgent: 'system', // Would be populated from request context\n      riskScore: this.calculateRiskScore(event),\n    };\n\n    this.auditTrails.push(auditEvent);\n\n    // Evict old entries to prevent unbounded memory growth\n    if (this.auditTrails.length > HIPAAComplianceService.MAX_AUDIT_TRAILS) {\n      this.auditTrails = this.auditTrails.slice(-(\n        HIPAAComplianceService.MAX_AUDIT_TRAILS - HIPAAComplianceService.AUDIT_EVICTION_COUNT\n      ));\n    }\n\n    // Check for suspicious activity\n    if (auditEvent.riskScore > 80) {\n      await this.flagSuspiciousActivity(auditEvent);\n    }\n  }\n\n  async getAuditTrail(filters: {\n    userId?: string;\n    patientId?: string;\n    startDate?: string;\n    endDate?: string;\n    actionType?: string;\n  }): Promise<AuditTrail[]> {\n    return this.auditTrails.filter(event => {\n      if (filters.userId && event.userId !== filters.userId) return false;\n      if (filters.patientId && event.patientId !== filters.patientId) return false;\n      if (filters.actionType && event.actionType !== filters.actionType) return false;\n\n      if (filters.startDate) {\n        const eventDate = new Date(event.timestamp);\n        const startDate = new Date(filters.startDate);\n        if (eventDate < startDate) return false;\n      }\n\n      if (filters.endDate) {\n        const eventDate = new Date(event.timestamp);\n        const endDate = new Date(filters.endDate);\n        if (eventDate > endDate) return false;\n      }\n\n      return true;\n    });\n  }\n\n  // Breach Management\n  async reportBreach(\n    breach: Omit<BreachAssessment, 'incidentId' | 'reportedDate' | 'investigationStatus'>\n  ): Promise<string> {\n    const incidentId = `br-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n\n    const breachAssessment: BreachAssessment = {\n      ...breach,\n      incidentId,\n      reportedDate: new Date().toISOString(),\n      investigationStatus: 'open',\n    };\n\n    this.breachAssessments.set(incidentId, breachAssessment);\n\n    // Determine notification requirements\n    if (breach.phiInvolved.patientCount >= 500) {\n      breachAssessment.notificationRequired = true;\n      breachAssessment.authoritiesNotified = true;\n      // Would trigger actual notifications in real implementation\n    }\n\n    await this.logAuditEvent({\n      actionType: 'create',\n      userId: 'system',\n      userRole: 'security-officer',\n      resourceType: 'breach-report',\n      resourceId: incidentId,\n      outcome: 'success',\n      details: { patientCount: breach.phiInvolved.patientCount, riskLevel: breach.riskLevel },\n    });\n\n    return incidentId;\n  }\n\n  async getBreachAssessment(incidentId: string): Promise<BreachAssessment | null> {\n    return this.breachAssessments.get(incidentId) || null;\n  }\n\n  // Compliance Reporting\n  async generateComplianceReport(period: { start: string; end: string }): Promise<{\n    period: { start: string; end: string };\n    summary: {\n      totalAuditEvents: number;\n      breachReports: number;\n      accessRequests: number;\n      dataValidations: number;\n      complianceScore: number;\n    };\n    riskAnalysis: {\n      highRiskEvents: number;\n      suspiciousActivity: number;\n      recommendations: string[];\n    };\n    generatedAt: string;\n  }> {\n    const startDate = new Date(period.start);\n    const endDate = new Date(period.end);\n\n    const periodEvents = this.auditTrails.filter(event => {\n      const eventDate = new Date(event.timestamp);\n      return eventDate >= startDate && eventDate <= endDate;\n    });\n\n    const highRiskEvents = periodEvents.filter(event => event.riskScore > 70).length;\n    const suspiciousActivity = periodEvents.filter(event => event.riskScore > 80).length;\n\n    const recommendations = this.generateComplianceRecommendations(periodEvents);\n    const complianceScore = this.calculateOverallComplianceScore(periodEvents);\n\n    return {\n      period,\n      summary: {\n        totalAuditEvents: periodEvents.length,\n        breachReports: Array.from(this.breachAssessments.values()).filter(b => {\n          const reportDate = new Date(b.reportedDate);\n          return reportDate >= startDate && reportDate <= endDate;\n        }).length,\n        accessRequests: Array.from(this.accessRequests.values()).filter(r => {\n          const requestDate = new Date(r.requestDate);\n          return requestDate >= startDate && requestDate <= endDate;\n        }).length,\n        dataValidations: periodEvents.filter(e => e.actionType === 'read').length,\n        complianceScore,\n      },\n      riskAnalysis: {\n        highRiskEvents,\n        suspiciousActivity,\n        recommendations,\n      },\n      generatedAt: new Date().toISOString(),\n    };\n  }\n\n  // Utility Methods\n  private isValidId(id: string): boolean {\n    return /^[A-Za-z0-9\\-.]{1,64}$/.test(id);\n  }\n\n  private isValidTimestamp(timestamp: string): boolean {\n    const date = new Date(timestamp);\n    return !isNaN(date.getTime());\n  }\n\n  private calculateComplianceScore(errors: string[], warnings: string[]): number {\n    const errorPenalty = errors.length * 20;\n    const warningPenalty = warnings.length * 5;\n    return Math.max(0, 100 - errorPenalty - warningPenalty);\n  }\n\n  private calculateRiskScore(\n    event: Omit<AuditTrail, 'eventId' | 'timestamp' | 'ipAddress' | 'userAgent' | 'riskScore'>\n  ): number {\n    let score = 0;\n\n    // Base risk by action type\n    const riskByAction = {\n      delete: 40,\n      export: 30,\n      print: 25,\n      update: 20,\n      read: 10,\n      create: 15,\n      access: 20,\n      login: 5,\n      logout: 0,\n    };\n\n    score += riskByAction[event.actionType] || 10;\n\n    // Increase risk for failed actions\n    if (event.outcome === 'failure') {\n      score += 30;\n    }\n\n    // Higher risk for patient data access\n    if (event.patientId) {\n      score += 10;\n    }\n\n    return Math.min(100, score);\n  }\n\n  private async flagSuspiciousActivity(event: AuditTrail): Promise<void> {\n    // Flag suspicious activity for review\n    console.warn('Suspicious activity detected:', {\n      eventId: event.eventId,\n      userId: event.userId,\n      riskScore: event.riskScore,\n      actionType: event.actionType,\n    });\n\n    // In a real implementation, this would trigger alerts to security officers\n  }\n\n  private generateComplianceRecommendations(events: AuditTrail[]): string[] {\n    const recommendations: string[] = [];\n\n    const failureRate = events.filter(e => e.outcome === 'failure').length / events.length;\n    if (failureRate > 0.1) {\n      recommendations.push('High failure rate detected - review access controls');\n    }\n\n    const highRiskEvents = events.filter(e => e.riskScore > 70).length;\n    if (highRiskEvents > 10) {\n      recommendations.push('Multiple high-risk events - enhance monitoring');\n    }\n\n    const uniqueUsers = new Set(events.map(e => e.userId)).size;\n    const avgEventsPerUser = events.length / uniqueUsers;\n    if (avgEventsPerUser > 100) {\n      recommendations.push('High activity per user - consider additional training');\n    }\n\n    return recommendations;\n  }\n\n  private calculateOverallComplianceScore(events: AuditTrail[]): number {\n    if (events.length === 0) return 100;\n\n    const avgRiskScore = events.reduce((sum, e) => sum + e.riskScore, 0) / events.length;\n    return Math.max(0, 100 - avgRiskScore);\n  }\n\n  private escapeRegExp(string: string): string {\n    return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n  }\n}\n\n// Export singleton instance\nexport const hipaaComplianceService = new HIPAAComplianceService({\n  organizationId: 'pain-tracker-org',\n  privacyOfficer: {\n    name: 'Privacy Officer',\n    title: 'Chief Privacy Officer',\n    email: 'privacy@paintracker.app',\n    phone: '+1-555-0100',\n  },\n  securityOfficer: {\n    name: 'Security Officer',\n    title: 'Chief Security Officer',\n    email: 'security@paintracker.app',\n    phone: '+1-555-0101',\n  },\n  complianceOfficer: {\n    name: 'Compliance Officer',\n    title: 'Chief Compliance Officer',\n    email: 'compliance@paintracker.app',\n    phone: '+1-555-0102',\n  },\n  businessAssociates: [],\n  policies: [],\n  technicalSafeguards: {\n    accessControl: {\n      uniqueUserIdentification: true,\n      automaticLogoff: true,\n      encryptionDecryption: true,\n    },\n    auditControls: {\n      hardwareSystemsAccess: true,\n      softwareSystemsAccess: true,\n      activityReviews: true,\n    },\n    integrity: {\n      protectionFromAlteration: true,\n      protectionFromDestruction: true,\n    },\n    personOrEntityAuthentication: {\n      verifyUserIdentity: true,\n    },\n    transmissionSecurity: {\n      guardAgainstUnauthorizedAccess: true,\n      dataIntegrityControls: true,\n      encryptionStandards: ['TLS-1.3', 'AES-256'],\n    },\n  },\n  physicalSafeguards: {\n    facilityAccessControls: {\n      limitPhysicalAccess: true,\n      workstationAccess: true,\n      mediaControls: true,\n    },\n    workstationUse: {\n      limitedAccess: true,\n      physicalAttributes: ['locked-room', 'secure-access'],\n    },\n    deviceMediaControls: {\n      disposalProcedures: true,\n      reuseProtocols: true,\n      accountabilityMeasures: true,\n      dataBackupStorage: true,\n    },\n  },\n  administrativeSafeguards: {\n    securityManagement: {\n      securityOfficerAssigned: true,\n      managementResponsibilities: ['policy-enforcement', 'incident-response'],\n    },\n    workforceTraining: {\n      privacyTraining: true,\n      securityTraining: true,\n      trainingFrequency: 'annually',\n      lastCompleted: '2025-01-01',\n    },\n    accessManagement: {\n      accessAuthorizationProcedures: true,\n      accessEstablishmentModification: true,\n      accessTerminationProcedures: true,\n    },\n    contingencyPlan: {\n      dataBackupPlan: true,\n      disasterRecoveryPlan: true,\n      emergencyModeOperationPlan: true,\n      dataRecoveryPlan: true,\n    },\n    businessAssociateContracts: {\n      writtenContracts: true,\n      safeguardRequirements: true,\n    },\n  },\n});\n","import { create } from 'zustand';\r\nimport { formatNumber } from '../utils/formatting';\r\nimport { devtools, persist, subscribeWithSelector } from 'zustand/middleware';\r\nimport { immer } from 'zustand/middleware/immer';\r\nimport type { PainEntry, EmergencyPanelData, ActivityLogEntry, ReportTemplate } from '../types';\r\nimport type { MoodEntry } from '../types/quantified-empathy';\r\nimport { makeMoodEntry } from '../utils/mood-entry-factory';\r\nimport type { FibromyalgiaEntry } from '../types/fibromyalgia';\r\nimport { privacyAnalytics } from '../services/PrivacyAnalyticsService';\r\nimport { hipaaComplianceService } from '../services/HIPAACompliance';\r\nimport { migratePainTrackerState } from './pain-tracker-migrations';\r\nimport { trackMoodEntryLogged } from '../analytics/ga4-events';\r\n\r\n// Error counters for silent failures (prevents data loss blindspots)\r\nlet analyticsErrorCount = 0;\r\nlet auditErrorCount = 0;\r\n\r\n/** Get current error counts for monitoring/debugging */\r\nexport function getStoreErrorCounts() {\r\n  return { analyticsErrorCount, auditErrorCount };\r\n}\r\n\r\n/** Reset error counters (for testing) */\r\nexport function resetStoreErrorCounts() {\r\n  analyticsErrorCount = 0;\r\n  auditErrorCount = 0;\r\n}\r\n\r\nexport interface UIState {\r\n  showWCBReport: boolean;\r\n  showOnboarding: boolean;\r\n  showWalkthrough: boolean;\r\n  showEmpathyDashboard: boolean;\r\n  currentFormSection: number;\r\n  reportPeriod: {\r\n    start: string;\r\n    end: string;\r\n  };\r\n}\r\n\r\nexport interface PainTrackerState {\r\n  // Data\r\n  entries: PainEntry[];\r\n  moodEntries: MoodEntry[];\r\n  fibromyalgiaEntries: FibromyalgiaEntry[];\r\n  emergencyData: EmergencyPanelData | null;\r\n  activityLogs: ActivityLogEntry[];\r\n\r\n  // UI State\r\n  ui: UIState;\r\n  // Preferences\r\n  crisisDetectionEnabled: boolean;\r\n\r\n  // Loading/Error states\r\n  isLoading: boolean;\r\n  error: string | null;\r\n\r\n  // Actions\r\n  addEntry: (entry: Omit<PainEntry, 'id' | 'timestamp'>) => void;\r\n  updateEntry: (id: string | number, updates: Partial<PainEntry>) => void;\r\n  deleteEntry: (id: string | number) => void;\r\n\r\n  // Mood Entry Actions\r\n  addMoodEntry: (entry: Omit<MoodEntry, 'id' | 'timestamp'>) => void;\r\n  updateMoodEntry: (idOrTimestamp: number | string, updates: Partial<MoodEntry>) => void;\r\n  deleteMoodEntry: (idOrTimestamp: number | string) => void;\r\n\r\n  // Fibromyalgia Entry Actions\r\n  addFibromyalgiaEntry: (entry: FibromyalgiaEntry) => void;\r\n  updateFibromyalgiaEntry: (id: number, updates: Partial<FibromyalgiaEntry>) => void;\r\n  deleteFibromyalgiaEntry: (id: number) => void;\r\n\r\n  // UI Actions\r\n  setShowWCBReport: (show: boolean) => void;\r\n  setShowOnboarding: (show: boolean) => void;\r\n  setShowWalkthrough: (show: boolean) => void;\r\n  setShowEmpathyDashboard: (show: boolean) => void;\r\n  setCurrentFormSection: (section: number) => void;\r\n  setReportPeriod: (period: Partial<UIState['reportPeriod']>) => void;\r\n\r\n  setCrisisDetectionEnabled: (enabled: boolean) => void;\r\n\r\n  // Emergency Actions\r\n  updateEmergencyData: (data: EmergencyPanelData) => void;\r\n\r\n  // Activity Log Actions\r\n  addActivityLog: (log: Omit<ActivityLogEntry, 'id'>) => void;\r\n  updateActivityLog: (id: string | number, updates: Partial<ActivityLogEntry>) => void;\r\n\r\n  // Utility Actions\r\n  setError: (error: string | null) => void;\r\n  setLoading: (loading: boolean) => void;\r\n  clearAllData: () => void;\r\n  loadSampleData: () => void;\r\n  loadChronicPainTestData: () => void;\r\n  // Reporting\r\n  scheduledReports: import('../types').ScheduledReport[];\r\n  addScheduledReport: (report: import('../types').ScheduledReport) => void;\r\n  deleteScheduledReport: (id: string) => void;\r\n  updateScheduledReport: (id: string, updates: Partial<import('../types').ScheduledReport>) => void;\r\n  runScheduledReport: (id: string) => Promise<void>;\r\n}\r\n\r\nexport const usePainTrackerStore = create<PainTrackerState>()(\r\n  devtools(\r\n    persist(\r\n      subscribeWithSelector(\r\n        immer(set => ({\r\n          entries: [],\r\n          moodEntries: [],\r\n          fibromyalgiaEntries: [],\r\n          emergencyData: null,\r\n          activityLogs: [],\r\n          ui: {\r\n            showWCBReport: false,\r\n            showOnboarding: false,\r\n            showWalkthrough: false,\r\n            showEmpathyDashboard: false,\r\n            currentFormSection: 0,\r\n            reportPeriod: {\r\n              start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n              end: new Date().toISOString().split('T')[0],\r\n            },\r\n          },\r\n          isLoading: false,\r\n          error: null,\r\n          crisisDetectionEnabled: true,\r\n          scheduledReports: [],\r\n\r\n          // Entry Management\r\n          addEntry: entryData => {\r\n            set(state => {\r\n              // Generate collision-resistant ID: timestamp + random suffix\r\n              const uniqueId = Date.now() * 1000 + Math.floor(Math.random() * 1000);\r\n              const newEntry: PainEntry = {\r\n                id: uniqueId,\r\n                timestamp: new Date().toISOString(),\r\n                baselineData: {\r\n                  pain: entryData.baselineData?.pain || 0,\r\n                  locations: entryData.baselineData?.locations || [],\r\n                  symptoms: entryData.baselineData?.symptoms || [],\r\n                },\r\n                functionalImpact: {\r\n                  limitedActivities: entryData.functionalImpact?.limitedActivities || [],\r\n                  assistanceNeeded: entryData.functionalImpact?.assistanceNeeded || [],\r\n                  mobilityAids: entryData.functionalImpact?.mobilityAids || [],\r\n                },\r\n                medications: {\r\n                  current: entryData.medications?.current || [],\r\n                  changes: entryData.medications?.changes || '',\r\n                  effectiveness: entryData.medications?.effectiveness || '',\r\n                },\r\n                treatments: {\r\n                  recent: entryData.treatments?.recent || [],\r\n                  effectiveness: entryData.treatments?.effectiveness || '',\r\n                  planned: entryData.treatments?.planned || [],\r\n                },\r\n                qualityOfLife: {\r\n                  sleepQuality: entryData.qualityOfLife?.sleepQuality || 0,\r\n                  moodImpact: entryData.qualityOfLife?.moodImpact || 0,\r\n                  socialImpact: entryData.qualityOfLife?.socialImpact || [],\r\n                },\r\n                workImpact: {\r\n                  missedWork: entryData.workImpact?.missedWork || 0,\r\n                  modifiedDuties: entryData.workImpact?.modifiedDuties || [],\r\n                  workLimitations: entryData.workImpact?.workLimitations || [],\r\n                },\r\n                comparison: {\r\n                  worseningSince: entryData.comparison?.worseningSince || '',\r\n                  newLimitations: entryData.comparison?.newLimitations || [],\r\n                },\r\n                notes: entryData.notes || '',\r\n                // Optional analytics-rich fields  preserve when provided so downstream\r\n                // dashboards and correlation panels (e.g., weather) stay populated\r\n                triggers: entryData.triggers ?? [],\r\n                intensity: entryData.intensity ?? entryData.baselineData?.pain ?? 0,\r\n                location: entryData.location ?? entryData.baselineData?.locations?.[0], // treat first logged location as primary when explicit value is missing\r\n                quality: entryData.quality ?? [],\r\n                reliefMethods: entryData.reliefMethods ?? [],\r\n                activityLevel: entryData.activityLevel ?? undefined,\r\n                weather: entryData.weather,\r\n                sleep: entryData.sleep ?? entryData.qualityOfLife?.sleepQuality, // keep flat alias in sync with QoL field\r\n                mood: entryData.mood ?? entryData.qualityOfLife?.moodImpact, // map mood impact into flattened field for analytics\r\n                stress: entryData.stress ?? undefined,\r\n                activities: entryData.activities ?? [],\r\n                medicationAdherence: entryData.medicationAdherence,\r\n              };\r\n\r\n              state.entries.push(newEntry);\r\n              state.error = null;\r\n\r\n              // Track analytics (async, fire-and-forget)\r\n              // GA4 events are sent automatically from PrivacyAnalyticsService\r\n              privacyAnalytics.trackPainEntry(newEntry).catch(() => {\r\n                // Track failure but don't affect user experience\r\n                analyticsErrorCount++;\r\n              });\r\n            });\r\n          },\r\n\r\n          updateEntry: (id, updates) => {\r\n            set(state => {\r\n              const index = state.entries.findIndex(entry => entry.id === id);\r\n              if (index >= 0) {\r\n                state.entries[index] = { ...state.entries[index], ...updates };\r\n              }\r\n            });\r\n          },\r\n\r\n          deleteEntry: id => {\r\n            set(state => {\r\n              state.entries = state.entries.filter(entry => entry.id !== id);\r\n            });\r\n          },\r\n\r\n          // Mood Entry Management\r\n          addMoodEntry: entryData => {\r\n            set(state => {\r\n              const newMoodEntry: MoodEntry = makeMoodEntry(entryData as Partial<MoodEntry>);\r\n\r\n              state.moodEntries.push(newMoodEntry);\r\n              state.error = null;\r\n\r\n              // Track GA4 custom event for mood entry\r\n              trackMoodEntryLogged(newMoodEntry.mood);\r\n            });\r\n          },\r\n\r\n          updateMoodEntry: (idOrTimestamp, updates) => {\r\n            set(state => {\r\n              const index = state.moodEntries.findIndex(entry => {\r\n                if (typeof idOrTimestamp === 'number') return entry.id === idOrTimestamp;\r\n                // Normalize timestamp strings\r\n                const incoming = idOrTimestamp;\r\n                return entry.timestamp === incoming || new Date(entry.timestamp).toISOString() === new Date(incoming).toISOString();\r\n              });\r\n              if (index >= 0) {\r\n                state.moodEntries[index] = { ...state.moodEntries[index], ...updates };\r\n              }\r\n            });\r\n          },\r\n\r\n          deleteMoodEntry: idOrTimestamp => {\r\n            set(state => {\r\n              state.moodEntries = state.moodEntries.filter(entry => {\r\n                if (typeof idOrTimestamp === 'number') return entry.id !== idOrTimestamp;\r\n                const incoming = idOrTimestamp;\r\n                return !(entry.timestamp === incoming || new Date(entry.timestamp).toISOString() === new Date(incoming).toISOString());\r\n              });\r\n            });\r\n          },\r\n\r\n          // Fibromyalgia Entry Actions\r\n          addFibromyalgiaEntry: entry => {\r\n            set(state => {\r\n              state.fibromyalgiaEntries.push(entry);\r\n            });\r\n          },\r\n\r\n          updateFibromyalgiaEntry: (id, updates) => {\r\n            set(state => {\r\n              const index = state.fibromyalgiaEntries.findIndex(entry => entry.id === id);\r\n              if (index !== -1) {\r\n                state.fibromyalgiaEntries[index] = {\r\n                  ...state.fibromyalgiaEntries[index],\r\n                  ...updates,\r\n                };\r\n              }\r\n            });\r\n          },\r\n\r\n          deleteFibromyalgiaEntry: id => {\r\n            set(state => {\r\n              state.fibromyalgiaEntries = state.fibromyalgiaEntries.filter(\r\n                entry => entry.id !== id\r\n              );\r\n            });\r\n          },\r\n\r\n          // UI Actions\r\n          setShowWCBReport: show => {\r\n            set(state => {\r\n              state.ui.showWCBReport = show;\r\n            });\r\n          },\r\n\r\n          setShowOnboarding: show => {\r\n            set(state => {\r\n              state.ui.showOnboarding = show;\r\n            });\r\n          },\r\n\r\n          setShowWalkthrough: show => {\r\n            set(state => {\r\n              state.ui.showWalkthrough = show;\r\n            });\r\n          },\r\n\r\n          setShowEmpathyDashboard: show => {\r\n            set(state => {\r\n              state.ui.showEmpathyDashboard = show;\r\n            });\r\n          },\r\n\r\n          setCurrentFormSection: section => {\r\n            set(state => {\r\n              state.ui.currentFormSection = section;\r\n            });\r\n          },\r\n\r\n          setReportPeriod: period => {\r\n            set(state => {\r\n              state.ui.reportPeriod = { ...state.ui.reportPeriod, ...period };\r\n            });\r\n          },\r\n\r\n          setCrisisDetectionEnabled: enabled => {\r\n            set(state => {\r\n              // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n              (state as any).crisisDetectionEnabled = enabled;\r\n            });\r\n          },\r\n\r\n          // Emergency Data\r\n          updateEmergencyData: data => {\r\n            set(state => {\r\n              state.emergencyData = data;\r\n            });\r\n          },\r\n\r\n          // Activity Logs\r\n          addActivityLog: logData => {\r\n            set(state => {\r\n              const newLog: ActivityLogEntry = {\r\n                id: Date.now(),\r\n                ...logData,\r\n              };\r\n              state.activityLogs.push(newLog);\r\n            });\r\n          },\r\n\r\n          updateActivityLog: (id, updates) => {\r\n            set(state => {\r\n              const index = state.activityLogs.findIndex(log => log.id === id);\r\n              if (index >= 0) {\r\n                state.activityLogs[index] = { ...state.activityLogs[index], ...updates };\r\n              }\r\n            });\r\n          },\r\n\r\n          // Utility Actions\r\n          setError: error => {\r\n            set(state => {\r\n              state.error = error;\r\n            });\r\n          },\r\n\r\n          setLoading: loading => {\r\n            set(state => {\r\n              state.isLoading = loading;\r\n            });\r\n          },\r\n\r\n          clearAllData: () => {\r\n            set(state => {\r\n              state.entries = [];\r\n              state.moodEntries = [];\r\n              state.fibromyalgiaEntries = [];\r\n              state.activityLogs = [];\r\n              state.emergencyData = null;\r\n              state.scheduledReports = [];\r\n              state.error = null;\r\n            });\r\n          },\r\n\r\n          loadSampleData: () => {\r\n            const state = usePainTrackerStore.getState();\r\n            // Prevent concurrent loads\r\n            if (state.isLoading) return;\r\n            \r\n            set(s => { s.isLoading = true; });\r\n            \r\n            import('../data/sampleData')\r\n              .then(({ samplePainEntries }) => {\r\n                set(s => {\r\n                  s.entries = samplePainEntries;\r\n                  s.isLoading = false;\r\n                });\r\n              })\r\n              .catch((error) => {\r\n                console.error('[Store] Failed to load sample data:', error);\r\n                set(s => {\r\n                  s.error = 'Failed to load sample data';\r\n                  s.isLoading = false;\r\n                });\r\n              });\r\n          },\r\n\r\n          loadChronicPainTestData: () => {\r\n            const state = usePainTrackerStore.getState();\r\n            // Prevent concurrent loads\r\n            if (state.isLoading) return;\r\n            \r\n            set(s => { s.isLoading = true; });\r\n            \r\n            import('../data/chronic-pain-12-month-seed')\r\n              .then(({ chronicPain12MonthPainEntries, chronicPain12MonthMoodEntries, chronicPainDataStats }) => {\r\n                console.log('[Store] Loading 12-month chronic pain test data:', chronicPainDataStats);\r\n                set(s => {\r\n                  s.entries = chronicPain12MonthPainEntries;\r\n                  s.moodEntries = chronicPain12MonthMoodEntries;\r\n                  s.isLoading = false;\r\n                });\r\n              })\r\n              .catch((error) => {\r\n                console.error('[Store] Failed to load chronic pain test data:', error);\r\n                set(s => {\r\n                  s.error = 'Failed to load test data';\r\n                  s.isLoading = false;\r\n                });\r\n              });\r\n          },\r\n\r\n          // Reporting\r\n          addScheduledReport: schedule => {\r\n            set(state => {\r\n              state.scheduledReports.push(schedule);\r\n            });\r\n            // Log audit event for creation\r\n            void hipaaComplianceService.logAuditEvent({\r\n              actionType: 'create',\r\n              userId: 'local-user',\r\n              userRole: 'patient',\r\n              resourceType: 'ScheduledReport',\r\n              resourceId: schedule.id,\r\n              outcome: 'success',\r\n              details: { name: schedule.name, frequency: schedule.frequency, recipients: schedule.recipients },\r\n            }).catch(() => {\r\n              // Track audit failure but don't block user flow\r\n              auditErrorCount++;\r\n            });\r\n          },\r\n\r\n          deleteScheduledReport: id => {\r\n            set(state => {\r\n              state.scheduledReports = state.scheduledReports.filter(s => s.id !== id);\r\n            });\r\n            void hipaaComplianceService.logAuditEvent({\r\n              actionType: 'delete',\r\n              userId: 'local-user',\r\n              userRole: 'patient',\r\n              resourceType: 'ScheduledReport',\r\n              resourceId: id,\r\n              outcome: 'success',\r\n              details: { action: 'delete' },\r\n            }).catch(() => {\r\n              auditErrorCount++;\r\n            });\r\n          },\r\n\r\n          updateScheduledReport: (id, updates) => {\r\n            set(state => {\r\n              const idx = state.scheduledReports.findIndex(s => s.id === id);\r\n              if (idx >= 0) {\r\n                state.scheduledReports[idx] = { ...state.scheduledReports[idx], ...updates };\r\n              }\r\n            });\r\n            void hipaaComplianceService.logAuditEvent({\r\n              actionType: 'update',\r\n              userId: 'local-user',\r\n              userRole: 'patient',\r\n              resourceType: 'ScheduledReport',\r\n              resourceId: id,\r\n              outcome: 'success',\r\n              details: { updates },\r\n            }).catch(() => {\r\n              auditErrorCount++;\r\n            });\r\n          },\r\n\r\n          runScheduledReport: async id => {\r\n            const state = usePainTrackerStore.getState();\r\n            const schedule = state.scheduledReports.find(s => s.id === id);\r\n            if (!schedule) return;\r\n\r\n            try {\r\n              // Lazy load PDF generator for better initial load performance\r\n              const { generatePDFReport } = await import('../utils/pdfReportGenerator');\r\n              \r\n              // Create PDF options using template placeholder and store entries for the period\r\n                // For now, create a simple date range of last 30 days\r\n              const end = new Date().toISOString().split('T')[0];\r\n              const start = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\r\n\r\n              await generatePDFReport({\r\n                template: { id: schedule.templateId, name: schedule.name, description: schedule.name, type: 'summary', sections: [], createdAt: new Date().toISOString(), lastModified: new Date().toISOString() } as ReportTemplate,\r\n                entries: state.entries,\r\n                dateRange: { start, end },\r\n                includeCharts: true,\r\n                includeRawData: false,\r\n              });\r\n\r\n              // Update lastRun and audit\r\n              set(s => {\r\n                const idx = s.scheduledReports.findIndex(r => r.id === id);\r\n                if (idx >= 0) s.scheduledReports[idx].lastRun = new Date().toISOString();\r\n              });\r\n\r\n              void hipaaComplianceService.logAuditEvent({\r\n                actionType: 'export',\r\n                userId: 'local-user',\r\n                userRole: 'patient',\r\n                resourceType: 'ScheduledReport',\r\n                resourceId: schedule.id,\r\n                outcome: 'success',\r\n                details: { runNow: true, recipients: schedule.recipients },\r\n              }).catch(() => {\r\n                auditErrorCount++;\r\n              });\r\n            } catch (err) {\r\n              void hipaaComplianceService.logAuditEvent({\r\n                actionType: 'export',\r\n                userId: 'local-user',\r\n                userRole: 'patient',\r\n                resourceType: 'ScheduledReport',\r\n                resourceId: id,\r\n                outcome: 'failure',\r\n                details: { error: (err as Error).message || 'unknown' },\r\n              }).catch(() => {\r\n                auditErrorCount++;\r\n              });\r\n            }\r\n          },\r\n        }))\r\n      ),\r\n      {\r\n        name: 'pain-tracker-storage',\r\n        version: 2,\r\n        migrate: (persistedState: unknown, fromVersion: number) => {\r\n          const state = persistedState as Partial<PainTrackerState> | undefined;\r\n          return migratePainTrackerState(state, fromVersion);\r\n        },\r\n        partialize: state => ({\r\n          entries: state.entries,\r\n          moodEntries: state.moodEntries,\r\n          emergencyData: state.emergencyData,\r\n          activityLogs: state.activityLogs,\r\n          scheduledReports: state.scheduledReports,\r\n        }),\r\n      }\r\n    ),\r\n    { name: 'PainTracker Store' }\r\n  )\r\n);\r\n\r\n// Selectors for optimized component subscriptions\r\nexport const selectEntries = (state: PainTrackerState) => state.entries;\r\nexport const selectMoodEntries = (state: PainTrackerState) => state.moodEntries;\r\nexport const selectUIState = (state: PainTrackerState) => state.ui;\r\nexport const selectError = (state: PainTrackerState) => state.error;\r\nexport const selectIsLoading = (state: PainTrackerState) => state.isLoading;\r\n\r\n// Computed selectors\r\nexport const selectEntriesCount = (state: PainTrackerState) => state.entries.length;\r\nexport const selectMoodEntriesCount = (state: PainTrackerState) => state.moodEntries.length;\r\nexport const selectLatestEntry = (state: PainTrackerState) =>\r\n  state.entries.length > 0 ? state.entries[state.entries.length - 1] : null;\r\nexport const selectLatestMoodEntry = (state: PainTrackerState) =>\r\n  state.moodEntries.length > 0 ? state.moodEntries[state.moodEntries.length - 1] : null;\r\nexport const selectAveragePain = (state: PainTrackerState) => {\r\n  if (state.entries.length === 0) return 0;\r\n  const sum = state.entries.reduce((acc, entry) => acc + entry.baselineData.pain, 0);\r\n  return Number(formatNumber(sum / state.entries.length, 1));\r\n};\r\nexport const selectAverageMood = (state: PainTrackerState) => {\r\n  if (state.moodEntries.length === 0) return 0;\r\n  const sum = state.moodEntries.reduce((acc, entry) => acc + entry.mood, 0);\r\n  return Number(formatNumber(sum / state.moodEntries.length, 1));\r\n};\r\n","import type { MoodEntry } from '../types/quantified-empathy';\r\nimport { toIsoString } from './date-utils';\r\n\r\nexport function makeMoodEntry(\r\n  data: Partial<MoodEntry> & { timestamp?: string | Date; id?: number } = {}\r\n): MoodEntry {\r\n  const ts = toIsoString(data.timestamp) ?? data.timestamp;\r\n  // Generate collision-resistant ID: timestamp * 1000 + random suffix (0-999)\r\n  const id = data.id ?? (Date.now() * 1000 + Math.floor(Math.random() * 1000));\r\n  return {\r\n    id,\r\n    timestamp: ts ?? new Date().toISOString(),\r\n    mood: data.mood ?? 5,\r\n    energy: data.energy ?? 5,\r\n    anxiety: data.anxiety ?? 5,\r\n    stress: data.stress ?? 5,\r\n    hopefulness: data.hopefulness ?? 5,\r\n    selfEfficacy: data.selfEfficacy ?? 5,\r\n    emotionalClarity: data.emotionalClarity ?? 5,\r\n    emotionalRegulation: data.emotionalRegulation ?? 5,\r\n    context: data.context ?? '',\r\n    triggers: data.triggers ?? [],\r\n    copingStrategies: data.copingStrategies ?? [],\r\n    socialSupport: data.socialSupport ?? 'none',\r\n    notes: data.notes ?? '',\r\n  };\r\n}\r\n\r\nexport default makeMoodEntry;\r\n","import type { PainTrackerState } from './pain-tracker-store';\r\nimport type { MoodEntry } from '../types/quantified-empathy';\r\nimport type { PainEntry } from '../types';\r\nimport type { ActivityLogEntry, ScheduledReport } from '../types';\r\nimport { toIsoString } from '../utils/date-utils';\r\n\r\nexport function migratePainTrackerState(\r\n  persistedState: Partial<PainTrackerState> | undefined,\r\n  _fromVersion?: number\r\n): Partial<PainTrackerState> | undefined {\r\n  if (!persistedState) return persistedState;\r\n\r\n  const state = { ...persistedState } as Partial<PainTrackerState>;\r\n\r\n  if (Array.isArray(state.moodEntries)) {\r\n    state.moodEntries = state.moodEntries.map((entry): MoodEntry => {\r\n      const e: Partial<MoodEntry> = { ...entry } as Partial<MoodEntry>;\r\n\r\n      // Ensure id exists\r\n      if (e.id === undefined || e.id === null) {\r\n        // Use a high-entropy id to reduce collision risk\r\n        e.id = Date.now() + Math.floor(Math.random() * 10000);\r\n      }\r\n\r\n      // Ensure timestamp is an ISO string\r\n      const ts = toIsoString(e.timestamp);\r\n      e.timestamp = ts ?? new Date().toISOString();\r\n\r\n      return e as MoodEntry;\r\n    });\r\n  }\r\n\r\n  // Normalize pain entries: ensure id and timestamp strings\r\n  if (Array.isArray(state.entries)) {\r\n    state.entries = state.entries.map((entry): PainEntry => {\r\n      const e = { ...entry } as PainEntry;\r\n      if (!e.id) e.id = Date.now() + Math.floor(Math.random() * 10000);\r\n  e.timestamp = toIsoString(e.timestamp) ?? new Date().toISOString();\r\n      // Normalize nested treatment dates to ISO strings if present\r\n      if (e.treatments && Array.isArray(e.treatments.recent)) {\r\n  e.treatments.recent = e.treatments.recent.map(t => ({ ...t, date: toIsoString(t.date) ?? new Date().toISOString() }));\r\n      }\r\n      return e;\r\n    });\r\n  }\r\n\r\n  // Normalize activity logs: ensure id and date and activity timestamps\r\n  if (Array.isArray(state.activityLogs)) {\r\n    state.activityLogs = state.activityLogs.map((log): ActivityLogEntry => {\r\n      const a = { ...log } as ActivityLogEntry;\r\n      if (!a.id) a.id = Date.now() + Math.floor(Math.random() * 10000);\r\n  a.date = toIsoString(a.date) ?? new Date().toISOString();\r\n      if (Array.isArray(a.activities)) {\r\n  a.activities = a.activities.map(act => ({ ...act, timestamp: toIsoString(act.timestamp) ?? new Date().toISOString() }));\r\n      }\r\n      return a;\r\n    });\r\n  }\r\n\r\n  // Normalize scheduled reports: ensure id and nextRun/lastRun strings\r\n  if (Array.isArray(state.scheduledReports)) {\r\n    state.scheduledReports = state.scheduledReports.map((s): ScheduledReport => {\r\n      const sr = { ...s } as ScheduledReport;\r\n      if (!sr.id) sr.id = `sr-${Date.now()}-${Math.floor(Math.random() * 10000)}`;\r\n  sr.nextRun = toIsoString(sr.nextRun) ?? new Date().toISOString();\r\n  sr.lastRun = toIsoString(sr.lastRun) ?? sr.lastRun;\r\n      return sr;\r\n    });\r\n  }\r\n\r\n  // Migrate other timestamp-like fields if needed (emotional triggers, recovery metrics)\r\n  if (Array.isArray(state.scheduledReports)) {\r\n    // no-op for scheduledReports for now\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nexport default migratePainTrackerState;\r\n","/**\r\n * @fileoverview Tone Context Provider\r\n *\r\n * Provides adaptive tone throughout the app based on patient state\r\n * and user preferences.\r\n */\r\n\r\nimport React, { createContext, useState, useCallback, useEffect } from 'react';\r\nimport type {\r\n  PatientState,\r\n  TonePreferences,\r\n  ToneContext as ToneContextType,\r\n  AdaptiveCopy,\r\n  CopyIntent,\r\n  ToneMeasurement,\r\n} from '../types/tone';\r\nimport { DEFAULT_TONE_PREFERENCES } from '../types/tone';\r\nimport { toneEngine } from '../services/ToneEngine';\r\nimport { usePainTrackerStore } from '../stores/pain-tracker-store';\r\n\r\nexport interface ToneProviderValue {\r\n  /** Current tone context */\r\n  context: ToneContextType;\r\n\r\n  /** User's tone preferences */\r\n  preferences: TonePreferences;\r\n\r\n  /** Update tone preferences */\r\n  updatePreferences: (updates: Partial<TonePreferences>) => void;\r\n\r\n  /** Get adaptive copy for current context */\r\n  getCopy: (copy: AdaptiveCopy) => string;\r\n\r\n  /** Track user interaction with copy */\r\n  trackInteraction: (intent: CopyIntent, accepted: boolean) => void;\r\n\r\n  /** Track time to calm in panic mode */\r\n  trackTimeToCalm: (seconds: number) => void;\r\n\r\n  /** Force state change (for testing) */\r\n  forceState: (state: PatientState) => void;\r\n}\r\n\r\nexport const ToneContext = createContext<ToneProviderValue | undefined>(undefined);\r\n\r\ninterface ToneProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\n/**\r\n * Tone Provider Component\r\n *\r\n * Wraps the app and provides adaptive tone based on patient state\r\n */\r\nexport function ToneProvider({ children }: ToneProviderProps) {\r\n  // Get pain entries from store\r\n  const entries = usePainTrackerStore(state => state.entries || []);\r\n\r\n  // Tone preferences (stored in localStorage)\r\n  const [preferences, setPreferences] = useState<TonePreferences>(() => {\r\n    const stored = localStorage.getItem('tone-preferences');\r\n    if (stored) {\r\n      try {\r\n        return JSON.parse(stored);\r\n      } catch {\r\n        return DEFAULT_TONE_PREFERENCES;\r\n      }\r\n    }\r\n    return DEFAULT_TONE_PREFERENCES;\r\n  });\r\n\r\n  // Build tone context\r\n  const [context, setContext] = useState<ToneContextType>(() =>\r\n    toneEngine.buildContext(entries, preferences)\r\n  );\r\n\r\n  // Update context when entries or preferences change\r\n  useEffect(() => {\r\n    const newContext = toneEngine.buildContext(entries, preferences, {\r\n      // Could add sleep quality, time since flare, etc.\r\n    });\r\n    setContext(newContext);\r\n  }, [entries, preferences]);\r\n\r\n  // Update preferences\r\n  const updatePreferences = useCallback((updates: Partial<TonePreferences>) => {\r\n    setPreferences(prev => {\r\n      const next = { ...prev, ...updates };\r\n      localStorage.setItem('tone-preferences', JSON.stringify(next));\r\n      return next;\r\n    });\r\n  }, []);\r\n\r\n  // Get copy for current context\r\n  const getCopy = useCallback(\r\n    (copy: AdaptiveCopy): string => {\r\n      return toneEngine.selectCopy(copy, context);\r\n    },\r\n    [context]\r\n  );\r\n\r\n  // Track user interaction (prompt acceptance)\r\n  const trackInteraction = useCallback(\r\n    (intent: CopyIntent, accepted: boolean) => {\r\n      const measurement: ToneMeasurement = {\r\n        metric: 'prompt_acceptance',\r\n        value: accepted ? 1 : 0,\r\n        context: {\r\n          state: context.state,\r\n          intent,\r\n        },\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n\r\n      toneEngine.trackMeasurement(measurement);\r\n    },\r\n    [context.state]\r\n  );\r\n\r\n  // Track time to calm\r\n  const trackTimeToCalm = useCallback((seconds: number) => {\r\n    const measurement: ToneMeasurement = {\r\n      metric: 'time_to_calm',\r\n      value: seconds,\r\n      context: {\r\n        state: 'flare',\r\n        intent: 'coach',\r\n      },\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n\r\n    toneEngine.trackMeasurement(measurement);\r\n  }, []);\r\n\r\n  // Force state (for testing)\r\n  const forceState = useCallback((state: PatientState) => {\r\n    setContext(prev => ({ ...prev, state }));\r\n  }, []);\r\n\r\n  const value: ToneProviderValue = {\r\n    context,\r\n    preferences,\r\n    updatePreferences,\r\n    getCopy,\r\n    trackInteraction,\r\n    trackTimeToCalm,\r\n    forceState,\r\n  };\r\n\r\n  return <ToneContext.Provider value={value}>{children}</ToneContext.Provider>;\r\n}\r\n","/**\r\n * @fileoverview Tone Context Hooks\r\n *\r\n * Separated from ToneContext.tsx to fix Fast Refresh warnings\r\n */\r\n\r\nimport { useContext, useCallback } from 'react';\r\nimport type { AdaptiveCopy, CopyIntent } from '../types/tone';\r\nimport { ToneContext } from './ToneContext';\r\n\r\n/**\r\n * Hook to access tone context\r\n */\r\nexport function useTone() {\r\n  const context = useContext(ToneContext);\r\n\r\n  if (!context) {\r\n    throw new Error('useTone must be used within ToneProvider');\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\n/**\r\n * Hook to get adaptive copy\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const copy = useAdaptiveCopy({\r\n *   base: \"Log pain (10s)\",\r\n *   states: {\r\n *     flare: \"Log pain\",\r\n *   },\r\n * });\r\n * ```\r\n */\r\nexport function useAdaptiveCopy(copy: AdaptiveCopy): string {\r\n  const { getCopy } = useTone();\r\n  return getCopy(copy);\r\n}\r\n\r\n/**\r\n * Hook to track prompt interactions\r\n *\r\n * Usage:\r\n * ```tsx\r\n * const trackPrompt = usePromptTracking('coach');\r\n *\r\n * // When user accepts prompt\r\n * trackPrompt(true);\r\n *\r\n * // When user dismisses\r\n * trackPrompt(false);\r\n * ```\r\n */\r\nexport function usePromptTracking(intent: CopyIntent) {\r\n  const { trackInteraction } = useTone();\r\n\r\n  return useCallback(\r\n    (accepted: boolean) => {\r\n      trackInteraction(intent, accepted);\r\n    },\r\n    [intent, trackInteraction]\r\n  );\r\n}\r\n","/**\r\n * SaaS Subscription Tiers Configuration\r\n * Defines the specific features, limits, and pricing for each tier\r\n */\r\n\r\nimport type {\r\n  SubscriptionPlan,\r\n  TierFeatures,\r\n  PricingInfo,\r\n  SubscriptionTier,\r\n} from '../types/subscription';\r\n\r\n/**\r\n * Free Tier Features\r\n * Perfect for individuals trying out pain tracking\r\n * Core tracking is unlimited - upgrade for advanced analytics and sharing\r\n */\r\nconst FREE_FEATURES: TierFeatures = {\r\n  // Storage Limits - Unlimited core tracking\r\n  maxPainEntries: -1, // Unlimited\r\n  maxMoodEntries: -1, // Unlimited\r\n  maxActivityLogs: -1, // Unlimited\r\n  maxStorageMB: 100,\r\n  dataRetentionDays: -1, // Unlimited\r\n\r\n  // Analytics & Insights\r\n  basicAnalytics: true,\r\n  advancedAnalytics: false,\r\n  predictiveInsights: false,\r\n  customReports: false,\r\n  empathyIntelligence: false,\r\n\r\n  // Export Capabilities\r\n  csvExport: true,\r\n  jsonExport: true,\r\n  pdfReports: true,\r\n  wcbReports: true,\r\n  clinicalPDFExport: false,\r\n  scheduledReports: false,\r\n  maxExportsPerMonth: 5,\r\n\r\n  // Integration Features\r\n  healthcareProviderAPI: false,\r\n  fhirIntegration: false,\r\n  calendarSync: false,\r\n  wearableDevices: false,\r\n\r\n  // Collaboration\r\n  multiUser: false,\r\n  familySharing: false,\r\n  caregiverAccess: false,\r\n  maxSharedUsers: 0,\r\n\r\n  // Security & Privacy\r\n  encryption: 'basic',\r\n  twoFactorAuth: false,\r\n  auditLogs: false,\r\n  hipaaCompliance: false,\r\n  soc2Compliance: false,\r\n  customDataRetention: false,\r\n\r\n  // Support\r\n  supportLevel: 'community',\r\n  responseTime: '72h',\r\n  onboarding: false,\r\n  customTraining: false,\r\n\r\n  // AI & Automation\r\n  aiInsights: false,\r\n  automatedReminders: true,\r\n  smartSuggestions: false,\r\n  patternRecognition: false,\r\n\r\n  // Customization\r\n  customThemes: false,\r\n  customDashboard: false,\r\n  customFields: false,\r\n  branding: false,\r\n  whiteLabel: false,\r\n\r\n  // Advanced Features\r\n  offlineMode: true,\r\n  mobileApp: true,\r\n  apiAccess: false,\r\n  webhooks: false,\r\n  customIntegrations: false,\r\n};\r\n\r\n/**\r\n * Basic Tier Features\r\n * For individuals committed to chronic pain management\r\n * Includes advanced analytics and exports\r\n */\r\nconst BASIC_FEATURES: TierFeatures = {\r\n  // Storage Limits - Unlimited entries, more storage\r\n  maxPainEntries: -1, // Unlimited\r\n  maxMoodEntries: -1, // Unlimited\r\n  maxActivityLogs: -1, // Unlimited\r\n  maxStorageMB: 500,\r\n  dataRetentionDays: -1, // Unlimited\r\n\r\n  // Analytics & Insights\r\n  basicAnalytics: true,\r\n  advancedAnalytics: true,\r\n  predictiveInsights: false,\r\n  customReports: true,\r\n  empathyIntelligence: true,\r\n\r\n  // Export Capabilities\r\n  csvExport: true,\r\n  jsonExport: true,\r\n  pdfReports: true,\r\n  wcbReports: true,\r\n  clinicalPDFExport: false,\r\n  scheduledReports: false,\r\n  maxExportsPerMonth: 50,\r\n\r\n  // Integration Features\r\n  healthcareProviderAPI: false,\r\n  fhirIntegration: false,\r\n  calendarSync: true,\r\n  wearableDevices: false,\r\n\r\n  // Collaboration\r\n  multiUser: false,\r\n  familySharing: true,\r\n  caregiverAccess: true,\r\n  maxSharedUsers: 2,\r\n\r\n  // Security & Privacy\r\n  encryption: 'advanced',\r\n  twoFactorAuth: true,\r\n  auditLogs: false,\r\n  hipaaCompliance: false,\r\n  soc2Compliance: false,\r\n  customDataRetention: false,\r\n\r\n  // Support\r\n  supportLevel: 'email',\r\n  responseTime: '24h',\r\n  onboarding: true,\r\n  customTraining: false,\r\n\r\n  // AI & Automation\r\n  aiInsights: true,\r\n  automatedReminders: true,\r\n  smartSuggestions: true,\r\n  patternRecognition: true,\r\n\r\n  // Customization\r\n  customThemes: true,\r\n  customDashboard: true,\r\n  customFields: true,\r\n  branding: false,\r\n  whiteLabel: false,\r\n\r\n  // Advanced Features\r\n  offlineMode: true,\r\n  mobileApp: true,\r\n  apiAccess: false,\r\n  webhooks: false,\r\n  customIntegrations: false,\r\n};\r\n\r\n/**\r\n * Pro Tier Features\r\n * For power users, caregivers, and healthcare coordination\r\n */\r\nconst PRO_FEATURES: TierFeatures = {\r\n  // Storage Limits\r\n  maxPainEntries: -1, // Unlimited\r\n  maxMoodEntries: -1,\r\n  maxActivityLogs: -1,\r\n  maxStorageMB: 5000, // 5GB\r\n  dataRetentionDays: -1, // Unlimited\r\n\r\n  // Analytics & Insights\r\n  basicAnalytics: true,\r\n  advancedAnalytics: true,\r\n  predictiveInsights: true,\r\n  customReports: true,\r\n  empathyIntelligence: true,\r\n\r\n  // Export Capabilities\r\n  csvExport: true,\r\n  jsonExport: true,\r\n  pdfReports: true,\r\n  wcbReports: true,\r\n  clinicalPDFExport: true,\r\n  scheduledReports: true,\r\n  maxExportsPerMonth: 200,\r\n\r\n  // Integration Features\r\n  healthcareProviderAPI: true,\r\n  fhirIntegration: true,\r\n  calendarSync: true,\r\n  wearableDevices: true,\r\n\r\n  // Collaboration\r\n  multiUser: true,\r\n  familySharing: true,\r\n  caregiverAccess: true,\r\n  maxSharedUsers: 5,\r\n\r\n  // Security & Privacy\r\n  encryption: 'advanced',\r\n  twoFactorAuth: true,\r\n  auditLogs: true,\r\n  hipaaCompliance: true,\r\n  soc2Compliance: false,\r\n  customDataRetention: true,\r\n\r\n  // Support\r\n  supportLevel: 'priority',\r\n  responseTime: '4h',\r\n  onboarding: true,\r\n  customTraining: false,\r\n\r\n  // AI & Automation\r\n  aiInsights: true,\r\n  automatedReminders: true,\r\n  smartSuggestions: true,\r\n  patternRecognition: true,\r\n\r\n  // Customization\r\n  customThemes: true,\r\n  customDashboard: true,\r\n  customFields: true,\r\n  branding: false,\r\n  whiteLabel: false,\r\n\r\n  // Advanced Features\r\n  offlineMode: true,\r\n  mobileApp: true,\r\n  apiAccess: true,\r\n  webhooks: true,\r\n  customIntegrations: false,\r\n};\r\n\r\n/**\r\n * Enterprise Tier Features\r\n * For healthcare organizations, clinics, and large-scale deployments\r\n */\r\nconst ENTERPRISE_FEATURES: TierFeatures = {\r\n  // Storage Limits\r\n  maxPainEntries: -1,\r\n  maxMoodEntries: -1,\r\n  maxActivityLogs: -1,\r\n  maxStorageMB: -1, // Unlimited\r\n  dataRetentionDays: -1,\r\n\r\n  // Analytics & Insights\r\n  basicAnalytics: true,\r\n  advancedAnalytics: true,\r\n  predictiveInsights: true,\r\n  customReports: true,\r\n  empathyIntelligence: true,\r\n\r\n  // Export Capabilities\r\n  csvExport: true,\r\n  jsonExport: true,\r\n  pdfReports: true,\r\n  wcbReports: true,\r\n  clinicalPDFExport: true,\r\n  scheduledReports: true,\r\n  maxExportsPerMonth: -1,\r\n\r\n  // Integration Features\r\n  healthcareProviderAPI: true,\r\n  fhirIntegration: true,\r\n  calendarSync: true,\r\n  wearableDevices: true,\r\n\r\n  // Collaboration\r\n  multiUser: true,\r\n  familySharing: true,\r\n  caregiverAccess: true,\r\n  maxSharedUsers: -1, // Unlimited\r\n\r\n  // Security & Privacy\r\n  encryption: 'enterprise',\r\n  twoFactorAuth: true,\r\n  auditLogs: true,\r\n  hipaaCompliance: true,\r\n  soc2Compliance: false,\r\n  customDataRetention: true,\r\n\r\n  // Support\r\n  supportLevel: 'dedicated',\r\n  responseTime: '1h',\r\n  onboarding: true,\r\n  customTraining: true,\r\n\r\n  // AI & Automation\r\n  aiInsights: true,\r\n  automatedReminders: true,\r\n  smartSuggestions: true,\r\n  patternRecognition: true,\r\n\r\n  // Customization\r\n  customThemes: true,\r\n  customDashboard: true,\r\n  customFields: true,\r\n  branding: true,\r\n  whiteLabel: true,\r\n\r\n  // Advanced Features\r\n  offlineMode: true,\r\n  mobileApp: true,\r\n  apiAccess: true,\r\n  webhooks: true,\r\n  customIntegrations: true,\r\n};\r\n\r\n/**\r\n * Pricing Configuration\r\n */\r\nconst FREE_PRICING: PricingInfo = {\r\n  tier: 'free',\r\n  monthly: {\r\n    amount: 0,\r\n    currency: 'USD',\r\n    display: '$0',\r\n  },\r\n  yearly: {\r\n    amount: 0,\r\n    currency: 'USD',\r\n    display: '$0',\r\n    savings: 0,\r\n  },\r\n  trial: {\r\n    enabled: false,\r\n    days: 0,\r\n  },\r\n};\r\n\r\nconst BASIC_PRICING: PricingInfo = {\r\n  tier: 'basic',\r\n  monthly: {\r\n    amount: 999, // $9.99/month\r\n    currency: 'USD',\r\n    display: '$9.99',\r\n  },\r\n  yearly: {\r\n    amount: 9990, // $99.90/year (2 months free)\r\n    currency: 'USD',\r\n    display: '$99.90',\r\n    savings: 17, // 17% savings\r\n  },\r\n  trial: {\r\n    enabled: true,\r\n    days: 14,\r\n  },\r\n};\r\n\r\nconst PRO_PRICING: PricingInfo = {\r\n  tier: 'pro',\r\n  monthly: {\r\n    amount: 2499, // $24.99/month\r\n    currency: 'USD',\r\n    display: '$24.99',\r\n  },\r\n  yearly: {\r\n    amount: 24990, // $249.90/year (2.5 months free)\r\n    currency: 'USD',\r\n    display: '$249.90',\r\n    savings: 21, // 21% savings\r\n  },\r\n  lifetime: {\r\n    amount: 49900, // $499 one-time\r\n    currency: 'USD',\r\n    display: '$499',\r\n  },\r\n  trial: {\r\n    enabled: true,\r\n    days: 30,\r\n  },\r\n};\r\n\r\nconst ENTERPRISE_PRICING: PricingInfo = {\r\n  tier: 'enterprise',\r\n  monthly: {\r\n    amount: 0, // Custom pricing\r\n    currency: 'USD',\r\n    display: 'Custom',\r\n  },\r\n  yearly: {\r\n    amount: 0,\r\n    currency: 'USD',\r\n    display: 'Custom',\r\n    savings: 0,\r\n  },\r\n  trial: {\r\n    enabled: true,\r\n    days: 60,\r\n  },\r\n};\r\n\r\n/**\r\n * Complete Subscription Plans\r\n */\r\nexport const SUBSCRIPTION_PLANS: Record<SubscriptionTier, SubscriptionPlan> = {\r\n  free: {\r\n    tier: 'free',\r\n    name: 'Free',\r\n    tagline: 'Unlimited pain tracking, forever free',\r\n    description:\r\n      'Complete pain, mood, and activity tracking with no entry limits. Upgrade for advanced analytics, automated insights, and clinical reports.',\r\n    features: FREE_FEATURES,\r\n    pricing: FREE_PRICING,\r\n    limits: {\r\n      softLimits: false,\r\n      gracePeriodDays: 0,\r\n    },\r\n    targeting: {\r\n      userType: ['individual', 'patient', 'caregiver'],\r\n      painLevel: 'any',\r\n    },\r\n  },\r\n\r\n  basic: {\r\n    tier: 'basic',\r\n    name: 'Basic',\r\n    tagline: 'Comprehensive pain management',\r\n    description:\r\n      'For individuals committed to understanding and managing chronic pain. Includes advanced analytics, PDF reports, and family sharing.',\r\n    features: BASIC_FEATURES,\r\n    pricing: BASIC_PRICING,\r\n    popular: true,\r\n    limits: {\r\n      softLimits: true,\r\n      gracePeriodDays: 7,\r\n    },\r\n    targeting: {\r\n      userType: ['individual', 'caregiver'],\r\n      painLevel: 'chronic',\r\n    },\r\n  },\r\n\r\n  pro: {\r\n    tier: 'pro',\r\n    name: 'Pro',\r\n    tagline: 'Clinic-ready exports & insights',\r\n    description:\r\n      'Power users and healthcare coordination. Unlimited entries, pattern-based alerts, clinical PDF exports, and HIPAA-aligned controls.',\r\n    features: PRO_FEATURES,\r\n    pricing: PRO_PRICING,\r\n    recommended: true,\r\n    limits: {\r\n      softLimits: true,\r\n      gracePeriodDays: 14,\r\n    },\r\n    targeting: {\r\n      userType: ['power_user', 'healthcare_coordinator', 'professional'],\r\n      painLevel: 'chronic',\r\n    },\r\n  },\r\n\r\n  enterprise: {\r\n    tier: 'enterprise',\r\n    name: 'Enterprise',\r\n    tagline: 'Healthcare organization solution',\r\n    description:\r\n      'For clinics, healthcare organizations, and large-scale deployments. Custom features, white-label options, and dedicated support.',\r\n    features: ENTERPRISE_FEATURES,\r\n    pricing: ENTERPRISE_PRICING,\r\n    limits: {\r\n      softLimits: true,\r\n      gracePeriodDays: 30,\r\n    },\r\n    targeting: {\r\n      userType: ['organization', 'clinic', 'healthcare_provider'],\r\n    },\r\n  },\r\n};\r\n\r\n/**\r\n * Feature Comparison Matrix\r\n * Useful for pricing page and upgrade prompts\r\n */\r\nexport const FEATURE_COMPARISON = {\r\n  storage: {\r\n    category: 'Storage & Data',\r\n    items: [\r\n      {\r\n        name: 'Pain Entries',\r\n        free: 'Unlimited',\r\n        basic: 'Unlimited',\r\n        pro: 'Unlimited',\r\n        enterprise: 'Unlimited',\r\n      },\r\n      {\r\n        name: 'Data Retention',\r\n        free: 'Unlimited',\r\n        basic: 'Unlimited',\r\n        pro: 'Unlimited',\r\n        enterprise: 'Unlimited + Custom',\r\n      },\r\n      {\r\n        name: 'Storage Space',\r\n        free: '100 MB',\r\n        basic: '500 MB',\r\n        pro: '5 GB',\r\n        enterprise: 'Unlimited',\r\n      },\r\n    ],\r\n  },\r\n  analytics: {\r\n    category: 'Analytics & Insights',\r\n    items: [\r\n      {\r\n        name: 'Basic Analytics',\r\n        free: true,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'Advanced Analytics',\r\n        free: false,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'Pattern-based alerts',\r\n        free: false,\r\n        basic: false,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'Empathy Intelligence',\r\n        free: false,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n    ],\r\n  },\r\n  export: {\r\n    category: 'Reports & Export',\r\n    items: [\r\n      {\r\n        name: 'CSV Export',\r\n        free: true,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'PDF Reports',\r\n        free: true,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'WorkSafe BC Reports',\r\n        free: true,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'Clinical PDF Export',\r\n        free: false,\r\n        basic: false,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n    ],\r\n  },\r\n  collaboration: {\r\n    category: 'Sharing & Collaboration',\r\n    items: [\r\n      {\r\n        name: 'Family Sharing',\r\n        free: false,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'Shared Users',\r\n        free: '0',\r\n        basic: '2',\r\n        pro: '5',\r\n        enterprise: 'Unlimited',\r\n      },\r\n      {\r\n        name: 'Caregiver Access',\r\n        free: false,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n    ],\r\n  },\r\n  security: {\r\n    category: 'Security & Compliance',\r\n    items: [\r\n      {\r\n        name: 'Encryption',\r\n        free: 'Basic',\r\n        basic: 'Advanced',\r\n        pro: 'Advanced',\r\n        enterprise: 'Enterprise',\r\n      },\r\n      {\r\n        name: 'Two-Factor Auth',\r\n        free: false,\r\n        basic: true,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n      {\r\n        name: 'HIPAA-aligned controls',\r\n        free: false,\r\n        basic: false,\r\n        pro: true,\r\n        enterprise: true,\r\n      },\r\n    ],\r\n  },\r\n  support: {\r\n    category: 'Support',\r\n    items: [\r\n      {\r\n        name: 'Support Level',\r\n        free: 'Community',\r\n        basic: 'Email',\r\n        pro: 'Priority',\r\n        enterprise: 'Dedicated',\r\n      },\r\n      {\r\n        name: 'Response Time',\r\n        free: '72 hours',\r\n        basic: '24 hours',\r\n        pro: '4 hours',\r\n        enterprise: '1 hour',\r\n      },\r\n      {\r\n        name: 'Custom Training',\r\n        free: false,\r\n        basic: false,\r\n        pro: false,\r\n        enterprise: true,\r\n      },\r\n    ],\r\n  },\r\n};\r\n\r\n/**\r\n * Tier Upgrade Paths\r\n * Defines logical upgrade flows\r\n */\r\nexport const UPGRADE_PATHS: Record<SubscriptionTier, SubscriptionTier[]> = {\r\n  free: ['basic', 'pro', 'enterprise'],\r\n  basic: ['pro', 'enterprise'],\r\n  pro: ['enterprise'],\r\n  enterprise: [],\r\n};\r\n\r\n/**\r\n * Tier Downgrade Paths\r\n */\r\nexport const DOWNGRADE_PATHS: Record<SubscriptionTier, SubscriptionTier[]> = {\r\n  enterprise: ['pro', 'basic', 'free'],\r\n  pro: ['basic', 'free'],\r\n  basic: ['free'],\r\n  free: [],\r\n};\r\n\r\n/**\r\n * Feature Usage Limits by Tier\r\n * Used for soft limit warnings and usage tracking\r\n * Note: Core tracking (entries) is unlimited for all tiers\r\n */\r\nexport const USAGE_LIMITS = {\r\n  free: {\r\n    // Entries are unlimited - no painEntries limit\r\n    storageMB: { limit: 100, warningAt: 80, unit: 'MB' },\r\n    exportCount: { limit: 5, warningAt: 4, unit: 'exports/month', resetMonthly: true },\r\n  },\r\n  basic: {\r\n    // Entries are unlimited\r\n    storageMB: { limit: 500, warningAt: 450, unit: 'MB' },\r\n    exportCount: { limit: 50, warningAt: 45, unit: 'exports/month', resetMonthly: true },\r\n  },\r\n  pro: {\r\n    storageMB: { limit: 5000, warningAt: 4500, unit: 'MB' },\r\n    apiCalls: { limit: 10000, warningAt: 9000, unit: 'calls/month', resetMonthly: true },\r\n  },\r\n  enterprise: {\r\n    // Custom limits set per organization\r\n  },\r\n};\r\n\r\n/**\r\n * Trial Configurations\r\n */\r\nexport const TRIAL_CONFIGS = {\r\n  basic: {\r\n    tier: 'basic' as SubscriptionTier,\r\n    duration: 14,\r\n    requiresPaymentMethod: false,\r\n    autoConvert: false,\r\n    features: BASIC_FEATURES,\r\n    conversionIncentive: {\r\n      discount: 20, // 20% off first month\r\n      validDays: 7, // Valid for 7 days after trial\r\n    },\r\n  },\r\n  pro: {\r\n    tier: 'pro' as SubscriptionTier,\r\n    duration: 30,\r\n    requiresPaymentMethod: false,\r\n    autoConvert: false,\r\n    features: PRO_FEATURES,\r\n    conversionIncentive: {\r\n      discount: 25,\r\n      validDays: 14,\r\n    },\r\n  },\r\n  enterprise: {\r\n    tier: 'enterprise' as SubscriptionTier,\r\n    duration: 60,\r\n    requiresPaymentMethod: false,\r\n    autoConvert: false,\r\n    features: ENTERPRISE_FEATURES,\r\n  },\r\n};\r\n","/**\r\n * Subscription Management Service\r\n * Handles subscription lifecycle, tier validation, and usage tracking\r\n */\r\n\r\nimport type {\r\n  UserSubscription,\r\n  SubscriptionTier,\r\n  BillingInterval,\r\n  FeatureAccessResult,\r\n  UsageQuota,\r\n  TierChangeOption,\r\n  BillingEvent,\r\n  SubscriptionAnalytics,\r\n} from '../types/subscription';\r\nimport {\r\n  SUBSCRIPTION_PLANS,\r\n  USAGE_LIMITS,\r\n  UPGRADE_PATHS,\r\n} from '../config/subscription-tiers';\r\nimport { securityService } from './SecurityService';\r\n\r\n/**\r\n * Subscription Service\r\n * Core service for managing user subscriptions and feature access\r\n */\r\nexport class SubscriptionService {\r\n  private subscriptions = new Map<string, UserSubscription>();\r\n  private billingEvents: BillingEvent[] = [];\r\n\r\n  /**\r\n   * Initialize a new subscription\r\n   */\r\n  async createSubscription(\r\n    userId: string,\r\n    tier: SubscriptionTier = 'free',\r\n    billingInterval: BillingInterval = 'monthly'\r\n  ): Promise<UserSubscription> {\r\n    const now = new Date().toISOString();\r\n    const plan = SUBSCRIPTION_PLANS[tier];\r\n\r\n    // Calculate period dates\r\n    const currentPeriodStart = now;\r\n    const currentPeriodEnd = this.calculatePeriodEnd(currentPeriodStart, billingInterval);\r\n\r\n    // Check if trial is available\r\n    const isTrial = plan.pricing.trial.enabled && tier !== 'free';\r\n\r\n    const subscription: UserSubscription = {\r\n      id: this.generateSubscriptionId(),\r\n      userId,\r\n      tier,\r\n      status: isTrial ? 'trialing' : 'active',\r\n      billingInterval,\r\n      currentPeriodStart,\r\n      currentPeriodEnd,\r\n      cancelAtPeriodEnd: false,\r\n      trialStart: isTrial ? now : undefined,\r\n      trialEnd: isTrial ? this.calculateTrialEnd(now, plan.pricing.trial.days) : undefined,\r\n      usage: {\r\n        painEntries: 0,\r\n        moodEntries: 0,\r\n        activityLogs: 0,\r\n        storageMB: 0,\r\n        apiCalls: 0,\r\n        exportCount: 0,\r\n      },\r\n      createdAt: now,\r\n      updatedAt: now,\r\n    };\r\n\r\n    this.subscriptions.set(userId, subscription);\r\n\r\n    // Log event\r\n    await this.logBillingEvent({\r\n      type: 'subscription_created',\r\n      subscriptionId: subscription.id,\r\n      userId,\r\n      metadata: { billingInterval, isTrial, tier },\r\n    });\r\n\r\n    await securityService.logSecurityEvent({\r\n      type: 'audit',\r\n      level: 'info',\r\n      message: `Subscription created: ${tier} tier for user ${userId}`,\r\n      userId,\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    return subscription;\r\n  }\r\n\r\n  /**\r\n   * Get user subscription\r\n   */\r\n  getSubscription(userId: string): UserSubscription | null {\r\n    return this.subscriptions.get(userId) || null;\r\n  }\r\n\r\n  /**\r\n   * Get user's current tier\r\n   */\r\n  getUserTier(userId: string): SubscriptionTier {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) return 'free';\r\n\r\n    // Check if subscription is expired or canceled\r\n    if (this.isSubscriptionExpired(subscription)) {\r\n      return 'free';\r\n    }\r\n\r\n    return subscription.tier;\r\n  }\r\n\r\n  /**\r\n   * Check if user has access to a specific feature\r\n   */\r\n  async checkFeatureAccess(\r\n    userId: string,\r\n    featureName: keyof typeof SUBSCRIPTION_PLANS.free.features\r\n  ): Promise<FeatureAccessResult> {\r\n    const tier = this.getUserTier(userId);\r\n    const plan = SUBSCRIPTION_PLANS[tier];\r\n    const feature = plan.features[featureName];\r\n\r\n    // Check if feature is enabled for this tier\r\n    if (typeof feature === 'boolean') {\r\n      return {\r\n        hasAccess: feature,\r\n        reason: feature\r\n          ? 'Feature included in your plan'\r\n          : `Feature requires ${this.getMinimumTierForFeature(featureName)} plan`,\r\n        upgradeRequired: feature ? undefined : this.getMinimumTierForFeature(featureName),\r\n      };\r\n    }\r\n\r\n    // For numeric limits, check quota\r\n    if (typeof feature === 'number') {\r\n      const subscription = this.getSubscription(userId);\r\n      if (!subscription) {\r\n        return {\r\n          hasAccess: false,\r\n          reason: 'No active subscription',\r\n          upgradeRequired: 'basic',\r\n        };\r\n      }\r\n\r\n      const quota = await this.getFeatureQuota(userId, featureName);\r\n\r\n      return {\r\n        hasAccess: quota.remaining > 0 || feature === -1,\r\n        reason: quota.remaining > 0 ? 'Quota available' : 'Quota exceeded',\r\n        quota,\r\n        upgradeRequired: quota.remaining <= 0 ? this.getNextTier(tier) : undefined,\r\n      };\r\n    }\r\n\r\n    // For string values (like encryption level)\r\n    return {\r\n      hasAccess: !!feature,\r\n      reason: feature ? `${feature} access included` : 'Feature not available',\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get usage quota for a feature\r\n   */\r\n  async getFeatureQuota(\r\n    userId: string,\r\n    featureName: keyof typeof SUBSCRIPTION_PLANS.free.features\r\n  ): Promise<UsageQuota> {\r\n    const tier = this.getUserTier(userId);\r\n    const plan = SUBSCRIPTION_PLANS[tier];\r\n    const subscription = this.getSubscription(userId);\r\n\r\n    if (!subscription) {\r\n      return {\r\n        feature: featureName,\r\n        limit: 0,\r\n        current: 0,\r\n        remaining: 0,\r\n        percentage: 0,\r\n      };\r\n    }\r\n\r\n    // Get the limit for this feature\r\n    const featureValue = plan.features[featureName];\r\n    const limit = typeof featureValue === 'number' ? featureValue : 0;\r\n\r\n    // Get current usage based on feature type\r\n    let current = 0;\r\n    if (featureName === 'maxPainEntries') current = subscription.usage.painEntries;\r\n    else if (featureName === 'maxMoodEntries') current = subscription.usage.moodEntries;\r\n    else if (featureName === 'maxActivityLogs') current = subscription.usage.activityLogs;\r\n    else if (featureName === 'maxStorageMB') current = subscription.usage.storageMB;\r\n    else if (featureName === 'maxExportsPerMonth') current = subscription.usage.exportCount;\r\n\r\n    const remaining = limit === -1 ? Infinity : Math.max(0, limit - current);\r\n    const percentage = limit === -1 ? 0 : Math.min(100, (current / limit) * 100);\r\n\r\n    return {\r\n      feature: featureName,\r\n      limit,\r\n      current,\r\n      remaining: limit === -1 ? -1 : remaining,\r\n      percentage,\r\n      resetDate: this.shouldResetMonthly(featureName) ? subscription.currentPeriodEnd : undefined,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Track feature usage\r\n   */\r\n  async trackUsage(\r\n    userId: string,\r\n    usageType: keyof UserSubscription['usage'],\r\n    amount: number = 1\r\n  ): Promise<{ success: boolean; quota?: UsageQuota }> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) {\r\n      return { success: false };\r\n    }\r\n\r\n    // Update usage\r\n    subscription.usage[usageType] += amount;\r\n    subscription.updatedAt = new Date().toISOString();\r\n\r\n    // Get updated quota\r\n    const featureMap: Record<\r\n      keyof UserSubscription['usage'],\r\n      keyof typeof SUBSCRIPTION_PLANS.free.features\r\n    > = {\r\n      painEntries: 'maxPainEntries',\r\n      moodEntries: 'maxMoodEntries',\r\n      activityLogs: 'maxActivityLogs',\r\n      storageMB: 'maxStorageMB',\r\n      apiCalls: 'maxPainEntries', // Placeholder until dedicated apiCalls quota added\r\n      exportCount: 'maxExportsPerMonth',\r\n    };\r\n\r\n    const featureName = featureMap[usageType];\r\n    const quota = await this.getFeatureQuota(userId, featureName);\r\n\r\n    // Check if approaching limit (for warnings)\r\n    const tier = this.getUserTier(userId);\r\n    const limits = USAGE_LIMITS[tier as keyof typeof USAGE_LIMITS];\r\n    if (limits && limits[usageType as keyof typeof limits]) {\r\n      const limit = limits[usageType as keyof typeof limits] as {\r\n        limit: number;\r\n        warningAt: number;\r\n      };\r\n      if (subscription.usage[usageType] >= limit.warningAt) {\r\n        await securityService.logSecurityEvent({\r\n          type: 'audit',\r\n          level: 'warning',\r\n          message: `User approaching ${usageType} limit: ${subscription.usage[usageType]}/${limit.limit}`,\r\n          userId,\r\n          timestamp: new Date(),\r\n        });\r\n      }\r\n    }\r\n\r\n    return { success: true, quota };\r\n  }\r\n\r\n  /**\r\n   * Upgrade subscription\r\n   */\r\n  async upgradeTier(\r\n    userId: string,\r\n    newTier: SubscriptionTier,\r\n    immediate: boolean = true\r\n  ): Promise<TierChangeOption> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) {\r\n      throw new Error('No active subscription found');\r\n    }\r\n\r\n    const currentTier = subscription.tier;\r\n    const changeOption = await this.calculateTierChange(currentTier, newTier);\r\n\r\n    if (immediate) {\r\n      subscription.tier = newTier;\r\n      subscription.status = 'active';\r\n      subscription.updatedAt = new Date().toISOString();\r\n\r\n      await this.logBillingEvent({\r\n        type: 'tier_upgraded',\r\n        subscriptionId: subscription.id,\r\n        userId,\r\n        metadata: { fromTier: currentTier, toTier: newTier },\r\n      });\r\n\r\n      await securityService.logSecurityEvent({\r\n        type: 'audit',\r\n        level: 'info',\r\n        message: `Subscription upgraded: ${currentTier}  ${newTier}`,\r\n        userId,\r\n        timestamp: new Date(),\r\n      });\r\n    } else {\r\n      // Schedule upgrade for next billing period\r\n      subscription.scheduledChange = {\r\n        newTier,\r\n        effectiveDate: subscription.currentPeriodEnd,\r\n        reason: 'upgrade',\r\n      };\r\n    }\r\n\r\n    return changeOption;\r\n  }\r\n\r\n  /**\r\n   * Downgrade subscription\r\n   */\r\n  async downgradeTier(userId: string, newTier: SubscriptionTier): Promise<TierChangeOption> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) {\r\n      throw new Error('No active subscription found');\r\n    }\r\n\r\n    const currentTier = subscription.tier;\r\n    const changeOption = await this.calculateTierChange(currentTier, newTier);\r\n\r\n    // Downgrades always happen at period end\r\n    subscription.scheduledChange = {\r\n      newTier,\r\n      effectiveDate: subscription.currentPeriodEnd,\r\n      reason: 'downgrade',\r\n    };\r\n    subscription.updatedAt = new Date().toISOString();\r\n\r\n    await this.logBillingEvent({\r\n      type: 'tier_downgraded',\r\n      subscriptionId: subscription.id,\r\n      userId,\r\n      metadata: {\r\n        fromTier: currentTier,\r\n        toTier: newTier,\r\n        effectiveDate: subscription.currentPeriodEnd,\r\n      },\r\n    });\r\n\r\n    return changeOption;\r\n  }\r\n\r\n  /**\r\n   * Cancel subscription\r\n   */\r\n  async cancelSubscription(userId: string, immediate: boolean = false): Promise<UserSubscription> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) {\r\n      throw new Error('No active subscription found');\r\n    }\r\n\r\n    if (immediate) {\r\n      subscription.status = 'canceled';\r\n      subscription.tier = 'free';\r\n    } else {\r\n      subscription.cancelAtPeriodEnd = true;\r\n      subscription.status = 'canceled';\r\n    }\r\n\r\n    subscription.updatedAt = new Date().toISOString();\r\n\r\n    await this.logBillingEvent({\r\n      type: 'subscription_canceled',\r\n      subscriptionId: subscription.id,\r\n      userId,\r\n      metadata: {\r\n        immediate,\r\n        effectiveDate: immediate ? new Date().toISOString() : subscription.currentPeriodEnd,\r\n      },\r\n    });\r\n\r\n    await securityService.logSecurityEvent({\r\n      type: 'audit',\r\n      level: 'info',\r\n      message: `Subscription canceled${immediate ? ' (immediate)' : ' (at period end)'}`,\r\n      userId,\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    return subscription;\r\n  }\r\n\r\n  /**\r\n   * Reactivate canceled subscription\r\n   */\r\n  async reactivateSubscription(userId: string): Promise<UserSubscription> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) {\r\n      throw new Error('No subscription found');\r\n    }\r\n\r\n    if (subscription.status !== 'canceled' || !subscription.cancelAtPeriodEnd) {\r\n      throw new Error('Subscription is not canceled');\r\n    }\r\n\r\n    subscription.cancelAtPeriodEnd = false;\r\n    subscription.status = 'active';\r\n    subscription.updatedAt = new Date().toISOString();\r\n\r\n    await securityService.logSecurityEvent({\r\n      type: 'audit',\r\n      level: 'info',\r\n      message: 'Subscription reactivated',\r\n      userId,\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    return subscription;\r\n  }\r\n\r\n  /**\r\n   * Calculate tier change details\r\n   */\r\n  private async calculateTierChange(\r\n    fromTier: SubscriptionTier,\r\n    toTier: SubscriptionTier\r\n  ): Promise<TierChangeOption> {\r\n    const fromPlan = SUBSCRIPTION_PLANS[fromTier];\r\n    const toPlan = SUBSCRIPTION_PLANS[toTier];\r\n\r\n    const isUpgrade = this.isUpgrade(fromTier, toTier);\r\n\r\n    // Calculate feature differences\r\n    const featuresGained: string[] = [];\r\n    const featuresLost: string[] = [];\r\n\r\n    const featureKeys = Object.keys(fromPlan.features) as Array<keyof typeof fromPlan.features>;\r\n    featureKeys.forEach(key => {\r\n      const fromValue = fromPlan.features[key];\r\n      const toValue = toPlan.features[key];\r\n\r\n      if (typeof fromValue === 'boolean' && typeof toValue === 'boolean') {\r\n        if (!fromValue && toValue) featuresGained.push(key);\r\n        if (fromValue && !toValue) featuresLost.push(key);\r\n      }\r\n    });\r\n\r\n    return {\r\n      fromTier,\r\n      toTier,\r\n      type: isUpgrade ? 'upgrade' : 'downgrade',\r\n      immediateCharge: isUpgrade ? toPlan.pricing.monthly.amount : 0,\r\n      nextBillingChange: toPlan.pricing.monthly.amount,\r\n      featuresGained,\r\n      featuresLost,\r\n      requiresMigration: !isUpgrade,\r\n      effectiveImmediately: isUpgrade,\r\n      confirmationRequired: featuresLost.length > 0,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get subscription analytics\r\n   */\r\n  async getAnalytics(userId: string): Promise<SubscriptionAnalytics | null> {\r\n    const subscription = this.getSubscription(userId);\r\n    if (!subscription) return null;\r\n\r\n    const now = new Date();\r\n    const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);\r\n    const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n    const oneMonthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n\r\n    // Calculate engagement score (0-100)\r\n    const engagementScore = this.calculateEngagementScore(subscription);\r\n    const churnRisk = this.calculateChurnRisk(engagementScore, subscription);\r\n\r\n    return {\r\n      userId,\r\n      tier: subscription.tier,\r\n      dailyActive: new Date(subscription.updatedAt) > oneDayAgo,\r\n      weeklyActive: new Date(subscription.updatedAt) > oneWeekAgo,\r\n      monthlyActive: new Date(subscription.updatedAt) > oneMonthAgo,\r\n      mostUsedFeatures: [],\r\n      entriesCreated: subscription.usage.painEntries + subscription.usage.moodEntries,\r\n      reportsGenerated: subscription.usage.exportCount,\r\n      insightsViewed: 0,\r\n      exportsMade: subscription.usage.exportCount,\r\n      engagementScore,\r\n      churnRisk,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Helper: Check if subscription is expired\r\n   */\r\n  private isSubscriptionExpired(subscription: UserSubscription): boolean {\r\n    if (subscription.status === 'active' || subscription.status === 'trialing') {\r\n      return false;\r\n    }\r\n\r\n    if (subscription.status === 'canceled' && !subscription.cancelAtPeriodEnd) {\r\n      return new Date() > new Date(subscription.currentPeriodEnd);\r\n    }\r\n\r\n    return subscription.status === 'expired';\r\n  }\r\n\r\n  /**\r\n   * Helper: Get minimum tier for a feature\r\n   */\r\n  private getMinimumTierForFeature(\r\n    featureName: keyof typeof SUBSCRIPTION_PLANS.free.features\r\n  ): SubscriptionTier {\r\n    const tiers: SubscriptionTier[] = ['free', 'basic', 'pro', 'enterprise'];\r\n\r\n    for (const tier of tiers) {\r\n      const plan = SUBSCRIPTION_PLANS[tier];\r\n      const feature = plan.features[featureName];\r\n      // Booleans: true indicates availability\r\n      if (typeof feature === 'boolean') {\r\n        if (feature === true) return tier;\r\n        continue;\r\n      }\r\n      // Numbers: any non-zero value indicates availability (-1 = unlimited)\r\n      if (typeof feature === 'number') {\r\n        if (feature !== 0) return tier;\r\n        continue;\r\n      }\r\n      // Strings (e.g., encryption levels): any defined value indicates availability\r\n      if (typeof feature === 'string') {\r\n        return tier;\r\n      }\r\n    }\r\n\r\n    return 'enterprise';\r\n  }\r\n\r\n  /**\r\n   * Helper: Get next tier up\r\n   */\r\n  private getNextTier(currentTier: SubscriptionTier): SubscriptionTier | undefined {\r\n    const upgrades = UPGRADE_PATHS[currentTier];\r\n    return upgrades.length > 0 ? upgrades[0] : undefined;\r\n  }\r\n\r\n  /**\r\n   * Helper: Check if tier change is an upgrade\r\n   */\r\n  private isUpgrade(fromTier: SubscriptionTier, toTier: SubscriptionTier): boolean {\r\n    const tierOrder: SubscriptionTier[] = ['free', 'basic', 'pro', 'enterprise'];\r\n    return tierOrder.indexOf(toTier) > tierOrder.indexOf(fromTier);\r\n  }\r\n\r\n  /**\r\n   * Helper: Calculate period end date\r\n   */\r\n  private calculatePeriodEnd(start: string, interval: BillingInterval): string {\r\n    const startDate = new Date(start);\r\n\r\n    if (interval === 'monthly') {\r\n      startDate.setMonth(startDate.getMonth() + 1);\r\n    } else if (interval === 'yearly') {\r\n      startDate.setFullYear(startDate.getFullYear() + 1);\r\n    } else {\r\n      // Lifetime - set to 100 years in future\r\n      startDate.setFullYear(startDate.getFullYear() + 100);\r\n    }\r\n\r\n    return startDate.toISOString();\r\n  }\r\n\r\n  /**\r\n   * Helper: Calculate trial end date\r\n   */\r\n  private calculateTrialEnd(start: string, days: number): string {\r\n    const startDate = new Date(start);\r\n    startDate.setDate(startDate.getDate() + days);\r\n    return startDate.toISOString();\r\n  }\r\n\r\n  /**\r\n   * Helper: Check if feature should reset monthly\r\n   */\r\n  private shouldResetMonthly(featureName: string): boolean {\r\n    return ['exportCount', 'apiCalls'].includes(featureName);\r\n  }\r\n\r\n  /**\r\n   * Helper: Calculate engagement score\r\n   */\r\n  private calculateEngagementScore(subscription: UserSubscription): number {\r\n    let score = 0;\r\n\r\n    // Usage frequency (40 points)\r\n    if (subscription.usage.painEntries > 0) score += 20;\r\n    if (subscription.usage.painEntries > 10) score += 10;\r\n    if (subscription.usage.painEntries > 50) score += 10;\r\n\r\n    // Feature diversity (30 points)\r\n    if (subscription.usage.moodEntries > 0) score += 10;\r\n    if (subscription.usage.activityLogs > 0) score += 10;\r\n    if (subscription.usage.exportCount > 0) score += 10;\r\n\r\n    // Recency (30 points)\r\n    const daysSinceUpdate = Math.floor(\r\n      (Date.now() - new Date(subscription.updatedAt).getTime()) / (1000 * 60 * 60 * 24)\r\n    );\r\n    if (daysSinceUpdate === 0) score += 30;\r\n    else if (daysSinceUpdate <= 3) score += 20;\r\n    else if (daysSinceUpdate <= 7) score += 10;\r\n\r\n    return Math.min(100, score);\r\n  }\r\n\r\n  /**\r\n   * Helper: Calculate churn risk\r\n   */\r\n  private calculateChurnRisk(\r\n    engagementScore: number,\r\n    subscription: UserSubscription\r\n  ): 'low' | 'medium' | 'high' {\r\n    if (subscription.cancelAtPeriodEnd) return 'high';\r\n    if (engagementScore < 30) return 'high';\r\n    if (engagementScore < 60) return 'medium';\r\n    return 'low';\r\n  }\r\n\r\n  /**\r\n   * Helper: Generate subscription ID\r\n   */\r\n  private generateSubscriptionId(): string {\r\n    return `sub_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Helper: Log billing event\r\n   */\r\n  private async logBillingEvent(event: Partial<BillingEvent>): Promise<void> {\r\n    const billingEvent: BillingEvent = {\r\n      id: `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      type: event.type!,\r\n      subscriptionId: event.subscriptionId!,\r\n      userId: event.userId!,\r\n      timestamp: new Date().toISOString(),\r\n      amount: event.amount,\r\n      currency: event.currency,\r\n      metadata: event.metadata,\r\n    };\r\n\r\n    this.billingEvents.push(billingEvent);\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const subscriptionService = new SubscriptionService();\r\n","/**\r\n * Subscription Context and Provider\r\n * React context for managing subscription state throughout the app\r\n */\r\n\r\nimport React, {\r\n  createContext,\r\n  useContext,\r\n  useState,\r\n  useEffect,\r\n  useCallback,\r\n  ReactNode,\r\n} from 'react';\r\nimport type {\r\n  UserSubscription,\r\n  SubscriptionTier,\r\n  FeatureAccessResult,\r\n  TierChangeOption,\r\n  SubscriptionAnalytics,\r\n} from '../types/subscription';\r\nimport type { TierFeatures } from '../types/subscription';\r\nimport { subscriptionService } from '../services/SubscriptionService';\r\nimport { SUBSCRIPTION_PLANS } from '../config/subscription-tiers';\r\n\r\ninterface SubscriptionContextValue {\r\n  // Current subscription state\r\n  subscription: UserSubscription | null;\r\n  currentTier: SubscriptionTier;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n\r\n  // Subscription management\r\n  initialize: (userId: string) => Promise<void>;\r\n  upgradeTier: (newTier: SubscriptionTier, immediate?: boolean) => Promise<TierChangeOption>;\r\n  downgradeTier: (newTier: SubscriptionTier) => Promise<TierChangeOption>;\r\n  cancelSubscription: (immediate?: boolean) => Promise<void>;\r\n  reactivateSubscription: () => Promise<void>;\r\n\r\n  // Feature access\r\n  checkFeatureAccess: (featureName: keyof TierFeatures) => Promise<FeatureAccessResult>;\r\n  hasFeature: (featureName: keyof TierFeatures) => boolean;\r\n  trackUsage: (usageType: keyof UserSubscription['usage'], amount?: number) => Promise<void>;\r\n\r\n  // Analytics\r\n  getAnalytics: () => Promise<SubscriptionAnalytics | null>;\r\n\r\n  // Utility\r\n  refresh: () => Promise<void>;\r\n}\r\n\r\nconst SubscriptionContext = createContext<SubscriptionContextValue | undefined>(undefined);\r\n\r\ninterface SubscriptionProviderProps {\r\n  children: ReactNode;\r\n  userId?: string;\r\n}\r\n\r\nexport const SubscriptionProvider: React.FC<SubscriptionProviderProps> = ({ children, userId }) => {\r\n  const [subscription, setSubscription] = useState<UserSubscription | null>(null);\r\n  const [currentTier, setCurrentTier] = useState<SubscriptionTier>('free');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  /**\r\n   * Initialize subscription for user\r\n   */\r\n  const initialize = useCallback(async (uid: string) => {\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // Try to get existing subscription\r\n      let sub = await subscriptionService.getSubscription(uid);\r\n\r\n      // If no subscription exists, create a free one\r\n      if (!sub) {\r\n        sub = await subscriptionService.createSubscription(uid, 'free');\r\n      }\r\n\r\n      setSubscription(sub);\r\n      setCurrentTier(sub.tier);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to initialize subscription');\r\n      console.error('Subscription initialization error:', err);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  /**\r\n   * Refresh subscription data\r\n   */\r\n  const refresh = useCallback(async () => {\r\n    if (!subscription?.userId) return;\r\n    await initialize(subscription.userId);\r\n  }, [subscription?.userId, initialize]);\r\n\r\n  /**\r\n   * Upgrade subscription tier\r\n   */\r\n  const upgradeTier = useCallback(\r\n    async (newTier: SubscriptionTier, immediate: boolean = true): Promise<TierChangeOption> => {\r\n      if (!subscription) {\r\n        throw new Error('No active subscription');\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const changeOption = await subscriptionService.upgradeTier(\r\n          subscription.userId,\r\n          newTier,\r\n          immediate\r\n        );\r\n\r\n        await refresh();\r\n        return changeOption;\r\n      } catch (err) {\r\n        const errorMsg = err instanceof Error ? err.message : 'Failed to upgrade subscription';\r\n        setError(errorMsg);\r\n        throw err;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [subscription, refresh]\r\n  );\r\n\r\n  /**\r\n   * Downgrade subscription tier\r\n   */\r\n  const downgradeTier = useCallback(\r\n    async (newTier: SubscriptionTier): Promise<TierChangeOption> => {\r\n      if (!subscription) {\r\n        throw new Error('No active subscription');\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        const changeOption = await subscriptionService.downgradeTier(subscription.userId, newTier);\r\n\r\n        await refresh();\r\n        return changeOption;\r\n      } catch (err) {\r\n        const errorMsg = err instanceof Error ? err.message : 'Failed to downgrade subscription';\r\n        setError(errorMsg);\r\n        throw err;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [subscription, refresh]\r\n  );\r\n\r\n  /**\r\n   * Cancel subscription\r\n   */\r\n  const cancelSubscription = useCallback(\r\n    async (immediate: boolean = false) => {\r\n      if (!subscription) {\r\n        throw new Error('No active subscription');\r\n      }\r\n\r\n      setIsLoading(true);\r\n      setError(null);\r\n\r\n      try {\r\n        await subscriptionService.cancelSubscription(subscription.userId, immediate);\r\n        await refresh();\r\n      } catch (err) {\r\n        const errorMsg = err instanceof Error ? err.message : 'Failed to cancel subscription';\r\n        setError(errorMsg);\r\n        throw err;\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    },\r\n    [subscription, refresh]\r\n  );\r\n\r\n  /**\r\n   * Reactivate subscription\r\n   */\r\n  const reactivateSubscription = useCallback(async () => {\r\n    if (!subscription) {\r\n      throw new Error('No active subscription');\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      await subscriptionService.reactivateSubscription(subscription.userId);\r\n      await refresh();\r\n    } catch (err) {\r\n      const errorMsg = err instanceof Error ? err.message : 'Failed to reactivate subscription';\r\n      setError(errorMsg);\r\n      throw err;\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [subscription, refresh]);\r\n\r\n  /**\r\n   * Check feature access\r\n   */\r\n  const checkFeatureAccess = useCallback(\r\n    async (featureName: keyof TierFeatures): Promise<FeatureAccessResult> => {\r\n      if (!subscription) {\r\n        return {\r\n          hasAccess: false,\r\n          reason: 'No active subscription',\r\n          upgradeRequired: 'basic',\r\n        };\r\n      }\r\n\r\n      return subscriptionService.checkFeatureAccess(subscription.userId, featureName);\r\n    },\r\n    [subscription]\r\n  );\r\n\r\n  /**\r\n   * Quick check if user has a feature (synchronous)\r\n   */\r\n  const hasFeature = useCallback(\r\n    (featureName: keyof TierFeatures): boolean => {\r\n      const plan = SUBSCRIPTION_PLANS[currentTier];\r\n      const feature = plan.features[featureName];\r\n\r\n      if (typeof feature === 'boolean') {\r\n        return feature;\r\n      }\r\n\r\n      if (typeof feature === 'number') {\r\n        return feature !== 0;\r\n      }\r\n\r\n      return !!feature;\r\n    },\r\n    [currentTier]\r\n  );\r\n\r\n  /**\r\n   * Track usage\r\n   */\r\n  const trackUsage = useCallback(\r\n    async (usageType: keyof UserSubscription['usage'], amount: number = 1) => {\r\n      if (!subscription) return;\r\n\r\n      try {\r\n        const result = await subscriptionService.trackUsage(subscription.userId, usageType, amount);\r\n\r\n        if (result.success && result.quota && result.quota.remaining === 0) {\r\n          setError(`You've reached your ${usageType} limit. Consider upgrading your plan.`);\r\n        }\r\n\r\n        await refresh();\r\n      } catch (err) {\r\n        console.error('Failed to track usage:', err);\r\n      }\r\n    },\r\n    [subscription, refresh]\r\n  );\r\n\r\n  /**\r\n   * Get analytics\r\n   */\r\n  const getAnalytics = useCallback(async (): Promise<SubscriptionAnalytics | null> => {\r\n    if (!subscription) return null;\r\n    return subscriptionService.getAnalytics(subscription.userId);\r\n  }, [subscription]);\r\n\r\n  // Auto-initialize if userId is provided\r\n  useEffect(() => {\r\n    if (userId) {\r\n      void initialize(userId);\r\n    }\r\n  }, [userId, initialize]);\r\n\r\n  const value: SubscriptionContextValue = {\r\n    subscription,\r\n    currentTier,\r\n    isLoading,\r\n    error,\r\n    initialize,\r\n    upgradeTier,\r\n    downgradeTier,\r\n    cancelSubscription,\r\n    reactivateSubscription,\r\n    checkFeatureAccess,\r\n    hasFeature,\r\n    trackUsage,\r\n    getAnalytics,\r\n    refresh,\r\n  };\r\n\r\n  return <SubscriptionContext.Provider value={value}>{children}</SubscriptionContext.Provider>;\r\n};\r\n\r\n/**\r\n * Hook to use subscription context\r\n */\r\nexport const useSubscription = (): SubscriptionContextValue => {\r\n  const context = useContext(SubscriptionContext);\r\n  if (!context) {\r\n    throw new Error('useSubscription must be used within a SubscriptionProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n/**\r\n * Hook to check if user has a specific tier or higher\r\n */\r\nexport const useHasTier = (requiredTier: SubscriptionTier): boolean => {\r\n  const { currentTier } = useSubscription();\r\n\r\n  const tierOrder: SubscriptionTier[] = ['free', 'basic', 'pro', 'enterprise'];\r\n  const currentIndex = tierOrder.indexOf(currentTier);\r\n  const requiredIndex = tierOrder.indexOf(requiredTier);\r\n\r\n  return currentIndex >= requiredIndex;\r\n};\r\n\r\n/**\r\n * Hook to check feature access with automatic tracking\r\n */\r\nexport const useFeatureAccess = (\r\n  featureName: keyof TierFeatures\r\n): FeatureAccessResult & { loading: boolean } => {\r\n  const { checkFeatureAccess } = useSubscription();\r\n  const [result, setResult] = useState<FeatureAccessResult>({\r\n    hasAccess: false,\r\n    reason: 'Checking...',\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n\r\n    const check = async () => {\r\n      try {\r\n        const access = await checkFeatureAccess(featureName);\r\n        if (mounted) {\r\n          setResult(access);\r\n        }\r\n      } catch {\r\n        if (mounted) {\r\n          setResult({\r\n            hasAccess: false,\r\n            reason: 'Error checking feature access',\r\n          });\r\n        }\r\n      } finally {\r\n        if (mounted) {\r\n          setLoading(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    void check();\r\n\r\n    return () => {\r\n      mounted = false;\r\n    };\r\n  }, [featureName, checkFeatureAccess]);\r\n\r\n  return { ...result, loading };\r\n};\r\n\r\n/**\r\n * Hook for subscription tier badge display\r\n */\r\nexport const useTierBadge = () => {\r\n  const { currentTier } = useSubscription();\r\n\r\n  const badges = {\r\n    free: {\r\n      label: 'Free',\r\n      color: 'gray',\r\n      icon: '',\r\n    },\r\n    basic: {\r\n      label: 'Basic',\r\n      color: 'blue',\r\n      icon: '',\r\n    },\r\n    pro: {\r\n      label: 'Pro',\r\n      color: 'purple',\r\n      icon: '',\r\n    },\r\n    enterprise: {\r\n      label: 'Enterprise',\r\n      color: 'gold',\r\n      icon: '',\r\n    },\r\n  };\r\n\r\n  return badges[currentTier];\r\n};\r\n","/**\r\n * StartupPromptsContext - Coordinates display of startup prompts to prevent \"notification wall\"\r\n * Ensures only one prompt appears at a time on initial app startup\r\n */\r\n\r\nimport { createContext, useContext, useState, useCallback, ReactNode, useEffect } from 'react';\r\n\r\nexport type PromptType = 'beta-warning' | 'notification-consent' | 'analytics-consent';\r\n\r\ninterface PromptRequest {\r\n  type: PromptType;\r\n  priority: number; // Lower number = higher priority\r\n}\r\n\r\ninterface StartupPromptsContextType {\r\n  requestPrompt: (type: PromptType, priority: number) => void;\r\n  dismissPrompt: (type: PromptType) => void;\r\n  canShowPrompt: (type: PromptType) => boolean;\r\n  activePrompt: PromptType | null;\r\n}\r\n\r\nconst StartupPromptsContext = createContext<StartupPromptsContextType | undefined>(undefined);\r\n\r\nexport function useStartupPrompts() {\r\n  const context = useContext(StartupPromptsContext);\r\n  if (!context) {\r\n    throw new Error('useStartupPrompts must be used within StartupPromptsProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\ninterface StartupPromptsProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function StartupPromptsProvider({ children }: StartupPromptsProviderProps) {\r\n  const [activePrompt, setActivePrompt] = useState<PromptType | null>(null);\r\n  const [promptQueue, setPromptQueue] = useState<PromptRequest[]>([]);\r\n  const [dismissedPrompts, setDismissedPrompts] = useState<Set<PromptType>>(new Set());\r\n\r\n  // Process the queue when active prompt changes or queue updates\r\n  useEffect(() => {\r\n    if (activePrompt === null && promptQueue.length > 0) {\r\n      // Sort by priority and show the highest priority prompt\r\n      const sorted = [...promptQueue].sort((a, b) => a.priority - b.priority);\r\n      const next = sorted[0];\r\n      setActivePrompt(next.type);\r\n      setPromptQueue(promptQueue.filter(p => p.type !== next.type));\r\n    }\r\n  }, [activePrompt, promptQueue]);\r\n\r\n  const requestPrompt = useCallback((type: PromptType, priority: number) => {\r\n    // Don't add if already dismissed or already in queue\r\n    setPromptQueue(prev => {\r\n      const alreadyQueued = prev.some(p => p.type === type);\r\n      if (alreadyQueued) return prev;\r\n      return [...prev, { type, priority }];\r\n    });\r\n  }, []);\r\n\r\n  const dismissPrompt = useCallback((type: PromptType) => {\r\n    setDismissedPrompts(prev => new Set(prev).add(type));\r\n    if (activePrompt === type) {\r\n      setActivePrompt(null);\r\n    }\r\n  }, [activePrompt]);\r\n\r\n  const canShowPrompt = useCallback((type: PromptType) => {\r\n    return activePrompt === type && !dismissedPrompts.has(type);\r\n  }, [activePrompt, dismissedPrompts]);\r\n\r\n  return (\r\n    <StartupPromptsContext.Provider value={{ requestPrompt, dismissPrompt, canShowPrompt, activePrompt }}>\r\n      {children}\r\n    </StartupPromptsContext.Provider>\r\n  );\r\n}\r\n","/**\n * Accessibility Utilities\n *\n * Comprehensive utilities for accessibility enhancements including:\n * - Announce live regions\n * - Focus management\n * - Keyboard navigation helpers\n * - Screen reader optimizations\n */\n\n/**\n * Announce a message to screen readers\n */\nexport const announceToScreenReader = (\n  message: string,\n  priority: 'polite' | 'assertive' = 'polite',\n  timeout = 100\n): void => {\n  // Find or create live region\n  let liveRegion = document.getElementById('aria-live-region');\n\n  if (!liveRegion) {\n    liveRegion = document.createElement('div');\n    liveRegion.id = 'aria-live-region';\n    liveRegion.setAttribute('aria-live', priority);\n    liveRegion.setAttribute('aria-atomic', 'true');\n    liveRegion.className = 'sr-only';\n    document.body.appendChild(liveRegion);\n  }\n\n  // Update aria-live priority if different\n  if (liveRegion.getAttribute('aria-live') !== priority) {\n    liveRegion.setAttribute('aria-live', priority);\n  }\n\n  // Clear and set new message with slight delay for SR detection\n  liveRegion.textContent = '';\n  setTimeout(() => {\n    if (liveRegion) {\n      liveRegion.textContent = message;\n    }\n  }, timeout);\n};\n\n/**\n * Focus management helper\n */\nexport class FocusManager {\n  private static focusStack: HTMLElement[] = [];\n\n  /**\n   * Save current focus and move to new element\n   */\n  static saveFocusAndMoveTo(newElement: HTMLElement | null): void {\n    const currentFocus = document.activeElement as HTMLElement;\n    if (currentFocus && currentFocus !== document.body) {\n      this.focusStack.push(currentFocus);\n    }\n\n    if (newElement) {\n      newElement.focus();\n    }\n  }\n\n  /**\n   * Restore previously saved focus\n   */\n  static restoreFocus(): void {\n    const previousFocus = this.focusStack.pop();\n    if (previousFocus && document.body.contains(previousFocus)) {\n      previousFocus.focus();\n    }\n  }\n\n  /**\n   * Get all focusable elements within a container\n   */\n  static getFocusableElements(container: HTMLElement): HTMLElement[] {\n    const focusableSelectors = [\n      'a[href]',\n      'button:not([disabled])',\n      'input:not([disabled])',\n      'select:not([disabled])',\n      'textarea:not([disabled])',\n      '[tabindex]:not([tabindex=\"-1\"])',\n      '[contenteditable=\"true\"]',\n    ].join(', ');\n\n    return Array.from(container.querySelectorAll<HTMLElement>(focusableSelectors)).filter(\n      el => !el.hasAttribute('hidden') && el.offsetParent !== null\n    );\n  }\n\n  /**\n   * Create focus trap for modal dialogs\n   */\n  static createFocusTrap(container: HTMLElement): () => void {\n    const focusableElements = this.getFocusableElements(container);\n    const firstElement = focusableElements[0];\n    const lastElement = focusableElements[focusableElements.length - 1];\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key !== 'Tab') return;\n\n      if (e.shiftKey) {\n        // Shift + Tab\n        if (document.activeElement === firstElement) {\n          e.preventDefault();\n          lastElement?.focus();\n        }\n      } else {\n        // Tab\n        if (document.activeElement === lastElement) {\n          e.preventDefault();\n          firstElement?.focus();\n        }\n      }\n    };\n\n    container.addEventListener('keydown', handleKeyDown);\n\n    // Return cleanup function\n    return () => {\n      container.removeEventListener('keydown', handleKeyDown);\n    };\n  }\n}\n\n/**\n * Keyboard navigation helper\n */\nexport class KeyboardNavigationHelper {\n  /**\n   * Handle arrow key navigation in a list\n   */\n  static setupArrowKeyNavigation(\n    container: HTMLElement,\n    itemSelector: string,\n    options: {\n      loop?: boolean;\n      orientation?: 'vertical' | 'horizontal' | 'grid';\n      onSelect?: (item: HTMLElement) => void;\n    } = {}\n  ): () => void {\n    const { loop = true, orientation = 'vertical', onSelect } = options;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      const items = Array.from(container.querySelectorAll<HTMLElement>(itemSelector));\n      const currentIndex = items.findIndex(item => item === document.activeElement);\n\n      if (currentIndex === -1) return;\n\n      let nextIndex = currentIndex;\n\n      switch (e.key) {\n        case 'ArrowDown':\n          if (orientation === 'vertical' || orientation === 'grid') {\n            e.preventDefault();\n            nextIndex = currentIndex + 1;\n          }\n          break;\n        case 'ArrowUp':\n          if (orientation === 'vertical' || orientation === 'grid') {\n            e.preventDefault();\n            nextIndex = currentIndex - 1;\n          }\n          break;\n        case 'ArrowRight':\n          if (orientation === 'horizontal' || orientation === 'grid') {\n            e.preventDefault();\n            nextIndex = currentIndex + 1;\n          }\n          break;\n        case 'ArrowLeft':\n          if (orientation === 'horizontal' || orientation === 'grid') {\n            e.preventDefault();\n            nextIndex = currentIndex - 1;\n          }\n          break;\n        case 'Home':\n          e.preventDefault();\n          nextIndex = 0;\n          break;\n        case 'End':\n          e.preventDefault();\n          nextIndex = items.length - 1;\n          break;\n        case 'Enter':\n        case ' ':\n          if (onSelect) {\n            e.preventDefault();\n            onSelect(items[currentIndex]);\n          }\n          break;\n        default:\n          return;\n      }\n\n      // Handle looping\n      if (loop) {\n        nextIndex = (nextIndex + items.length) % items.length;\n      } else {\n        nextIndex = Math.max(0, Math.min(nextIndex, items.length - 1));\n      }\n\n      if (nextIndex !== currentIndex) {\n        items[nextIndex]?.focus();\n      }\n    };\n\n    container.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      container.removeEventListener('keydown', handleKeyDown);\n    };\n  }\n}\n\n/**\n * Skip link helper for main content navigation\n */\nexport const setupSkipLinks = (): void => {\n  // Ensure skip links are present\n  const skipLinks = [\n    { id: 'skip-to-main', target: 'main-content', text: 'Skip to main content' },\n    { id: 'skip-to-nav', target: 'main-navigation', text: 'Skip to navigation' },\n    { id: 'skip-to-footer', target: 'page-footer', text: 'Skip to footer' },\n  ];\n\n  const existingContainer = document.getElementById('skip-links-container');\n  if (existingContainer) return; // Already setup\n\n  const container = document.createElement('div');\n  container.id = 'skip-links-container';\n  container.className = 'sr-only-focusable';\n\n  skipLinks.forEach(({ id, target, text }) => {\n    const targetElement = document.getElementById(target);\n    if (!targetElement) return;\n\n    const link = document.createElement('a');\n    link.id = id;\n    link.href = `#${target}`;\n    link.textContent = text;\n    link.className = 'skip-link';\n\n    link.addEventListener('click', e => {\n      e.preventDefault();\n      targetElement.focus();\n      targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });\n    });\n\n    container.appendChild(link);\n  });\n\n  document.body.insertBefore(container, document.body.firstChild);\n};\n\n/**\n * Add ARIA labels to elements missing them\n */\nexport const addMissingAriaLabels = (container: HTMLElement = document.body): void => {\n  // Buttons without labels\n  const buttons = container.querySelectorAll<HTMLButtonElement>('button:not([aria-label])');\n  buttons.forEach(button => {\n    if (!button.textContent?.trim() && !button.getAttribute('aria-labelledby')) {\n      const iconHint = button.querySelector('[class*=\"icon\"]')?.className || '';\n      button.setAttribute('aria-label', `Button with ${iconHint || 'no label'}`);\n      console.warn('Button missing aria-label:', button);\n    }\n  });\n\n  // Links without text\n  const links = container.querySelectorAll<HTMLAnchorElement>('a:not([aria-label])');\n  links.forEach(link => {\n    if (!link.textContent?.trim() && !link.getAttribute('aria-labelledby')) {\n      const href = link.getAttribute('href');\n      link.setAttribute('aria-label', `Link to ${href || 'unknown destination'}`);\n      console.warn('Link missing aria-label:', link);\n    }\n  });\n\n  // Form inputs without labels\n  const inputs = container.querySelectorAll<HTMLInputElement>(\n    'input:not([aria-label]):not([aria-labelledby])'\n  );\n  inputs.forEach(input => {\n    const id = input.getAttribute('id');\n    const label = id ? container.querySelector<HTMLLabelElement>(`label[for=\"${id}\"]`) : null;\n\n    if (!label) {\n      const placeholder = input.getAttribute('placeholder');\n      input.setAttribute('aria-label', placeholder || 'Input field');\n      console.warn('Input missing label:', input);\n    }\n  });\n};\n\n/**\n * Validate ARIA implementation\n */\nexport const validateARIA = (\n  container: HTMLElement = document.body\n): {\n  errors: string[];\n  warnings: string[];\n} => {\n  const errors: string[] = [];\n  const warnings: string[] = [];\n\n  // Check for ARIA role validity\n  const elementsWithRoles = container.querySelectorAll('[role]');\n  const validRoles = [\n    'alert',\n    'alertdialog',\n    'application',\n    'article',\n    'banner',\n    'button',\n    'checkbox',\n    'dialog',\n    'grid',\n    'gridcell',\n    'heading',\n    'img',\n    'link',\n    'list',\n    'listbox',\n    'listitem',\n    'main',\n    'menu',\n    'menubar',\n    'menuitem',\n    'navigation',\n    'progressbar',\n    'radio',\n    'radiogroup',\n    'region',\n    'row',\n    'rowheader',\n    'search',\n    'slider',\n    'spinbutton',\n    'status',\n    'tab',\n    'tablist',\n    'tabpanel',\n    'textbox',\n    'toolbar',\n    'tooltip',\n    'tree',\n    'treegrid',\n    'treeitem',\n  ];\n\n  elementsWithRoles.forEach(el => {\n    const role = el.getAttribute('role');\n    if (role && !validRoles.includes(role)) {\n      errors.push(`Invalid ARIA role: ${role} on element ${el.tagName}`);\n    }\n  });\n\n  // Check for required aria-labelledby references\n  const labelledByElements = container.querySelectorAll('[aria-labelledby]');\n  labelledByElements.forEach(el => {\n    const ids = el.getAttribute('aria-labelledby')?.split(' ') || [];\n    ids.forEach(id => {\n      if (!document.getElementById(id)) {\n        warnings.push(`aria-labelledby references non-existent ID: ${id}`);\n      }\n    });\n  });\n\n  // Check for required aria-describedby references\n  const describedByElements = container.querySelectorAll('[aria-describedby]');\n  describedByElements.forEach(el => {\n    const ids = el.getAttribute('aria-describedby')?.split(' ') || [];\n    ids.forEach(id => {\n      if (!document.getElementById(id)) {\n        warnings.push(`aria-describedby references non-existent ID: ${id}`);\n      }\n    });\n  });\n\n  return { errors, warnings };\n};\n\n/**\n * Enhance form accessibility\n */\nexport const enhanceFormAccessibility = (form: HTMLFormElement): void => {\n  // Add required indicators\n  const requiredInputs = form.querySelectorAll<HTMLInputElement>('[required]');\n  requiredInputs.forEach(input => {\n    input.setAttribute('aria-required', 'true');\n\n    // Add visual indicator if missing\n    const label = form.querySelector<HTMLLabelElement>(`label[for=\"${input.id}\"]`);\n    if (label && !label.querySelector('.required-indicator')) {\n      const indicator = document.createElement('span');\n      indicator.className = 'required-indicator text-red-500';\n      indicator.setAttribute('aria-hidden', 'true');\n      indicator.textContent = ' *';\n      label.appendChild(indicator);\n    }\n  });\n\n  // Enhance error messages\n  const inputs = form.querySelectorAll<HTMLInputElement>('input, textarea, select');\n  inputs.forEach(input => {\n    input.addEventListener('invalid', e => {\n      e.preventDefault();\n\n      const errorId = `${input.id}-error`;\n      let errorElement = document.getElementById(errorId);\n\n      if (!errorElement) {\n        errorElement = document.createElement('div');\n        errorElement.id = errorId;\n        errorElement.className = 'error-message text-red-600 text-sm mt-1';\n        errorElement.setAttribute('role', 'alert');\n        input.parentElement?.appendChild(errorElement);\n      }\n\n      errorElement.textContent = input.validationMessage;\n      input.setAttribute('aria-invalid', 'true');\n      input.setAttribute('aria-describedby', errorId);\n\n      announceToScreenReader(`Error: ${input.validationMessage}`, 'assertive');\n    });\n\n    input.addEventListener('input', () => {\n      if (input.validity.valid) {\n        input.removeAttribute('aria-invalid');\n        const errorId = `${input.id}-error`;\n        const errorElement = document.getElementById(errorId);\n        if (errorElement) {\n          errorElement.remove();\n        }\n      }\n    });\n  });\n};\n","import { useEffect } from 'react';\nimport {\n  setupSkipLinks,\n  addMissingAriaLabels,\n  validateARIA,\n  announceToScreenReader,\n} from '../utils/accessibility';\n\n/**\n * Global Accessibility Hook\n *\n * Initializes and maintains accessibility features across the application.\n * Should be called once at the app level.\n */\nexport const useGlobalAccessibility = (\n  options: {\n    enableValidation?: boolean;\n    enableAutoLabeling?: boolean;\n    announceRouteChanges?: boolean;\n  } = {}\n) => {\n  const {\n    enableValidation = process.env.NODE_ENV === 'development',\n    enableAutoLabeling = true,\n    announceRouteChanges = true,\n  } = options;\n\n  useEffect(() => {\n    // Setup skip links\n    setupSkipLinks();\n\n    // Add missing ARIA labels in development\n    if (enableAutoLabeling) {\n      const interval = setInterval(() => {\n        addMissingAriaLabels();\n      }, 5000); // Check every 5 seconds\n\n      return () => clearInterval(interval);\n    }\n  }, [enableAutoLabeling]);\n\n  useEffect(() => {\n    // Validate ARIA in development\n    if (enableValidation) {\n      const validateInterval = setInterval(() => {\n        const { errors, warnings } = validateARIA();\n\n        if (errors.length > 0) {\n          console.error('ARIA Validation Errors:', errors);\n        }\n\n        if (warnings.length > 0) {\n          console.warn('ARIA Validation Warnings:', warnings);\n        }\n      }, 10000); // Check every 10 seconds\n\n      return () => clearInterval(validateInterval);\n    }\n  }, [enableValidation]);\n\n  useEffect(() => {\n    // Announce route changes\n    if (announceRouteChanges) {\n      const observer = new MutationObserver(mutations => {\n        mutations.forEach(mutation => {\n          if (mutation.type === 'childList' && mutation.target === document.body) {\n            const title = document.title;\n            announceToScreenReader(`Navigated to: ${title}`, 'polite', 1000);\n          }\n        });\n      });\n\n      observer.observe(document.body, {\n        childList: true,\n        subtree: true,\n      });\n\n      return () => observer.disconnect();\n    }\n  }, [announceRouteChanges]);\n\n  // Add global keyboard shortcuts\n  useEffect(() => {\n    const handleGlobalKeyboard = (e: KeyboardEvent) => {\n      // Ctrl/Cmd + / to show keyboard shortcuts\n      if ((e.ctrlKey || e.metaKey) && e.key === '/') {\n        e.preventDefault();\n        const event = new CustomEvent('showKeyboardShortcuts');\n        window.dispatchEvent(event);\n      }\n\n      // Escape to close modals (handled by components but announced here)\n      if (e.key === 'Escape') {\n        const openModal = document.querySelector('[role=\"dialog\"][aria-modal=\"true\"]');\n        if (openModal) {\n          announceToScreenReader('Modal closed', 'polite');\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleGlobalKeyboard);\n    return () => document.removeEventListener('keydown', handleGlobalKeyboard);\n  }, []);\n\n  return {\n    announceMessage: announceToScreenReader,\n  };\n};\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\nimport LanguageDetector from 'i18next-browser-languagedetector';\nimport en from './locales/en.json';\nimport fr from './locales/fr.json';\nimport es from './locales/es.json';\n\nconst resources = {\n  en: { translation: en },\n  fr: { translation: fr },\n  es: { translation: es },\n};\n\ni18n\n  .use(LanguageDetector)\n  .use(initReactI18next)\n  .init({\n    resources,\n    fallbackLng: 'en',\n    debug: import.meta.env.DEV,\n\n    interpolation: {\n      escapeValue: false,\n    },\n\n    detection: {\n      order: ['localStorage', 'navigator', 'htmlTag'],\n      caches: ['localStorage'],\n    },\n\n    react: {\n      useSuspense: false,\n    },\n  });\n\nexport default i18n;\n","// Enhanced PWA utility functions for Pain Tracker\n// Note: offlineStorage and backgroundSync loaded dynamically for code splitting\nimport { formatNumber } from './formatting';\nimport { secureStorage } from '../lib/storage/secureStorage';\n\n// Lightweight declaration for BeforeInstallPromptEvent for environments\n// where the DOM lib may not include it by default.\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\ninterface OfflineData {\n  entries: unknown[];\n  settings: Record<string, unknown>;\n  timestamp: string;\n  syncQueue?: unknown[];\n}\n\ninterface SyncManager {\n  register(tag: string): Promise<void>;\n}\n\ntype MaybeForceSync = {\n  forceSync?: () => Promise<unknown>;\n  forcSync?: () => Promise<unknown>;\n};\n\ninterface PWACapabilities {\n  serviceWorker: boolean;\n  pushNotifications: boolean;\n  backgroundSync: boolean;\n  persistentStorage: boolean;\n  installPrompt: boolean;\n  fullscreen: boolean;\n}\n\nexport class PWAManager {\n  private static instance: PWAManager;\n  private installPromptEvent: BeforeInstallPromptEvent | null = null;\n  private isInstalled = false;\n  private swRegistration: ServiceWorkerRegistration | null = null;\n  private isInitialized = false;\n  private capabilities: PWACapabilities = {\n    serviceWorker: false,\n    pushNotifications: false,\n    backgroundSync: false,\n    persistentStorage: false,\n    installPrompt: false,\n    fullscreen: false,\n  };\n\n  private constructor() {\n    // Delayed initialization to ensure DOM is ready\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', () => this.init());\n    } else {\n      this.init();\n    }\n  }\n\n  static getInstance(): PWAManager {\n    if (!PWAManager.instance) {\n      PWAManager.instance = new PWAManager();\n    }\n    return PWAManager.instance;\n  }\n\n  private async init() {\n    if (this.isInitialized) return;\n\n    if (process.env.NODE_ENV === 'development') {\n      console.log('PWA: Initializing PWA Manager');\n    }\n    this.checkInstallStatus();\n    this.setupInstallPromptListener();\n    await this.detectCapabilities();\n    await this.registerServiceWorker();\n    await this.initializeOfflineStorage();\n    this.setupOnlineOfflineListeners();\n    this.setupPerformanceMonitoring();\n\n    this.isInitialized = true;\n    this.dispatchCustomEvent('pwa-initialized', { capabilities: this.capabilities });\n  }\n\n  // Capability Detection\n  private async detectCapabilities(): Promise<void> {\n    this.capabilities.serviceWorker = 'serviceWorker' in navigator;\n    this.capabilities.pushNotifications = 'Notification' in window && 'PushManager' in window;\n    this.capabilities.backgroundSync =\n      'serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype;\n    this.capabilities.installPrompt = 'BeforeInstallPromptEvent' in window;\n    this.capabilities.fullscreen = 'requestFullscreen' in document.documentElement;\n\n    // Check for persistent storage\n    if ('storage' in navigator && 'persist' in navigator.storage) {\n      this.capabilities.persistentStorage = await navigator.storage.persist();\n    }\n  }\n\n  getCapabilities(): PWACapabilities {\n    return { ...this.capabilities };\n  }\n\n  // Enhanced Storage Initialization\n  private async initializeOfflineStorage(): Promise<void> {\n    try {\n      const { offlineStorage } = await import('../lib/offline-storage');\n      await offlineStorage.init();\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Offline storage initialized');\n      }\n\n      // Request persistent storage for critical health data\n      if ('storage' in navigator && 'persist' in navigator.storage) {\n        const persistent = await navigator.storage.persist();\n        if (process.env.NODE_ENV === 'development') {\n          console.log('PWA: Persistent storage:', persistent ? 'granted' : 'denied');\n        }\n\n        if (persistent) {\n          this.dispatchCustomEvent('pwa-persistent-storage-granted');\n        }\n      }\n    } catch (error) {\n      console.error('PWA: Failed to initialize offline storage:', error);\n      this.dispatchCustomEvent('pwa-storage-error', { error });\n    }\n  }\n  // Enhanced Service Worker Registration\n  private async registerServiceWorker(): Promise<void> {\n    if (!this.capabilities.serviceWorker) {\n      console.warn('PWA: Service Workers not supported');\n      return;\n    }\n\n    // Skip service worker in development if there are issues\n    if (import.meta.env.DEV && import.meta.env.VITE_SKIP_SW === 'true') {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Service Worker disabled in development mode');\n      }\n      return;\n    }\n\n    try {\n      // Prefer explicit Vite-provided base override (VITE_BASE) for test runs,\n      // otherwise fall back to Vite's BASE_URL and finally '/'.\n      const _env = import.meta.env as unknown as Record<string, string | undefined>;\n      let baseUrl = (_env.VITE_BASE as string) || (import.meta.env.BASE_URL as string) || '/';\n\n      // Normalise cases where Vite gives a relative './' base (e.g. relative build).\n      // In test/dev servers the runtime location.pathname usually reflects the actual base\n      // (for example '/pain-tracker/'), so prefer that when BASE_URL is './' or otherwise\n      // doesn't start with '/'. This prevents registering './' as the scope which some\n      // tests interpret literally and cause manifest/start_url mismatches.\n      try {\n        if (!baseUrl || baseUrl === './' || !baseUrl.startsWith('/')) {\n          const locBase = location.pathname.endsWith('/') ? location.pathname : location.pathname + '/';\n          baseUrl = locBase || '/';\n        }\n      } catch {\n        // If location isn't available for some reason, fall back to '/'\n        baseUrl = baseUrl === './' ? '/' : baseUrl;\n      }\n\n      const swPath = `${baseUrl}sw.js`.replace(/\\/\\/+/, '/'); // Clean up double slashes\n\n      this.swRegistration = await navigator.serviceWorker.register(swPath, {\n        scope: baseUrl,\n        updateViaCache: 'none', // Force check for updates every time\n      });\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Service Worker registered successfully', this.swRegistration);\n      }\n\n      // Listen for service worker updates\n      this.swRegistration.addEventListener('updatefound', () => {\n        const newWorker = this.swRegistration?.installing;\n        if (newWorker) {\n          newWorker.addEventListener('statechange', () => {\n            if (newWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // New content is available\n                this.notifyUpdate();\n              } else {\n                // Content is cached for first time\n                this.notifyInstalled();\n              }\n            }\n          });\n        }\n      });\n\n      // Setup message listener for service worker communication\n      navigator.serviceWorker.addEventListener('message', event => {\n        this.handleServiceWorkerMessage(event);\n      });\n\n      // Lightweight handshake: set a global flag when the service worker signals readiness\n      try {\n        // Listen for SW_READY or PONG messages (the SW posts SW_READY on activation and\n        // responds to PING with PONG). This provides a reliable readiness signal for tests.\n        navigator.serviceWorker.addEventListener('message', (ev) => {\n          try {\n            const data = (ev && ev.data) || {};\n            if (data.type === 'SW_READY' || data.type === 'PONG') {\n              // Mark page-level readiness for tests/tools that await this flag.\n              // Use a typed-free assignment to avoid TSC strict-any lint errors.\n              (window as unknown as Record<string, unknown>).__pwa_sw_ready = true;\n              (window as unknown as Record<string, unknown>).__pwa_sw_version = data.version || (this.swRegistration && (this.swRegistration as unknown as Record<string, unknown>).__SW_VERSION) || null;\n            }\n          } catch {\n            // ignore\n          }\n        });\n\n        // If the registration is already active, probe it with a PING and set the flag\n        // if we get a response. Don't block init if this fails.\n        (async () => {\n          try {\n            if (this.swRegistration && this.swRegistration.active) {\n              try {\n                this.swRegistration.active.postMessage({ type: 'PING' });\n              } catch {\n                // ignore\n              }\n              // Also set the flag optimistically if the active worker exists\n              (window as unknown as Record<string, unknown>).__pwa_sw_ready = true;\n              (window as unknown as Record<string, unknown>).__pwa_sw_version = (this.swRegistration.active && (this.swRegistration as unknown as Record<string, unknown>).__SW_VERSION) || null;\n            }\n          } catch {\n            // ignore\n          }\n        })();\n      } catch {\n        // ignore\n      }\n\n      // Setup background sync if supported\n      if (this.capabilities.backgroundSync) {\n        this.setupBackgroundSync();\n      }\n\n      // Monitor service worker performance\n      this.monitorServiceWorkerPerformance();\n    } catch (error) {\n      console.error('PWA: Service Worker registration failed:', error);\n      this.dispatchCustomEvent('pwa-sw-registration-failed', { error });\n    }\n  }\n\n  /**\n   * Test hook: triggers service worker registration explicitly for unit tests.\n   * No-op if already registered or capability unsupported.\n   */\n  public async __test_registerSW(): Promise<void> {\n    if (this.swRegistration || !this.capabilities.serviceWorker) return;\n    await this.registerServiceWorker();\n  }\n\n  private handleServiceWorkerMessage(event: MessageEvent): void {\n    const { data } = event;\n\n    switch (data.type) {\n      case 'SW_UPDATE_AVAILABLE':\n        this.dispatchCustomEvent('pwa-update-available');\n        break;\n      case 'SW_OFFLINE_FALLBACK':\n        this.dispatchCustomEvent('pwa-offline-fallback', { url: data.url });\n        break;\n      case 'SW_CACHE_UPDATED':\n        this.dispatchCustomEvent('pwa-cache-updated', { cacheName: data.cacheName });\n        break;\n      case 'SW_SYNC_COMPLETED':\n        this.dispatchCustomEvent('pwa-sync-completed', { stats: data.stats });\n        break;\n    }\n  }\n\n  private monitorServiceWorkerPerformance(): void {\n    if (!this.swRegistration) return;\n\n    // Monitor cache hit ratio\n    let cacheHits = 0;\n    let cacheMisses = 0;\n\n    navigator.serviceWorker.addEventListener('message', event => {\n      if (event.data.type === 'CACHE_HIT') {\n        cacheHits++;\n      } else if (event.data.type === 'CACHE_MISS') {\n        cacheMisses++;\n      }\n    });\n\n    // Report performance metrics periodically\n    setInterval(() => {\n      const total = cacheHits + cacheMisses;\n      if (total > 0) {\n        const hitRatio = (cacheHits / total) * 100;\n        this.dispatchCustomEvent('pwa-cache-performance', {\n          hitRatio: Number(formatNumber(hitRatio, 2)),\n          totalRequests: total,\n        });\n\n        // Reset counters\n        cacheHits = 0;\n        cacheMisses = 0;\n      }\n    }, 60000); // Every minute\n  }\n\n  // Install Prompt Management\n  private setupInstallPromptListener(): void {\n    // cspell:ignore beforeinstallprompt appinstalled\n    window.addEventListener('beforeinstallprompt', e => {\n      e.preventDefault();\n      this.installPromptEvent = e as BeforeInstallPromptEvent;\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Install prompt available');\n      }\n      this.dispatchCustomEvent('pwa-install-available');\n    });\n\n    window.addEventListener('appinstalled', () => {\n      this.isInstalled = true;\n      this.installPromptEvent = null;\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: App installed successfully');\n      }\n      this.dispatchCustomEvent('pwa-installed');\n    });\n  }\n\n  async showInstallPrompt(): Promise<boolean> {\n    if (!this.installPromptEvent) {\n      return false;\n    }\n\n    try {\n      await this.installPromptEvent.prompt();\n      const choiceResult = await this.installPromptEvent.userChoice;\n\n      if (choiceResult.outcome === 'accepted') {\n        if (process.env.NODE_ENV === 'development') {\n          console.log('PWA: User accepted install prompt');\n        }\n        return true;\n      } else {\n        if (process.env.NODE_ENV === 'development') {\n          console.log('PWA: User dismissed install prompt');\n        }\n        return false;\n      }\n    } catch (error) {\n      console.error('PWA: Error showing install prompt:', error);\n      return false;\n    }\n  }\n\n  isInstallPromptAvailable(): boolean {\n    return this.installPromptEvent !== null;\n  }\n\n  // Installation Status\n  private checkInstallStatus(): void {\n    // Check if running as PWA\n    if (window.matchMedia('(display-mode: standalone)').matches) {\n      this.isInstalled = true;\n    }\n\n    // Check if running in mobile app mode\n    if ((window.navigator as Navigator & { standalone?: boolean }).standalone) {\n      this.isInstalled = true;\n    }\n  }\n\n  isAppInstalled(): boolean {\n    return this.isInstalled;\n  }\n\n  // Enhanced Online/Offline Management with Background Sync Integration\n  private setupOnlineOfflineListeners(): void {\n    window.addEventListener('online', async () => {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Back online');\n      }\n      await this.handleOnlineStatus(true);\n      this.dispatchCustomEvent('pwa-online');\n    });\n\n    window.addEventListener('offline', () => {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Gone offline');\n      }\n      this.handleOnlineStatus(false);\n      this.dispatchCustomEvent('pwa-offline');\n    });\n\n    // Monitor connection quality\n    this.monitorConnectionQuality();\n  }\n\n  private async handleOnlineStatus(isOnline: boolean): Promise<void> {\n    if (isOnline) {\n      // Trigger background sync when coming back online\n      try {\n        const { backgroundSync } = await import('../lib/background-sync');\n        // Support legacy typo (forcSync) and future corrected (forceSync)\n        const svc = backgroundSync as unknown as MaybeForceSync;\n        if (typeof svc.forceSync === 'function') {\n          await svc.forceSync();\n        } else if (typeof svc.forcSync === 'function') {\n          await svc.forcSync();\n        }\n\n        // Notify service worker\n        if (this.swRegistration?.active) {\n          this.swRegistration.active.postMessage({ type: 'ONLINE' });\n        }\n\n        // Trigger background sync registration if supported\n        if ('sync' in this.swRegistration!) {\n          try {\n            const reg = this.swRegistration as ServiceWorkerRegistration & { sync: SyncManager };\n            await reg.sync.register('pain-tracker-sync');\n          } catch (error) {\n            console.error('PWA: Background sync registration failed:', error);\n          }\n        }\n      } catch (error) {\n        console.error('PWA: Failed to sync data when coming online:', error);\n      }\n    }\n  }\n\n  private monitorConnectionQuality(): void {\n    // Monitor connection using Network Information API if available\n    if ('connection' in navigator) {\n      type NetworkInformationLike = {\n        effectiveType?: string;\n        downlink?: number;\n        rtt?: number;\n        saveData?: boolean;\n        addEventListener?: (type: string, listener: () => void) => void;\n      };\n      const connection = (navigator as Navigator & { connection?: NetworkInformationLike })\n        .connection;\n\n      const updateConnectionInfo = () => {\n        if (!connection) return;\n        this.dispatchCustomEvent('pwa-connection-change', {\n          effectiveType: connection.effectiveType,\n          downlink: connection.downlink,\n          rtt: connection.rtt,\n          saveData: connection.saveData,\n        });\n      };\n\n      if (connection && typeof connection.addEventListener === 'function') {\n        connection.addEventListener('change', updateConnectionInfo);\n      }\n      updateConnectionInfo(); // Initial check\n    }\n\n    // Fallback: Periodic connection quality test\n    this.startConnectionQualityTests();\n  }\n\n  private startConnectionQualityTests(): void {\n    setInterval(async () => {\n      if (!navigator.onLine) return;\n\n      const startTime = performance.now();\n      try {\n        // Use the correct base URL for manifest.json\n        const baseUrl = import.meta.env.BASE_URL || '/';\n        const manifestUrl = `${baseUrl}manifest.json`.replace(/\\/+/g, '/');\n\n        await fetch(manifestUrl, {\n          mode: 'cors',\n          cache: 'no-cache',\n        });\n        const endTime = performance.now();\n        const latency = endTime - startTime;\n\n        this.dispatchCustomEvent('pwa-connection-test', {\n          latency,\n          quality: latency < 100 ? 'good' : latency < 500 ? 'moderate' : 'poor',\n        });\n      } catch {\n        this.dispatchCustomEvent('pwa-connection-test', {\n          latency: -1,\n          quality: 'offline',\n        });\n      }\n    }, 30000); // Test every 30 seconds\n  }\n\n  private setupPerformanceMonitoring(): void {\n    // Monitor PWA performance metrics\n    if ('performance' in window) {\n      // Monitor navigation timing\n      window.addEventListener('load', () => {\n        setTimeout(() => {\n          const navigation = performance.getEntriesByType(\n            'navigation'\n          )[0] as PerformanceNavigationTiming;\n\n          this.dispatchCustomEvent('pwa-performance-metrics', {\n            loadTime: navigation.loadEventEnd - navigation.fetchStart,\n            domContentLoaded: navigation.domContentLoadedEventEnd - navigation.fetchStart,\n            firstPaint: this.getFirstPaint(),\n            cacheHitRatio: this.getCacheHitRatio(),\n          });\n        }, 0);\n      });\n\n      // Monitor resource timing\n      const observer = new PerformanceObserver(list => {\n        const entries = list.getEntries();\n        const slowResources = entries.filter(entry => entry.duration > 1000);\n\n        if (slowResources.length > 0) {\n          this.dispatchCustomEvent('pwa-slow-resources', {\n            resources: slowResources.map(entry => {\n              const resource = entry as PerformanceResourceTiming;\n              return {\n                name: entry.name,\n                duration: entry.duration,\n                size: resource.transferSize || 0,\n              };\n            }),\n          });\n        }\n      });\n\n      observer.observe({ type: 'resource', buffered: true });\n    }\n  }\n\n  private getFirstPaint(): number {\n    const paintEntries = performance.getEntriesByType('paint');\n    const firstPaint = paintEntries.find(entry => entry.name === 'first-paint');\n    return firstPaint ? firstPaint.startTime : 0;\n  }\n\n  private getCacheHitRatio(): number {\n    // This would be populated by service worker messages\n    // Non-sensitive metric; avoid encryption overhead\n    const ratio = secureStorage.get<string>('pwa-cache-hit-ratio');\n    return parseFloat(ratio || '0');\n  }\n\n  isOnline(): boolean {\n    return navigator.onLine;\n  }\n\n  // Push Notifications\n  async requestNotificationPermission(): Promise<NotificationPermission> {\n    if (!('Notification' in window)) {\n      console.warn('PWA: This browser does not support notifications');\n      return 'denied';\n    }\n\n    if (Notification.permission === 'default') {\n      return await Notification.requestPermission();\n    }\n\n    return Notification.permission;\n  }\n\n  async subscribeToPushNotifications(): Promise<PushSubscription | null> {\n    if (!this.swRegistration) {\n      console.error('PWA: Service Worker not registered');\n      return null;\n    }\n\n    try {\n      const permission = await this.requestNotificationPermission();\n      if (permission !== 'granted') {\n        console.warn('PWA: Notification permission not granted');\n        return null;\n      }\n\n      const applicationServerKey = (import.meta as unknown as { env?: Record<string, string> }).env\n        ?.VITE_VAPID_PUBLIC_KEY;\n      if (!applicationServerKey) {\n        console.error('PWA: VAPID public key not found');\n        return null;\n      }\n\n      const subscription = await this.swRegistration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: this.urlBase64ToUint8Array(applicationServerKey)\n          .buffer as ArrayBuffer,\n      });\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Push subscription created:', subscription);\n      }\n      return subscription;\n    } catch (error) {\n      console.error('PWA: Failed to subscribe to push notifications:', error);\n      return null;\n    }\n  }\n\n  // Medication Reminders\n  async scheduleNotification(title: string, body: string, delay: number): Promise<void> {\n    if (!('Notification' in window)) return;\n\n    const permission = await this.requestNotificationPermission();\n    if (permission !== 'granted') return;\n\n    setTimeout(() => {\n      const baseUrl = import.meta.env.BASE_URL || '/';\n      new Notification(title, {\n        body,\n        icon: `${baseUrl}icons/icon-192x192.png`.replace(/\\/+/g, '/'),\n        badge: `${baseUrl}icons/badge-72x72.png`.replace(/\\/+/g, '/'),\n        tag: 'pain-tracker-reminder',\n        requireInteraction: true,\n      });\n    }, delay);\n  }\n\n  // Background Sync\n  private setupBackgroundSync(): void {\n    if (this.swRegistration && 'sync' in this.swRegistration) {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Background sync is supported');\n      }\n    } else {\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Background sync is not supported');\n      }\n    }\n  }\n\n  // App Updates\n  private notifyUpdate(): void {\n    this.dispatchCustomEvent('pwa-update-available');\n  }\n\n  private notifyInstalled(): void {\n    this.dispatchCustomEvent('pwa-content-cached');\n  }\n\n  async updateApp(): Promise<void> {\n    if (this.swRegistration) {\n      const registration = this.swRegistration;\n      if (registration.waiting) {\n        // Tell the waiting SW to skip waiting\n        registration.waiting.postMessage({ type: 'SKIP_WAITING' });\n\n        // Reload the page to activate the new service worker\n        window.location.reload();\n      }\n    }\n  }\n\n  // Utility Methods\n  private dispatchCustomEvent(type: string, detail?: unknown): void {\n    const event = new CustomEvent(type, { detail });\n    window.dispatchEvent(event);\n  }\n\n  private urlBase64ToUint8Array(base64String: string): Uint8Array {\n    const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\n    const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\n\n    const rawData = window.atob(base64);\n    const outputArray = new Uint8Array(rawData.length);\n\n    for (let i = 0; i < rawData.length; ++i) {\n      outputArray[i] = rawData.charCodeAt(i);\n    }\n    return outputArray;\n  }\n\n  // Cache Management\n  async clearCaches(): Promise<void> {\n    if ('caches' in window) {\n      const cacheNames = await caches.keys();\n      await Promise.all(cacheNames.map(cacheName => caches.delete(cacheName)));\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: All caches cleared');\n      }\n    }\n  }\n\n  async getCacheSize(): Promise<number> {\n    if (!('storage' in navigator && 'estimate' in navigator.storage)) {\n      return 0;\n    }\n\n    try {\n      const estimate = await navigator.storage.estimate();\n      return estimate.usage || 0;\n    } catch (error) {\n      console.error('PWA: Failed to get cache size:', error);\n      return 0;\n    }\n  }\n\n  // Enhanced Data Management with Offline Support\n  async exportOfflineData(): Promise<OfflineData> {\n    try {\n      // Export from IndexedDB for complete offline data\n      const { offlineStorage } = await import('../lib/offline-storage');\n      const offlineDataExport = await offlineStorage.exportData();\n\n      // Combine with localStorage data\n      const localData = {\n        entries: secureStorage.safeJSON('painEntries', []),\n        settings: secureStorage.safeJSON('pain-tracker-settings', {}),\n        timestamp: new Date().toISOString(),\n        syncQueue: offlineDataExport.syncQueue,\n      };\n\n      return localData;\n    } catch (error) {\n      console.error('PWA: Failed to export offline data:', error);\n      throw error;\n    }\n  }\n\n  async importOfflineData(data: OfflineData): Promise<void> {\n    try {\n      // Import to localStorage\n      if (data.entries) secureStorage.set('painEntries', data.entries);\n      if (data.settings) secureStorage.set('pain-tracker-settings', data.settings);\n\n      // Import sync queue if available\n      if (data.syncQueue) {\n        // Import sync queue items to IndexedDB\n        const { offlineStorage } = await import('../lib/offline-storage');\n        for (const item of data.syncQueue) {\n          // Ensure item matches expected sync queue shape before adding\n          const queueItem = item as {\n            url: string;\n            method: string;\n            headers?: Record<string, string>;\n            body?: unknown;\n            priority?: 'high' | 'medium' | 'low';\n            type?: string;\n            metadata?: Record<string, unknown>;\n          };\n          await offlineStorage.addToSyncQueue({\n            url: queueItem.url,\n            method: queueItem.method,\n            headers: queueItem.headers || {},\n            body:\n              typeof queueItem.body === 'string'\n                ? queueItem.body\n                : JSON.stringify(queueItem.body || {}),\n            priority: queueItem.priority || 'medium',\n            type: queueItem.type || 'sync',\n          });\n        }\n      }\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Data imported successfully');\n      }\n      this.dispatchCustomEvent('pwa-data-imported');\n    } catch (error) {\n      console.error('PWA: Failed to import offline data:', error);\n      throw error;\n    }\n  }\n\n  // Health Data Specific PWA Features\n  async enableHealthDataSync(): Promise<boolean> {\n    try {\n      // Request persistent storage for health data\n      if ('storage' in navigator && 'persist' in navigator.storage) {\n        const persistent = await navigator.storage.persist();\n        if (!persistent) {\n          console.warn('PWA: Persistent storage not granted for health data');\n          return false;\n        }\n      }\n\n      // Enable background sync for health data\n      if (this.swRegistration && 'sync' in this.swRegistration) {\n        const reg = this.swRegistration as ServiceWorkerRegistration & { sync: SyncManager };\n        await reg.sync.register('health-data-sync');\n        if (process.env.NODE_ENV === 'development') {\n          console.log('PWA: Health data background sync enabled');\n        }\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      console.error('PWA: Failed to enable health data sync:', error);\n      return false;\n    }\n  }\n\n  async scheduleHealthReminder(title: string, body: string, triggerTime: Date): Promise<void> {\n    if (!('Notification' in window)) {\n      console.warn('PWA: Notifications not supported');\n      return;\n    }\n\n    const permission = await this.requestNotificationPermission();\n    if (permission !== 'granted') {\n      console.warn('PWA: Notification permission not granted');\n      return;\n    }\n\n    const now = new Date();\n    const delay = triggerTime.getTime() - now.getTime();\n\n    if (delay <= 0) {\n      // Show immediately if time has passed\n      this.showNotification(title, body);\n      return;\n    }\n\n    // Schedule for future\n    setTimeout(() => {\n      this.showNotification(title, body);\n    }, delay);\n\n    if (process.env.NODE_ENV === 'development') {\n      console.log(`PWA: Health reminder scheduled for ${triggerTime.toLocaleString()}`);\n    }\n  }\n\n  private showNotification(title: string, body: string): void {\n    const baseUrl = import.meta.env.BASE_URL || '/';\n    new Notification(title, {\n      body,\n      icon: `${baseUrl}icons/icon-192x192.png`.replace(/\\/+/g, '/'),\n      badge: `${baseUrl}icons/badge-72x72.png`.replace(/\\/+/g, '/'),\n      tag: 'health-reminder',\n      requireInteraction: true,\n      data: {\n        url: `${baseUrl}?reminder=true`.replace(/\\/+/g, '/'),\n        timestamp: new Date().toISOString(),\n      },\n    });\n  }\n\n  // PWA Status and Diagnostics\n  async getDiagnostics(): Promise<{\n    isInstalled: boolean;\n    hasServiceWorker: boolean;\n    isOnline: boolean;\n    storageUsage: { used: number; quota: number };\n    capabilities: PWACapabilities;\n    pendingSyncItems: number;\n    lastSync: string | null;\n  }> {\n    const { offlineStorage } = await import('../lib/offline-storage');\n    const { backgroundSync } = await import('../lib/background-sync');\n    const storageUsage = await offlineStorage.getStorageUsage();\n    const pendingSyncItems = await backgroundSync.getPendingItemsCount();\n    const lastSync = secureStorage.get<string>('last-sync-time');\n\n    return {\n      isInstalled: this.isInstalled,\n      hasServiceWorker: !!this.swRegistration,\n      isOnline: navigator.onLine,\n      storageUsage,\n      capabilities: this.capabilities,\n      pendingSyncItems,\n      lastSync,\n    };\n  }\n\n  async clearPWAData(): Promise<void> {\n    try {\n      // Clear service worker caches\n      await this.clearCaches();\n\n      // Clear IndexedDB\n      const { offlineStorage } = await import('../lib/offline-storage');\n      await offlineStorage.clearAllData();\n\n      // Clear all secureStorage-managed keys (namespaced)\n      secureStorage.keys().forEach(k => secureStorage.remove(k));\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: All PWA data cleared');\n      }\n      this.dispatchCustomEvent('pwa-data-cleared');\n    } catch (error) {\n      console.error('PWA: Failed to clear PWA data:', error);\n      throw error;\n    }\n  }\n\n  // Complete service worker reset for debugging\n  async resetServiceWorker(): Promise<void> {\n    try {\n      // Unregister all service workers\n      if ('serviceWorker' in navigator) {\n        const registrations = await navigator.serviceWorker.getRegistrations();\n        await Promise.all(registrations.map(reg => reg.unregister()));\n        if (process.env.NODE_ENV === 'development') {\n          console.log('PWA: All service workers unregistered');\n        }\n      }\n\n      // Clear all caches\n      await this.clearCaches();\n\n      // Clear PWA data\n      await this.clearPWAData();\n\n      if (process.env.NODE_ENV === 'development') {\n        console.log('PWA: Service worker completely reset');\n      }\n      this.dispatchCustomEvent('pwa-service-worker-reset');\n    } catch (error) {\n      console.error('PWA: Failed to reset service worker:', error);\n      throw error;\n    }\n  }\n\n  // Force refresh with cache bypass\n  async forceRefresh(): Promise<void> {\n    try {\n      // Clear caches first\n      await this.clearCaches();\n\n      // Force reload without cache\n      window.location.reload();\n    } catch (error) {\n      console.error('PWA: Failed to force refresh:', error);\n      // Fallback to normal reload\n      window.location.reload();\n    }\n  }\n\n  // Check if app needs update\n  async checkForUpdates(): Promise<boolean> {\n    if (!this.swRegistration) return false;\n\n    try {\n      await this.swRegistration.update();\n      return !!this.swRegistration.waiting;\n    } catch (error) {\n      console.error('PWA: Failed to check for updates:', error);\n      return false;\n    }\n  }\n}\n\n// Export singleton instance\nexport const pwaManager = PWAManager.getInstance();\n","import { useState, useEffect } from 'react';\nimport { Download, X, Smartphone, Sparkles, Wifi, Zap, Bell } from 'lucide-react';\nimport { pwaManager } from '../../utils/pwa-utils';\nimport { Button } from '../../design-system';\n\nexport function PWAInstallPrompt() {\n  const [showPrompt, setShowPrompt] = useState(false);\n  const [isInstalling, setIsInstalling] = useState(false);\n\n  useEffect(() => {\n    const handleInstallAvailable = () => {\n      if (!pwaManager.isAppInstalled()) {\n        setShowPrompt(true);\n      }\n    };\n\n    const handleInstalled = () => {\n      setShowPrompt(false);\n      setIsInstalling(false);\n    };\n\n    // Check if install prompt is already available\n    if (pwaManager.isInstallPromptAvailable() && !pwaManager.isAppInstalled()) {\n      setShowPrompt(true);\n    }\n\n    window.addEventListener('pwa-install-available', handleInstallAvailable);\n    window.addEventListener('pwa-installed', handleInstalled);\n\n    return () => {\n      window.removeEventListener('pwa-install-available', handleInstallAvailable);\n      window.removeEventListener('pwa-installed', handleInstalled);\n    };\n  }, []);\n\n  const handleInstall = async () => {\n    setIsInstalling(true);\n    try {\n      const success = await pwaManager.showInstallPrompt();\n      if (!success) {\n        setIsInstalling(false);\n      }\n    } catch (error) {\n      console.error('Failed to install PWA:', error);\n      setIsInstalling(false);\n    }\n  };\n\n  const handleDismiss = () => {\n    setShowPrompt(false);\n    // Remember dismissal for this session\n    sessionStorage.setItem('pwa-install-dismissed', 'true');\n  };\n\n  // Don't show if already dismissed this session\n  if (sessionStorage.getItem('pwa-install-dismissed')) {\n    return null;\n  }\n\n  if (!showPrompt) {\n    return null;\n  }\n\n  return (\n    <div\n      className=\"fixed bottom-4 left-4 z-50 max-w-sm w-[min(92%,420px)]\"\n      role=\"dialog\"\n      aria-label=\"Install Pain Tracker\"\n    >\n      {/* Glow effect behind card */}\n      <div \n        className=\"absolute -inset-2 rounded-3xl opacity-60 blur-xl\"\n        style={{ \n          background: 'linear-gradient(135deg, rgba(56, 189, 248, 0.3) 0%, rgba(168, 85, 247, 0.3) 100%)' \n        }}\n      />\n      \n      {/* Main card */}\n      <div \n        className=\"relative rounded-2xl overflow-hidden\"\n        style={{\n          background: 'linear-gradient(135deg, rgba(30, 41, 59, 0.98) 0%, rgba(15, 23, 42, 0.98) 100%)',\n          border: '1px solid rgba(56, 189, 248, 0.3)',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 40px rgba(56, 189, 248, 0.15)',\n        }}\n      >\n        {/* Gradient line at top */}\n        <div className=\"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-sky-400 to-transparent\" />\n        \n        <div className=\"p-5\">\n          <div className=\"flex items-start gap-4\">\n            {/* Icon */}\n            <div \n              className=\"flex-shrink-0 w-12 h-12 rounded-xl flex items-center justify-center\"\n              style={{ \n                background: 'linear-gradient(135deg, rgba(56, 189, 248, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%)',\n                boxShadow: '0 8px 20px rgba(56, 189, 248, 0.2)',\n              }}\n            >\n              <Smartphone className=\"h-6 w-6 text-sky-400\" />\n            </div>\n\n            {/* Content */}\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-center gap-2\">\n                <h3 className=\"text-base font-bold text-white\">Install Pain Tracker</h3>\n                <Sparkles className=\"h-4 w-4 text-amber-400\" />\n              </div>\n              <p className=\"text-sm text-slate-400 mt-1 leading-relaxed\">\n                Add to your home screen for quick access and offline tracking\n              </p>\n\n              {/* CTA Buttons */}\n              <div className=\"flex items-center gap-3 mt-4\">\n                <Button\n                  size=\"sm\"\n                  onClick={handleInstall}\n                  disabled={isInstalling}\n                  className=\"relative px-5 py-2.5 text-white font-medium transition-all duration-300 hover:scale-105\"\n                  style={{\n                    background: 'linear-gradient(135deg, #0ea5e9 0%, #8b5cf6 100%)',\n                    boxShadow: '0 8px 20px rgba(56, 189, 248, 0.3)',\n                  }}\n                >\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  <span>{isInstalling ? 'Installing...' : 'Install App'}</span>\n                </Button>\n\n                <button\n                  onClick={handleDismiss}\n                  className=\"p-2 rounded-lg text-slate-500 hover:text-slate-300 hover:bg-slate-800/50 transition-colors duration-200\"\n                  aria-label=\"Dismiss\"\n                >\n                  <X className=\"h-5 w-5\" />\n                </button>\n              </div>\n            </div>\n          </div>\n\n          {/* Benefits list */}\n          <div \n            className=\"mt-5 pt-4 grid grid-cols-3 gap-3\"\n            style={{ borderTop: '1px solid rgba(255, 255, 255, 0.1)' }}\n          >\n            {[\n              { icon: Wifi, label: 'Works offline', color: '#34d399' },\n              { icon: Zap, label: 'Lightning fast', color: '#38bdf8' },\n              { icon: Bell, label: 'Reminders', color: '#a855f7' },\n            ].map((benefit) => (\n              <div key={benefit.label} className=\"flex flex-col items-center text-center\">\n                <div \n                  className=\"w-8 h-8 rounded-lg flex items-center justify-center mb-1.5\"\n                  style={{ background: `${benefit.color}20` }}\n                >\n                  <benefit.icon className=\"h-4 w-4\" style={{ color: benefit.color }} />\n                </div>\n                <span className=\"text-[11px] text-slate-400\">{benefit.label}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState } from 'react';\n\ninterface PWAStatus {\n  isOnline: boolean;\n  pendingSync: number;\n  isSyncing: boolean;\n}\n\n/**\n * PWA Status Indicator Component\n * Shows offline/online status, sync status, and pending sync items\n */\nexport function PWAStatusIndicator() {\n  const [status, setStatus] = useState<PWAStatus>({\n    isOnline: navigator.onLine,\n    pendingSync: 0,\n    isSyncing: false,\n  });\n\n  useEffect(() => {\n    const updateStatus = async () => {\n      try {\n        // Get pending sync count if background sync is available\n        const { backgroundSync } = await import('../../lib/background-sync');\n        const pendingSync = await backgroundSync.getPendingItemsCount();\n        const { isSyncing } = backgroundSync.getSyncStatus();\n\n        setStatus(prev => ({\n          ...prev,\n          pendingSync,\n          isSyncing,\n        }));\n      } catch {\n        // Background sync not available, continue without it\n        setStatus(prev => ({\n          ...prev,\n          pendingSync: 0,\n          isSyncing: false,\n        }));\n      }\n    };\n\n    const handleOnline = () => {\n      setStatus(prev => ({ ...prev, isOnline: true }));\n      updateStatus(); // Refresh sync status when back online\n    };\n\n    const handleOffline = () => setStatus(prev => ({ ...prev, isOnline: false }));\n\n    const handleSyncUpdate = () => updateStatus();\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    window.addEventListener('background-sync-sync-completed', handleSyncUpdate);\n    window.addEventListener('background-sync-sync-started', handleSyncUpdate);\n\n    updateStatus();\n\n    // Update every 30 seconds\n    const interval = setInterval(updateStatus, 30000);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n      window.removeEventListener('background-sync-sync-completed', handleSyncUpdate);\n      window.removeEventListener('background-sync-sync-started', handleSyncUpdate);\n      clearInterval(interval);\n    };\n  }, []);\n\n  // Don't show anything if everything is good\n  if (status.isOnline && status.pendingSync === 0 && !status.isSyncing) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed bottom-4 right-4 z-50\">\n      <div className=\"bg-white rounded-lg border shadow-lg border-l-4 border-l-blue-500 p-3 max-w-xs\">\n        <div className=\"flex items-center space-x-2\">\n          {!status.isOnline && (\n            <div className=\"flex items-center space-x-1\">\n              <div className=\"w-2 h-2 bg-red-500 rounded-full\"></div>\n              <span className=\"text-sm font-medium text-red-700\">Offline</span>\n            </div>\n          )}\n          {status.isSyncing && (\n            <div className=\"flex items-center space-x-1\">\n              <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\n              <span className=\"text-sm font-medium text-blue-700\">Syncing...</span>\n            </div>\n          )}\n          {status.pendingSync > 0 && !status.isSyncing && (\n            <div className=\"flex items-center space-x-1\">\n              <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\n              <span className=\"text-sm font-medium text-yellow-700\">\n                {status.pendingSync} pending\n              </span>\n            </div>\n          )}\n        </div>\n        {!status.isOnline && (\n          <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n            Your data is saved locally and will sync when you're back online\n          </p>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useRef } from 'react';\r\nimport { useToast } from './feedback';\r\nimport { useStartupPrompts } from '../contexts/StartupPromptsContext';\r\n\r\nconst STORAGE_KEY = 'pain-tracker:notification-consent';\r\n\r\nexport default function NotificationConsentPrompt() {\r\n  const [consent, setConsent] = useState<string | null>(() => {\r\n    try {\r\n      return localStorage.getItem(STORAGE_KEY);\r\n    } catch {\r\n      return null;\r\n    }\r\n  });\r\n  const { bottomLeft } = useToast();\r\n  const { requestPrompt, dismissPrompt, canShowPrompt } = useStartupPrompts();\r\n  // Track whether we've already shown the toast to prevent duplicate toasts\r\n  const hasShownToast = useRef(false);\r\n  // Use refs to avoid dependency changes causing infinite re-renders\r\n  const dismissPromptRef = useRef(dismissPrompt);\r\n\r\n  // Keep refs up to date with latest values\r\n  useEffect(() => {\r\n    dismissPromptRef.current = dismissPrompt;\r\n  }, [dismissPrompt]);\r\n\r\n  useEffect(() => {\r\n    if (!consent) {\r\n      // Request to show this prompt with priority 2 (after beta warning)\r\n      requestPrompt('notification-consent', 2);\r\n    }\r\n  }, [consent, requestPrompt]);\r\n\r\n  useEffect(() => {\r\n    // Check localStorage directly to avoid race conditions with React state\r\n    const storedConsent = localStorage.getItem(STORAGE_KEY);\r\n    if (storedConsent) {\r\n      // Already have consent stored, don't show toast\r\n      return;\r\n    }\r\n    \r\n    // Only show toast once per session to prevent infinite re-renders\r\n    if (!consent && canShowPrompt('notification-consent') && !hasShownToast.current) {\r\n      hasShownToast.current = true;\r\n\r\n      const handleGrant = async () => {\r\n        try {\r\n          const p = await Notification.requestPermission();\r\n          localStorage.setItem(STORAGE_KEY, p);\r\n          setConsent(p);\r\n          dismissPromptRef.current('notification-consent');\r\n        } catch {\r\n          localStorage.setItem(STORAGE_KEY, 'denied');\r\n          setConsent('denied');\r\n          dismissPromptRef.current('notification-consent');\r\n        }\r\n      };\r\n\r\n      const handleDismiss = () => {\r\n        // When dismissed (X clicked), store 'dismissed'\r\n        localStorage.setItem(STORAGE_KEY, 'dismissed');\r\n        setConsent('dismissed');\r\n        dismissPromptRef.current('notification-consent');\r\n      };\r\n\r\n      // Show notification permission prompt as a bottom-left toast\r\n      bottomLeft.info(\r\n        'Get gentle notifications?',\r\n        'We can notify you about important pain pattern alerts and medication reminders. You can change this later in Settings.',\r\n        {\r\n          label: 'Allow',\r\n          onClick: handleGrant,\r\n        },\r\n        {\r\n          onDismiss: handleDismiss\r\n        }\r\n      );\r\n    }\r\n    // Note: bottomLeft is intentionally omitted from deps - using it would cause infinite re-renders\r\n    // because useToast returns a new object on each render. We use bottomLeft inside the effect\r\n    // but guard against re-execution with hasShownToast ref and localStorage check.\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [consent, canShowPrompt]);\r\n\r\n  // Don't render anything - the toast handles the UI\r\n  return null;\r\n}\r\n","import { useEffect, useState, useRef } from 'react';\r\nimport { useToast } from './feedback';\r\nimport { privacyAnalytics } from '../services/PrivacyAnalyticsService';\r\nimport { useStartupPrompts } from '../contexts/StartupPromptsContext';\r\n\r\nconst STORAGE_KEY = 'pain-tracker:analytics-consent';\r\n\r\nexport default function AnalyticsConsentPrompt() {\r\n  const [consent, setConsent] = useState<string | null>(() => {\r\n    try {\r\n      return localStorage.getItem(STORAGE_KEY);\r\n    } catch {\r\n      return null;\r\n    }\r\n  });\r\n  const { bottomLeft } = useToast();\r\n  const { requestPrompt, dismissPrompt, canShowPrompt } = useStartupPrompts();\r\n  // Track whether we've already shown the toast to prevent duplicate toasts\r\n  const hasShownToast = useRef(false);\r\n  // Use refs to avoid dependency changes causing infinite re-renders\r\n  const bottomLeftRef = useRef(bottomLeft);\r\n  const dismissPromptRef = useRef(dismissPrompt);\r\n\r\n  // Keep refs up to date with latest values\r\n  useEffect(() => {\r\n    bottomLeftRef.current = bottomLeft;\r\n    dismissPromptRef.current = dismissPrompt;\r\n  }, [bottomLeft, dismissPrompt]);\r\n\r\n  useEffect(() => {\r\n    if (!consent) {\r\n      // Request to show this prompt with priority 3 (after notification consent)\r\n      requestPrompt('analytics-consent', 3);\r\n    }\r\n  }, [consent, requestPrompt]);\r\n\r\n  useEffect(() => {\r\n    // Check localStorage directly to avoid race conditions with React state\r\n    const storedConsent = localStorage.getItem(STORAGE_KEY);\r\n    if (storedConsent) {\r\n      // Already have consent stored, don't show toast\r\n      return;\r\n    }\r\n    \r\n    // Only show toast once per session to prevent infinite re-renders\r\n    if (!consent && canShowPrompt('analytics-consent') && !hasShownToast.current) {\r\n      hasShownToast.current = true;\r\n\r\n      const handleGrant = async () => {\r\n        try {\r\n          localStorage.setItem(STORAGE_KEY, 'granted');\r\n          setConsent('granted');\r\n\r\n          // Enable analytics in the service\r\n          const consentGranted = await privacyAnalytics.requestConsent();\r\n\r\n          if (consentGranted) {\r\n            bottomLeftRef.current.success(\r\n              'Thank you!',\r\n              'Your anonymous usage data will help us improve Pain Tracker for everyone.'\r\n            );\r\n          }\r\n          \r\n          dismissPromptRef.current('analytics-consent');\r\n        } catch {\r\n          localStorage.setItem(STORAGE_KEY, 'error');\r\n          setConsent('error');\r\n          dismissPromptRef.current('analytics-consent');\r\n        }\r\n      };\r\n\r\n      const handleDismiss = () => {\r\n        // When dismissed (X clicked), store 'declined'\r\n        localStorage.setItem(STORAGE_KEY, 'declined');\r\n        setConsent('declined');\r\n        privacyAnalytics.updatePrivacyConfig({ enableAnalytics: false });\r\n        dismissPromptRef.current('analytics-consent');\r\n      };\r\n\r\n      // Show analytics consent prompt as a bottom-left toast\r\n      bottomLeftRef.current.info(\r\n        'Help improve Pain Tracker?',\r\n        'We\\'d like to collect anonymous usage data to improve the app. Your pain data stays private and local. No personal information is collected.',\r\n        {\r\n          label: 'Allow',\r\n          onClick: handleGrant\r\n        },\r\n        {\r\n          onDismiss: handleDismiss\r\n        }\r\n      );\r\n    }\r\n    // Note: bottomLeftRef.current is intentionally used instead of adding bottomLeft to deps.\r\n    // useToast returns a new object on each render which would cause infinite re-renders.\r\n    // We use refs and guard against re-execution with hasShownToast ref and localStorage check.\r\n     \r\n  }, [consent, canShowPrompt]);\r\n\r\n  // Don't render anything - the toast handles the UI\r\n  return null;\r\n}\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nlet sodiumInstance: any = null;\nlet sodiumPromise: Promise<any> | null = null;\n\nexport async function getSodium(): Promise<any> {\n  // Validate cached instance has required functions\n  if (sodiumInstance && typeof sodiumInstance.crypto_pwhash === 'function') {\n    return sodiumInstance;\n  }\n\n  // Clear invalid cache\n  if (sodiumInstance) {\n    console.warn('[sodium] Clearing invalid cached instance');\n    sodiumInstance = null;\n    sodiumPromise = null;\n  }\n\n  if (!sodiumPromise) {\n    sodiumPromise = (async () => {\n      console.log('[sodium] Starting initialization (SUMO version)...');\n      const sodiumModule = await import('libsodium-wrappers-sumo');\n      console.log('[sodium] Module type:', typeof sodiumModule);\n      console.log('[sodium] Module.default type:', typeof sodiumModule.default);\n\n      // Get the default export from the module\n      const sodium = sodiumModule.default || sodiumModule;\n\n      console.log('[sodium] Waiting for ready...');\n      await sodium.ready;\n\n      console.log('[sodium] Library initialized successfully');\n      console.log('[sodium] crypto_pwhash type:', typeof sodium.crypto_pwhash);\n      console.log('[sodium] crypto_pwhash_str type:', typeof sodium.crypto_pwhash_str);\n      console.log('[sodium] crypto_pwhash_SALTBYTES:', sodium.crypto_pwhash_SALTBYTES);\n\n      // Validate we have the required functions\n      if (typeof sodium.crypto_pwhash !== 'function') {\n        throw new Error('[sodium] crypto_pwhash function not available even in SUMO version!');\n      }\n\n      sodiumInstance = sodium;\n      return sodium;\n    })();\n  }\n  return sodiumPromise;\n}\n\nexport function getSodiumSync(): any {\n  return sodiumInstance;\n}\n","import { securityService } from './SecurityService';\nimport { secureStorage } from '../lib/storage/secureStorage';\nimport { getSodium, getSodiumSync } from '../lib/crypto/sodium';\n\ntype VaultPhase = 'uninitialized' | 'locked' | 'unlocking' | 'unlocked' | 'error';\n\ntype Listener = (status: VaultStatus) => void;\n\nconst STORAGE_KEY = 'vault:metadata';\nconst VAULT_VERSION = '3.0.0';\nconst BASE64_VARIANT = 1; // libsodium.base64_variants.ORIGINAL\n\nfunction toBytes(input: unknown): Uint8Array {\n  if (input == null) {\n    throw new TypeError('encryptString: message is null/undefined');\n  }\n\n  if (input instanceof Uint8Array) {\n    return input;\n  }\n\n  if (\n    typeof Buffer !== 'undefined' &&\n    typeof Buffer.isBuffer === 'function' &&\n    Buffer.isBuffer(input)\n  ) {\n    return new Uint8Array(\n      (input as Buffer).buffer,\n      (input as Buffer).byteOffset,\n      (input as Buffer).byteLength\n    );\n  }\n\n  if (ArrayBuffer.isView(input)) {\n    const view = input as ArrayBufferView;\n    return new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n  }\n\n  if (input instanceof ArrayBuffer) {\n    return new Uint8Array(input);\n  }\n\n  // For strings and objects, use TextEncoder (universally available in Node + browsers)\n  const encoder = new TextEncoder();\n  if (typeof input === 'string') {\n    return encoder.encode(input);\n  }\n\n  return encoder.encode(JSON.stringify(input));\n}\n\nasync function ensureReady(): Promise<void> {\n  await getSodium();\n}\n\nfunction isEnvelopeString(raw: string): boolean {\n  try {\n    const parsed = JSON.parse(raw);\n    return (\n      typeof parsed === 'object' &&\n      parsed?.v === 'xchacha20-poly1305' &&\n      typeof parsed?.c === 'string' &&\n      typeof parsed?.n === 'string'\n    );\n  } catch {\n    return false;\n  }\n}\n\nexport interface VaultMetadata {\n  version: string;\n  createdAt: string;\n  updatedAt: string;\n  derivation: {\n    algorithm: 'argon2id';\n    salt: string; // base64\n    opslimit: number;\n    memlimit: number;\n    keyLength: number;\n  };\n  verification: {\n    algorithm: 'argon2id';\n    hash: string;\n  };\n  cipher: {\n    algorithm: 'xchacha20-poly1305';\n    nonceLength: number;\n  };\n  migrations?: {\n    legacyCompletedAt?: string;\n  };\n}\n\nexport interface VaultStatus {\n  state: VaultPhase;\n  metadata: VaultMetadata | null;\n  sodiumReady: boolean;\n}\n\nexport class EncryptedVaultService {\n  private status: VaultStatus = {\n    state: 'uninitialized',\n    metadata: null,\n    sodiumReady: false,\n  };\n\n  private key: Uint8Array | null = null;\n  private listeners = new Set<Listener>();\n  private initialized = false;\n\n  async initialize(): Promise<VaultStatus> {\n    if (this.initialized) {\n      return this.status;\n    }\n\n    try {\n      await getSodium();\n      this.status.sodiumReady = true;\n    } catch (error) {\n      this.logEvent('error', 'Failed to initialize libsodium', {\n        error: error instanceof Error ? error.message : 'unknown',\n      });\n      this.status.state = 'error';\n      return this.status;\n    }\n\n    const metadata = this.loadMetadata();\n    if (!metadata) {\n      this.status = { state: 'uninitialized', metadata: null, sodiumReady: true };\n    } else {\n      this.status = { state: 'locked', metadata, sodiumReady: true };\n    }\n\n    this.initialized = true;\n    this.emit();\n    return this.status;\n  }\n\n  onChange(listener: Listener): () => void {\n    this.listeners.add(listener);\n    listener(this.status);\n    return () => {\n      this.listeners.delete(listener);\n    };\n  }\n\n  getStatus(): VaultStatus {\n    return this.status;\n  }\n\n  async setupPassphrase(passphrase: string): Promise<void> {\n    if (!passphrase || passphrase.length < 12) {\n      throw new Error('Passphrase must be at least 12 characters.');\n    }\n\n    // Ensure libsodium ready and reference stable instance\n    await ensureReady();\n    const sodium = await getSodium();\n\n    console.log('[VaultService] Sodium instance retrieved:', {\n      sodiumType: typeof sodium,\n      hasCryptoPwhash: typeof sodium.crypto_pwhash,\n      hasCryptoPwhashStr: typeof sodium.crypto_pwhash_str,\n      saltBytes: sodium.crypto_pwhash_SALTBYTES,\n    });\n\n    // Defensive: crypto_pwhash_SALTBYTES must be a valid positive integer\n    const configuredSaltBytes = sodium.crypto_pwhash_SALTBYTES as unknown;\n    const saltBytes =\n      Number.isInteger(configuredSaltBytes as number) && (configuredSaltBytes as number) > 0\n        ? (configuredSaltBytes as number)\n        : 16; // fallback to 16 bytes in test/env edge cases\n    if (saltBytes !== configuredSaltBytes) {\n      this.logEvent('warning', 'Using fallback salt length', { configuredSaltBytes, saltBytes });\n    }\n    const salt = sodium.randombytes_buf(saltBytes);\n    const opslimit = sodium.crypto_pwhash_OPSLIMIT_MODERATE;\n    const memlimit = sodium.crypto_pwhash_MEMLIMIT_MODERATE;\n    const keyLength = sodium.crypto_aead_xchacha20poly1305_ietf_KEYBYTES;\n\n    console.log('[VaultService] Creating vault with:', {\n      passphraseType: typeof passphrase,\n      passphraseLength: passphrase?.length,\n      keyLength,\n      opslimit,\n      memlimit,\n      saltLength: salt.length,\n    });\n\n    const key = sodium.crypto_pwhash(\n      keyLength,\n      passphrase,\n      salt,\n      opslimit,\n      memlimit,\n      sodium.crypto_pwhash_ALG_ARGON2ID13\n    );\n\n    console.log('[VaultService] Key derived, creating verification hash...');\n\n    const verificationHash = sodium.crypto_pwhash_str(passphrase, opslimit, memlimit);\n\n    console.log('[VaultService] Verification hash created:', verificationHash?.length);\n\n    const metadata: VaultMetadata = {\n      version: VAULT_VERSION,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      derivation: {\n        algorithm: 'argon2id',\n        salt: sodium.to_base64(salt, BASE64_VARIANT),\n        opslimit,\n        memlimit,\n        keyLength,\n      },\n      verification: {\n        algorithm: 'argon2id',\n        hash: verificationHash,\n      },\n      cipher: {\n        algorithm: 'xchacha20-poly1305',\n        nonceLength: sodium.crypto_aead_xchacha20poly1305_ietf_NPUBBYTES,\n      },\n      migrations: {},\n    };\n\n    const storeResult = secureStorage.set(STORAGE_KEY, metadata);\n    if (!storeResult.success) {\n      throw new Error('Failed to persist vault metadata.');\n    }\n\n    this.key = key;\n    this.status = { state: 'unlocked', metadata, sodiumReady: true };\n    this.applyGlobalHooks();\n    await this.migrateLegacyStorage();\n    this.logEvent('info', 'Vault passphrase initialized');\n    this.emit();\n  }\n\n  async unlock(passphrase: string): Promise<void> {\n    if (!passphrase) {\n      throw new Error('Passphrase is required.');\n    }\n\n    await this.initialize();\n    await ensureReady();\n\n    const { metadata } = this.status;\n    if (!metadata) {\n      throw new Error('Vault not configured.');\n    }\n\n    const sodium = await getSodium();\n\n    let isValid = false;\n    try {\n      isValid = sodium.crypto_pwhash_str_verify(metadata.verification.hash, passphrase);\n    } catch (error) {\n      this.logEvent('error', `Passphrase verification error: ${error}`);\n      throw new Error('Passphrase verification failed.');\n    }\n\n    if (!isValid) {\n      this.logEvent('warning', 'Vault unlock attempt failed');\n      throw new Error('Incorrect passphrase.');\n    }\n\n    const salt = sodium.from_base64(metadata.derivation.salt, BASE64_VARIANT);\n    if (!(salt instanceof Uint8Array) || salt.length <= 0) {\n      this.logEvent('error', 'Derived salt invalid', { actual: (salt as Uint8Array)?.length });\n    }\n    const key = sodium.crypto_pwhash(\n      metadata.derivation.keyLength,\n      passphrase,\n      salt,\n      metadata.derivation.opslimit,\n      metadata.derivation.memlimit,\n      sodium.crypto_pwhash_ALG_ARGON2ID13\n    );\n\n    this.key = key;\n    this.status = { ...this.status, state: 'unlocked' };\n    this.applyGlobalHooks();\n    await this.migrateLegacyStorage();\n    this.logEvent('info', 'Vault unlocked');\n    this.emit();\n  }\n\n  lock(): void {\n    if (this.key) {\n      void getSodium()\n        .then(sodium => {\n          sodium.memzero(this.key!);\n        })\n        .catch(() => undefined);\n    }\n    this.key = null;\n    delete (globalThis as { __secureStorageEncrypt?: (plaintext: string) => string })\n      .__secureStorageEncrypt;\n    delete (globalThis as { __secureStorageDecrypt?: (ciphertext: string) => string })\n      .__secureStorageDecrypt;\n    if (this.status.state !== 'uninitialized') {\n      this.status = { ...this.status, state: 'locked' };\n      this.emit();\n    }\n    this.logEvent('info', 'Vault locked');\n  }\n\n  isUnlocked(): boolean {\n    return this.status.state === 'unlocked' && !!this.key;\n  }\n\n  encryptString(message: unknown): string {\n    if (!this.key) {\n      throw new Error('encryptString: key not set');\n    }\n    if (!this.status.sodiumReady) {\n      throw new Error('encryptString: libsodium not ready');\n    }\n\n    const sodium = this.assertSodium();\n    const key = this.key as Uint8Array;\n    if (\n      !(key instanceof Uint8Array) ||\n      key.length !== sodium.crypto_aead_xchacha20poly1305_ietf_KEYBYTES\n    ) {\n      throw new Error('encryptString: invalid key type/length');\n    }\n\n    const msg = toBytes(message);\n\n    const nonceLen = sodium.crypto_aead_xchacha20poly1305_ietf_NPUBBYTES;\n    if (!Number.isInteger(nonceLen) || nonceLen <= 0) {\n      throw new Error('encryptString: invalid nonce length constant');\n    }\n    const nonce = sodium.randombytes_buf(nonceLen);\n\n    // Ensure msg is truly a Uint8Array for libsodium (realm-safe conversion)\n    const finalMsg = ArrayBuffer.isView(msg)\n      ? new Uint8Array(\n          (msg as ArrayBufferView).buffer,\n          (msg as ArrayBufferView).byteOffset,\n          (msg as ArrayBufferView).byteLength\n        )\n      : msg;\n\n    const cipher = sodium.crypto_aead_xchacha20poly1305_ietf_encrypt(\n      finalMsg,\n      null,\n      null,\n      nonce,\n      key\n    );\n\n    return JSON.stringify({\n      v: 'xchacha20-poly1305',\n      n: sodium.to_base64(nonce, BASE64_VARIANT),\n      c: sodium.to_base64(cipher, BASE64_VARIANT),\n    });\n  }\n\n  decryptString(payload: string): string {\n    if (!this.key) {\n      throw new Error('decryptString: key not set');\n    }\n    if (!this.status.sodiumReady) {\n      throw new Error('decryptString: libsodium not ready');\n    }\n\n    const sodium = this.assertSodium();\n    try {\n      const env = JSON.parse(payload);\n      if (env?.v !== 'xchacha20-poly1305') {\n        return payload;\n      }\n\n      const key = this.key as Uint8Array;\n      const nonce = sodium.from_base64(env.n, BASE64_VARIANT);\n      const cipher = sodium.from_base64(env.c, BASE64_VARIANT);\n      const plain = sodium.crypto_aead_xchacha20poly1305_ietf_decrypt(\n        null,\n        cipher,\n        null,\n        nonce,\n        key\n      );\n      return sodium.to_string(plain);\n    } catch {\n      return payload;\n    }\n  }\n\n  encryptBytes(data: Uint8Array): { nonce: string; cipher: string } {\n    if (!this.key) {\n      throw new Error('Vault is locked.');\n    }\n    const sodium = this.assertSodium();\n    const nonceSize = sodium.crypto_aead_xchacha20poly1305_ietf_NPUBBYTES;\n    if (!Number.isInteger(nonceSize) || nonceSize <= 0) {\n      throw new Error('encryptBytes: invalid nonce length constant');\n    }\n    const nonce = sodium.randombytes_buf(nonceSize);\n    const cipher = sodium.crypto_aead_xchacha20poly1305_ietf_encrypt(\n      data,\n      null,\n      null,\n      nonce,\n      this.key\n    );\n    return {\n      nonce: sodium.to_base64(nonce, BASE64_VARIANT),\n      cipher: sodium.to_base64(cipher, BASE64_VARIANT),\n    };\n  }\n\n  decryptBytes(payload: { nonce: string; cipher: string }): Uint8Array {\n    if (!this.key) {\n      throw new Error('Vault is locked.');\n    }\n    const sodium = this.assertSodium();\n    const nonce = sodium.from_base64(payload.nonce, BASE64_VARIANT);\n    const cipher = sodium.from_base64(payload.cipher, BASE64_VARIANT);\n    const decrypted = sodium.crypto_aead_xchacha20poly1305_ietf_decrypt(\n      null,\n      cipher,\n      null,\n      nonce,\n      this.key\n    );\n    return decrypted;\n  }\n\n  clearAll(): void {\n    secureStorage.remove(STORAGE_KEY);\n    this.lock();\n    this.status = { state: 'uninitialized', metadata: null, sodiumReady: this.status.sodiumReady };\n    this.emit();\n  }\n\n  private emit(): void {\n    for (const listener of this.listeners) {\n      listener(this.status);\n    }\n  }\n\n  private loadMetadata(): VaultMetadata | null {\n    try {\n      const metadata = secureStorage.get<VaultMetadata>(STORAGE_KEY);\n      if (!metadata) {\n        return null;\n      }\n      return metadata;\n    } catch {\n      return null;\n    }\n  }\n\n  private async migrateLegacyStorage(): Promise<void> {\n    if (!this.key || !this.status.metadata) {\n      return;\n    }\n\n    let reencrypted = 0;\n    let skipped = 0;\n\n    for (let i = 0; i < localStorage.length; i++) {\n      const fullKey = localStorage.key(i);\n      if (!fullKey || !fullKey.startsWith('pt:')) {\n        continue;\n      }\n      if (fullKey === `pt:${STORAGE_KEY}`) {\n        continue;\n      }\n\n      const raw = localStorage.getItem(fullKey);\n      if (typeof raw !== 'string' || raw.length === 0) {\n        skipped += 1;\n        continue;\n      }\n      if (isEnvelopeString(raw)) {\n        continue;\n      }\n\n      try {\n        const wrapped = this.encryptString(raw);\n        localStorage.setItem(fullKey, wrapped);\n        reencrypted += 1;\n      } catch (error) {\n        skipped += 1;\n        this.logEvent('warning', 'Failed to migrate legacy secureStorage entry', {\n          key: fullKey,\n          error: error instanceof Error ? error.message : 'unknown',\n        });\n      }\n    }\n\n    if (reencrypted > 0 || skipped > 0) {\n      const metadata: VaultMetadata = {\n        ...this.status.metadata,\n        migrations: {\n          ...this.status.metadata?.migrations,\n          legacyCompletedAt: new Date().toISOString(),\n        },\n        updatedAt: new Date().toISOString(),\n      };\n      const updateResult = secureStorage.set(STORAGE_KEY, metadata);\n      if (!updateResult.success) {\n        this.logEvent('warning', 'Failed to update vault metadata after migration');\n      }\n      this.status = { ...this.status, metadata };\n      this.logEvent('info', 'Legacy storage re-encrypted', { reencrypted, skipped });\n    }\n  }\n\n  private applyGlobalHooks(): void {\n    if (!this.key) return;\n    (\n      globalThis as { __secureStorageEncrypt?: (plaintext: string) => string }\n    ).__secureStorageEncrypt = (plaintext: string) => this.encryptString(plaintext);\n    (\n      globalThis as { __secureStorageDecrypt?: (ciphertext: string) => string }\n    ).__secureStorageDecrypt = (ciphertext: string) => this.decryptString(ciphertext);\n  }\n\n  private assertSodium(): typeof import('libsodium-wrappers') {\n    const sodium = getSodiumSync();\n    if (!sodium) {\n      throw new Error('libsodium not ready');\n    }\n    return sodium;\n  }\n\n  private logEvent(\n    level: 'info' | 'warning' | 'error',\n    message: string,\n    metadata?: Record<string, unknown>\n  ): void {\n    try {\n      securityService.logSecurityEvent({\n        type: 'vault',\n        level,\n        message,\n        metadata,\n        timestamp: new Date(),\n      });\n    } catch {\n      // ignore logging failures\n    }\n  }\n}\n\nexport const vaultService = new EncryptedVaultService();\n\n// DEV-only: expose a small test hook on window so E2E tests can programmatically\n// initialize or unlock the vault in newly created pages. This avoids flaky UI\n// interactions in isolated pages used by tests. Only attach in development builds.\ntry {\n  // Vite exposes import.meta.env.DEV; guard to ensure this stays absent in prod\n  if (import.meta.env && (import.meta as unknown as { DEV?: boolean }).DEV) {\n    (globalThis as unknown as { __test_vault?: unknown }).__test_vault = {\n      setup: async (passphrase: string) => {\n        try {\n          await vaultService.setupPassphrase(passphrase);\n          return { success: true };\n        } catch (err) {\n          return { success: false, error: String((err as Error)?.message || err) };\n        }\n      },\n      unlock: async (passphrase: string) => {\n        try {\n          await vaultService.unlock(passphrase);\n          return { success: true };\n        } catch (err) {\n          return { success: false, error: String((err as Error)?.message || err) };\n        }\n      },\n      isUnlocked: () => vaultService.isUnlocked(),\n    };\n  }\n} catch {\n  // ignore failures attaching test hook\n}\n","import { useEffect } from 'react';\nimport { useSyncExternalStore } from 'react';\nimport { vaultService, type VaultStatus } from '../services/VaultService';\n\nfunction subscribe(listener: () => void) {\n  return vaultService.onChange(() => listener());\n}\n\nfunction getSnapshot(): VaultStatus {\n  return vaultService.getStatus();\n}\n\nexport function useVaultStatus(): VaultStatus {\n  const status = useSyncExternalStore(subscribe, getSnapshot, getSnapshot);\n\n  useEffect(() => {\n    void vaultService.initialize();\n  }, []);\n\n  return status;\n}\n\nexport function useVault(): {\n  status: VaultStatus;\n  setupPassphrase: (passphrase: string) => Promise<void>;\n  unlock: (passphrase: string) => Promise<void>;\n  lock: () => void;\n  clearAll: () => void;\n} {\n  const status = useVaultStatus();\n\n  return {\n    status,\n    setupPassphrase: (passphrase: string) => vaultService.setupPassphrase(passphrase),\n    unlock: (passphrase: string) => vaultService.unlock(passphrase),\n    lock: () => vaultService.lock(),\n    clearAll: () => vaultService.clearAll(),\n  };\n}\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { useVault } from '../../hooks/useVault';\r\n\r\nconst MIN_PASSPHRASE_LENGTH = 12;\r\n\r\nexport interface VaultGateProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const VaultGate: React.FC<VaultGateProps> = ({ children }) => {\r\n  const { status, setupPassphrase, unlock, lock, clearAll } = useVault();\r\n  const [passphrase, setPassphrase] = useState('');\r\n  const [confirmPassphrase, setConfirmPassphrase] = useState('');\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const passphraseInputRef = useRef<HTMLInputElement>(null);\r\n  const [showPassphrase, setShowPassphrase] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (status.state === 'uninitialized' || status.state === 'locked') {\r\n      setTimeout(() => {\r\n        passphraseInputRef.current?.focus();\r\n      }, 50);\r\n    }\r\n  }, [status.state]);\r\n\r\n  const resetForm = () => {\r\n    setPassphrase('');\r\n    setConfirmPassphrase('');\r\n    setError(null);\r\n  };\r\n\r\n  const handleSetup = async (event: React.FormEvent) => {\r\n    event.preventDefault();\r\n    if (isProcessing) return;\r\n\r\n    if (passphrase !== confirmPassphrase) {\r\n      setError('Passphrases must match.');\r\n      return;\r\n    }\r\n\r\n    if (passphrase.length < MIN_PASSPHRASE_LENGTH) {\r\n      setError(`Passphrase must be at least ${MIN_PASSPHRASE_LENGTH} characters long.`);\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setError(null);\r\n    try {\r\n      await setupPassphrase(passphrase);\r\n      resetForm();\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Unable to initialize vault.');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleUnlock = async (event: React.FormEvent) => {\r\n    event.preventDefault();\r\n    if (isProcessing) return;\r\n\r\n    if (!passphrase) {\r\n      setError('Please enter your secure passphrase.');\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    setError(null);\r\n    try {\r\n      await unlock(passphrase);\r\n      resetForm();\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Unable to unlock vault.');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  const handleResetVault = async () => {\r\n    const confirmed = window.confirm(\r\n      'Resetting the secure vault will permanently remove all locally stored entries and settings. This action cannot be undone. Do you want to continue?'\r\n    );\r\n    if (!confirmed) return;\r\n    clearAll();\r\n    lock();\r\n    resetForm();\r\n  };\r\n\r\n  const renderSetup = () => (\r\n    <form onSubmit={handleSetup} className=\"space-y-6\" aria-labelledby=\"vault-setup-title\">\r\n      <div>\r\n        <h2\r\n          id=\"vault-setup-title\"\r\n          className=\"text-2xl font-semibold text-gray-900 dark:text-gray-100\"\r\n        >\r\n          Create a secure passphrase\r\n        </h2>\r\n        <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n          Choose a gentle yet strong passphrase that you will remember. It protects your pain\r\n          entries and personal notes on this device. For security, your passphrase is never stored\r\n          anywhere.\r\n        </p>\r\n      </div>\r\n\r\n      <div className=\"space-y-4\">\r\n        <label className=\"block\" htmlFor=\"vault-passphrase\">\r\n          <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Passphrase</span>\r\n          <input\r\n            id=\"vault-passphrase\"\r\n            ref={passphraseInputRef}\r\n            type={showPassphrase ? 'text' : 'password'}\r\n            value={passphrase}\r\n            onChange={e => setPassphrase(e.target.value)}\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n            minLength={MIN_PASSPHRASE_LENGTH}\r\n            aria-describedby=\"vault-passphrase-help\"\r\n            autoComplete=\"new-password\"\r\n            required\r\n          />\r\n        </label>\r\n        <p id=\"vault-passphrase-help\" className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n          Use at least {MIN_PASSPHRASE_LENGTH} characters. Short sentences or unique phrases are\r\n          often easiest to recall.\r\n        </p>\r\n\r\n        <label className=\"block\" htmlFor=\"vault-passphrase-confirm\">\r\n          <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n            Confirm passphrase\r\n          </span>\r\n          <input\r\n            id=\"vault-passphrase-confirm\"\r\n            type={showPassphrase ? 'text' : 'password'}\r\n            value={confirmPassphrase}\r\n            onChange={e => setConfirmPassphrase(e.target.value)}\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n            autoComplete=\"new-password\"\r\n            required\r\n          />\r\n        </label>\r\n\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setShowPassphrase(prev => !prev)}\r\n          className=\"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 focus:outline-none\"\r\n        >\r\n          {showPassphrase ? 'Hide passphrase' : 'Show passphrase'}\r\n        </button>\r\n      </div>\r\n\r\n      {error && (\r\n        <div\r\n          role=\"alert\"\r\n          className=\"rounded-md bg-red-50 dark:bg-red-900/30 p-3 text-sm text-red-700 dark:text-red-300 border border-red-100 dark:border-red-800\"\r\n        >\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3\">\r\n        <button\r\n          type=\"submit\"\r\n          className=\"inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-60\"\r\n          disabled={isProcessing}\r\n        >\r\n          {isProcessing ? 'Securing...' : 'Create secure vault'}\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={resetForm}\r\n          className=\"inline-flex items-center justify-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\r\n        >\r\n          Clear fields\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n\r\n  const renderUnlock = () => (\r\n    <form onSubmit={handleUnlock} className=\"space-y-6\" aria-labelledby=\"vault-unlock-title\">\r\n      <div className=\"flex items-start justify-between\">\r\n        <div>\r\n          <h2\r\n            id=\"vault-unlock-title\"\r\n            className=\"text-2xl font-semibold text-gray-900 dark:text-gray-100\"\r\n          >\r\n            Unlock secure vault\r\n          </h2>\r\n          <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n            Enter your trusted passphrase to access encrypted pain entries and preferences.\r\n          </p>\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={handleResetVault}\r\n          className=\"text-sm text-red-600 dark:text-red-400 hover:text-red-500 focus:outline-none\"\r\n        >\r\n          Reset vault\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"space-y-4\">\r\n        <label className=\"block\" htmlFor=\"vault-passphrase-unlock\">\r\n          <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Passphrase</span>\r\n          <input\r\n            id=\"vault-passphrase-unlock\"\r\n            ref={passphraseInputRef}\r\n            type={showPassphrase ? 'text' : 'password'}\r\n            value={passphrase}\r\n            onChange={e => setPassphrase(e.target.value)}\r\n            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 px-3 py-2 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-500\"\r\n            autoComplete=\"current-password\"\r\n            required\r\n          />\r\n        </label>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setShowPassphrase(prev => !prev)}\r\n          className=\"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 focus:outline-none\"\r\n        >\r\n          {showPassphrase ? 'Hide passphrase' : 'Show passphrase'}\r\n        </button>\r\n      </div>\r\n\r\n      {error && (\r\n        <div\r\n          role=\"alert\"\r\n          className=\"rounded-md bg-yellow-50 dark:bg-yellow-900/30 p-3 text-sm text-yellow-800 dark:text-yellow-300 border border-yellow-100 dark:border-yellow-800\"\r\n        >\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex flex-col space-y-3 sm:flex-row sm:space-y-0 sm:space-x-3\">\r\n        <button\r\n          type=\"submit\"\r\n          className=\"inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-60\"\r\n          disabled={isProcessing}\r\n        >\r\n          {isProcessing ? 'Unlocking...' : 'Unlock vault'}\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => {\r\n            resetForm();\r\n            setTimeout(() => passphraseInputRef.current?.focus(), 50);\r\n          }}\r\n          className=\"inline-flex items-center justify-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-slate-700 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 shadow-sm hover:bg-gray-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2\"\r\n        >\r\n          Try again\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n\r\n  const renderContent = () => {\r\n    if (!status.sodiumReady) {\r\n      return (\r\n        <div className=\"text-center\">\r\n          <p className=\"text-lg font-medium text-gray-900 dark:text-gray-100\">\r\n            Preparing secure vault\r\n          </p>\r\n          <p className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\r\n            Loading privacy protections. Thank you for your patience.\r\n          </p>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (status.state === 'unlocked') {\r\n      return <>{children}</>;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        className=\"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/95 dark:bg-black/90 px-4\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n        aria-labelledby=\"vault-dialog-title\"\r\n      >\r\n        <div className=\"w-full max-w-lg rounded-xl bg-white dark:bg-slate-800 p-6 shadow-2xl focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-500\">\r\n          <div className=\"flex items-center justify-between mb-6\">\r\n            <div>\r\n              <h1\r\n                id=\"vault-dialog-title\"\r\n                className=\"text-3xl font-semibold text-gray-900 dark:text-gray-100\"\r\n              >\r\n                Secure vault\r\n              </h1>\r\n              <p className=\"mt-1 text-sm text-gray-600 dark:text-gray-400\">\r\n                End-to-end encrypted storage protects your story and wellbeing.\r\n              </p>\r\n            </div>\r\n            <span\r\n              aria-hidden=\"true\"\r\n              className=\"inline-flex h-10 w-10 items-center justify-center rounded-full bg-indigo-50 text-indigo-600 text-lg font-semibold\"\r\n            >\r\n              \r\n            </span>\r\n          </div>\r\n          <div>{status.state === 'uninitialized' ? renderSetup() : renderUnlock()}</div>\r\n          <p className=\"mt-6 text-xs text-gray-500 dark:text-gray-400\">\r\n            Tip: If you ever need to safely reset the vault, choose Reset vault. This keeps your\r\n            account secure but removes local data from this device.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  // Allow tests to bypass the vault in DEV only when both the test-mode bootstrap\r\n  // flag and a persistent test-mode localStorage key are present. This guards\r\n  // against accidental bypass in interactive dev sessions.\r\n  try {\r\n    const isTestModeWindow = (window as unknown as { __pt_test_mode?: boolean }).__pt_test_mode;\r\n    const isTestModeLS = typeof localStorage !== 'undefined' && localStorage.getItem('pt:test_mode') === '1';\r\n    if (import.meta.env.DEV && isTestModeWindow && isTestModeLS) {\r\n      return <>{children}</>;\r\n    }\r\n  } catch {\r\n    // ignore storage errors in unusual environments\r\n  }\r\n\r\n  return <>{status.state === 'unlocked' ? children : renderContent()}</>;\r\n};\r\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","module.exports = Function.call.bind(Object.prototype.hasOwnProperty);\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n  var loggedTypeFailures = {};\n  var has = require('./lib/has');\n\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) { /**/ }\n  };\n}\n\n/**\n * Assert that the values match with the type specs.\n * Error messages are memorized and will only be shown once.\n *\n * @param {object} typeSpecs Map of name to a ReactPropType\n * @param {object} values Runtime values that need to be type-checked\n * @param {string} location e.g. \"prop\", \"context\", \"child context\"\n * @param {string} componentName Name of the component for error messages.\n * @param {?Function} getStack Returns the component stack.\n * @private\n */\nfunction checkPropTypes(typeSpecs, values, location, componentName, getStack) {\n  if (process.env.NODE_ENV !== 'production') {\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error;\n        // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\n            var err = Error(\n              (componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' +\n              'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' +\n              'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.'\n            );\n            err.name = 'Invariant Violation';\n            throw err;\n          }\n          error = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, ReactPropTypesSecret);\n        } catch (ex) {\n          error = ex;\n        }\n        if (error && !(error instanceof Error)) {\n          printWarning(\n            (componentName || 'React class') + ': type specification of ' +\n            location + ' `' + typeSpecName + '` is invalid; the type checker ' +\n            'function must return `null` or an `Error` but returned a ' + typeof error + '. ' +\n            'You may have forgotten to pass an argument to the type checker ' +\n            'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' +\n            'shape all require an argument).'\n          );\n        }\n        if (error instanceof Error && !(error.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error.message] = true;\n\n          var stack = getStack ? getStack() : '';\n\n          printWarning(\n            'Failed ' + location + ' type: ' + error.message + (stack != null ? stack : '')\n          );\n        }\n      }\n    }\n  }\n}\n\n/**\n * Resets warning cache when testing.\n *\n * @private\n */\ncheckPropTypes.resetWarningCache = function() {\n  if (process.env.NODE_ENV !== 'production') {\n    loggedTypeFailures = {};\n  }\n}\n\nmodule.exports = checkPropTypes;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactIs = require('react-is');\nvar assign = require('object-assign');\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\nvar has = require('./lib/has');\nvar checkPropTypes = require('./checkPropTypes');\n\nvar printWarning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  printWarning = function(text) {\n    var message = 'Warning: ' + text;\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  };\n}\n\nfunction emptyFunctionThatReturnsNull() {\n  return null;\n}\n\nmodule.exports = function(isValidElement, throwOnDirectAccess) {\n  /* global Symbol */\n  var ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\n  var FAUX_ITERATOR_SYMBOL = '@@iterator'; // Before Symbol spec.\n\n  /**\n   * Returns the iterator method function contained on the iterable object.\n   *\n   * Be sure to invoke the function with the iterable as context:\n   *\n   *     var iteratorFn = getIteratorFn(myIterable);\n   *     if (iteratorFn) {\n   *       var iterator = iteratorFn.call(myIterable);\n   *       ...\n   *     }\n   *\n   * @param {?object} maybeIterable\n   * @return {?function}\n   */\n  function getIteratorFn(maybeIterable) {\n    var iteratorFn = maybeIterable && (ITERATOR_SYMBOL && maybeIterable[ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL]);\n    if (typeof iteratorFn === 'function') {\n      return iteratorFn;\n    }\n  }\n\n  /**\n   * Collection of methods that allow declaration and validation of props that are\n   * supplied to React components. Example usage:\n   *\n   *   var Props = require('ReactPropTypes');\n   *   var MyArticle = React.createClass({\n   *     propTypes: {\n   *       // An optional string prop named \"description\".\n   *       description: Props.string,\n   *\n   *       // A required enum prop named \"category\".\n   *       category: Props.oneOf(['News','Photos']).isRequired,\n   *\n   *       // A prop named \"dialog\" that requires an instance of Dialog.\n   *       dialog: Props.instanceOf(Dialog).isRequired\n   *     },\n   *     render: function() { ... }\n   *   });\n   *\n   * A more formal specification of how these methods are used:\n   *\n   *   type := array|bool|func|object|number|string|oneOf([...])|instanceOf(...)\n   *   decl := ReactPropTypes.{type}(.isRequired)?\n   *\n   * Each and every declaration produces a function with the same signature. This\n   * allows the creation of custom validation functions. For example:\n   *\n   *  var MyLink = React.createClass({\n   *    propTypes: {\n   *      // An optional string or URI prop named \"href\".\n   *      href: function(props, propName, componentName) {\n   *        var propValue = props[propName];\n   *        if (propValue != null && typeof propValue !== 'string' &&\n   *            !(propValue instanceof URI)) {\n   *          return new Error(\n   *            'Expected a string or an URI for ' + propName + ' in ' +\n   *            componentName\n   *          );\n   *        }\n   *      }\n   *    },\n   *    render: function() {...}\n   *  });\n   *\n   * @internal\n   */\n\n  var ANONYMOUS = '<<anonymous>>';\n\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithThrowingShims.js`.\n  var ReactPropTypes = {\n    array: createPrimitiveTypeChecker('array'),\n    bigint: createPrimitiveTypeChecker('bigint'),\n    bool: createPrimitiveTypeChecker('boolean'),\n    func: createPrimitiveTypeChecker('function'),\n    number: createPrimitiveTypeChecker('number'),\n    object: createPrimitiveTypeChecker('object'),\n    string: createPrimitiveTypeChecker('string'),\n    symbol: createPrimitiveTypeChecker('symbol'),\n\n    any: createAnyTypeChecker(),\n    arrayOf: createArrayOfTypeChecker,\n    element: createElementTypeChecker(),\n    elementType: createElementTypeTypeChecker(),\n    instanceOf: createInstanceTypeChecker,\n    node: createNodeChecker(),\n    objectOf: createObjectOfTypeChecker,\n    oneOf: createEnumTypeChecker,\n    oneOfType: createUnionTypeChecker,\n    shape: createShapeTypeChecker,\n    exact: createStrictShapeTypeChecker,\n  };\n\n  /**\n   * inlined Object.is polyfill to avoid requiring consumers ship their own\n   * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is\n   */\n  /*eslint-disable no-self-compare*/\n  function is(x, y) {\n    // SameValue algorithm\n    if (x === y) {\n      // Steps 1-5, 7-10\n      // Steps 6.b-6.e: +0 != -0\n      return x !== 0 || 1 / x === 1 / y;\n    } else {\n      // Step 6.a: NaN == NaN\n      return x !== x && y !== y;\n    }\n  }\n  /*eslint-enable no-self-compare*/\n\n  /**\n   * We use an Error-like object for backward compatibility as people may call\n   * PropTypes directly and inspect their output. However, we don't use real\n   * Errors anymore. We don't inspect their stack anyway, and creating them\n   * is prohibitively expensive if they are created too often, such as what\n   * happens in oneOfType() for any type before the one that matched.\n   */\n  function PropTypeError(message, data) {\n    this.message = message;\n    this.data = data && typeof data === 'object' ? data: {};\n    this.stack = '';\n  }\n  // Make `instanceof Error` still work for returned errors.\n  PropTypeError.prototype = Error.prototype;\n\n  function createChainableTypeChecker(validate) {\n    if (process.env.NODE_ENV !== 'production') {\n      var manualPropTypeCallCache = {};\n      var manualPropTypeWarningCount = 0;\n    }\n    function checkType(isRequired, props, propName, componentName, location, propFullName, secret) {\n      componentName = componentName || ANONYMOUS;\n      propFullName = propFullName || propName;\n\n      if (secret !== ReactPropTypesSecret) {\n        if (throwOnDirectAccess) {\n          // New behavior only for users of `prop-types` package\n          var err = new Error(\n            'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n            'Use `PropTypes.checkPropTypes()` to call them. ' +\n            'Read more at http://fb.me/use-check-prop-types'\n          );\n          err.name = 'Invariant Violation';\n          throw err;\n        } else if (process.env.NODE_ENV !== 'production' && typeof console !== 'undefined') {\n          // Old behavior for people using React.PropTypes\n          var cacheKey = componentName + ':' + propName;\n          if (\n            !manualPropTypeCallCache[cacheKey] &&\n            // Avoid spamming the console because they are often not actionable except for lib authors\n            manualPropTypeWarningCount < 3\n          ) {\n            printWarning(\n              'You are manually calling a React.PropTypes validation ' +\n              'function for the `' + propFullName + '` prop on `' + componentName + '`. This is deprecated ' +\n              'and will throw in the standalone `prop-types` package. ' +\n              'You may be seeing this warning due to a third-party PropTypes ' +\n              'library. See https://fb.me/react-warning-dont-call-proptypes ' + 'for details.'\n            );\n            manualPropTypeCallCache[cacheKey] = true;\n            manualPropTypeWarningCount++;\n          }\n        }\n      }\n      if (props[propName] == null) {\n        if (isRequired) {\n          if (props[propName] === null) {\n            return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required ' + ('in `' + componentName + '`, but its value is `null`.'));\n          }\n          return new PropTypeError('The ' + location + ' `' + propFullName + '` is marked as required in ' + ('`' + componentName + '`, but its value is `undefined`.'));\n        }\n        return null;\n      } else {\n        return validate(props, propName, componentName, location, propFullName);\n      }\n    }\n\n    var chainedCheckType = checkType.bind(null, false);\n    chainedCheckType.isRequired = checkType.bind(null, true);\n\n    return chainedCheckType;\n  }\n\n  function createPrimitiveTypeChecker(expectedType) {\n    function validate(props, propName, componentName, location, propFullName, secret) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== expectedType) {\n        // `propValue` being instance of, say, date/regexp, pass the 'object'\n        // check, but we can offer a more precise error message here rather than\n        // 'of type `object`'.\n        var preciseType = getPreciseType(propValue);\n\n        return new PropTypeError(\n          'Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + preciseType + '` supplied to `' + componentName + '`, expected ') + ('`' + expectedType + '`.'),\n          {expectedType: expectedType}\n        );\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createAnyTypeChecker() {\n    return createChainableTypeChecker(emptyFunctionThatReturnsNull);\n  }\n\n  function createArrayOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside arrayOf.');\n      }\n      var propValue = props[propName];\n      if (!Array.isArray(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an array.'));\n      }\n      for (var i = 0; i < propValue.length; i++) {\n        var error = typeChecker(propValue, i, componentName, location, propFullName + '[' + i + ']', ReactPropTypesSecret);\n        if (error instanceof Error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!isValidElement(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createElementTypeTypeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      if (!ReactIs.isValidElementType(propValue)) {\n        var propType = getPropType(propValue);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected a single ReactElement type.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createInstanceTypeChecker(expectedClass) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!(props[propName] instanceof expectedClass)) {\n        var expectedClassName = expectedClass.name || ANONYMOUS;\n        var actualClassName = getClassName(props[propName]);\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + actualClassName + '` supplied to `' + componentName + '`, expected ') + ('instance of `' + expectedClassName + '`.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createEnumTypeChecker(expectedValues) {\n    if (!Array.isArray(expectedValues)) {\n      if (process.env.NODE_ENV !== 'production') {\n        if (arguments.length > 1) {\n          printWarning(\n            'Invalid arguments supplied to oneOf, expected an array, got ' + arguments.length + ' arguments. ' +\n            'A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).'\n          );\n        } else {\n          printWarning('Invalid argument supplied to oneOf, expected an array.');\n        }\n      }\n      return emptyFunctionThatReturnsNull;\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      for (var i = 0; i < expectedValues.length; i++) {\n        if (is(propValue, expectedValues[i])) {\n          return null;\n        }\n      }\n\n      var valuesString = JSON.stringify(expectedValues, function replacer(key, value) {\n        var type = getPreciseType(value);\n        if (type === 'symbol') {\n          return String(value);\n        }\n        return value;\n      });\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of value `' + String(propValue) + '` ' + ('supplied to `' + componentName + '`, expected one of ' + valuesString + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createObjectOfTypeChecker(typeChecker) {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (typeof typeChecker !== 'function') {\n        return new PropTypeError('Property `' + propFullName + '` of component `' + componentName + '` has invalid PropType notation inside objectOf.');\n      }\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type ' + ('`' + propType + '` supplied to `' + componentName + '`, expected an object.'));\n      }\n      for (var key in propValue) {\n        if (has(propValue, key)) {\n          var error = typeChecker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n          if (error instanceof Error) {\n            return error;\n          }\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createUnionTypeChecker(arrayOfTypeCheckers) {\n    if (!Array.isArray(arrayOfTypeCheckers)) {\n      process.env.NODE_ENV !== 'production' ? printWarning('Invalid argument supplied to oneOfType, expected an instance of array.') : void 0;\n      return emptyFunctionThatReturnsNull;\n    }\n\n    for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n      var checker = arrayOfTypeCheckers[i];\n      if (typeof checker !== 'function') {\n        printWarning(\n          'Invalid argument supplied to oneOfType. Expected an array of check functions, but ' +\n          'received ' + getPostfixForTypeWarning(checker) + ' at index ' + i + '.'\n        );\n        return emptyFunctionThatReturnsNull;\n      }\n    }\n\n    function validate(props, propName, componentName, location, propFullName) {\n      var expectedTypes = [];\n      for (var i = 0; i < arrayOfTypeCheckers.length; i++) {\n        var checker = arrayOfTypeCheckers[i];\n        var checkerResult = checker(props, propName, componentName, location, propFullName, ReactPropTypesSecret);\n        if (checkerResult == null) {\n          return null;\n        }\n        if (checkerResult.data && has(checkerResult.data, 'expectedType')) {\n          expectedTypes.push(checkerResult.data.expectedType);\n        }\n      }\n      var expectedTypesMessage = (expectedTypes.length > 0) ? ', expected one of type [' + expectedTypes.join(', ') + ']': '';\n      return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`' + expectedTypesMessage + '.'));\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createNodeChecker() {\n    function validate(props, propName, componentName, location, propFullName) {\n      if (!isNode(props[propName])) {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` supplied to ' + ('`' + componentName + '`, expected a ReactNode.'));\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function invalidValidatorError(componentName, location, propFullName, key, type) {\n    return new PropTypeError(\n      (componentName || 'React class') + ': ' + location + ' type `' + propFullName + '.' + key + '` is invalid; ' +\n      'it must be a function, usually from the `prop-types` package, but received `' + type + '`.'\n    );\n  }\n\n  function createShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      for (var key in shapeTypes) {\n        var checker = shapeTypes[key];\n        if (typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n    return createChainableTypeChecker(validate);\n  }\n\n  function createStrictShapeTypeChecker(shapeTypes) {\n    function validate(props, propName, componentName, location, propFullName) {\n      var propValue = props[propName];\n      var propType = getPropType(propValue);\n      if (propType !== 'object') {\n        return new PropTypeError('Invalid ' + location + ' `' + propFullName + '` of type `' + propType + '` ' + ('supplied to `' + componentName + '`, expected `object`.'));\n      }\n      // We need to check all keys in case some are required but missing from props.\n      var allKeys = assign({}, props[propName], shapeTypes);\n      for (var key in allKeys) {\n        var checker = shapeTypes[key];\n        if (has(shapeTypes, key) && typeof checker !== 'function') {\n          return invalidValidatorError(componentName, location, propFullName, key, getPreciseType(checker));\n        }\n        if (!checker) {\n          return new PropTypeError(\n            'Invalid ' + location + ' `' + propFullName + '` key `' + key + '` supplied to `' + componentName + '`.' +\n            '\\nBad object: ' + JSON.stringify(props[propName], null, '  ') +\n            '\\nValid keys: ' + JSON.stringify(Object.keys(shapeTypes), null, '  ')\n          );\n        }\n        var error = checker(propValue, key, componentName, location, propFullName + '.' + key, ReactPropTypesSecret);\n        if (error) {\n          return error;\n        }\n      }\n      return null;\n    }\n\n    return createChainableTypeChecker(validate);\n  }\n\n  function isNode(propValue) {\n    switch (typeof propValue) {\n      case 'number':\n      case 'string':\n      case 'undefined':\n        return true;\n      case 'boolean':\n        return !propValue;\n      case 'object':\n        if (Array.isArray(propValue)) {\n          return propValue.every(isNode);\n        }\n        if (propValue === null || isValidElement(propValue)) {\n          return true;\n        }\n\n        var iteratorFn = getIteratorFn(propValue);\n        if (iteratorFn) {\n          var iterator = iteratorFn.call(propValue);\n          var step;\n          if (iteratorFn !== propValue.entries) {\n            while (!(step = iterator.next()).done) {\n              if (!isNode(step.value)) {\n                return false;\n              }\n            }\n          } else {\n            // Iterator will provide entry [k,v] tuples rather than values.\n            while (!(step = iterator.next()).done) {\n              var entry = step.value;\n              if (entry) {\n                if (!isNode(entry[1])) {\n                  return false;\n                }\n              }\n            }\n          }\n        } else {\n          return false;\n        }\n\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  function isSymbol(propType, propValue) {\n    // Native Symbol.\n    if (propType === 'symbol') {\n      return true;\n    }\n\n    // falsy value can't be a Symbol\n    if (!propValue) {\n      return false;\n    }\n\n    // 19.4.3.5 Symbol.prototype[@@toStringTag] === 'Symbol'\n    if (propValue['@@toStringTag'] === 'Symbol') {\n      return true;\n    }\n\n    // Fallback for non-spec compliant Symbols which are polyfilled.\n    if (typeof Symbol === 'function' && propValue instanceof Symbol) {\n      return true;\n    }\n\n    return false;\n  }\n\n  // Equivalent of `typeof` but with special handling for array and regexp.\n  function getPropType(propValue) {\n    var propType = typeof propValue;\n    if (Array.isArray(propValue)) {\n      return 'array';\n    }\n    if (propValue instanceof RegExp) {\n      // Old webkits (at least until Android 4.0) return 'function' rather than\n      // 'object' for typeof a RegExp. We'll normalize this here so that /bla/\n      // passes PropTypes.object.\n      return 'object';\n    }\n    if (isSymbol(propType, propValue)) {\n      return 'symbol';\n    }\n    return propType;\n  }\n\n  // This handles more types than `getPropType`. Only used for error messages.\n  // See `createPrimitiveTypeChecker`.\n  function getPreciseType(propValue) {\n    if (typeof propValue === 'undefined' || propValue === null) {\n      return '' + propValue;\n    }\n    var propType = getPropType(propValue);\n    if (propType === 'object') {\n      if (propValue instanceof Date) {\n        return 'date';\n      } else if (propValue instanceof RegExp) {\n        return 'regexp';\n      }\n    }\n    return propType;\n  }\n\n  // Returns a string that is postfixed to a warning about an invalid type.\n  // For example, \"undefined\" or \"of type array\"\n  function getPostfixForTypeWarning(value) {\n    var type = getPreciseType(value);\n    switch (type) {\n      case 'array':\n      case 'object':\n        return 'an ' + type;\n      case 'boolean':\n      case 'date':\n      case 'regexp':\n        return 'a ' + type;\n      default:\n        return type;\n    }\n  }\n\n  // Returns class name of the object, if any.\n  function getClassName(propValue) {\n    if (!propValue.constructor || !propValue.constructor.name) {\n      return ANONYMOUS;\n    }\n    return propValue.constructor.name;\n  }\n\n  ReactPropTypes.checkPropTypes = checkPropTypes;\n  ReactPropTypes.resetWarningCache = checkPropTypes.resetWarningCache;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/*!\n* tabbable 5.3.3\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\nvar candidateSelectors = ['input', 'select', 'textarea', 'a[href]', 'button', '[tabindex]:not(slot)', 'audio[controls]', 'video[controls]', '[contenteditable]:not([contenteditable=\"false\"])', 'details>summary:first-of-type', 'details'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar NoElement = typeof Element === 'undefined';\nvar matches = NoElement ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\nvar getRootNode = !NoElement && Element.prototype.getRootNode ? function (element) {\n  return element.getRootNode();\n} : function (element) {\n  return element.ownerDocument;\n};\n/**\n * @param {Element} el container to check in\n * @param {boolean} includeContainer add container to check\n * @param {(node: Element) => boolean} filter filter candidates\n * @returns {Element[]}\n */\n\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n/**\n * @callback GetShadowRoot\n * @param {Element} element to check for shadow root\n * @returns {ShadowRoot|boolean} ShadowRoot if available or boolean indicating if a shadowRoot is attached but not available.\n */\n\n/**\n * @callback ShadowRootFilter\n * @param {Element} shadowHostNode the element which contains shadow content\n * @returns {boolean} true if a shadow root could potentially contain valid candidates.\n */\n\n/**\n * @typedef {Object} CandidatesScope\n * @property {Element} scope contains inner candidates\n * @property {Element[]} candidates\n */\n\n/**\n * @typedef {Object} IterativeOptions\n * @property {GetShadowRoot|boolean} getShadowRoot true if shadow support is enabled; falsy if not;\n *  if a function, implies shadow support is enabled and either returns the shadow root of an element\n *  or a boolean stating if it has an undisclosed shadow root\n * @property {(node: Element) => boolean} filter filter candidates\n * @property {boolean} flatten if true then result will flatten any CandidatesScope into the returned list\n * @property {ShadowRootFilter} shadowRootFilter filter shadow roots;\n */\n\n/**\n * @param {Element[]} elements list of element containers to match candidates from\n * @param {boolean} includeContainer add container list to check\n * @param {IterativeOptions} options\n * @returns {Array.<Element|CandidatesScope>}\n */\n\n\nvar getCandidatesIteratively = function getCandidatesIteratively(elements, includeContainer, options) {\n  var candidates = [];\n  var elementsToCheck = Array.from(elements);\n\n  while (elementsToCheck.length) {\n    var element = elementsToCheck.shift();\n\n    if (element.tagName === 'SLOT') {\n      // add shadow dom slot scope (slot itself cannot be focusable)\n      var assigned = element.assignedElements();\n      var content = assigned.length ? assigned : element.children;\n      var nestedCandidates = getCandidatesIteratively(content, true, options);\n\n      if (options.flatten) {\n        candidates.push.apply(candidates, nestedCandidates);\n      } else {\n        candidates.push({\n          scope: element,\n          candidates: nestedCandidates\n        });\n      }\n    } else {\n      // check candidate element\n      var validCandidate = matches.call(element, candidateSelector);\n\n      if (validCandidate && options.filter(element) && (includeContainer || !elements.includes(element))) {\n        candidates.push(element);\n      } // iterate over shadow content if possible\n\n\n      var shadowRoot = element.shadowRoot || // check for an undisclosed shadow\n      typeof options.getShadowRoot === 'function' && options.getShadowRoot(element);\n      var validShadowRoot = !options.shadowRootFilter || options.shadowRootFilter(element);\n\n      if (shadowRoot && validShadowRoot) {\n        // add shadow dom scope IIF a shadow root node was given; otherwise, an undisclosed\n        //  shadow exists, so look at light dom children as fallback BUT create a scope for any\n        //  child candidates found because they're likely slotted elements (elements that are\n        //  children of the web component element (which has the shadow), in the light dom, but\n        //  slotted somewhere _inside_ the undisclosed shadow) -- the scope is created below,\n        //  _after_ we return from this recursive call\n        var _nestedCandidates = getCandidatesIteratively(shadowRoot === true ? element.children : shadowRoot.children, true, options);\n\n        if (options.flatten) {\n          candidates.push.apply(candidates, _nestedCandidates);\n        } else {\n          candidates.push({\n            scope: element,\n            candidates: _nestedCandidates\n          });\n        }\n      } else {\n        // there's not shadow so just dig into the element's (light dom) children\n        //  __without__ giving the element special scope treatment\n        elementsToCheck.unshift.apply(elementsToCheck, element.children);\n      }\n    }\n  }\n\n  return candidates;\n};\n\nvar getTabindex = function getTabindex(node, isScope) {\n  if (node.tabIndex < 0) {\n    // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n    // `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n    // yet they are still part of the regular tab order; in FF, they get a default\n    // `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n    // order, consider their tab index to be 0.\n    // Also browsers do not return `tabIndex` correctly for contentEditable nodes;\n    // so if they don't have a tabindex attribute specifically set, assume it's 0.\n    //\n    // isScope is positive for custom element with shadow root or slot that by default\n    // have tabIndex -1, but need to be sorted by document order in order for their\n    // content to be inserted in the correct position\n    if ((isScope || /^(AUDIO|VIDEO|DETAILS)$/.test(node.tagName) || node.isContentEditable) && isNaN(parseInt(node.getAttribute('tabindex'), 10))) {\n      return 0;\n    }\n  }\n\n  return node.tabIndex;\n};\n\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\n\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\n\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\n\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n\n  var radioScope = node.form || getRootNode(node);\n\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n\n  var radioSet;\n\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nvar isZeroArea = function isZeroArea(node) {\n  var _node$getBoundingClie = node.getBoundingClientRect(),\n      width = _node$getBoundingClie.width,\n      height = _node$getBoundingClie.height;\n\n  return width === 0 && height === 0;\n};\n\nvar isHidden = function isHidden(node, _ref) {\n  var displayCheck = _ref.displayCheck,\n      getShadowRoot = _ref.getShadowRoot;\n\n  // NOTE: visibility will be `undefined` if node is detached from the document\n  //  (see notes about this further down), which means we will consider it visible\n  //  (this is legacy behavior from a very long way back)\n  // NOTE: we check this regardless of `displayCheck=\"none\"` because this is a\n  //  _visibility_ check, not a _display_ check\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  } // The root node is the shadow root if the node is in a shadow DOM; some document otherwise\n  //  (but NOT _the_ document; see second 'If' comment below for more).\n  // If rootNode is shadow root, it'll have a host, which is the element to which the shadow\n  //  is attached, and the one we need to check if it's in the document or not (because the\n  //  shadow, and all nodes it contains, is never considered in the document since shadows\n  //  behave like self-contained DOMs; but if the shadow's HOST, which is part of the document,\n  //  is hidden, or is not in the document itself but is detached, it will affect the shadow's\n  //  visibility, including all the nodes it contains). The host could be any normal node,\n  //  or a custom element (i.e. web component). Either way, that's the one that is considered\n  //  part of the document, not the shadow root, nor any of its children (i.e. the node being\n  //  tested).\n  // If rootNode is not a shadow root, it won't have a host, and so rootNode should be the\n  //  document (per the docs) and while it's a Document-type object, that document does not\n  //  appear to be the same as the node's `ownerDocument` for some reason, so it's safer\n  //  to ignore the rootNode at this point, and use `node.ownerDocument`. Otherwise,\n  //  using `rootNode.contains(node)` will _always_ be true we'll get false-positives when\n  //  node is actually detached.\n\n\n  var nodeRootHost = getRootNode(node).host;\n  var nodeIsAttached = (nodeRootHost === null || nodeRootHost === void 0 ? void 0 : nodeRootHost.ownerDocument.contains(nodeRootHost)) || node.ownerDocument.contains(node);\n\n  if (!displayCheck || displayCheck === 'full') {\n    if (typeof getShadowRoot === 'function') {\n      // figure out if we should consider the node to be in an undisclosed shadow and use the\n      //  'non-zero-area' fallback\n      var originalNode = node;\n\n      while (node) {\n        var parentElement = node.parentElement;\n        var rootNode = getRootNode(node);\n\n        if (parentElement && !parentElement.shadowRoot && getShadowRoot(parentElement) === true // check if there's an undisclosed shadow\n        ) {\n          // node has an undisclosed shadow which means we can only treat it as a black box, so we\n          //  fall back to a non-zero-area test\n          return isZeroArea(node);\n        } else if (node.assignedSlot) {\n          // iterate up slot\n          node = node.assignedSlot;\n        } else if (!parentElement && rootNode !== node.ownerDocument) {\n          // cross shadow boundary\n          node = rootNode.host;\n        } else {\n          // iterate up normal dom\n          node = parentElement;\n        }\n      }\n\n      node = originalNode;\n    } // else, `getShadowRoot` might be true, but all that does is enable shadow DOM support\n    //  (i.e. it does not also presume that all nodes might have undisclosed shadows); or\n    //  it might be a falsy value, which means shadow DOM support is disabled\n    // Since we didn't find it sitting in an undisclosed shadow (or shadows are disabled)\n    //  now we can just test to see if it would normally be visible or not, provided it's\n    //  attached to the main document.\n    // NOTE: We must consider case where node is inside a shadow DOM and given directly to\n    //  `isTabbable()` or `isFocusable()` -- regardless of `getShadowRoot` option setting.\n\n\n    if (nodeIsAttached) {\n      // this works wherever the node is: if there's at least one client rect, it's\n      //  somehow displayed; it also covers the CSS 'display: contents' case where the\n      //  node itself is hidden in place of its contents; and there's no need to search\n      //  up the hierarchy either\n      return !node.getClientRects().length;\n    } // Else, the node isn't attached to the document, which means the `getClientRects()`\n    //  API will __always__ return zero rects (this can happen, for example, if React\n    //  is used to render nodes onto a detached tree, as confirmed in this thread:\n    //  https://github.com/facebook/react/issues/9117#issuecomment-284228870)\n    //\n    // It also means that even window.getComputedStyle(node).display will return `undefined`\n    //  because styles are only computed for nodes that are in the document.\n    //\n    // NOTE: THIS HAS BEEN THE CASE FOR YEARS. It is not new, nor is it caused by tabbable\n    //  somehow. Though it was never stated officially, anyone who has ever used tabbable\n    //  APIs on nodes in detached containers has actually implicitly used tabbable in what\n    //  was later (as of v5.2.0 on Apr 9, 2021) called `displayCheck=\"none\"` mode -- essentially\n    //  considering __everything__ to be visible because of the innability to determine styles.\n\n  } else if (displayCheck === 'non-zero-area') {\n    // NOTE: Even though this tests that the node's client rect is non-zero to determine\n    //  whether it's displayed, and that a detached node will __always__ have a zero-area\n    //  client rect, we don't special-case for whether the node is attached or not. In\n    //  this mode, we do want to consider nodes that have a zero area to be hidden at all\n    //  times, and that includes attached or not.\n    return isZeroArea(node);\n  } // visible, as far as we can tell, or per current `displayCheck` mode\n\n\n  return false;\n}; // form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\n\n\nvar isDisabledFromFieldset = function isDisabledFromFieldset(node) {\n  if (/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(node.tagName)) {\n    var parentNode = node.parentElement; // check if `node` is contained in a disabled <fieldset>\n\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> among the children of the disabled <fieldset>\n        for (var i = 0; i < parentNode.children.length; i++) {\n          var child = parentNode.children.item(i); // when the first <legend> (in document order) is found\n\n          if (child.tagName === 'LEGEND') {\n            // if its parent <fieldset> is not nested in another disabled <fieldset>,\n            // return whether `node` is a descendant of its first <legend>\n            return matches.call(parentNode, 'fieldset[disabled] *') ? true : !child.contains(node);\n          }\n        } // the disabled <fieldset> containing `node` has no <legend>\n\n\n        return true;\n      }\n\n      parentNode = parentNode.parentElement;\n    }\n  } // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n\n\n  return false;\n};\n\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled || isHiddenInput(node) || isHidden(node, options) || // For a details element with a summary, the summary element gets the focus\n  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (isNonTabbableRadio(node) || getTabindex(node) < 0 || !isNodeMatchingSelectorFocusable(options, node)) {\n    return false;\n  }\n\n  return true;\n};\n\nvar isValidShadowRootTabbable = function isValidShadowRootTabbable(shadowHostNode) {\n  var tabIndex = parseInt(shadowHostNode.getAttribute('tabindex'), 10);\n\n  if (isNaN(tabIndex) || tabIndex >= 0) {\n    return true;\n  } // If a custom element has an explicit negative tabindex,\n  // browsers will not allow tab targeting said element's children.\n\n\n  return false;\n};\n/**\n * @param {Array.<Element|CandidatesScope>} candidates\n * @returns Element[]\n */\n\n\nvar sortByOrder = function sortByOrder(candidates) {\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  candidates.forEach(function (item, i) {\n    var isScope = !!item.scope;\n    var element = isScope ? item.scope : item;\n    var candidateTabindex = getTabindex(element, isScope);\n    var elements = isScope ? sortByOrder(item.candidates) : element;\n\n    if (candidateTabindex === 0) {\n      isScope ? regularTabbables.push.apply(regularTabbables, elements) : regularTabbables.push(element);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        item: item,\n        isScope: isScope,\n        content: elements\n      });\n    }\n  });\n  return orderedTabbables.sort(sortOrderedTabbables).reduce(function (acc, sortable) {\n    sortable.isScope ? acc.push.apply(acc, sortable.content) : acc.push(sortable.content);\n    return acc;\n  }, []).concat(regularTabbables);\n};\n\nvar tabbable = function tabbable(el, options) {\n  options = options || {};\n  var candidates;\n\n  if (options.getShadowRoot) {\n    candidates = getCandidatesIteratively([el], options.includeContainer, {\n      filter: isNodeMatchingSelectorTabbable.bind(null, options),\n      flatten: false,\n      getShadowRoot: options.getShadowRoot,\n      shadowRootFilter: isValidShadowRootTabbable\n    });\n  } else {\n    candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  }\n\n  return sortByOrder(candidates);\n};\n\nvar focusable = function focusable(el, options) {\n  options = options || {};\n  var candidates;\n\n  if (options.getShadowRoot) {\n    candidates = getCandidatesIteratively([el], options.includeContainer, {\n      filter: isNodeMatchingSelectorFocusable.bind(null, options),\n      flatten: true,\n      getShadowRoot: options.getShadowRoot\n    });\n  } else {\n    candidates = getCandidates(el, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  }\n\n  return candidates;\n};\n\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\n\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n\n  if (!node) {\n    throw new Error('No node provided');\n  }\n\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","/*!\n* focus-trap 6.9.4\n* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE\n*/\nimport { tabbable, focusable, isTabbable, isFocusable } from 'tabbable';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar activeFocusTraps = function () {\n  var trapQueue = [];\n  return {\n    activateTrap: function activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        var activeTrap = trapQueue[trapQueue.length - 1];\n\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n    deactivateTrap: function deactivateTrap(trap) {\n      var trapIndex = trapQueue.indexOf(trap);\n\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    }\n  };\n}();\n\nvar isSelectableInput = function isSelectableInput(node) {\n  return node.tagName && node.tagName.toLowerCase() === 'input' && typeof node.select === 'function';\n};\n\nvar isEscapeEvent = function isEscapeEvent(e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nvar isTabEvent = function isTabEvent(e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nvar delay = function delay(fn) {\n  return setTimeout(fn, 0);\n}; // Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\n\n\nvar findIndex = function findIndex(arr, fn) {\n  var idx = -1;\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n  return idx;\n};\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\n\n\nvar valueOrHandler = function valueOrHandler(value) {\n  for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    params[_key - 1] = arguments[_key];\n  }\n\n  return typeof value === 'function' ? value.apply(void 0, params) : value;\n};\n\nvar getActualTarget = function getActualTarget(event) {\n  // NOTE: If the trap is _inside_ a shadow DOM, event.target will always be the\n  //  shadow host. However, event.target.composedPath() will be an array of\n  //  nodes \"clicked\" from inner-most (the actual element inside the shadow) to\n  //  outer-most (the host HTML document). If we have access to composedPath(),\n  //  then use its first element; otherwise, fall back to event.target (and\n  //  this only works for an _open_ shadow DOM; otherwise,\n  //  composedPath()[0] === event.target always).\n  return event.target.shadowRoot && typeof event.composedPath === 'function' ? event.composedPath()[0] : event.target;\n};\n\nvar createFocusTrap = function createFocusTrap(elements, userOptions) {\n  // SSR: a live trap shouldn't be created in this type of environment so this\n  //  should be safe code to execute if the `document` option isn't specified\n  var doc = (userOptions === null || userOptions === void 0 ? void 0 : userOptions.document) || document;\n\n  var config = _objectSpread2({\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true\n  }, userOptions);\n\n  var state = {\n    // containers given to createFocusTrap()\n    // @type {Array<HTMLElement>}\n    containers: [],\n    // list of objects identifying tabbable nodes in `containers` in the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{\n    //   container: HTMLElement,\n    //   tabbableNodes: Array<HTMLElement>, // empty if none\n    //   focusableNodes: Array<HTMLElement>, // empty if none\n    //   firstTabbableNode: HTMLElement|null,\n    //   lastTabbableNode: HTMLElement|null,\n    //   nextTabbableNode: (node: HTMLElement, forward: boolean) => HTMLElement|undefined\n    // }>}\n    containerGroups: [],\n    // same order/length as `containers` list\n    // references to objects in `containerGroups`, but only those that actually have\n    //  tabbable nodes in them\n    // NOTE: same order as `containers` and `containerGroups`, but __not necessarily__\n    //  the same length\n    tabbableGroups: [],\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n    // timer ID for when delayInitialFocus is true and initial focus in this trap\n    //  has been delayed during activation\n    delayInitialFocusTimer: undefined\n  };\n  var trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  /**\n   * Gets a configuration option value.\n   * @param {Object|undefined} configOverrideOptions If true, and option is defined in this set,\n   *  value will be taken from this object. Otherwise, value will be taken from base configuration.\n   * @param {string} optionName Name of the option whose value is sought.\n   * @param {string|undefined} [configOptionName] Name of option to use __instead of__ `optionName`\n   *  IIF `configOverrideOptions` is not defined. Otherwise, `optionName` is used.\n   */\n\n  var getOption = function getOption(configOverrideOptions, optionName, configOptionName) {\n    return configOverrideOptions && configOverrideOptions[optionName] !== undefined ? configOverrideOptions[optionName] : config[configOptionName || optionName];\n  };\n  /**\n   * Finds the index of the container that contains the element.\n   * @param {HTMLElement} element\n   * @returns {number} Index of the container in either `state.containers` or\n   *  `state.containerGroups` (the order/length of these lists are the same); -1\n   *  if the element isn't found.\n   */\n\n\n  var findContainerIndex = function findContainerIndex(element) {\n    // NOTE: search `containerGroups` because it's possible a group contains no tabbable\n    //  nodes, but still contains focusable nodes (e.g. if they all have `tabindex=-1`)\n    //  and we still need to find the element in there\n    return state.containerGroups.findIndex(function (_ref) {\n      var container = _ref.container,\n          tabbableNodes = _ref.tabbableNodes;\n      return container.contains(element) || // fall back to explicit tabbable search which will take into consideration any\n      //  web components if the `tabbableOptions.getShadowRoot` option was used for\n      //  the trap, enabling shadow DOM support in tabbable (`Node.contains()` doesn't\n      //  look inside web components even if open)\n      tabbableNodes.find(function (node) {\n        return node === element;\n      });\n    });\n  };\n  /**\n   * Gets the node for the given option, which is expected to be an option that\n   *  can be either a DOM node, a string that is a selector to get a node, `false`\n   *  (if a node is explicitly NOT given), or a function that returns any of these\n   *  values.\n   * @param {string} optionName\n   * @returns {undefined | false | HTMLElement | SVGElement} Returns\n   *  `undefined` if the option is not specified; `false` if the option\n   *  resolved to `false` (node explicitly not given); otherwise, the resolved\n   *  DOM node.\n   * @throws {Error} If the option is set, not `false`, and is not, or does not\n   *  resolve to a node.\n   */\n\n\n  var getNodeForOption = function getNodeForOption(optionName) {\n    var optionValue = config[optionName];\n\n    if (typeof optionValue === 'function') {\n      for (var _len2 = arguments.length, params = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        params[_key2 - 1] = arguments[_key2];\n      }\n\n      optionValue = optionValue.apply(void 0, params);\n    }\n\n    if (optionValue === true) {\n      optionValue = undefined; // use default value\n    }\n\n    if (!optionValue) {\n      if (optionValue === undefined || optionValue === false) {\n        return optionValue;\n      } // else, empty string (invalid), null (invalid), 0 (invalid)\n\n\n      throw new Error(\"`\".concat(optionName, \"` was specified but was not a node, or did not return a node\"));\n    }\n\n    var node = optionValue; // could be HTMLElement, SVGElement, or non-empty string at this point\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue); // resolve to node, or null if fails\n\n      if (!node) {\n        throw new Error(\"`\".concat(optionName, \"` as selector refers to no known node\"));\n      }\n    }\n\n    return node;\n  };\n\n  var getInitialFocusNode = function getInitialFocusNode() {\n    var node = getNodeForOption('initialFocus'); // false explicitly indicates we want no initialFocus at all\n\n    if (node === false) {\n      return false;\n    }\n\n    if (node === undefined) {\n      // option not specified: use fallback options\n      if (findContainerIndex(doc.activeElement) >= 0) {\n        node = doc.activeElement;\n      } else {\n        var firstTabbableGroup = state.tabbableGroups[0];\n        var firstTabbableNode = firstTabbableGroup && firstTabbableGroup.firstTabbableNode; // NOTE: `fallbackFocus` option function cannot return `false` (not supported)\n\n        node = firstTabbableNode || getNodeForOption('fallbackFocus');\n      }\n    }\n\n    if (!node) {\n      throw new Error('Your focus-trap needs to have at least one focusable element');\n    }\n\n    return node;\n  };\n\n  var updateTabbableNodes = function updateTabbableNodes() {\n    state.containerGroups = state.containers.map(function (container) {\n      var tabbableNodes = tabbable(container, config.tabbableOptions); // NOTE: if we have tabbable nodes, we must have focusable nodes; focusable nodes\n      //  are a superset of tabbable nodes\n\n      var focusableNodes = focusable(container, config.tabbableOptions);\n      return {\n        container: container,\n        tabbableNodes: tabbableNodes,\n        focusableNodes: focusableNodes,\n        firstTabbableNode: tabbableNodes.length > 0 ? tabbableNodes[0] : null,\n        lastTabbableNode: tabbableNodes.length > 0 ? tabbableNodes[tabbableNodes.length - 1] : null,\n\n        /**\n         * Finds the __tabbable__ node that follows the given node in the specified direction,\n         *  in this container, if any.\n         * @param {HTMLElement} node\n         * @param {boolean} [forward] True if going in forward tab order; false if going\n         *  in reverse.\n         * @returns {HTMLElement|undefined} The next tabbable node, if any.\n         */\n        nextTabbableNode: function nextTabbableNode(node) {\n          var forward = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n          // NOTE: If tabindex is positive (in order to manipulate the tab order separate\n          //  from the DOM order), this __will not work__ because the list of focusableNodes,\n          //  while it contains tabbable nodes, does not sort its nodes in any order other\n          //  than DOM order, because it can't: Where would you place focusable (but not\n          //  tabbable) nodes in that order? They have no order, because they aren't tabbale...\n          // Support for positive tabindex is already broken and hard to manage (possibly\n          //  not supportable, TBD), so this isn't going to make things worse than they\n          //  already are, and at least makes things better for the majority of cases where\n          //  tabindex is either 0/unset or negative.\n          // FYI, positive tabindex issue: https://github.com/focus-trap/focus-trap/issues/375\n          var nodeIdx = focusableNodes.findIndex(function (n) {\n            return n === node;\n          });\n\n          if (nodeIdx < 0) {\n            return undefined;\n          }\n\n          if (forward) {\n            return focusableNodes.slice(nodeIdx + 1).find(function (n) {\n              return isTabbable(n, config.tabbableOptions);\n            });\n          }\n\n          return focusableNodes.slice(0, nodeIdx).reverse().find(function (n) {\n            return isTabbable(n, config.tabbableOptions);\n          });\n        }\n      };\n    });\n    state.tabbableGroups = state.containerGroups.filter(function (group) {\n      return group.tabbableNodes.length > 0;\n    }); // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n\n    if (state.tabbableGroups.length <= 0 && !getNodeForOption('fallbackFocus') // returning false not supported for this option\n    ) {\n      throw new Error('Your focus-trap must have at least one container with at least one tabbable node in it at all times');\n    }\n  };\n\n  var tryFocus = function tryFocus(node) {\n    if (node === false) {\n      return;\n    }\n\n    if (node === doc.activeElement) {\n      return;\n    }\n\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({\n      preventScroll: !!config.preventScroll\n    });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  var getReturnFocusNode = function getReturnFocusNode(previousActiveElement) {\n    var node = getNodeForOption('setReturnFocus', previousActiveElement);\n    return node ? node : node === false ? false : previousActiveElement;\n  }; // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n\n\n  var checkPointerDown = function checkPointerDown(e) {\n    var target = getActualTarget(e);\n\n    if (findContainerIndex(target) >= 0) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(target, config.tabbableOptions)\n      });\n      return;\n    } // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    } // otherwise, prevent the click\n\n\n    e.preventDefault();\n  }; // In case focus escapes the trap for some strange reason, pull it back in.\n\n\n  var checkFocusIn = function checkFocusIn(e) {\n    var target = getActualTarget(e);\n    var targetContained = findContainerIndex(target) >= 0; // In Firefox when you Tab out of an iframe the Document is briefly focused.\n\n    if (targetContained || target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  }; // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n\n\n  var checkTab = function checkTab(e) {\n    var target = getActualTarget(e);\n    updateTabbableNodes();\n    var destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      // NOTE: the target may also be the container itself if it's focusable\n      //  with tabIndex='-1' and was given initial focus\n      var containerIndex = findContainerIndex(target);\n      var containerGroup = containerIndex >= 0 ? state.containerGroups[containerIndex] : undefined;\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode = state.tabbableGroups[state.tabbableGroups.length - 1].lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        // is the target the first tabbable node in a group?\n        var startOfGroupIndex = findIndex(state.tabbableGroups, function (_ref2) {\n          var firstTabbableNode = _ref2.firstTabbableNode;\n          return target === firstTabbableNode;\n        });\n\n        if (startOfGroupIndex < 0 && (containerGroup.container === target || isFocusable(target, config.tabbableOptions) && !isTabbable(target, config.tabbableOptions) && !containerGroup.nextTabbableNode(target, false))) {\n          // an exception case where the target is either the container itself, or\n          //  a non-tabbable node that was given focus (i.e. tabindex is negative\n          //  and user clicked on it or node was programmatically given focus)\n          //  and is not followed by any other tabbable node, in which\n          //  case, we should handle shift+tab as if focus were on the container's\n          //  first tabbable node, and go to the last tabbable node of the LAST group\n          startOfGroupIndex = containerIndex;\n        }\n\n        if (startOfGroupIndex >= 0) {\n          // YES: then shift+tab should go to the last tabbable node in the\n          //  previous group (and wrap around to the last tabbable node of\n          //  the LAST group if it's the first tabbable node of the FIRST group)\n          var destinationGroupIndex = startOfGroupIndex === 0 ? state.tabbableGroups.length - 1 : startOfGroupIndex - 1;\n          var destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        // is the target the last tabbable node in a group?\n        var lastOfGroupIndex = findIndex(state.tabbableGroups, function (_ref3) {\n          var lastTabbableNode = _ref3.lastTabbableNode;\n          return target === lastTabbableNode;\n        });\n\n        if (lastOfGroupIndex < 0 && (containerGroup.container === target || isFocusable(target, config.tabbableOptions) && !isTabbable(target, config.tabbableOptions) && !containerGroup.nextTabbableNode(target))) {\n          // an exception case where the target is the container itself, or\n          //  a non-tabbable node that was given focus (i.e. tabindex is negative\n          //  and user clicked on it or node was programmatically given focus)\n          //  and is not followed by any other tabbable node, in which\n          //  case, we should handle tab as if focus were on the container's\n          //  last tabbable node, and go to the first tabbable node of the FIRST group\n          lastOfGroupIndex = containerIndex;\n        }\n\n        if (lastOfGroupIndex >= 0) {\n          // YES: then tab should go to the first tabbable node in the next\n          //  group (and wrap around to the first tabbable node of the FIRST\n          //  group if it's the last tabbable node of the LAST group)\n          var _destinationGroupIndex = lastOfGroupIndex === state.tabbableGroups.length - 1 ? 0 : lastOfGroupIndex + 1;\n\n          var _destinationGroup = state.tabbableGroups[_destinationGroupIndex];\n          destinationNode = _destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      // NOTE: the fallbackFocus option does not support returning false to opt-out\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    } // else, let the browser take care of [shift+]tab and move the focus\n\n  };\n\n  var checkKey = function checkKey(e) {\n    if (isEscapeEvent(e) && valueOrHandler(config.escapeDeactivates, e) !== false) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  var checkClick = function checkClick(e) {\n    var target = getActualTarget(e);\n\n    if (findContainerIndex(target) >= 0) {\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  }; //\n  // EVENT LISTENERS\n  //\n\n\n  var addListeners = function addListeners() {\n    if (!state.active) {\n      return;\n    } // There can be only one listening focus trap at a time\n\n\n    activeFocusTraps.activateTrap(trap); // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n\n    state.delayInitialFocusTimer = config.delayInitialFocus ? delay(function () {\n      tryFocus(getInitialFocusNode());\n    }) : tryFocus(getInitialFocusNode());\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false\n    });\n    return trap;\n  };\n\n  var removeListeners = function removeListeners() {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n    return trap;\n  }; //\n  // TRAP DEFINITION\n  //\n\n\n  trap = {\n    get active() {\n      return state.active;\n    },\n\n    get paused() {\n      return state.paused;\n    },\n\n    activate: function activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      var onActivate = getOption(activateOptions, 'onActivate');\n      var onPostActivate = getOption(activateOptions, 'onPostActivate');\n      var checkCanFocusTrap = getOption(activateOptions, 'checkCanFocusTrap');\n\n      if (!checkCanFocusTrap) {\n        updateTabbableNodes();\n      }\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      if (onActivate) {\n        onActivate();\n      }\n\n      var finishActivation = function finishActivation() {\n        if (checkCanFocusTrap) {\n          updateTabbableNodes();\n        }\n\n        addListeners();\n\n        if (onPostActivate) {\n          onPostActivate();\n        }\n      };\n\n      if (checkCanFocusTrap) {\n        checkCanFocusTrap(state.containers.concat()).then(finishActivation, finishActivation);\n        return this;\n      }\n\n      finishActivation();\n      return this;\n    },\n    deactivate: function deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      var options = _objectSpread2({\n        onDeactivate: config.onDeactivate,\n        onPostDeactivate: config.onPostDeactivate,\n        checkCanReturnFocus: config.checkCanReturnFocus\n      }, deactivateOptions);\n\n      clearTimeout(state.delayInitialFocusTimer); // noop if undefined\n\n      state.delayInitialFocusTimer = undefined;\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n      activeFocusTraps.deactivateTrap(trap);\n      var onDeactivate = getOption(options, 'onDeactivate');\n      var onPostDeactivate = getOption(options, 'onPostDeactivate');\n      var checkCanReturnFocus = getOption(options, 'checkCanReturnFocus');\n      var returnFocus = getOption(options, 'returnFocus', 'returnFocusOnDeactivate');\n\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      var finishDeactivation = function finishDeactivation() {\n        delay(function () {\n          if (returnFocus) {\n            tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n          }\n\n          if (onPostDeactivate) {\n            onPostDeactivate();\n          }\n        });\n      };\n\n      if (returnFocus && checkCanReturnFocus) {\n        checkCanReturnFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation)).then(finishDeactivation, finishDeactivation);\n        return this;\n      }\n\n      finishDeactivation();\n      return this;\n    },\n    pause: function pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n      return this;\n    },\n    unpause: function unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n      return this;\n    },\n    updateContainerElements: function updateContainerElements(containerElements) {\n      var elementsAsArray = [].concat(containerElements).filter(Boolean);\n      state.containers = elementsAsArray.map(function (element) {\n        return typeof element === 'string' ? doc.querySelector(element) : element;\n      });\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    }\n  }; // initialize container elements\n\n  trap.updateContainerElements(elements);\n  return trap;\n};\n\nexport { createFocusTrap };\n//# sourceMappingURL=focus-trap.esm.js.map\n","\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar React = require('react');\n\nvar PropTypes = require('prop-types');\n\nvar _require = require('focus-trap'),\n    createFocusTrap = _require.createFocusTrap;\n\nvar _require2 = require('tabbable'),\n    isFocusable = _require2.isFocusable;\n\nvar FocusTrap = /*#__PURE__*/function (_React$Component) {\n  _inherits(FocusTrap, _React$Component);\n\n  var _super = _createSuper(FocusTrap);\n\n  function FocusTrap(props) {\n    var _this;\n\n    _classCallCheck(this, FocusTrap);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"getNodeForOption\", function (optionName) {\n      var _this$internalOptions;\n\n      // use internal options first, falling back to original options\n      var optionValue = (_this$internalOptions = this.internalOptions[optionName]) !== null && _this$internalOptions !== void 0 ? _this$internalOptions : this.originalOptions[optionName];\n\n      if (typeof optionValue === 'function') {\n        for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          params[_key - 1] = arguments[_key];\n        }\n\n        optionValue = optionValue.apply(void 0, params);\n      }\n\n      if (optionValue === true) {\n        optionValue = undefined; // use default value\n      }\n\n      if (!optionValue) {\n        if (optionValue === undefined || optionValue === false) {\n          return optionValue;\n        } // else, empty string (invalid), null (invalid), 0 (invalid)\n\n\n        throw new Error(\"`\".concat(optionName, \"` was specified but was not a node, or did not return a node\"));\n      }\n\n      var node = optionValue; // could be HTMLElement, SVGElement, or non-empty string at this point\n\n      if (typeof optionValue === 'string') {\n        var _this$getDocument;\n\n        node = (_this$getDocument = this.getDocument()) === null || _this$getDocument === void 0 ? void 0 : _this$getDocument.querySelector(optionValue); // resolve to node, or null if fails\n\n        if (!node) {\n          throw new Error(\"`\".concat(optionName, \"` as selector refers to no known node\"));\n        }\n      }\n\n      return node;\n    });\n\n    _this.handleDeactivate = _this.handleDeactivate.bind(_assertThisInitialized(_this));\n    _this.handlePostDeactivate = _this.handlePostDeactivate.bind(_assertThisInitialized(_this));\n    _this.handleClickOutsideDeactivates = _this.handleClickOutsideDeactivates.bind(_assertThisInitialized(_this)); // focus-trap options used internally when creating the trap\n\n    _this.internalOptions = {\n      // We need to hijack the returnFocusOnDeactivate option,\n      // because React can move focus into the element before we arrived at\n      // this lifecycle hook (e.g. with autoFocus inputs). So the component\n      // captures the previouslyFocusedElement in componentWillMount,\n      // then (optionally) returns focus to it in componentWillUnmount.\n      returnFocusOnDeactivate: false,\n      // the rest of these are also related to deactivation of the trap, and we\n      //  need to use them and control them as well\n      checkCanReturnFocus: null,\n      onDeactivate: _this.handleDeactivate,\n      onPostDeactivate: _this.handlePostDeactivate,\n      // we need to special-case this setting as well so that we can know if we should\n      //  NOT return focus if the trap gets auto-deactivated as the result of an\n      //  outside click (otherwise, we'll always think we should return focus because\n      //  of how we manage that flag internally here)\n      clickOutsideDeactivates: _this.handleClickOutsideDeactivates\n    }; // original options provided by the consumer\n\n    _this.originalOptions = {\n      // because of the above `internalOptions`, we maintain our own flag for\n      //  this option, and default it to `true` because that's focus-trap's default\n      returnFocusOnDeactivate: true,\n      // because of the above `internalOptions`, we keep these separate since\n      //  they're part of the deactivation process which we configure (internally) to\n      //  be shared between focus-trap and focus-trap-react\n      onDeactivate: null,\n      onPostDeactivate: null,\n      checkCanReturnFocus: null,\n      // the user's setting, defaulted to false since focus-trap defaults this to false\n      clickOutsideDeactivates: false\n    };\n    var focusTrapOptions = props.focusTrapOptions;\n\n    for (var optionName in focusTrapOptions) {\n      if (!Object.prototype.hasOwnProperty.call(focusTrapOptions, optionName)) {\n        continue;\n      }\n\n      if (optionName === 'returnFocusOnDeactivate' || optionName === 'onDeactivate' || optionName === 'onPostDeactivate' || optionName === 'checkCanReturnFocus' || optionName === 'clickOutsideDeactivates') {\n        _this.originalOptions[optionName] = focusTrapOptions[optionName];\n        continue; // exclude from internalOptions\n      }\n\n      _this.internalOptions[optionName] = focusTrapOptions[optionName];\n    } // if set, `{ target: Node, allowDeactivation: boolean }` where `target` is the outside\n    //  node that was clicked, and `allowDeactivation` is the result of the consumer's\n    //  option (stored in `this.originalOptions.clickOutsideDeactivates`, which may be a\n    //  function) whether to allow or deny auto-deactivation on click on this outside node\n\n\n    _this.outsideClick = null; // elements from which to create the focus trap on mount; if a child is used\n    //  instead of the `containerElements` prop, we'll get the child's related\n    //  element when the trap renders and then is declared 'mounted'\n\n    _this.focusTrapElements = props.containerElements || []; // now we remember what the currently focused element is, not relying on focus-trap\n\n    _this.updatePreviousElement();\n\n    return _this;\n  }\n  /**\n   * Gets the configured document.\n   * @returns {Document|undefined} Configured document, falling back to the main\n   *  document, if it exists. During SSR, `undefined` is returned since the\n   *  document doesn't exist.\n   */\n\n\n  _createClass(FocusTrap, [{\n    key: \"getDocument\",\n    value: function getDocument() {\n      // SSR: careful to check if `document` exists before accessing it as a variable\n      return this.props.focusTrapOptions.document || (typeof document !== 'undefined' ? document : undefined);\n    }\n    /**\n     * Gets the node for the given option, which is expected to be an option that\n     *  can be either a DOM node, a string that is a selector to get a node, `false`\n     *  (if a node is explicitly NOT given), or a function that returns any of these\n     *  values.\n     * @param {string} optionName\n     * @returns {undefined | false | HTMLElement | SVGElement} Returns\n     *  `undefined` if the option is not specified; `false` if the option\n     *  resolved to `false` (node explicitly not given); otherwise, the resolved\n     *  DOM node.\n     * @throws {Error} If the option is set, not `false`, and is not, or does not\n     *  resolve to a node.\n     */\n\n  }, {\n    key: \"getReturnFocusNode\",\n    value: function getReturnFocusNode() {\n      var node = this.getNodeForOption('setReturnFocus', this.previouslyFocusedElement);\n      return node ? node : node === false ? false : this.previouslyFocusedElement;\n    }\n    /** Update the previously focused element with the currently focused element. */\n\n  }, {\n    key: \"updatePreviousElement\",\n    value: function updatePreviousElement() {\n      var currentDocument = this.getDocument();\n\n      if (currentDocument) {\n        this.previouslyFocusedElement = currentDocument.activeElement;\n      }\n    }\n  }, {\n    key: \"deactivateTrap\",\n    value: function deactivateTrap() {\n      // NOTE: it's possible the focus trap has already been deactivated without our knowing it,\n      //  especially if the user set the `clickOutsideDeactivates: true` option on the trap,\n      //  and the mouse was clicked on some element outside the trap; at that point, focus-trap\n      //  will initiate its auto-deactivation process, which will call our own\n      //  handleDeactivate(), which will call into this method\n      if (!this.focusTrap || !this.focusTrap.active) {\n        return;\n      }\n\n      this.focusTrap.deactivate({\n        // NOTE: we never let the trap return the focus since we do that ourselves\n        returnFocus: false,\n        // we'll call this in our own post deactivate handler so make sure the trap doesn't\n        //  do it prematurely\n        checkCanReturnFocus: null,\n        // let it call the user's original deactivate handler, if any, instead of\n        //  our own which calls back into this function\n        onDeactivate: this.originalOptions.onDeactivate // NOTE: for post deactivate, don't specify anything so that it calls the\n        //  onPostDeactivate handler specified on `this.internalOptions`\n        //  which will always be our own `handlePostDeactivate()` handler, which\n        //  will finish things off by calling the user's provided onPostDeactivate\n        //  handler, if any, at the right time\n        // onPostDeactivate: NOTHING\n\n      });\n    }\n  }, {\n    key: \"handleClickOutsideDeactivates\",\n    value: function handleClickOutsideDeactivates(event) {\n      // use consumer's option (or call their handler) as the permission or denial\n      var allowDeactivation = typeof this.originalOptions.clickOutsideDeactivates === 'function' ? this.originalOptions.clickOutsideDeactivates.call(null, event) // call out of context\n      : this.originalOptions.clickOutsideDeactivates; // boolean\n\n      if (allowDeactivation) {\n        // capture the outside target that was clicked so we can use it in the deactivation\n        //  process since the consumer allowed it to cause auto-deactivation\n        this.outsideClick = {\n          target: event.target,\n          allowDeactivation: allowDeactivation\n        };\n      }\n\n      return allowDeactivation;\n    }\n  }, {\n    key: \"handleDeactivate\",\n    value: function handleDeactivate() {\n      if (this.originalOptions.onDeactivate) {\n        this.originalOptions.onDeactivate.call(null); // call user's handler out of context\n      }\n\n      this.deactivateTrap();\n    }\n  }, {\n    key: \"handlePostDeactivate\",\n    value: function handlePostDeactivate() {\n      var _this2 = this;\n\n      var finishDeactivation = function finishDeactivation() {\n        var returnFocusNode = _this2.getReturnFocusNode();\n\n        var canReturnFocus = !!( // did the consumer allow it?\n        _this2.originalOptions.returnFocusOnDeactivate && // can we actually focus the node?\n        returnFocusNode !== null && returnFocusNode !== void 0 && returnFocusNode.focus && ( // was there an outside click that allowed deactivation?\n        !_this2.outsideClick || // did the consumer allow deactivation when the outside node was clicked?\n        _this2.outsideClick.allowDeactivation && // is the outside node NOT focusable (implying that it did NOT receive focus\n        //  as a result of the click-through) -- in which case do NOT restore focus\n        //  to `returnFocusNode` because focus should remain on the outside node\n        !isFocusable(_this2.outsideClick.target, _this2.internalOptions.tabbableOptions)) // if no, the restore focus to `returnFocusNode` at this point\n        );\n        var _this2$internalOption = _this2.internalOptions.preventScroll,\n            preventScroll = _this2$internalOption === void 0 ? false : _this2$internalOption;\n\n        if (canReturnFocus) {\n          // return focus to the element that had focus when the trap was activated\n          returnFocusNode.focus({\n            preventScroll: preventScroll\n          });\n        }\n\n        if (_this2.originalOptions.onPostDeactivate) {\n          _this2.originalOptions.onPostDeactivate.call(null); // don't call it in context of \"this\"\n\n        }\n\n        _this2.outsideClick = null; // reset: no longer needed\n      };\n\n      if (this.originalOptions.checkCanReturnFocus) {\n        this.originalOptions.checkCanReturnFocus.call(null, this.getReturnFocusNode()) // call out of context\n        .then(finishDeactivation, finishDeactivation);\n      } else {\n        finishDeactivation();\n      }\n    }\n  }, {\n    key: \"setupFocusTrap\",\n    value: function setupFocusTrap() {\n      if (this.focusTrap) {\n        // trap already exists: it's possible we're in StrictMode and we're being remounted,\n        //  in which case, we will have deactivated the trap when we got unmounted (remember,\n        //  StrictMode, in development, purposely unmounts and remounts components after\n        //  mounting them the first time to make sure they have reusable state,\n        //  @see https://reactjs.org/docs/strict-mode.html#ensuring-reusable-state) so now\n        //  we need to restore the state of the trap according to our component state\n        // NOTE: Strict mode __violates__ assumptions about the `componentWillUnmount()` API\n        //  which clearly states -- even for React 18 -- that, \"Once a component instance is\n        //  unmounted, __it will never be mounted again.__\" (emphasis ours). So when we get\n        //  unmounted, we assume we're gone forever and we deactivate the trap. But then\n        //  we get remounted and we're supposed to restore state. But if you had paused,\n        //  we've now deactivated (we don't know we're amount to get remounted again)\n        //  which means we need to reactivate and then pause. Otherwise, do nothing.\n        if (this.props.active && !this.focusTrap.active) {\n          this.focusTrap.activate();\n\n          if (this.props.paused) {\n            this.focusTrap.pause();\n          }\n        }\n      } else {\n        var nodesExist = this.focusTrapElements.some(Boolean);\n\n        if (nodesExist) {\n          // eslint-disable-next-line react/prop-types -- _createFocusTrap is an internal prop\n          this.focusTrap = this.props._createFocusTrap(this.focusTrapElements, this.internalOptions);\n\n          if (this.props.active) {\n            this.focusTrap.activate();\n          }\n\n          if (this.props.paused) {\n            this.focusTrap.pause();\n          }\n        }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.active) {\n        this.setupFocusTrap();\n      } // else, wait for later activation in case the `focusTrapOptions` will be updated\n      //  again before the trap is activated (e.g. if waiting to know what the document\n      //  object will be, so the Trap must be rendered, but the consumer is waiting to\n      //  activate until they have obtained the document from a ref)\n      //  @see https://github.com/focus-trap/focus-trap-react/issues/539\n\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.focusTrap) {\n        if (prevProps.containerElements !== this.props.containerElements) {\n          this.focusTrap.updateContainerElements(this.props.containerElements);\n        }\n\n        var hasActivated = !prevProps.active && this.props.active;\n        var hasDeactivated = prevProps.active && !this.props.active;\n        var hasPaused = !prevProps.paused && this.props.paused;\n        var hasUnpaused = prevProps.paused && !this.props.paused;\n\n        if (hasActivated) {\n          this.updatePreviousElement();\n          this.focusTrap.activate();\n        }\n\n        if (hasDeactivated) {\n          this.deactivateTrap();\n          return; // un/pause does nothing on an inactive trap\n        }\n\n        if (hasPaused) {\n          this.focusTrap.pause();\n        }\n\n        if (hasUnpaused) {\n          this.focusTrap.unpause();\n        }\n      } else {\n        // NOTE: if we're in `componentDidUpdate` and we don't have a trap yet,\n        //  it either means it shouldn't be active, or it should be but none of\n        //  of given `containerElements` were present in the DOM the last time\n        //  we tried to create the trap\n        if (prevProps.containerElements !== this.props.containerElements) {\n          this.focusTrapElements = this.props.containerElements;\n        } // don't create the trap unless it should be active in case the consumer\n        //  is still updating `focusTrapOptions`\n        //  @see https://github.com/focus-trap/focus-trap-react/issues/539\n\n\n        if (this.props.active) {\n          this.updatePreviousElement();\n          this.setupFocusTrap();\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.deactivateTrap();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var child = this.props.children ? React.Children.only(this.props.children) : undefined;\n\n      if (child) {\n        if (child.type && child.type === React.Fragment) {\n          throw new Error('A focus-trap cannot use a Fragment as its child container. Try replacing it with a <div> element.');\n        }\n\n        var callbackRef = function callbackRef(element) {\n          var containerElements = _this3.props.containerElements;\n\n          if (child) {\n            if (typeof child.ref === 'function') {\n              child.ref(element);\n            } else if (child.ref) {\n              child.ref.current = element;\n            }\n          }\n\n          _this3.focusTrapElements = containerElements ? containerElements : [element];\n        };\n\n        var childWithRef = React.cloneElement(child, {\n          ref: callbackRef\n        });\n        return childWithRef;\n      }\n\n      return null;\n    }\n  }]);\n\n  return FocusTrap;\n}(React.Component); // support server-side rendering where `Element` will not be defined\n\n\nvar ElementType = typeof Element === 'undefined' ? Function : Element;\nFocusTrap.propTypes = {\n  active: PropTypes.bool,\n  paused: PropTypes.bool,\n  focusTrapOptions: PropTypes.shape({\n    document: PropTypes.object,\n    onActivate: PropTypes.func,\n    onPostActivate: PropTypes.func,\n    checkCanFocusTrap: PropTypes.func,\n    onDeactivate: PropTypes.func,\n    onPostDeactivate: PropTypes.func,\n    checkCanReturnFocus: PropTypes.func,\n    initialFocus: PropTypes.oneOfType([PropTypes.instanceOf(ElementType), PropTypes.string, PropTypes.bool, PropTypes.func]),\n    fallbackFocus: PropTypes.oneOfType([PropTypes.instanceOf(ElementType), PropTypes.string, // NOTE: does not support `false` as value (or return value from function)\n    PropTypes.func]),\n    escapeDeactivates: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),\n    clickOutsideDeactivates: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),\n    returnFocusOnDeactivate: PropTypes.bool,\n    setReturnFocus: PropTypes.oneOfType([PropTypes.instanceOf(ElementType), PropTypes.string, PropTypes.bool, PropTypes.func]),\n    allowOutsideClick: PropTypes.oneOfType([PropTypes.bool, PropTypes.func]),\n    preventScroll: PropTypes.bool,\n    tabbableOptions: PropTypes.shape({\n      displayCheck: PropTypes.oneOf(['full', 'non-zero-area', 'none']),\n      getShadowRoot: PropTypes.oneOfType([PropTypes.bool, PropTypes.func])\n    })\n  }),\n  containerElements: PropTypes.arrayOf(PropTypes.instanceOf(ElementType)),\n  // DOM element ONLY\n  children: PropTypes.oneOfType([PropTypes.element, // React element\n  PropTypes.instanceOf(ElementType) // DOM element\n  ]) // NOTE: _createFocusTrap is internal, for testing purposes only, so we don't\n  //  specify it here. It's expected to be set to the function returned from\n  //  require('focus-trap'), or one with a compatible interface.\n\n};\nFocusTrap.defaultProps = {\n  active: true,\n  paused: false,\n  focusTrapOptions: {},\n  _createFocusTrap: createFocusTrap\n};\nmodule.exports = FocusTrap;","import React, { useEffect, useState, useRef } from 'react';\nimport FocusTrap from 'focus-trap-react';\nimport { cn } from '../design-system/utils';\n\nconst STORAGE_KEY = 'pain-tracker:alerts-log';\n\nexport type AlertRecord = { id: string; time: string; message: string };\n\nexport function loadAlerts(): AlertRecord[] {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    return raw ? JSON.parse(raw) : [];\n  } catch {\n    // localStorage access failed or invalid JSON\n    return [];\n  }\n}\n\nexport function saveAlert(rec: AlertRecord) {\n  try {\n    const curr = loadAlerts();\n    curr.unshift(rec);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(curr.slice(0, 50)));\n    window.dispatchEvent(new Event('alerts-log-updated'));\n  } catch {\n    // localStorage save failed, alert will not be persisted\n  }\n}\n\nexport function clearAlerts() {\n  try {\n    localStorage.removeItem(STORAGE_KEY);\n    window.dispatchEvent(new Event('alerts-log-updated'));\n  } catch {\n    // localStorage clear failed\n  }\n}\n\nexport function acknowledgeAlert(id: string) {\n  try {\n    const curr = loadAlerts().filter(a => a.id !== id);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(curr));\n    window.dispatchEvent(new Event('alerts-log-updated'));\n  } catch {\n    // localStorage update failed\n  }\n}\n\ntype AlertsActivityLogProps = {\n  variant?: 'overlay' | 'inline';\n  className?: string;\n};\n\nexport default function AlertsActivityLog({\n  variant = 'overlay',\n  className,\n}: AlertsActivityLogProps) {\n  const [alerts, setAlerts] = useState<AlertRecord[]>(() => loadAlerts());\n  const [showingConfirm, setShowingConfirm] = useState(false);\n  const [prevAlerts, setPrevAlerts] = useState<AlertRecord[] | null>(null);\n  const [showUndo, setShowUndo] = useState(false);\n  const undoTimer = useRef<number | null>(null);\n  const statusRef = useRef<HTMLDivElement | null>(null);\n  const [open, setOpen] = useState(false);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const prevActiveRef = useRef<HTMLElement | null>(null);\n  const [slideIn, setSlideIn] = useState(false);\n\n  useEffect(() => {\n    const onNew = () => setAlerts(loadAlerts());\n    window.addEventListener('alerts-log-updated', onNew);\n    return () => window.removeEventListener('alerts-log-updated', onNew);\n  }, []);\n\n  useEffect(() => {\n    return () => {\n      if (undoTimer.current) {\n        window.clearTimeout(undoTimer.current);\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    const prefersReduced =\n      typeof window !== 'undefined' &&\n      typeof window.matchMedia === 'function' &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n\n    if (open) {\n      prevActiveRef.current = document.activeElement as HTMLElement | null;\n      if (prefersReduced) {\n        setSlideIn(true);\n        return;\n      }\n      setSlideIn(false);\n      const timer = window.setTimeout(() => setSlideIn(true), 10);\n      return () => window.clearTimeout(timer);\n    }\n\n    setSlideIn(false);\n    try {\n      prevActiveRef.current?.focus();\n    } catch {\n      // ignore focus errors\n    }\n  }, [open]);\n\n  function timeAgo(iso: string) {\n    try {\n      const then = new Date(iso).getTime();\n      const diff = Date.now() - then;\n      const seconds = Math.floor(diff / 1000);\n      if (seconds < 60) return `${seconds}s ago`;\n      const minutes = Math.floor(seconds / 60);\n      if (minutes < 60) return `${minutes}m ago`;\n      const hours = Math.floor(minutes / 60);\n      if (hours < 24) return `${hours}h ago`;\n      const days = Math.floor(hours / 24);\n      return `${days}d ago`;\n    } catch {\n      return new Date(iso).toLocaleString();\n    }\n  }\n\n  const hasAlerts = alerts.length > 0;\n\n  const handleClose = () => {\n    setOpen(false);\n    setShowingConfirm(false);\n  };\n\n  const handleUndo = () => {\n    if (!prevAlerts) {\n      return;\n    }\n\n    try {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(prevAlerts));\n      window.dispatchEvent(new Event('alerts-log-updated'));\n      setAlerts(prevAlerts);\n    } catch {\n      // Restore failed\n    }\n\n    setPrevAlerts(null);\n    setShowUndo(false);\n    if (undoTimer.current) {\n      window.clearTimeout(undoTimer.current);\n      undoTimer.current = null;\n    }\n  };\n\n  const scheduleUndoHide = () => {\n    if (undoTimer.current) {\n      window.clearTimeout(undoTimer.current);\n    }\n    undoTimer.current = window.setTimeout(() => {\n      setShowUndo(false);\n      setPrevAlerts(null);\n      undoTimer.current = null;\n    }, 6000);\n  };\n\n  const handleConfirmClear = () => {\n    const copy = loadAlerts();\n    setPrevAlerts(copy);\n    clearAlerts();\n    setAlerts([]);\n    setShowingConfirm(false);\n    setShowUndo(true);\n    scheduleUndoHide();\n    window.setTimeout(() => {\n      statusRef.current?.focus();\n    }, 10);\n  };\n\n  const handleAcknowledge = (id: string) => {\n    let shouldDismiss = true;\n    if (typeof window !== 'undefined' && typeof window.confirm === 'function') {\n      try {\n        shouldDismiss = window.confirm('Acknowledge this alert?');\n      } catch {\n        shouldDismiss = true;\n      }\n    }\n\n    if (!shouldDismiss) {\n      return;\n    }\n\n    acknowledgeAlert(id);\n    setAlerts(current => current.filter(alert => alert.id !== id));\n  };\n\n  const renderConfirmDialog = () => (\n    <div\n      role=\"dialog\"\n      aria-modal=\"true\"\n      className=\"fixed inset-0 z-[70] flex items-center justify-center bg-black/40\"\n    >\n      <div className=\"bg-card p-4 rounded max-w-sm w-full border shadow-lg\">\n        <div className=\"font-medium mb-2\">Clear all alerts?</div>\n        <p className=\"text-sm text-muted-foreground mb-4\">You can undo within a few seconds.</p>\n        <div className=\"flex justify-end space-x-2\">\n          <button onClick={() => setShowingConfirm(false)} className=\"px-3 py-1 text-sm\">\n            Cancel\n          </button>\n          <button\n            onClick={handleConfirmClear}\n            className=\"px-3 py-1 bg-destructive text-destructive-foreground rounded text-sm\"\n          >\n            Yes, clear\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n\n  const renderUndoBanner = (context: 'inline' | 'overlay') => {\n    if (!showUndo || !prevAlerts) {\n      return null;\n    }\n\n    const classes =\n      context === 'inline'\n        ? 'rounded-md border border-primary/40 bg-primary/10 p-3 text-xs flex items-center justify-between'\n        : 'mt-4 p-3 rounded-md bg-primary/10 border border-primary/40 text-xs flex items-center justify-between';\n\n    return (\n      <div className={classes} role=\"status\" aria-live=\"polite\">\n        <span>Alerts cleared.</span>\n        <button onClick={handleUndo} className=\"underline\">\n          Undo\n        </button>\n      </div>\n    );\n  };\n\n  const renderList = (options?: { limit?: number; context?: 'inline' | 'overlay' }) => {\n    const { limit, context = 'overlay' } = options ?? {};\n    const items = typeof limit === 'number' ? alerts.slice(0, limit) : alerts;\n\n    if (items.length === 0) {\n      if (context === 'inline') {\n        return (\n          <div\n            className=\"rounded-lg border border-dashed py-6 text-center text-sm text-muted-foreground\"\n            role=\"status\"\n            aria-live=\"polite\"\n            tabIndex={-1}\n            ref={statusRef}\n          >\n            No recent alerts\n          </div>\n        );\n      }\n\n      return (\n        <div className=\"flex flex-col items-center gap-2 mt-6\">\n          <div className=\"text-sm text-muted-foreground\" tabIndex={-1} ref={statusRef}>\n            No recent alerts\n          </div>\n          <button\n            className=\"mt-2 px-3 py-1 rounded bg-muted text-foreground text-sm border\"\n            onClick={handleClose}\n            autoFocus\n          >\n            Close\n          </button>\n        </div>\n      );\n    }\n\n    if (context === 'inline') {\n      return (\n        <ul className=\"space-y-3 text-sm\">\n          {items.map(alert => (\n            <li\n              key={alert.id}\n              className=\"flex items-start justify-between gap-3 rounded-md border border-border/60 bg-card/80 p-3\"\n            >\n              <div className=\"space-y-1\">\n                <div className=\"font-medium text-foreground\">{alert.message}</div>\n                <div className=\"text-xs text-muted-foreground\">{timeAgo(alert.time)}</div>\n              </div>\n              <button className=\"btn btn-xs\" onClick={() => handleAcknowledge(alert.id)}>\n                Acknowledge\n              </button>\n            </li>\n          ))}\n        </ul>\n      );\n    }\n\n    return (\n      <ul className=\"text-sm space-y-2\">\n        {items.map(alert => (\n          <li key={alert.id} className=\"border rounded p-2\">\n            <div className=\"flex justify-between items-start\">\n              <div>\n                <div className=\"font-medium\">{alert.message}</div>\n                <div\n                  className=\"text-muted-foreground text-xs\"\n                  aria-label={new Date(alert.time).toLocaleString()}\n                >\n                  {timeAgo(alert.time)}\n                </div>\n              </div>\n              <div className=\"ml-3 flex flex-col items-end\">\n                <button\n                  onClick={() => handleAcknowledge(alert.id)}\n                  className=\"text-xs text-foreground/80 hover:underline\"\n                >\n                  Acknowledge\n                </button>\n              </div>\n            </div>\n          </li>\n        ))}\n      </ul>\n    );\n  };\n\n  const renderOverlay = () => {\n    if (!open) {\n      return null;\n    }\n\n    return (\n      <div className=\"fixed inset-0 z-[100]\" role=\"presentation\">\n        <div className=\"absolute inset-0 bg-black/40\" onClick={handleClose} />\n        <FocusTrap\n          active={true}\n          focusTrapOptions={{\n            clickOutsideDeactivates: true,\n            escapeDeactivates: true,\n            onDeactivate: handleClose,\n          }}\n        >\n          <div\n            ref={containerRef}\n            role=\"dialog\"\n            aria-modal=\"true\"\n            tabIndex={-1}\n            className={`absolute right-0 top-0 h-full w-full md:w-96 bg-card shadow-xl border-l p-4 overflow-auto transform transition-all duration-200 ${\n              slideIn\n                ? 'translate-x-0 opacity-100 scale-100'\n                : 'translate-x-full opacity-0 scale-95'\n            }`}\n            style={\n              typeof window !== 'undefined' &&\n              typeof window.matchMedia === 'function' &&\n              window.matchMedia('(prefers-reduced-motion: reduce)').matches\n                ? { transitionTimingFunction: 'linear' }\n                : undefined\n            }\n          >\n            <button\n              id=\"__alerts-focus-anchor\"\n              tabIndex={0}\n              onFocus={() => {}}\n              style={{\n                position: 'absolute',\n                left: '-9999px',\n                width: 1,\n                height: 1,\n                margin: 0,\n                padding: 0,\n                border: 0,\n              }}\n            />\n            <div className=\"flex items-center justify-between mb-3\">\n              <h3 className=\"text-lg font-semibold\">Recent Alerts</h3>\n              <div className=\"flex items-center space-x-2\">\n                <button\n                  className=\"text-xs text-foreground/80 hover:underline mr-2\"\n                  onClick={() => setShowingConfirm(true)}\n                  aria-haspopup=\"dialog\"\n                >\n                  Clear all\n                </button>\n                <button className=\"btn btn-sm\" onClick={handleClose}>\n                  Close\n                </button>\n              </div>\n            </div>\n            {renderList({ context: 'overlay' })}\n            {renderUndoBanner('overlay')}\n            {showingConfirm && renderConfirmDialog()}\n          </div>\n        </FocusTrap>\n      </div>\n    );\n  };\n\n  if (variant === 'inline') {\n    return (\n      <>\n        <div className={cn('rounded-lg border bg-muted/30 p-4 space-y-4 text-sm', className)}>\n          <div className=\"flex items-start justify-between gap-3\">\n            <div>\n              <h3 className=\"font-semibold text-foreground\">Recent alerts</h3>\n              <p className=\"text-xs text-muted-foreground\">\n                Review the latest safety notices and acknowledge them.\n              </p>\n            </div>\n            {hasAlerts && (\n              <span className=\"rounded-full bg-destructive/10 px-2 py-0.5 text-xs text-destructive\">\n                {alerts.length}\n              </span>\n            )}\n          </div>\n\n          {renderList({ limit: 4, context: 'inline' })}\n          {renderUndoBanner('inline')}\n\n          <div className=\"flex items-center justify-between text-xs text-muted-foreground\">\n            {hasAlerts ? (\n              <span>Last update {timeAgo(alerts[0].time)}</span>\n            ) : (\n              <span>Alerts appear here instantly.</span>\n            )}\n            <div className=\"flex gap-2\">\n              <button className=\"btn btn-xs btn-outline\" onClick={() => setOpen(true)}>\n                Manage\n              </button>\n              {hasAlerts && (\n                <button className=\"btn btn-xs\" onClick={() => setShowingConfirm(true)}>\n                  Clear\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n        {renderOverlay()}\n        {showingConfirm && !open && renderConfirmDialog()}\n      </>\n    );\n  }\n\n  return (\n    <>\n      <div>\n        <button\n          onClick={() => setOpen(true)}\n          className=\"relative bg-white border rounded-md px-3 py-2 shadow-sm text-sm flex items-center gap-2\"\n        >\n          <svg\n            width=\"16\"\n            height=\"16\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            aria-hidden\n          >\n            <path\n              d=\"M12 2C13.1046 2 14 2.89543 14 4V5.178C16.39 6.006 18 8.388 18 11V16L20 18V19H4V18L6 16V11C6 8.388 7.61 6.006 10 5.178V4C10 2.89543 10.8954 2 12 2Z\"\n              stroke=\"currentColor\"\n              strokeWidth=\"1.2\"\n              strokeLinejoin=\"round\"\n            />\n          </svg>\n          Recent Alerts\n          {hasAlerts && (\n            <span className=\"absolute -top-1 -right-1 bg-destructive text-white text-xs rounded-full px-2\">\n              {alerts.length}\n            </span>\n          )}\n          {hasAlerts && (\n            <span className=\"ml-2 text-xs text-muted-foreground\">{timeAgo(alerts[0].time)}</span>\n          )}\n        </button>\n      </div>\n      {renderOverlay()}\n    </>\n  );\n}\n","import { useEffect, useRef } from 'react';\n// Mock implementations for pattern detection services\nconst detectSuddenSpike = (series: number[], threshold: number): number => {\n  for (let i = 1; i < series.length; i++) {\n    if (series[i] - series[i - 1] >= threshold) {\n      return i;\n    }\n  }\n  return -1;\n};\n\nconst rollingAverageSpike = (series: number[], windowSize: number, threshold: number): number => {\n  for (let i = windowSize; i < series.length; i++) {\n    const avg = series.slice(i - windowSize, i).reduce((a, b) => a + b, 0) / windowSize;\n    if (series[i] - avg >= threshold) {\n      return i;\n    }\n  }\n  return -1;\n};\n\nconst simpleZScoreOutlier = (series: number[], threshold: number): number => {\n  const mean = series.reduce((a, b) => a + b, 0) / series.length;\n  const std = Math.sqrt(series.reduce((a, b) => a + Math.pow(b - mean, 2), 0) / series.length);\n  for (let i = 0; i < series.length; i++) {\n    if (Math.abs(series[i] - mean) / std >= threshold) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n// import { detectSuddenSpike } from '@pain-tracker/services/patterns';\n// import { rollingAverageSpike, simpleZScoreOutlier } from '@pain-tracker/services/detectors';\nimport { saveAlert } from '../components/AlertsActivityLog';\n\nconst SETTINGS_KEY = 'pain-tracker:alerts-settings';\nconst CONSENT_KEY = 'pain-tracker:notification-consent';\n\nexport function usePatternAlerts(entries: { time: string; pain: number }[]) {\n  const seen = useRef<Set<number>>(new Set());\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(SETTINGS_KEY);\n      const settings = raw ? JSON.parse(raw) : { threshold: 3 };\n      const consent = localStorage.getItem(CONSENT_KEY);\n\n      const series = entries.map(e => e.pain);\n      // Run multiple detectors; first to report an index wins\n      const detectors = [\n        (s: number[]) => detectSuddenSpike(s, settings.threshold),\n        (s: number[]) => rollingAverageSpike(s, 3, 1),\n        (s: number[]) => simpleZScoreOutlier(s, 2),\n      ];\n      let idx = -1;\n      for (const d of detectors) {\n        const r = d(series);\n        if (r >= 0) {\n          idx = r;\n          break;\n        }\n      }\n\n      if (idx >= 0 && !seen.current.has(idx)) {\n        seen.current.add(idx);\n        const message = `Sudden pain increase to ${series[idx]} (entry ${idx + 1})`;\n        // Save to alerts log\n        try {\n          saveAlert({\n            id: `${Date.now()}-${Math.random().toString(36).slice(2, 7)}`,\n            time: new Date().toISOString(),\n            message,\n          });\n          window.dispatchEvent(new Event('alerts-log-updated'));\n        } catch {\n          // Alert logging failed, continue without saving\n        }\n\n        // Only notify if user has explicitly allowed notifications\n        if (consent === 'granted' && typeof Notification !== 'undefined') {\n          new Notification('Pain pattern detected', { body: message });\n        } else {\n          console.debug('Pattern alert suppressed (no consent)');\n        }\n      }\n    } catch (e) {\n      console.debug('usePatternAlerts: error', e);\n    }\n  }, [entries]);\n}\n","import { useState, useEffect } from 'react';\nimport { WifiOff, Wifi, CloudOff, RefreshCw } from 'lucide-react';\n\nexport function OfflineIndicator() {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n  const [showOfflineMessage, setShowOfflineMessage] = useState(false);\n\n  useEffect(() => {\n    const handleOnline = () => {\n      setIsOnline(true);\n      setShowOfflineMessage(false);\n\n      // Show brief \"back online\" message\n      setTimeout(() => {\n        setShowOfflineMessage(false);\n      }, 3000);\n    };\n\n    const handleOffline = () => {\n      setIsOnline(false);\n      setShowOfflineMessage(true);\n    };\n\n    // Listen to PWA events\n    window.addEventListener('pwa-online', handleOnline);\n    window.addEventListener('pwa-offline', handleOffline);\n\n    // Listen to browser events\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('pwa-online', handleOnline);\n      window.removeEventListener('pwa-offline', handleOffline);\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Don't show anything if online and no message needed\n  if (isOnline && !showOfflineMessage) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed top-4 left-1/2 transform -translate-x-1/2 z-50\">\n      <div\n        className={`flex items-center space-x-2 px-4 py-2 rounded-lg shadow-lg text-sm font-medium transition-all duration-300 ${\n          isOnline ? 'bg-green-500 text-white' : 'bg-orange-500 text-white'\n        }`}\n      >\n        {isOnline ? (\n          <>\n            <Wifi className=\"h-4 w-4\" />\n            <span>Back online</span>\n          </>\n        ) : (\n          <>\n            <WifiOff className=\"h-4 w-4\" />\n            <span>You're offline</span>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function OfflineBanner() {\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n\n  useEffect(() => {\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  if (isOnline) return null;\n\n  return (\n    <div className=\"bg-orange-500 text-white px-4 py-2\">\n      <div className=\"max-w-7xl mx-auto flex items-center justify-between\">\n        <div className=\"flex items-center space-x-2\">\n          <CloudOff className=\"h-5 w-5\" />\n          <div>\n            <p className=\"font-medium\">You're currently offline</p>\n            <p className=\"text-xs opacity-90\">\n              Your data is saved locally and will sync when you're back online\n            </p>\n          </div>\n        </div>\n\n        <button\n          onClick={() => window.location.reload()}\n          className=\"flex items-center space-x-1 px-3 py-1 bg-white/20 hover:bg-white/30 rounded-md transition-colors\"\n        >\n          <RefreshCw className=\"h-4 w-4\" />\n          <span className=\"text-xs\">Retry</span>\n        </button>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\r\nimport './BlackBoxSplashScreen.css';\r\n\r\ninterface BlackBoxSplashScreenProps {\r\n  message?: string;\r\n}\r\n\r\nexport const BlackBoxSplashScreen: React.FC<BlackBoxSplashScreenProps> = ({ \r\n  message = \"Localizing Database... Air-Gap Active\" \r\n}) => {\r\n  return (\r\n    <div className=\"fixed inset-0 w-full h-full bg-[#050505] flex items-center justify-center overflow-hidden z-50 font-mono\">\r\n      <div className=\"glitch-container\">\r\n        <div className=\"glitch-logo\"></div>\r\n        <div className=\"absolute -bottom-10 w-full text-center text-[#00F3FF] text-xs tracking-[2px] uppercase opacity-60\">\r\n          {message}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","/**\r\n * @fileoverview Tone System State Testing Utility\r\n *\r\n * Use this component in development to test all 4 patient states\r\n * and verify adaptive copy changes throughout the app.\r\n *\r\n * Usage:\r\n * 1. Import and render in App.tsx (dev only)\r\n * 2. Click buttons to force different states\r\n * 3. Navigate through app to see copy adapt\r\n * 4. Check QuickLogStepper, PanicMode, Dashboard, Empty States\r\n *\r\n * Keyboard shortcuts:\r\n * - Ctrl+T: Toggle visibility\r\n * - Escape: Minimize panel\r\n * - 1-4: Force states (when visible)\r\n */\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTone } from '../../contexts/useTone';\r\nimport type { PatientState } from '../../types/tone';\r\n\r\nexport function ToneStateTester() {\r\n  const isDev = import.meta.env.DEV;\r\n  const { context, forceState, preferences, updatePreferences } = useTone();\r\n  const [isVisible, setIsVisible] = useState(false); // Start minimized by default\r\n\r\n  const toggleVisibility = useCallback(() => {\r\n    setIsVisible(v => !v);\r\n  }, []);\r\n\r\n  // Keyboard shortcuts\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      const target = e.target as HTMLElement;\r\n      const isInputField =\r\n        target.tagName === 'INPUT' || target.tagName === 'TEXTAREA' || target.isContentEditable;\r\n\r\n      // Ctrl+T to toggle\r\n      if (e.key === 't' && (e.ctrlKey || e.metaKey)) {\r\n        e.preventDefault();\r\n        toggleVisibility();\r\n      }\r\n      // Escape to minimize\r\n      else if (e.key === 'Escape' && isVisible) {\r\n        setIsVisible(false);\r\n      }\r\n      // Number keys 1-4 to force states (when visible and not in input)\r\n      else if (isVisible && !isInputField && ['1', '2', '3', '4'].includes(e.key)) {\r\n        const states: PatientState[] = ['stable', 'rising', 'flare', 'recovery'];\r\n        const stateIndex = parseInt(e.key) - 1;\r\n        if (states[stateIndex]) {\r\n          forceState(states[stateIndex]);\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isVisible, toggleVisibility, forceState]);\r\n\r\n  if (!isDev) return null; // Only show in development\r\n\r\n  if (!isVisible) {\r\n    return (\r\n      <button\r\n        onClick={toggleVisibility}\r\n        className=\"fixed bottom-24 right-4 z-50 px-3 py-2 bg-purple-600/90 hover:bg-purple-500 text-white text-xs rounded-lg shadow-lg hover:shadow-xl transition-all hover:scale-105 backdrop-blur-sm\"\r\n        aria-label=\"Show tone state tester (Ctrl+T)\"\r\n        title=\"Tone Tester (Ctrl+T)\"\r\n      >\r\n         Tone Tester\r\n      </button>\r\n    );\r\n  }\r\n\r\n  const states: Array<{ state: PatientState; emoji: string; description: string; key: string }> = [\r\n    { state: 'stable', emoji: '', description: 'Brief, upbeat, professional-warm', key: '1' },\r\n    { state: 'rising', emoji: '', description: 'Steady, specific, encouraging', key: '2' },\r\n    { state: 'flare', emoji: '', description: 'Short lines, imperative, slow cadence', key: '3' },\r\n    { state: 'recovery', emoji: '', description: 'Warm, factual, no cheerleading', key: '4' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"fixed bottom-4 left-4 z-50 bg-gray-900 dark:bg-gray-100 text-white p-4 rounded-lg shadow-2xl max-w-md max-h-[85vh] overflow-y-auto border-2 border-purple-600 animate-in fade-in slide-in-from-bottom-4 duration-300\">\r\n      <div className=\"flex items-center justify-between mb-3 sticky top-0 bg-gray-900 dark:bg-gray-100 pb-2 border-b border-gray-700 dark:border-gray-300 z-10\">\r\n        <h3 className=\"text-sm font-bold text-purple-400\"> Tone State Tester</h3>\r\n        <button\r\n          onClick={() => setIsVisible(false)}\r\n          className=\"text-gray-400 dark:text-gray-500 hover:text-white text-xl leading-none px-2 py-1 rounded hover:bg-gray-800 dark:bg-gray-200 transition-colors\"\r\n          aria-label=\"Minimize tone state tester (Esc)\"\r\n          title=\"Minimize (Esc)\"\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n\r\n      {/* Keyboard shortcuts hint */}\r\n      <div className=\"mb-3 p-2 bg-purple-900/30 rounded border border-purple-700/50 text-xs text-purple-300\">\r\n        <div className=\"font-bold mb-1\"> Shortcuts:</div>\r\n        <div className=\"space-y-0.5 text-purple-200\">\r\n          <div>\r\n            <kbd className=\"px-1 py-0.5 bg-gray-800 dark:bg-gray-200 rounded text-xs\">Ctrl+T</kbd>{' '}\r\n            Toggle panel\r\n          </div>\r\n          <div>\r\n            <kbd className=\"px-1 py-0.5 bg-gray-800 dark:bg-gray-200 rounded text-xs\">Esc</kbd>{' '}\r\n            Minimize\r\n          </div>\r\n          <div>\r\n            <kbd className=\"px-1 py-0.5 bg-gray-800 dark:bg-gray-200 rounded text-xs\">1-4</kbd>{' '}\r\n            Force states\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Current State */}\r\n      <div className=\"mb-3 p-2 bg-gray-800 dark:bg-gray-200 rounded border border-gray-700 dark:border-gray-300\">\r\n        <div className=\"text-xs text-gray-400 dark:text-gray-500 mb-1\">Current State:</div>\r\n        <div className=\"text-sm font-mono font-bold text-purple-300\">\r\n          {context.state.toUpperCase()}\r\n        </div>\r\n        {context.painTrend && (\r\n          <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\r\n            Pain: {context.painTrend.current.toFixed(1)} (\r\n            {context.painTrend.direction === 'up'\r\n              ? ''\r\n              : context.painTrend.direction === 'down'\r\n                ? ''\r\n                : ''}\r\n            )\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* State Buttons */}\r\n      <div className=\"space-y-2 mb-3\">\r\n        <div className=\"text-xs text-gray-400 dark:text-gray-500 mb-2\">Force State:</div>\r\n        {states.map(({ state, emoji, description, key }) => (\r\n          <button\r\n            key={state}\r\n            onClick={() => forceState(state)}\r\n            className={`w-full px-3 py-2 text-left text-xs rounded transition-all ${\r\n              context.state === state\r\n                ? 'bg-purple-600 text-white shadow-md'\r\n                : 'bg-gray-800 hover:bg-gray-700 text-gray-300'\r\n            }`}\r\n          >\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <span className=\"mr-2\">{emoji}</span>\r\n                <span className=\"font-bold\">{state}</span>\r\n              </div>\r\n              <kbd className=\"px-1.5 py-0.5 bg-gray-700 dark:bg-gray-300 rounded text-xs\">\r\n                {key}\r\n              </kbd>\r\n            </div>\r\n            <div className=\"text-xs opacity-70 mt-1\">{description}</div>\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Preferences */}\r\n      <div className=\"border-t border-gray-700 dark:border-gray-300 pt-3 space-y-2\">\r\n        <div className=\"text-xs text-gray-400 dark:text-gray-500 mb-2\">Preferences:</div>\r\n\r\n        <label className=\"flex items-center justify-between text-xs cursor-pointer hover:bg-gray-800 dark:bg-gray-200 p-1 rounded transition-colors\">\r\n          <span>Warmth</span>\r\n          <select\r\n            value={preferences.warmth}\r\n            onChange={e => updatePreferences({ warmth: Number(e.target.value) as 0 | 1 })}\r\n            className=\"bg-gray-800 dark:bg-gray-200 border border-gray-700 dark:border-gray-300 rounded px-2 py-1 text-xs hover:border-purple-600 transition-colors\"\r\n          >\r\n            <option value=\"0\">Neutral</option>\r\n            <option value=\"1\">Warm</option>\r\n          </select>\r\n        </label>\r\n\r\n        <label className=\"flex items-center justify-between text-xs cursor-pointer hover:bg-gray-800 dark:bg-gray-200 p-1 rounded transition-colors\">\r\n          <span>Coach Intensity</span>\r\n          <select\r\n            value={preferences.coachIntensity}\r\n            onChange={e => updatePreferences({ coachIntensity: Number(e.target.value) as 0 | 1 })}\r\n            className=\"bg-gray-800 dark:bg-gray-200 border border-gray-700 dark:border-gray-300 rounded px-2 py-1 text-xs hover:border-purple-600 transition-colors\"\r\n          >\r\n            <option value=\"0\">Minimal</option>\r\n            <option value=\"1\">Guided</option>\r\n          </select>\r\n        </label>\r\n\r\n        <label className=\"flex items-center justify-between text-xs cursor-pointer hover:bg-gray-800 dark:bg-gray-200 p-1 rounded transition-colors\">\r\n          <span>Medical Terms</span>\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={preferences.medicalTerms}\r\n            onChange={e => updatePreferences({ medicalTerms: e.target.checked })}\r\n            className=\"bg-gray-800 dark:bg-gray-200 border border-gray-700 dark:border-gray-300 rounded\"\r\n          />\r\n        </label>\r\n\r\n        <label className=\"flex items-center justify-between text-xs cursor-pointer hover:bg-gray-800 dark:bg-gray-200 p-1 rounded transition-colors\">\r\n          <span>Allow Lightness</span>\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={preferences.allowLightness}\r\n            onChange={e => updatePreferences({ allowLightness: e.target.checked })}\r\n            className=\"bg-gray-800 dark:bg-gray-200 border border-gray-700 dark:border-gray-300 rounded\"\r\n          />\r\n        </label>\r\n      </div>\r\n\r\n      {/* Testing Instructions */}\r\n      <div className=\"border-t border-gray-700 dark:border-gray-300 pt-3 mt-3\">\r\n        <div className=\"text-xs text-gray-400 dark:text-gray-500 space-y-1\">\r\n          <div className=\"font-bold mb-1\">Test Areas:</div>\r\n          <div> QuickLogStepper: Pain slider, locations, notes</div>\r\n          <div> PanicMode: Greeting, breathing, crisis text</div>\r\n          <div> Dashboard: Empty states, insights</div>\r\n          <div> Analytics: Progress summaries</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\n\n// src/react/index.tsx\nimport { useEffect } from \"react\";\n\n// package.json\nvar name = \"@vercel/analytics\";\nvar version = \"1.6.1\";\n\n// src/queue.ts\nvar initQueue = () => {\n  if (window.va) return;\n  window.va = function a(...params) {\n    (window.vaq = window.vaq || []).push(params);\n  };\n};\n\n// src/utils.ts\nfunction isBrowser() {\n  return typeof window !== \"undefined\";\n}\nfunction detectEnvironment() {\n  try {\n    const env = process.env.NODE_ENV;\n    if (env === \"development\" || env === \"test\") {\n      return \"development\";\n    }\n  } catch (e) {\n  }\n  return \"production\";\n}\nfunction setMode(mode = \"auto\") {\n  if (mode === \"auto\") {\n    window.vam = detectEnvironment();\n    return;\n  }\n  window.vam = mode;\n}\nfunction getMode() {\n  const mode = isBrowser() ? window.vam : detectEnvironment();\n  return mode || \"production\";\n}\nfunction isProduction() {\n  return getMode() === \"production\";\n}\nfunction isDevelopment() {\n  return getMode() === \"development\";\n}\nfunction removeKey(key, { [key]: _, ...rest }) {\n  return rest;\n}\nfunction parseProperties(properties, options) {\n  if (!properties) return void 0;\n  let props = properties;\n  const errorProperties = [];\n  for (const [key, value] of Object.entries(properties)) {\n    if (typeof value === \"object\" && value !== null) {\n      if (options.strip) {\n        props = removeKey(key, props);\n      } else {\n        errorProperties.push(key);\n      }\n    }\n  }\n  if (errorProperties.length > 0 && !options.strip) {\n    throw Error(\n      `The following properties are not valid: ${errorProperties.join(\n        \", \"\n      )}. Only strings, numbers, booleans, and null are allowed.`\n    );\n  }\n  return props;\n}\nfunction getScriptSrc(props) {\n  if (props.scriptSrc) {\n    return props.scriptSrc;\n  }\n  if (isDevelopment()) {\n    return \"https://va.vercel-scripts.com/v1/script.debug.js\";\n  }\n  if (props.basePath) {\n    return `${props.basePath}/insights/script.js`;\n  }\n  return \"/_vercel/insights/script.js\";\n}\n\n// src/generic.ts\nfunction inject(props = {\n  debug: true\n}) {\n  var _a;\n  if (!isBrowser()) return;\n  setMode(props.mode);\n  initQueue();\n  if (props.beforeSend) {\n    (_a = window.va) == null ? void 0 : _a.call(window, \"beforeSend\", props.beforeSend);\n  }\n  const src = getScriptSrc(props);\n  if (document.head.querySelector(`script[src*=\"${src}\"]`)) return;\n  const script = document.createElement(\"script\");\n  script.src = src;\n  script.defer = true;\n  script.dataset.sdkn = name + (props.framework ? `/${props.framework}` : \"\");\n  script.dataset.sdkv = version;\n  if (props.disableAutoTrack) {\n    script.dataset.disableAutoTrack = \"1\";\n  }\n  if (props.endpoint) {\n    script.dataset.endpoint = props.endpoint;\n  } else if (props.basePath) {\n    script.dataset.endpoint = `${props.basePath}/insights`;\n  }\n  if (props.dsn) {\n    script.dataset.dsn = props.dsn;\n  }\n  script.onerror = () => {\n    const errorMessage = isDevelopment() ? \"Please check if any ad blockers are enabled and try again.\" : \"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.\";\n    console.log(\n      `[Vercel Web Analytics] Failed to load script from ${src}. ${errorMessage}`\n    );\n  };\n  if (isDevelopment() && props.debug === false) {\n    script.dataset.debug = \"false\";\n  }\n  document.head.appendChild(script);\n}\nfunction track(name2, properties, options) {\n  var _a, _b;\n  if (!isBrowser()) {\n    const msg = \"[Vercel Web Analytics] Please import `track` from `@vercel/analytics/server` when using this function in a server environment\";\n    if (isProduction()) {\n      console.warn(msg);\n    } else {\n      throw new Error(msg);\n    }\n    return;\n  }\n  if (!properties) {\n    (_a = window.va) == null ? void 0 : _a.call(window, \"event\", { name: name2, options });\n    return;\n  }\n  try {\n    const props = parseProperties(properties, {\n      strip: isProduction()\n    });\n    (_b = window.va) == null ? void 0 : _b.call(window, \"event\", {\n      name: name2,\n      data: props,\n      options\n    });\n  } catch (err) {\n    if (err instanceof Error && isDevelopment()) {\n      console.error(err);\n    }\n  }\n}\nfunction pageview({\n  route,\n  path\n}) {\n  var _a;\n  (_a = window.va) == null ? void 0 : _a.call(window, \"pageview\", { route, path });\n}\n\n// src/react/utils.ts\nfunction getBasePath() {\n  if (typeof process === \"undefined\" || typeof process.env === \"undefined\") {\n    return void 0;\n  }\n  return process.env.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH;\n}\n\n// src/react/index.tsx\nfunction Analytics(props) {\n  useEffect(() => {\n    var _a;\n    if (props.beforeSend) {\n      (_a = window.va) == null ? void 0 : _a.call(window, \"beforeSend\", props.beforeSend);\n    }\n  }, [props.beforeSend]);\n  useEffect(() => {\n    inject({\n      framework: props.framework || \"react\",\n      basePath: props.basePath ?? getBasePath(),\n      ...props.route !== void 0 && { disableAutoTrack: true },\n      ...props\n    });\n  }, []);\n  useEffect(() => {\n    if (props.route && props.path) {\n      pageview({ route: props.route, path: props.path });\n    }\n  }, [props.route, props.path]);\n  return null;\n}\nexport {\n  Analytics,\n  track\n};\n//# sourceMappingURL=index.mjs.map","/**\r\n * Pain Tracker - A comprehensive tool for tracking and managing chronic pain and injuries\r\n * Copyright (c) 2024 Pain Tracker. All rights reserved.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport { Suspense, useEffect, lazy, useState } from \"react\";\r\nimport { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\";\r\nimport { ErrorBoundary } from \"./components/ErrorBoundary\";\r\nimport { ThemeProvider } from \"./design-system\";\r\nimport { ToastProvider } from \"./components/feedback\";\r\nimport { TraumaInformedProvider } from \"./components/accessibility\";\r\nimport { SubscriptionProvider } from \"./contexts/SubscriptionContext\";\r\nimport { ToneProvider } from \"./contexts/ToneContext\";\r\nimport { StartupPromptsProvider } from \"./contexts/StartupPromptsContext\";\r\nimport { initializeToneEngine } from \"./services/ToneEngine\";\r\nimport { useGlobalAccessibility } from \"./hooks/useGlobalAccessibility\";\r\nimport './i18n/config';\r\nimport { PWAInstallPrompt } from './components/pwa/PWAInstallPrompt';\r\nimport { PWAStatusIndicator } from './components/pwa/PWAStatusIndicator';\r\nimport NotificationConsentPrompt from './components/NotificationConsentPrompt';\r\nimport AnalyticsConsentPrompt from './components/AnalyticsConsentPrompt';\r\nimport { VaultGate } from './components/security/VaultGate';\r\nimport { usePatternAlerts } from './hooks/usePatternAlerts';\r\nimport { usePainTrackerStore, selectEntries } from './stores/pain-tracker-store';\r\nimport { OfflineBanner } from './components/pwa/OfflineIndicator';\r\nimport { BlackBoxSplashScreen } from './components/branding/BlackBoxSplashScreen';\r\nimport { pwaManager } from './utils/pwa-utils';\r\nimport { ToneStateTester } from './components/dev/ToneStateTester';\r\nimport { trackSessionStart as trackUsageSessionStart } from './utils/usage-tracking';\r\nimport { Analytics } from \"@vercel/analytics/react\";\r\n\r\n// Lazy-loaded route components for code splitting\r\nconst PainTrackerContainer = lazy(() => import('./containers/PainTrackerContainer').then(m => ({ default: m.PainTrackerContainer })));\r\nconst LandingPage = lazy(() => import('./pages/LandingPage').then(m => ({ default: m.LandingPage })));\r\nconst PricingPage = lazy(() => import('./pages/PricingPage').then(m => ({ default: m.PricingPage })));\r\nconst ScreenshotShowcase = lazy(() => import('./pages/ScreenshotShowcase').then(m => ({ default: m.ScreenshotShowcase })));\r\nconst ClinicPortal = lazy(() => import('./pages/clinic/ClinicPortal').then(m => ({ default: m.ClinicPortal })));\r\nconst SubscriptionManagementPage = lazy(() => import('./pages/SubscriptionManagementPage').then(m => ({ default: m.SubscriptionManagementPage })));\r\nconst SubmitStoryPage = lazy(() => import('./pages/SubmitStoryPage').then(m => ({ default: m.SubmitStoryPage })));\r\n\r\nconst ErrorFallback = () => {\r\n  return (\r\n    <div className=\"min-h-screen flex items-center justify-center bg-background\">\r\n      <div className=\"text-center p-8 bg-card rounded-lg border shadow-lg max-w-md mx-4\">\r\n        <h2 className=\"text-2xl font-semibold text-destructive mb-4\">Something went wrong</h2>\r\n        <p className=\"text-muted-foreground mb-6\">\r\n          We encountered an unexpected error. Please try refreshing the page.\r\n        </p>\r\n        <button\r\n          onClick={() => window.location.reload()}\r\n          className=\"bg-primary text-primary-foreground px-6 py-2 rounded-md hover:bg-primary/90 transition-colors\"\r\n        >\r\n          Refresh Page\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst LoadingFallback = () => {\r\n  return <BlackBoxSplashScreen message=\"Loading...\" />;\r\n};\r\n\r\nfunction App() {\r\n  const [showSplash, setShowSplash] = useState(true);\r\n\r\n  // Ritual: Show splash screen for at least 2.5s on startup\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => setShowSplash(false), 2500);\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n\r\n  // Initialize global accessibility features\r\n  useGlobalAccessibility({\r\n    enableValidation: import.meta.env.DEV,\r\n    enableAutoLabeling: true,\r\n    announceRouteChanges: true,\r\n  });\r\n\r\n  // Defer non-critical initialization for faster mobile load\r\n  useEffect(() => {\r\n    // Use requestIdleCallback to defer analytics and tone engine\r\n    const initializeDeferred = () => {\r\n      // Initialize tone engine (non-blocking)\r\n      initializeToneEngine().catch(error => {\r\n        console.error('Failed to initialize tone engine:', error);\r\n        // Continue without tone engine - app still works\r\n      });\r\n      \r\n      // Defer analytics tracking to not block initial render\r\n      trackUsageSessionStart();\r\n      import('./services/AnalyticsTrackingService').then(({ trackSessionStart }) => {\r\n        trackSessionStart();\r\n      });\r\n    };\r\n\r\n    // Use requestIdleCallback if available, otherwise setTimeout\r\n    if ('requestIdleCallback' in window) {\r\n      (window as Window & { requestIdleCallback: (cb: () => void) => void }).requestIdleCallback(initializeDeferred);\r\n    } else {\r\n      setTimeout(initializeDeferred, 100);\r\n    }\r\n  }, []);\r\n\r\n  // Initialize PWA features\r\n  useEffect(() => {\r\n    // Initialize PWA manager\r\n    pwaManager.isAppInstalled();\r\n\r\n    // Initialize offline storage and background sync\r\n    const initializePWAFeatures = async () => {\r\n      try {\r\n        // Initialize offline storage\r\n        const { offlineStorage } = await import('./lib/offline-storage');\r\n        await offlineStorage.init();\r\n\r\n        // Initialize background sync with better error handling\r\n        try {\r\n          await import('./lib/background-sync');\r\n        } catch {\r\n          // Background sync not available - this is expected in some environments\r\n        }\r\n\r\n        // Setup health data sync if possible\r\n        await pwaManager.enableHealthDataSync();\r\n      } catch {\r\n        // Continue without PWA features - trauma-informed UX still works\r\n      }\r\n    };\r\n\r\n    initializePWAFeatures();\r\n\r\n    // Add debugging method to window for development\r\n    if (import.meta.env.DEV) {\r\n      (window as unknown as Record<string, unknown>).resetPWA = async () => {\r\n        try {\r\n          await pwaManager.resetServiceWorker();\r\n        } catch (error) {\r\n          console.error('PWA Reset failed:', error);\r\n        }\r\n      };\r\n      \r\n      // Expose test data loaders for console access\r\n      (window as unknown as Record<string, unknown>).loadChronicPainTestData = () => {\r\n        import('./data/chronic-pain-12-month-seed').then(\r\n          ({ chronicPain12MonthPainEntries, chronicPain12MonthMoodEntries, chronicPainDataStats }) => {\r\n            console.log('[Dev] Loading 12-month chronic pain test data:', chronicPainDataStats);\r\n            usePainTrackerStore.getState().clearAllData();\r\n            usePainTrackerStore.setState({\r\n              entries: chronicPain12MonthPainEntries,\r\n              moodEntries: chronicPain12MonthMoodEntries,\r\n            });\r\n            console.log('[Dev] Loaded', chronicPainDataStats.totalPainEntries, 'pain entries and', chronicPainDataStats.totalMoodEntries, 'mood entries');\r\n          }\r\n        );\r\n      };\r\n      \r\n      console.log('[Dev] Available commands: window.resetPWA(), window.loadChronicPainTestData()');\r\n    }\r\n  }, []);\r\n  // Subscribe to entries and wire pattern alerts\r\n  const storeEntries = usePainTrackerStore(selectEntries);\r\n  const patternEntries = storeEntries.map(e => ({\r\n    time: e.timestamp,\r\n    pain: e.baselineData?.pain ?? 0,\r\n  }));\r\n  usePatternAlerts(patternEntries);\r\n\r\n  // NOTE: Do NOT set basename when Vite handles the base path via VITE_BASE.\r\n  // Vite's dev server already serves from /pain-tracker/ and rewrites URLs correctly.\r\n  // Setting basename would cause React Router to strip the path from the URL bar,\r\n  // breaking bookmarks and page refreshes. Only set basename in production builds\r\n  // when deploying to a true subpath without server-side rewriting.\r\n  // For now, leave basename empty - Vite's base config handles asset paths.\r\n\r\n  if (showSplash) {\r\n    return <BlackBoxSplashScreen />;\r\n  }\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <Analytics />\r\n      <ThemeProvider>\r\n        <SubscriptionProvider>\r\n          <ToneProvider>\r\n            <TraumaInformedProvider>\r\n              <ToastProvider>\r\n                <StartupPromptsProvider>\r\n                  <Suspense fallback={<LoadingFallback />}>\r\n                    <Routes>\r\n                      {/* Landing Page - Public */}\r\n                      <Route path=\"/\" element={<LandingPage />} />\r\n\r\n                      {/* Pricing Page - Public */}\r\n                      <Route path=\"/pricing\" element={<PricingPage />} />\r\n\r\n                      {/* Screenshot Showcase - Public */}\r\n                      <Route path=\"/demo/*\" element={<ScreenshotShowcase />} />\r\n\r\n                      {/* Clinic Portal - Protected (separate UI/UX) */}\r\n                      <Route path=\"/clinic/*\" element={<ClinicPortal />} />\r\n\r\n                      {/* Subscription Management - Protected */}\r\n                      <Route\r\n                        path=\"/subscription\"\r\n                        element={\r\n                          <VaultGate>\r\n                            <SubscriptionManagementPage />\r\n                          </VaultGate>\r\n                        }\r\n                    />\r\n\r\n                    {/* Vault Setup/Login - Public */}\r\n                    <Route\r\n                      path=\"/start\"\r\n                      element={\r\n                        <VaultGate>\r\n                          <Navigate to=\"/app\" replace />\r\n                        </VaultGate>\r\n                      }\r\n                    />\r\n\r\n                    {/* Main Application - Protected */}\r\n                    <Route path=\"/app\" element={\r\n                      <VaultGate>\r\n                        <div className=\"min-h-screen bg-background transition-colors\" role=\"application\" aria-label=\"Pain Tracker Pro Application\">\r\n                          <OfflineBanner />\r\n                          <NotificationConsentPrompt />\r\n                          <AnalyticsConsentPrompt />\r\n                          <ErrorBoundary fallback={<ErrorFallback />}>\r\n                            <Suspense fallback={<LoadingFallback />}>\r\n                              <PainTrackerContainer />\r\n                            </Suspense>\r\n                          </ErrorBoundary>\r\n                          <PWAInstallPrompt />\r\n                          <PWAStatusIndicator />\r\n                          <ToneStateTester />\r\n                        </div>\r\n                      </VaultGate>\r\n                    } />\r\n\r\n                    {/* Route to open app and start daily check-in (used by notifications) */}\r\n                    <Route path=\"/app/checkin\" element={\r\n                      <VaultGate>\r\n                        <div className=\"min-h-screen bg-background transition-colors\" role=\"application\" aria-label=\"Pain Tracker Pro Application\">\r\n                          <OfflineBanner />\r\n                          <NotificationConsentPrompt />\r\n                          <AnalyticsConsentPrompt />\r\n                          <ErrorBoundary fallback={<ErrorFallback />}>\r\n                            <Suspense fallback={<LoadingFallback />}>\r\n                              <PainTrackerContainer initialView=\"daily-checkin\" />\r\n                            </Suspense>\r\n                          </ErrorBoundary>\r\n                          <PWAInstallPrompt />\r\n                          <PWAStatusIndicator />\r\n                          <ToneStateTester />\r\n                        </div>\r\n                      </VaultGate>\r\n                    } />\r\n\r\n                    {/* Submit testimonial/stories */}\r\n                    <Route path=\"/submit-story\" element={<SubmitStoryPage />} />\r\n\r\n                    {/* Fallback - redirect to landing */}\r\n                    <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\r\n                    </Routes>\r\n                  </Suspense>\r\n                </StartupPromptsProvider>\r\n              </ToastProvider>\r\n            </TraumaInformedProvider>\r\n          </ToneProvider>\r\n        </SubscriptionProvider>\r\n      </ThemeProvider>\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\nimport './styles/index.css';\r\n\r\n// Bootstrap test-mode flag when present in URL or localStorage.\r\n// This is intentionally limited to development builds (import.meta.env.DEV)\r\n// so it cannot be used in production to bypass security.\r\nif (import.meta.env.DEV) {\r\n  try {\r\n    const url = new URL(window.location.href);\r\n    const param = url.searchParams.get('pt_test_mode');\r\n    const lsFlag = localStorage.getItem('pt:test_mode');\r\n    if (param === '1' || lsFlag === '1') {\r\n      // set a well-known property on window for tests; typed as unknown to avoid `any`\r\n      (window as unknown as { __pt_test_mode?: boolean }).__pt_test_mode = true;\r\n    }\r\n  } catch {\r\n    // ignore errors reading URL/localStorage in some test harnesses\r\n  }\r\n}\r\n\r\nReactDOM.createRoot(document.getElementById('root')!).render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>\r\n);\r\n"],"file":"index-B7vNx0HN.js"}