{"version":3,"file":"HistoryPage-B2WU4TjY.js","sources":["../../src/components/history/HistoryPage.tsx"],"sourcesContent":["import { useMemo, useState } from 'react';\r\nimport { format } from 'date-fns';\r\nimport { Search, Pencil } from 'lucide-react';\r\nimport type { PainEntry } from '../../types';\r\nimport { Badge, Button, Card, CardContent, CardDescription, CardHeader, CardTitle, Input } from '../../design-system';\r\n\r\ninterface HistoryPageProps {\r\n  entries: PainEntry[];\r\n  onEditEntry: (id: PainEntry['id']) => void;\r\n}\r\n\r\nfunction stringifyEntry(entry: PainEntry): string {\r\n  const timestampText = format(new Date(entry.timestamp), 'EEE, MMM d, yyyy h:mm a');\r\n  const isoDate = entry.timestamp.split('T')[0] ?? '';\r\n\r\n  const locations = (entry.baselineData.locations ?? []).join(' ');\r\n  const symptoms = (entry.baselineData.symptoms ?? []).join(' ');\r\n  const notes = entry.notes ?? '';\r\n\r\n  return [timestampText, isoDate, String(entry.baselineData.pain), locations, symptoms, notes]\r\n    .join(' ')\r\n    .toLowerCase();\r\n}\r\n\r\nexport function HistoryPage({ entries, onEditEntry }: HistoryPageProps) {\r\n  const [query, setQuery] = useState('');\r\n  const normalizedQuery = query.trim().toLowerCase();\r\n\r\n  const filtered = useMemo(() => {\r\n    const sorted = [...entries].sort(\r\n      (a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()\r\n    );\r\n\r\n    if (!normalizedQuery) return sorted;\r\n\r\n    return sorted.filter(entry => stringifyEntry(entry).includes(normalizedQuery));\r\n  }, [entries, normalizedQuery]);\r\n\r\n  const resultLabel = useMemo(() => {\r\n    if (!normalizedQuery) return `${entries.length} total`;\r\n    return `${filtered.length} match${filtered.length === 1 ? '' : 'es'}`;\r\n  }, [entries.length, filtered.length, normalizedQuery]);\r\n\r\n  return (\r\n    <div className=\"mx-auto w-full max-w-5xl space-y-4\">\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>History</CardTitle>\r\n          <CardDescription>\r\n            Search by date, pain level, location, symptoms, or notes.\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-3\">\r\n          <div className=\"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between\">\r\n            <Input\r\n              label=\"Search\"\r\n              placeholder=\"Try: Dec 22, 7, lower back, cramping...\"\r\n              value={query}\r\n              onChange={e => setQuery(e.target.value)}\r\n              inputMode=\"search\"\r\n              startIcon={<Search className=\"h-4 w-4\" aria-hidden=\"true\" />}\r\n              fullWidth\r\n            />\r\n            <div className=\"flex items-center justify-between gap-2 sm:justify-end\">\r\n              <Badge variant=\"outline\">{resultLabel}</Badge>\r\n              {normalizedQuery && (\r\n                <Button type=\"button\" variant=\"outline\" onClick={() => setQuery('')}>\r\n                  Clear\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {filtered.length === 0 ? (\r\n            <p className=\"text-sm text-muted-foreground\">No matching entries.</p>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {filtered.map(entry => {\r\n                const timestampText = format(new Date(entry.timestamp), 'EEE, MMM d, yyyy h:mm a');\r\n                const locations = entry.baselineData.locations ?? [];\r\n                const symptoms = entry.baselineData.symptoms ?? [];\r\n\r\n                return (\r\n                  <div key={entry.id} className=\"rounded-lg border bg-card p-4\">\r\n                    <div className=\"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between\">\r\n                      <div className=\"space-y-1\">\r\n                        <div className=\"flex flex-wrap items-center gap-2\">\r\n                          <span className=\"text-sm font-semibold\">Pain {entry.baselineData.pain}/10</span>\r\n                          <span className=\"text-sm text-muted-foreground\">{timestampText}</span>\r\n                        </div>\r\n                        <div className=\"flex flex-wrap gap-2\">\r\n                          <Badge variant=\"outline\">{locations.length} location{locations.length === 1 ? '' : 's'}</Badge>\r\n                          <Badge variant=\"outline\">{symptoms.length} symptom{symptoms.length === 1 ? '' : 's'}</Badge>\r\n                        </div>\r\n                      </div>\r\n\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"outline\"\r\n                        onClick={() => onEditEntry(entry.id)}\r\n                        className=\"sm:self-start\"\r\n                      >\r\n                        <Pencil className=\"mr-2 h-4 w-4\" aria-hidden=\"true\" />\r\n                        Edit\r\n                      </Button>\r\n                    </div>\r\n\r\n                    {locations.length > 0 && (\r\n                      <p className=\"mt-3 text-sm text-muted-foreground\">\r\n                        <span className=\"font-medium text-foreground\">Locations:</span> {locations.join(', ')}\r\n                      </p>\r\n                    )}\r\n                    {symptoms.length > 0 && (\r\n                      <p className=\"mt-1 text-sm text-muted-foreground\">\r\n                        <span className=\"font-medium text-foreground\">Symptoms:</span> {symptoms.join(', ')}\r\n                      </p>\r\n                    )}\r\n                    {entry.notes && (\r\n                      <p className=\"mt-2 whitespace-pre-wrap text-sm text-muted-foreground\">\r\n                        <span className=\"font-medium text-foreground\">Notes:</span> {entry.notes}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HistoryPage;\r\n"],"names":["HistoryPage","entries","onEditEntry","query","setQuery","useState","normalizedQuery","trim","toLowerCase","filtered","useMemo","sorted","sort","a","b","Date","timestamp","getTime","filter","entry","timestampText","format","isoDate","split","locations","baselineData","join","symptoms","notes","String","pain","stringifyEntry","includes","resultLabel","length","jsxDEV","className","children","Card","CardHeader","CardTitle","fileName","lineNumber","columnNumber","this","CardDescription","CardContent","Input","label","placeholder","value","onChange","e","target","inputMode","startIcon","Search","fullWidth","Badge","variant","Button","type","onClick","map","id","Pencil"],"mappings":"8XAwBO,SAASA,GAAYC,QAAEA,EAAAC,YAASA,IACrC,MAAOC,EAAOC,GAAYC,EAAAA,SAAS,IAC7BC,EAAkBH,EAAMI,OAAOC,cAE/BC,EAAWC,EAAAA,QAAQ,KACvB,MAAMC,EAAS,IAAIV,GAASW,KAC1B,CAACC,EAAGC,IAAM,IAAIC,KAAKD,EAAEE,WAAWC,UAAY,IAAIF,KAAKF,EAAEG,WAAWC,WAGpE,OAAKX,EAEEK,EAAOO,OAAOC,GAxBzB,SAAwBA,GACtB,MAAMC,EAAgBC,EAAO,IAAIN,KAAKI,EAAMH,WAAY,2BAClDM,EAAUH,EAAMH,UAAUO,MAAM,KAAK,IAAM,GAE3CC,GAAaL,EAAMM,aAAaD,WAAa,IAAIE,KAAK,KACtDC,GAAYR,EAAMM,aAAaE,UAAY,IAAID,KAAK,KACpDE,EAAQT,EAAMS,OAAS,GAE7B,MAAO,CAACR,EAAeE,EAASO,OAAOV,EAAMM,aAAaK,MAAON,EAAWG,EAAUC,GACnFF,KAAK,KACLlB,aACL,CAakCuB,CAAeZ,GAAOa,SAAS1B,IAFhCK,GAG5B,CAACV,EAASK,IAEP2B,EAAcvB,EAAAA,QAAQ,IACrBJ,EACE,GAAGG,EAASyB,eAAmC,IAApBzB,EAASyB,OAAe,GAAK,OADlC,GAAGjC,EAAQiC,eAEvC,CAACjC,EAAQiC,OAAQzB,EAASyB,OAAQ5B,IAErC,OACE6B,EAAAA,OAAC,MAAA,CAAIC,UAAU,qCACbC,kBAACC,EAAA,CACCD,SAAA,CAAAF,SAACI,EAAA,CACCF,SAAA,CAAAF,EAAAA,OAACK,GAAUH,SAAA,gBAAX,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MACAT,EAAAA,OAACU,GAAgBR,SAAA,kEAAjB,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,GAAAC,QAMAT,OAACW,EAAA,CAAYV,UAAU,YACrBC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,kEACbC,SAAA,CAAAF,EAAAA,OAACY,EAAA,CACCC,MAAM,SACNC,YAAY,0CACZC,MAAO/C,EACPgD,SAAUC,GAAKhD,EAASgD,EAAEC,OAAOH,OACjCI,UAAU,SACVC,UAAWpB,EAAAA,OAACqB,EAAA,CAAOpB,UAAU,UAAU,cAAY,aAAxC,GAAA,EAAA,CAAAK,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MACXa,WAAS,QAPX,GAAA,EAAA,CAAAhB,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,QASAT,OAAC,MAAA,CAAIC,UAAU,yDACbC,SAAA,CAAAF,SAACuB,EAAA,CAAMC,QAAQ,UAAWtB,SAAAJ,QAA1B,GAAA,EAAA,CAAAQ,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MACCtC,GACC6B,EAAAA,OAACyB,EAAA,CAAOC,KAAK,SAASF,QAAQ,UAAUG,QAAS,IAAM1D,EAAS,IAAKiC,SAAA,cAArE,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAHJ,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAVF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MAoBqB,IAApBnC,EAASyB,gBACP,IAAA,CAAEE,UAAU,gCAAgCC,SAAA,6BAA7C,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MAEAT,SAAC,MAAA,CAAIC,UAAU,YACZC,SAAA5B,EAASsD,IAAI5C,IACZ,MAAMC,EAAgBC,EAAO,IAAIN,KAAKI,EAAMH,WAAY,2BAClDQ,EAAYL,EAAMM,aAAaD,WAAa,GAC5CG,EAAWR,EAAMM,aAAaE,UAAY,GAEhD,SACEQ,OAAC,MAAA,CAAmBC,UAAU,gCAC5BC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,oEACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,YACbC,SAAA,GAAAF,OAAC,MAAA,CAAIC,UAAU,oCACbC,SAAA,GAAAF,OAAC,OAAA,CAAKC,UAAU,wBAAwBC,SAAA,CAAA,QAAMlB,EAAMM,aAAaK,KAAK,aAAtE,GAAA,EAAA,CAAAW,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MACAT,SAAC,OAAA,CAAKC,UAAU,gCAAiCC,SAAAjB,QAAjD,GAAA,EAAA,CAAAqB,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,QAIAT,OAAC,MAAA,CAAIC,UAAU,uBACbC,SAAA,GAAAF,OAACuB,EAAA,CAAMC,QAAQ,UAAWtB,SAAA,CAAAb,EAAUU,OAAO,YAA+B,IAArBV,EAAUU,OAAe,GAAK,WAAnF,GAAA,EAAA,CAAAO,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,QACAT,OAACuB,EAAA,CAAMC,QAAQ,UAAWtB,SAAA,CAAAV,EAASO,OAAO,WAA6B,IAApBP,EAASO,OAAe,GAAK,WAAhF,GAAA,EAAA,CAAAO,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAFF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aALF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MAWAT,EAAAA,OAACyB,EAAA,CACCC,KAAK,SACLF,QAAQ,UACRG,QAAS,IAAM5D,EAAYiB,EAAM6C,IACjC5B,UAAU,gBAEVC,SAAA,CAAAF,SAAC8B,EAAA,CAAO7B,UAAU,eAAe,cAAY,aAA7C,GAAA,EAAA,CAAAK,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAAsD,cANxD,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAZF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,MAuBCpB,EAAUU,OAAS,GAClBC,EAAAA,OAAC,IAAA,CAAEC,UAAU,qCACXC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,8BAA8BC,SAAA,mBAA9C,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAA+D,IAAEpB,EAAUE,KAAK,aADlF,GAAA,EAAA,CAAAe,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAIDjB,EAASO,OAAS,GACjBC,EAAAA,OAAC,IAAA,CAAEC,UAAU,qCACXC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,8BAA8BC,SAAA,kBAA9C,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAA8D,IAAEjB,EAASD,KAAK,aADhF,GAAA,EAAA,CAAAe,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAIDzB,EAAMS,OACLO,SAAC,IAAA,CAAEC,UAAU,yDACXC,SAAA,CAAAF,SAAC,OAAA,CAAKC,UAAU,8BAA8BC,SAAA,eAA9C,GAAA,EAAA,CAAAI,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,MAA2D,IAAEzB,EAAMS,aADrE,GAAA,EAAA,CAAAa,SAAA,sFAAAC,WAAA,IAAAC,aAAA,IAAAC,QAnCMzB,EAAM6C,IAAhB,EAAA,CAAAvB,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,cAPN,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,IAAAC,aAxBJ,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,GAAAC,aAPF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,GAAAC,YADF,GAAA,EAAA,CAAAH,SAAA,sFAAAC,WAAA,GAAAC,aAAA,GAAAC,KAuFJ"}